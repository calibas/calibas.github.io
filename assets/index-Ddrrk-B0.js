var e2=Object.defineProperty;var t2=(i,e,t)=>e in i?e2(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var Be=(i,e,t)=>t2(i,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(a){if(a.ep)return;a.ep=!0;const s=t(a);fetch(a.href,s)}})();var kd={exports:{}},po={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var t1;function i2(){if(t1)return po;t1=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(r,a,s){var o=null;if(s!==void 0&&(o=""+s),a.key!==void 0&&(o=""+a.key),"key"in a){s={};for(var u in a)u!=="key"&&(s[u]=a[u])}else s=a;return a=s.ref,{$$typeof:i,type:r,key:o,ref:a!==void 0?a:null,props:s}}return po.Fragment=e,po.jsx=t,po.jsxs=t,po}var i1;function r2(){return i1||(i1=1,kd.exports=i2()),kd.exports}var nt=r2(),Ad={exports:{}},ot={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r1;function a2(){if(r1)return ot;r1=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),o=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),b=Symbol.iterator;function g(F){return F===null||typeof F!="object"?null:(F=b&&F[b]||F["@@iterator"],typeof F=="function"?F:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,C={};function E(F,he,_e){this.props=F,this.context=he,this.refs=C,this.updater=_e||v}E.prototype.isReactComponent={},E.prototype.setState=function(F,he){if(typeof F!="object"&&typeof F!="function"&&F!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,F,he,"setState")},E.prototype.forceUpdate=function(F){this.updater.enqueueForceUpdate(this,F,"forceUpdate")};function w(){}w.prototype=E.prototype;function R(F,he,_e){this.props=F,this.context=he,this.refs=C,this.updater=_e||v}var T=R.prototype=new w;T.constructor=R,y(T,E.prototype),T.isPureReactComponent=!0;var D=Array.isArray,k={H:null,A:null,T:null,S:null},V=Object.prototype.hasOwnProperty;function P(F,he,_e,ye,pe,Ne){return _e=Ne.ref,{$$typeof:i,type:F,key:he,ref:_e!==void 0?_e:null,props:Ne}}function U(F,he){return P(F.type,he,void 0,void 0,void 0,F.props)}function N(F){return typeof F=="object"&&F!==null&&F.$$typeof===i}function j(F){var he={"=":"=0",":":"=2"};return"$"+F.replace(/[=:]/g,function(_e){return he[_e]})}var Y=/\/+/g;function Z(F,he){return typeof F=="object"&&F!==null&&F.key!=null?j(""+F.key):he.toString(36)}function ce(){}function Le(F){switch(F.status){case"fulfilled":return F.value;case"rejected":throw F.reason;default:switch(typeof F.status=="string"?F.then(ce,ce):(F.status="pending",F.then(function(he){F.status==="pending"&&(F.status="fulfilled",F.value=he)},function(he){F.status==="pending"&&(F.status="rejected",F.reason=he)})),F.status){case"fulfilled":return F.value;case"rejected":throw F.reason}}throw F}function ge(F,he,_e,ye,pe){var Ne=typeof F;(Ne==="undefined"||Ne==="boolean")&&(F=null);var Oe=!1;if(F===null)Oe=!0;else switch(Ne){case"bigint":case"string":case"number":Oe=!0;break;case"object":switch(F.$$typeof){case i:case e:Oe=!0;break;case p:return Oe=F._init,ge(Oe(F._payload),he,_e,ye,pe)}}if(Oe)return pe=pe(F),Oe=ye===""?"."+Z(F,0):ye,D(pe)?(_e="",Oe!=null&&(_e=Oe.replace(Y,"$&/")+"/"),ge(pe,he,_e,"",function(q){return q})):pe!=null&&(N(pe)&&(pe=U(pe,_e+(pe.key==null||F&&F.key===pe.key?"":(""+pe.key).replace(Y,"$&/")+"/")+Oe)),he.push(pe)),1;Oe=0;var qe=ye===""?".":ye+":";if(D(F))for(var z=0;z<F.length;z++)ye=F[z],Ne=qe+Z(ye,z),Oe+=ge(ye,he,_e,Ne,pe);else if(z=g(F),typeof z=="function")for(F=z.call(F),z=0;!(ye=F.next()).done;)ye=ye.value,Ne=qe+Z(ye,z++),Oe+=ge(ye,he,_e,Ne,pe);else if(Ne==="object"){if(typeof F.then=="function")return ge(Le(F),he,_e,ye,pe);throw he=String(F),Error("Objects are not valid as a React child (found: "+(he==="[object Object]"?"object with keys {"+Object.keys(F).join(", ")+"}":he)+"). If you meant to render a collection of children, use an array instead.")}return Oe}function me(F,he,_e){if(F==null)return F;var ye=[],pe=0;return ge(F,ye,"","",function(Ne){return he.call(_e,Ne,pe++)}),ye}function de(F){if(F._status===-1){var he=F._result;he=he(),he.then(function(_e){(F._status===0||F._status===-1)&&(F._status=1,F._result=_e)},function(_e){(F._status===0||F._status===-1)&&(F._status=2,F._result=_e)}),F._status===-1&&(F._status=0,F._result=he)}if(F._status===1)return F._result.default;throw F._result}var ve=typeof reportError=="function"?reportError:function(F){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var he=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof F=="object"&&F!==null&&typeof F.message=="string"?String(F.message):String(F),error:F});if(!window.dispatchEvent(he))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",F);return}console.error(F)};function Me(){}return ot.Children={map:me,forEach:function(F,he,_e){me(F,function(){he.apply(this,arguments)},_e)},count:function(F){var he=0;return me(F,function(){he++}),he},toArray:function(F){return me(F,function(he){return he})||[]},only:function(F){if(!N(F))throw Error("React.Children.only expected to receive a single React element child.");return F}},ot.Component=E,ot.Fragment=t,ot.Profiler=a,ot.PureComponent=R,ot.StrictMode=r,ot.Suspense=h,ot.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=k,ot.act=function(){throw Error("act(...) is not supported in production builds of React.")},ot.cache=function(F){return function(){return F.apply(null,arguments)}},ot.cloneElement=function(F,he,_e){if(F==null)throw Error("The argument must be a React element, but you passed "+F+".");var ye=y({},F.props),pe=F.key,Ne=void 0;if(he!=null)for(Oe in he.ref!==void 0&&(Ne=void 0),he.key!==void 0&&(pe=""+he.key),he)!V.call(he,Oe)||Oe==="key"||Oe==="__self"||Oe==="__source"||Oe==="ref"&&he.ref===void 0||(ye[Oe]=he[Oe]);var Oe=arguments.length-2;if(Oe===1)ye.children=_e;else if(1<Oe){for(var qe=Array(Oe),z=0;z<Oe;z++)qe[z]=arguments[z+2];ye.children=qe}return P(F.type,pe,void 0,void 0,Ne,ye)},ot.createContext=function(F){return F={$$typeof:o,_currentValue:F,_currentValue2:F,_threadCount:0,Provider:null,Consumer:null},F.Provider=F,F.Consumer={$$typeof:s,_context:F},F},ot.createElement=function(F,he,_e){var ye,pe={},Ne=null;if(he!=null)for(ye in he.key!==void 0&&(Ne=""+he.key),he)V.call(he,ye)&&ye!=="key"&&ye!=="__self"&&ye!=="__source"&&(pe[ye]=he[ye]);var Oe=arguments.length-2;if(Oe===1)pe.children=_e;else if(1<Oe){for(var qe=Array(Oe),z=0;z<Oe;z++)qe[z]=arguments[z+2];pe.children=qe}if(F&&F.defaultProps)for(ye in Oe=F.defaultProps,Oe)pe[ye]===void 0&&(pe[ye]=Oe[ye]);return P(F,Ne,void 0,void 0,null,pe)},ot.createRef=function(){return{current:null}},ot.forwardRef=function(F){return{$$typeof:u,render:F}},ot.isValidElement=N,ot.lazy=function(F){return{$$typeof:p,_payload:{_status:-1,_result:F},_init:de}},ot.memo=function(F,he){return{$$typeof:d,type:F,compare:he===void 0?null:he}},ot.startTransition=function(F){var he=k.T,_e={};k.T=_e;try{var ye=F(),pe=k.S;pe!==null&&pe(_e,ye),typeof ye=="object"&&ye!==null&&typeof ye.then=="function"&&ye.then(Me,ve)}catch(Ne){ve(Ne)}finally{k.T=he}},ot.unstable_useCacheRefresh=function(){return k.H.useCacheRefresh()},ot.use=function(F){return k.H.use(F)},ot.useActionState=function(F,he,_e){return k.H.useActionState(F,he,_e)},ot.useCallback=function(F,he){return k.H.useCallback(F,he)},ot.useContext=function(F){return k.H.useContext(F)},ot.useDebugValue=function(){},ot.useDeferredValue=function(F,he){return k.H.useDeferredValue(F,he)},ot.useEffect=function(F,he){return k.H.useEffect(F,he)},ot.useId=function(){return k.H.useId()},ot.useImperativeHandle=function(F,he,_e){return k.H.useImperativeHandle(F,he,_e)},ot.useInsertionEffect=function(F,he){return k.H.useInsertionEffect(F,he)},ot.useLayoutEffect=function(F,he){return k.H.useLayoutEffect(F,he)},ot.useMemo=function(F,he){return k.H.useMemo(F,he)},ot.useOptimistic=function(F,he){return k.H.useOptimistic(F,he)},ot.useReducer=function(F,he,_e){return k.H.useReducer(F,he,_e)},ot.useRef=function(F){return k.H.useRef(F)},ot.useState=function(F){return k.H.useState(F)},ot.useSyncExternalStore=function(F,he,_e){return k.H.useSyncExternalStore(F,he,_e)},ot.useTransition=function(){return k.H.useTransition()},ot.version="19.0.0",ot}var a1;function sh(){return a1||(a1=1,Ad.exports=a2()),Ad.exports}var ne=sh(),Dd={exports:{}},mo={},Fd={exports:{}},Md={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n1;function n2(){return n1||(n1=1,function(i){function e(me,de){var ve=me.length;me.push(de);e:for(;0<ve;){var Me=ve-1>>>1,F=me[Me];if(0<a(F,de))me[Me]=de,me[ve]=F,ve=Me;else break e}}function t(me){return me.length===0?null:me[0]}function r(me){if(me.length===0)return null;var de=me[0],ve=me.pop();if(ve!==de){me[0]=ve;e:for(var Me=0,F=me.length,he=F>>>1;Me<he;){var _e=2*(Me+1)-1,ye=me[_e],pe=_e+1,Ne=me[pe];if(0>a(ye,ve))pe<F&&0>a(Ne,ye)?(me[Me]=Ne,me[pe]=ve,Me=pe):(me[Me]=ye,me[_e]=ve,Me=_e);else if(pe<F&&0>a(Ne,ve))me[Me]=Ne,me[pe]=ve,Me=pe;else break e}}return de}function a(me,de){var ve=me.sortIndex-de.sortIndex;return ve!==0?ve:me.id-de.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;i.unstable_now=function(){return s.now()}}else{var o=Date,u=o.now();i.unstable_now=function(){return o.now()-u}}var h=[],d=[],p=1,b=null,g=3,v=!1,y=!1,C=!1,E=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,R=typeof setImmediate<"u"?setImmediate:null;function T(me){for(var de=t(d);de!==null;){if(de.callback===null)r(d);else if(de.startTime<=me)r(d),de.sortIndex=de.expirationTime,e(h,de);else break;de=t(d)}}function D(me){if(C=!1,T(me),!y)if(t(h)!==null)y=!0,Le();else{var de=t(d);de!==null&&ge(D,de.startTime-me)}}var k=!1,V=-1,P=5,U=-1;function N(){return!(i.unstable_now()-U<P)}function j(){if(k){var me=i.unstable_now();U=me;var de=!0;try{e:{y=!1,C&&(C=!1,w(V),V=-1),v=!0;var ve=g;try{t:{for(T(me),b=t(h);b!==null&&!(b.expirationTime>me&&N());){var Me=b.callback;if(typeof Me=="function"){b.callback=null,g=b.priorityLevel;var F=Me(b.expirationTime<=me);if(me=i.unstable_now(),typeof F=="function"){b.callback=F,T(me),de=!0;break t}b===t(h)&&r(h),T(me)}else r(h);b=t(h)}if(b!==null)de=!0;else{var he=t(d);he!==null&&ge(D,he.startTime-me),de=!1}}break e}finally{b=null,g=ve,v=!1}de=void 0}}finally{de?Y():k=!1}}}var Y;if(typeof R=="function")Y=function(){R(j)};else if(typeof MessageChannel<"u"){var Z=new MessageChannel,ce=Z.port2;Z.port1.onmessage=j,Y=function(){ce.postMessage(null)}}else Y=function(){E(j,0)};function Le(){k||(k=!0,Y())}function ge(me,de){V=E(function(){me(i.unstable_now())},de)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(me){me.callback=null},i.unstable_continueExecution=function(){y||v||(y=!0,Le())},i.unstable_forceFrameRate=function(me){0>me||125<me?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<me?Math.floor(1e3/me):5},i.unstable_getCurrentPriorityLevel=function(){return g},i.unstable_getFirstCallbackNode=function(){return t(h)},i.unstable_next=function(me){switch(g){case 1:case 2:case 3:var de=3;break;default:de=g}var ve=g;g=de;try{return me()}finally{g=ve}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function(me,de){switch(me){case 1:case 2:case 3:case 4:case 5:break;default:me=3}var ve=g;g=me;try{return de()}finally{g=ve}},i.unstable_scheduleCallback=function(me,de,ve){var Me=i.unstable_now();switch(typeof ve=="object"&&ve!==null?(ve=ve.delay,ve=typeof ve=="number"&&0<ve?Me+ve:Me):ve=Me,me){case 1:var F=-1;break;case 2:F=250;break;case 5:F=1073741823;break;case 4:F=1e4;break;default:F=5e3}return F=ve+F,me={id:p++,callback:de,priorityLevel:me,startTime:ve,expirationTime:F,sortIndex:-1},ve>Me?(me.sortIndex=ve,e(d,me),t(h)===null&&me===t(d)&&(C?(w(V),V=-1):C=!0,ge(D,ve-Me))):(me.sortIndex=F,e(h,me),y||v||(y=!0,Le())),me},i.unstable_shouldYield=N,i.unstable_wrapCallback=function(me){var de=g;return function(){var ve=g;g=de;try{return me.apply(this,arguments)}finally{g=ve}}}}(Md)),Md}var s1;function s2(){return s1||(s1=1,Fd.exports=n2()),Fd.exports}var Od={exports:{}},Ii={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l1;function l2(){if(l1)return Ii;l1=1;var i=sh();function e(h){var d="https://react.dev/errors/"+h;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)d+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+h+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var r={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},a=Symbol.for("react.portal");function s(h,d,p){var b=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:b==null?null:""+b,children:h,containerInfo:d,implementation:p}}var o=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(h,d){if(h==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return Ii.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Ii.createPortal=function(h,d){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return s(h,d,null,p)},Ii.flushSync=function(h){var d=o.T,p=r.p;try{if(o.T=null,r.p=2,h)return h()}finally{o.T=d,r.p=p,r.d.f()}},Ii.preconnect=function(h,d){typeof h=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,r.d.C(h,d))},Ii.prefetchDNS=function(h){typeof h=="string"&&r.d.D(h)},Ii.preinit=function(h,d){if(typeof h=="string"&&d&&typeof d.as=="string"){var p=d.as,b=u(p,d.crossOrigin),g=typeof d.integrity=="string"?d.integrity:void 0,v=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;p==="style"?r.d.S(h,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:b,integrity:g,fetchPriority:v}):p==="script"&&r.d.X(h,{crossOrigin:b,integrity:g,fetchPriority:v,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},Ii.preinitModule=function(h,d){if(typeof h=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var p=u(d.as,d.crossOrigin);r.d.M(h,{crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&r.d.M(h)},Ii.preload=function(h,d){if(typeof h=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var p=d.as,b=u(p,d.crossOrigin);r.d.L(h,p,{crossOrigin:b,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},Ii.preloadModule=function(h,d){if(typeof h=="string")if(d){var p=u(d.as,d.crossOrigin);r.d.m(h,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else r.d.m(h)},Ii.requestFormReset=function(h){r.d.r(h)},Ii.unstable_batchedUpdates=function(h,d){return h(d)},Ii.useFormState=function(h,d,p){return o.H.useFormState(h,d,p)},Ii.useFormStatus=function(){return o.H.useHostTransitionStatus()},Ii.version="19.0.0",Ii}var o1;function ex(){if(o1)return Od.exports;o1=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),Od.exports=l2(),Od.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var u1;function o2(){if(u1)return mo;u1=1;var i=s2(),e=sh(),t=ex();function r(n){var l="https://react.dev/errors/"+n;if(1<arguments.length){l+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)l+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+n+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}var s=Symbol.for("react.element"),o=Symbol.for("react.transitional.element"),u=Symbol.for("react.portal"),h=Symbol.for("react.fragment"),d=Symbol.for("react.strict_mode"),p=Symbol.for("react.profiler"),b=Symbol.for("react.provider"),g=Symbol.for("react.consumer"),v=Symbol.for("react.context"),y=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),E=Symbol.for("react.suspense_list"),w=Symbol.for("react.memo"),R=Symbol.for("react.lazy"),T=Symbol.for("react.offscreen"),D=Symbol.for("react.memo_cache_sentinel"),k=Symbol.iterator;function V(n){return n===null||typeof n!="object"?null:(n=k&&n[k]||n["@@iterator"],typeof n=="function"?n:null)}var P=Symbol.for("react.client.reference");function U(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===P?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case h:return"Fragment";case u:return"Portal";case p:return"Profiler";case d:return"StrictMode";case C:return"Suspense";case E:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case v:return(n.displayName||"Context")+".Provider";case g:return(n._context.displayName||"Context")+".Consumer";case y:var l=n.render;return n=n.displayName,n||(n=l.displayName||l.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case w:return l=n.displayName||null,l!==null?l:U(n.type)||"Memo";case R:l=n._payload,n=n._init;try{return U(n(l))}catch{}}return null}var N=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,j=Object.assign,Y,Z;function ce(n){if(Y===void 0)try{throw Error()}catch(c){var l=c.stack.trim().match(/\n( *(at )?)/);Y=l&&l[1]||"",Z=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Y+n+Z}var Le=!1;function ge(n,l){if(!n||Le)return"";Le=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(l){var Re=function(){throw Error()};if(Object.defineProperty(Re.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Re,[])}catch(be){var ue=be}Reflect.construct(n,[],Re)}else{try{Re.call()}catch(be){ue=be}n.call(Re.prototype)}}else{try{throw Error()}catch(be){ue=be}(Re=n())&&typeof Re.catch=="function"&&Re.catch(function(){})}}catch(be){if(be&&ue&&typeof be.stack=="string")return[be.stack,ue.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var x=f.DetermineComponentFrameRoot(),_=x[0],O=x[1];if(_&&O){var G=_.split(`
`),J=O.split(`
`);for(m=f=0;f<G.length&&!G[f].includes("DetermineComponentFrameRoot");)f++;for(;m<J.length&&!J[m].includes("DetermineComponentFrameRoot");)m++;if(f===G.length||m===J.length)for(f=G.length-1,m=J.length-1;1<=f&&0<=m&&G[f]!==J[m];)m--;for(;1<=f&&0<=m;f--,m--)if(G[f]!==J[m]){if(f!==1||m!==1)do if(f--,m--,0>m||G[f]!==J[m]){var xe=`
`+G[f].replace(" at new "," at ");return n.displayName&&xe.includes("<anonymous>")&&(xe=xe.replace("<anonymous>",n.displayName)),xe}while(1<=f&&0<=m);break}}}finally{Le=!1,Error.prepareStackTrace=c}return(c=n?n.displayName||n.name:"")?ce(c):""}function me(n){switch(n.tag){case 26:case 27:case 5:return ce(n.type);case 16:return ce("Lazy");case 13:return ce("Suspense");case 19:return ce("SuspenseList");case 0:case 15:return n=ge(n.type,!1),n;case 11:return n=ge(n.type.render,!1),n;case 1:return n=ge(n.type,!0),n;default:return""}}function de(n){try{var l="";do l+=me(n),n=n.return;while(n);return l}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}function ve(n){var l=n,c=n;if(n.alternate)for(;l.return;)l=l.return;else{n=l;do l=n,(l.flags&4098)!==0&&(c=l.return),n=l.return;while(n)}return l.tag===3?c:null}function Me(n){if(n.tag===13){var l=n.memoizedState;if(l===null&&(n=n.alternate,n!==null&&(l=n.memoizedState)),l!==null)return l.dehydrated}return null}function F(n){if(ve(n)!==n)throw Error(r(188))}function he(n){var l=n.alternate;if(!l){if(l=ve(n),l===null)throw Error(r(188));return l!==n?null:n}for(var c=n,f=l;;){var m=c.return;if(m===null)break;var x=m.alternate;if(x===null){if(f=m.return,f!==null){c=f;continue}break}if(m.child===x.child){for(x=m.child;x;){if(x===c)return F(m),n;if(x===f)return F(m),l;x=x.sibling}throw Error(r(188))}if(c.return!==f.return)c=m,f=x;else{for(var _=!1,O=m.child;O;){if(O===c){_=!0,c=m,f=x;break}if(O===f){_=!0,f=m,c=x;break}O=O.sibling}if(!_){for(O=x.child;O;){if(O===c){_=!0,c=x,f=m;break}if(O===f){_=!0,f=x,c=m;break}O=O.sibling}if(!_)throw Error(r(189))}}if(c.alternate!==f)throw Error(r(190))}if(c.tag!==3)throw Error(r(188));return c.stateNode.current===c?n:l}function _e(n){var l=n.tag;if(l===5||l===26||l===27||l===6)return n;for(n=n.child;n!==null;){if(l=_e(n),l!==null)return l;n=n.sibling}return null}var ye=Array.isArray,pe=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ne={pending:!1,data:null,method:null,action:null},Oe=[],qe=-1;function z(n){return{current:n}}function q(n){0>qe||(n.current=Oe[qe],Oe[qe]=null,qe--)}function X(n,l){qe++,Oe[qe]=n.current,n.current=l}var W=z(null),we=z(null),H=z(null),ze=z(null);function He(n,l){switch(X(H,l),X(we,n),X(W,null),n=l.nodeType,n){case 9:case 11:l=(l=l.documentElement)&&(l=l.namespaceURI)?Dv(l):0;break;default:if(n=n===8?l.parentNode:l,l=n.tagName,n=n.namespaceURI)n=Dv(n),l=Fv(n,l);else switch(l){case"svg":l=1;break;case"math":l=2;break;default:l=0}}q(W),X(W,l)}function De(){q(W),q(we),q(H)}function Xe(n){n.memoizedState!==null&&X(ze,n);var l=W.current,c=Fv(l,n.type);l!==c&&(X(we,n),X(W,c))}function We(n){we.current===n&&(q(W),q(we)),ze.current===n&&(q(ze),oo._currentValue=Ne)}var tt=Object.prototype.hasOwnProperty,vt=i.unstable_scheduleCallback,ht=i.unstable_cancelCallback,Lt=i.unstable_shouldYield,Ve=i.unstable_requestPaint,rt=i.unstable_now,Fe=i.unstable_getCurrentPriorityLevel,jt=i.unstable_ImmediatePriority,ti=i.unstable_UserBlockingPriority,At=i.unstable_NormalPriority,qi=i.unstable_LowPriority,Xt=i.unstable_IdlePriority,Ie=i.log,bt=i.unstable_setDisableYieldValue,zt=null,xt=null;function er(n){if(xt&&typeof xt.onCommitFiberRoot=="function")try{xt.onCommitFiberRoot(zt,n,void 0,(n.current.flags&128)===128)}catch{}}function ii(n){if(typeof Ie=="function"&&bt(n),xt&&typeof xt.setStrictMode=="function")try{xt.setStrictMode(zt,n)}catch{}}var ri=Math.clz32?Math.clz32:Ln,Va=Math.log,Ts=Math.LN2;function Ln(n){return n>>>=0,n===0?32:31-(Va(n)/Ts|0)|0}var Ga=128,da=4194304;function Ri(n){var l=n&42;if(l!==0)return l;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function Wr(n,l){var c=n.pendingLanes;if(c===0)return 0;var f=0,m=n.suspendedLanes,x=n.pingedLanes,_=n.warmLanes;n=n.finishedLanes!==0;var O=c&134217727;return O!==0?(c=O&~m,c!==0?f=Ri(c):(x&=O,x!==0?f=Ri(x):n||(_=O&~_,_!==0&&(f=Ri(_))))):(O=c&~m,O!==0?f=Ri(O):x!==0?f=Ri(x):n||(_=c&~_,_!==0&&(f=Ri(_)))),f===0?0:l!==0&&l!==f&&(l&m)===0&&(m=f&-f,_=l&-l,m>=_||m===32&&(_&4194176)!==0)?l:f}function pa(n,l){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&l)===0}function yl(n,l){switch(n){case 1:case 2:case 4:case 8:return l+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function K(){var n=Ga;return Ga<<=1,(Ga&4194176)===0&&(Ga=128),n}function re(){var n=da;return da<<=1,(da&62914560)===0&&(da=4194304),n}function fe(n){for(var l=[],c=0;31>c;c++)l.push(n);return l}function Ae(n,l){n.pendingLanes|=l,l!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function Ue(n,l,c,f,m,x){var _=n.pendingLanes;n.pendingLanes=c,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=c,n.entangledLanes&=c,n.errorRecoveryDisabledLanes&=c,n.shellSuspendCounter=0;var O=n.entanglements,G=n.expirationTimes,J=n.hiddenUpdates;for(c=_&~c;0<c;){var xe=31-ri(c),Re=1<<xe;O[xe]=0,G[xe]=-1;var ue=J[xe];if(ue!==null)for(J[xe]=null,xe=0;xe<ue.length;xe++){var be=ue[xe];be!==null&&(be.lane&=-536870913)}c&=~Re}f!==0&&Je(n,f,0),x!==0&&m===0&&n.tag!==0&&(n.suspendedLanes|=x&~(_&~l))}function Je(n,l,c){n.pendingLanes|=l,n.suspendedLanes&=~l;var f=31-ri(l);n.entangledLanes|=l,n.entanglements[f]=n.entanglements[f]|1073741824|c&4194218}function et(n,l){var c=n.entangledLanes|=l;for(n=n.entanglements;c;){var f=31-ri(c),m=1<<f;m&l|n[f]&l&&(n[f]|=l),c&=~m}}function Ye(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function Ke(){var n=pe.p;return n!==0?n:(n=window.event,n===void 0?32:Kv(n.type))}function S(n,l){var c=pe.p;try{return pe.p=n,l()}finally{pe.p=c}}var L=Math.random().toString(36).slice(2),A="__reactFiber$"+L,M="__reactProps$"+L,B="__reactContainer$"+L,I="__reactEvents$"+L,te="__reactListeners$"+L,oe="__reactHandles$"+L,ee="__reactResources$"+L,ae="__reactMarker$"+L;function se(n){delete n[A],delete n[M],delete n[I],delete n[te],delete n[oe]}function Ce(n){var l=n[A];if(l)return l;for(var c=n.parentNode;c;){if(l=c[B]||c[A]){if(c=l.alternate,l.child!==null||c!==null&&c.child!==null)for(n=Lv(n);n!==null;){if(c=n[A])return c;n=Lv(n)}return l}n=c,c=n.parentNode}return null}function ke(n){if(n=n[A]||n[B]){var l=n.tag;if(l===5||l===6||l===13||l===26||l===27||l===3)return n}return null}function Pe(n){var l=n.tag;if(l===5||l===26||l===27||l===6)return n.stateNode;throw Error(r(33))}function Se(n){var l=n[ee];return l||(l=n[ee]={hoistableStyles:new Map,hoistableScripts:new Map}),l}function Te(n){n[ae]=!0}var it=new Set,Ft={};function Ze(n,l){ut(n,l),ut(n+"Capture",l)}function ut(n,l){for(Ft[n]=l,n=0;n<l.length;n++)it.add(l[n])}var li=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),lr=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ht={},ki={};function Wa(n){return tt.call(ki,n)?!0:tt.call(Ht,n)?!1:lr.test(n)?ki[n]=!0:(Ht[n]=!0,!1)}function Hi(n,l,c){if(Wa(l))if(c===null)n.removeAttribute(l);else{switch(typeof c){case"undefined":case"function":case"symbol":n.removeAttribute(l);return;case"boolean":var f=l.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){n.removeAttribute(l);return}}n.setAttribute(l,""+c)}}function gu(n,l,c){if(c===null)n.removeAttribute(l);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(l);return}n.setAttribute(l,""+c)}}function ma(n,l,c,f){if(f===null)n.removeAttribute(c);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(c);return}n.setAttributeNS(l,c,""+f)}}function Cr(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Op(n){var l=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function Ky(n){var l=Op(n)?"checked":"value",c=Object.getOwnPropertyDescriptor(n.constructor.prototype,l),f=""+n[l];if(!n.hasOwnProperty(l)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var m=c.get,x=c.set;return Object.defineProperty(n,l,{configurable:!0,get:function(){return m.call(this)},set:function(_){f=""+_,x.call(this,_)}}),Object.defineProperty(n,l,{enumerable:c.enumerable}),{getValue:function(){return f},setValue:function(_){f=""+_},stopTracking:function(){n._valueTracker=null,delete n[l]}}}}function vu(n){n._valueTracker||(n._valueTracker=Ky(n))}function Lp(n){if(!n)return!1;var l=n._valueTracker;if(!l)return!0;var c=l.getValue(),f="";return n&&(f=Op(n)?n.checked?"true":"false":n.value),n=f,n!==c?(l.setValue(n),!0):!1}function bu(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var $y=/[\n"\\]/g;function Tr(n){return n.replace($y,function(l){return"\\"+l.charCodeAt(0).toString(16)+" "})}function _h(n,l,c,f,m,x,_,O){n.name="",_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"?n.type=_:n.removeAttribute("type"),l!=null?_==="number"?(l===0&&n.value===""||n.value!=l)&&(n.value=""+Cr(l)):n.value!==""+Cr(l)&&(n.value=""+Cr(l)):_!=="submit"&&_!=="reset"||n.removeAttribute("value"),l!=null?Sh(n,_,Cr(l)):c!=null?Sh(n,_,Cr(c)):f!=null&&n.removeAttribute("value"),m==null&&x!=null&&(n.defaultChecked=!!x),m!=null&&(n.checked=m&&typeof m!="function"&&typeof m!="symbol"),O!=null&&typeof O!="function"&&typeof O!="symbol"&&typeof O!="boolean"?n.name=""+Cr(O):n.removeAttribute("name")}function Np(n,l,c,f,m,x,_,O){if(x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(n.type=x),l!=null||c!=null){if(!(x!=="submit"&&x!=="reset"||l!=null))return;c=c!=null?""+Cr(c):"",l=l!=null?""+Cr(l):c,O||l===n.value||(n.value=l),n.defaultValue=l}f=f??m,f=typeof f!="function"&&typeof f!="symbol"&&!!f,n.checked=O?n.checked:!!f,n.defaultChecked=!!f,_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"&&(n.name=_)}function Sh(n,l,c){l==="number"&&bu(n.ownerDocument)===n||n.defaultValue===""+c||(n.defaultValue=""+c)}function _s(n,l,c,f){if(n=n.options,l){l={};for(var m=0;m<c.length;m++)l["$"+c[m]]=!0;for(c=0;c<n.length;c++)m=l.hasOwnProperty("$"+n[c].value),n[c].selected!==m&&(n[c].selected=m),m&&f&&(n[c].defaultSelected=!0)}else{for(c=""+Cr(c),l=null,m=0;m<n.length;m++){if(n[m].value===c){n[m].selected=!0,f&&(n[m].defaultSelected=!0);return}l!==null||n[m].disabled||(l=n[m])}l!==null&&(l.selected=!0)}}function Bp(n,l,c){if(l!=null&&(l=""+Cr(l),l!==n.value&&(n.value=l),c==null)){n.defaultValue!==l&&(n.defaultValue=l);return}n.defaultValue=c!=null?""+Cr(c):""}function zp(n,l,c,f){if(l==null){if(f!=null){if(c!=null)throw Error(r(92));if(ye(f)){if(1<f.length)throw Error(r(93));f=f[0]}c=f}c==null&&(c=""),l=c}c=Cr(l),n.defaultValue=c,f=n.textContent,f===c&&f!==""&&f!==null&&(n.value=f)}function Ss(n,l){if(l){var c=n.firstChild;if(c&&c===n.lastChild&&c.nodeType===3){c.nodeValue=l;return}}n.textContent=l}var Zy=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Hp(n,l,c){var f=l.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?f?n.setProperty(l,""):l==="float"?n.cssFloat="":n[l]="":f?n.setProperty(l,c):typeof c!="number"||c===0||Zy.has(l)?l==="float"?n.cssFloat=c:n[l]=(""+c).trim():n[l]=c+"px"}function Pp(n,l,c){if(l!=null&&typeof l!="object")throw Error(r(62));if(n=n.style,c!=null){for(var f in c)!c.hasOwnProperty(f)||l!=null&&l.hasOwnProperty(f)||(f.indexOf("--")===0?n.setProperty(f,""):f==="float"?n.cssFloat="":n[f]="");for(var m in l)f=l[m],l.hasOwnProperty(m)&&c[m]!==f&&Hp(n,m,f)}else for(var x in l)l.hasOwnProperty(x)&&Hp(n,x,l[x])}function Rh(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Qy=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Jy=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function xu(n){return Jy.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}var kh=null;function Ah(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Rs=null,ks=null;function Ip(n){var l=ke(n);if(l&&(n=l.stateNode)){var c=n[M]||null;e:switch(n=l.stateNode,l.type){case"input":if(_h(n,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),l=c.name,c.type==="radio"&&l!=null){for(c=n;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+Tr(""+l)+'"][type="radio"]'),l=0;l<c.length;l++){var f=c[l];if(f!==n&&f.form===n.form){var m=f[M]||null;if(!m)throw Error(r(90));_h(f,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(l=0;l<c.length;l++)f=c[l],f.form===n.form&&Lp(f)}break e;case"textarea":Bp(n,c.value,c.defaultValue);break e;case"select":l=c.value,l!=null&&_s(n,!!c.multiple,l,!1)}}}var Dh=!1;function Up(n,l,c){if(Dh)return n(l,c);Dh=!0;try{var f=n(l);return f}finally{if(Dh=!1,(Rs!==null||ks!==null)&&(ic(),Rs&&(l=Rs,n=ks,ks=Rs=null,Ip(l),n)))for(l=0;l<n.length;l++)Ip(n[l])}}function El(n,l){var c=n.stateNode;if(c===null)return null;var f=c[M]||null;if(f===null)return null;c=f[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(n=n.type,f=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!f;break e;default:n=!1}if(n)return null;if(c&&typeof c!="function")throw Error(r(231,l,typeof c));return c}var Fh=!1;if(li)try{var Cl={};Object.defineProperty(Cl,"passive",{get:function(){Fh=!0}}),window.addEventListener("test",Cl,Cl),window.removeEventListener("test",Cl,Cl)}catch{Fh=!1}var ja=null,Mh=null,wu=null;function Vp(){if(wu)return wu;var n,l=Mh,c=l.length,f,m="value"in ja?ja.value:ja.textContent,x=m.length;for(n=0;n<c&&l[n]===m[n];n++);var _=c-n;for(f=1;f<=_&&l[c-f]===m[x-f];f++);return wu=m.slice(n,1<f?1-f:void 0)}function yu(n){var l=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&l===13&&(n=13)):n=l,n===10&&(n=13),32<=n||n===13?n:0}function Eu(){return!0}function Gp(){return!1}function tr(n){function l(c,f,m,x,_){this._reactName=c,this._targetInst=m,this.type=f,this.nativeEvent=x,this.target=_,this.currentTarget=null;for(var O in n)n.hasOwnProperty(O)&&(c=n[O],this[O]=c?c(x):x[O]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?Eu:Gp,this.isPropagationStopped=Gp,this}return j(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=Eu)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=Eu)},persist:function(){},isPersistent:Eu}),l}var Nn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Cu=tr(Nn),Tl=j({},Nn,{view:0,detail:0}),eE=tr(Tl),Oh,Lh,_l,Tu=j({},Tl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Bh,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==_l&&(_l&&n.type==="mousemove"?(Oh=n.screenX-_l.screenX,Lh=n.screenY-_l.screenY):Lh=Oh=0,_l=n),Oh)},movementY:function(n){return"movementY"in n?n.movementY:Lh}}),Wp=tr(Tu),tE=j({},Tu,{dataTransfer:0}),iE=tr(tE),rE=j({},Tl,{relatedTarget:0}),Nh=tr(rE),aE=j({},Nn,{animationName:0,elapsedTime:0,pseudoElement:0}),nE=tr(aE),sE=j({},Nn,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),lE=tr(sE),oE=j({},Nn,{data:0}),jp=tr(oE),uE={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},cE={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},hE={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function fE(n){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(n):(n=hE[n])?!!l[n]:!1}function Bh(){return fE}var dE=j({},Tl,{key:function(n){if(n.key){var l=uE[n.key]||n.key;if(l!=="Unidentified")return l}return n.type==="keypress"?(n=yu(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?cE[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Bh,charCode:function(n){return n.type==="keypress"?yu(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?yu(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),pE=tr(dE),mE=j({},Tu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Xp=tr(mE),gE=j({},Tl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Bh}),vE=tr(gE),bE=j({},Nn,{propertyName:0,elapsedTime:0,pseudoElement:0}),xE=tr(bE),wE=j({},Tu,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),yE=tr(wE),EE=j({},Nn,{newState:0,oldState:0}),CE=tr(EE),TE=[9,13,27,32],zh=li&&"CompositionEvent"in window,Sl=null;li&&"documentMode"in document&&(Sl=document.documentMode);var _E=li&&"TextEvent"in window&&!Sl,Yp=li&&(!zh||Sl&&8<Sl&&11>=Sl),qp=" ",Kp=!1;function $p(n,l){switch(n){case"keyup":return TE.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Zp(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var As=!1;function SE(n,l){switch(n){case"compositionend":return Zp(l);case"keypress":return l.which!==32?null:(Kp=!0,qp);case"textInput":return n=l.data,n===qp&&Kp?null:n;default:return null}}function RE(n,l){if(As)return n==="compositionend"||!zh&&$p(n,l)?(n=Vp(),wu=Mh=ja=null,As=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return Yp&&l.locale!=="ko"?null:l.data;default:return null}}var kE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Qp(n){var l=n&&n.nodeName&&n.nodeName.toLowerCase();return l==="input"?!!kE[n.type]:l==="textarea"}function Jp(n,l,c,f){Rs?ks?ks.push(f):ks=[f]:Rs=f,l=lc(l,"onChange"),0<l.length&&(c=new Cu("onChange","change",null,c,f),n.push({event:c,listeners:l}))}var Rl=null,kl=null;function AE(n){_v(n,0)}function _u(n){var l=Pe(n);if(Lp(l))return n}function em(n,l){if(n==="change")return l}var tm=!1;if(li){var Hh;if(li){var Ph="oninput"in document;if(!Ph){var im=document.createElement("div");im.setAttribute("oninput","return;"),Ph=typeof im.oninput=="function"}Hh=Ph}else Hh=!1;tm=Hh&&(!document.documentMode||9<document.documentMode)}function rm(){Rl&&(Rl.detachEvent("onpropertychange",am),kl=Rl=null)}function am(n){if(n.propertyName==="value"&&_u(kl)){var l=[];Jp(l,kl,n,Ah(n)),Up(AE,l)}}function DE(n,l,c){n==="focusin"?(rm(),Rl=l,kl=c,Rl.attachEvent("onpropertychange",am)):n==="focusout"&&rm()}function FE(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return _u(kl)}function ME(n,l){if(n==="click")return _u(l)}function OE(n,l){if(n==="input"||n==="change")return _u(l)}function LE(n,l){return n===l&&(n!==0||1/n===1/l)||n!==n&&l!==l}var or=typeof Object.is=="function"?Object.is:LE;function Al(n,l){if(or(n,l))return!0;if(typeof n!="object"||n===null||typeof l!="object"||l===null)return!1;var c=Object.keys(n),f=Object.keys(l);if(c.length!==f.length)return!1;for(f=0;f<c.length;f++){var m=c[f];if(!tt.call(l,m)||!or(n[m],l[m]))return!1}return!0}function nm(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function sm(n,l){var c=nm(n);n=0;for(var f;c;){if(c.nodeType===3){if(f=n+c.textContent.length,n<=l&&f>=l)return{node:c,offset:l-n};n=f}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=nm(c)}}function lm(n,l){return n&&l?n===l?!0:n&&n.nodeType===3?!1:l&&l.nodeType===3?lm(n,l.parentNode):"contains"in n?n.contains(l):n.compareDocumentPosition?!!(n.compareDocumentPosition(l)&16):!1:!1}function om(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var l=bu(n.document);l instanceof n.HTMLIFrameElement;){try{var c=typeof l.contentWindow.location.href=="string"}catch{c=!1}if(c)n=l.contentWindow;else break;l=bu(n.document)}return l}function Ih(n){var l=n&&n.nodeName&&n.nodeName.toLowerCase();return l&&(l==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||l==="textarea"||n.contentEditable==="true")}function NE(n,l){var c=om(l);l=n.focusedElem;var f=n.selectionRange;if(c!==l&&l&&l.ownerDocument&&lm(l.ownerDocument.documentElement,l)){if(f!==null&&Ih(l)){if(n=f.start,c=f.end,c===void 0&&(c=n),"selectionStart"in l)l.selectionStart=n,l.selectionEnd=Math.min(c,l.value.length);else if(c=(n=l.ownerDocument||document)&&n.defaultView||window,c.getSelection){c=c.getSelection();var m=l.textContent.length,x=Math.min(f.start,m);f=f.end===void 0?x:Math.min(f.end,m),!c.extend&&x>f&&(m=f,f=x,x=m),m=sm(l,x);var _=sm(l,f);m&&_&&(c.rangeCount!==1||c.anchorNode!==m.node||c.anchorOffset!==m.offset||c.focusNode!==_.node||c.focusOffset!==_.offset)&&(n=n.createRange(),n.setStart(m.node,m.offset),c.removeAllRanges(),x>f?(c.addRange(n),c.extend(_.node,_.offset)):(n.setEnd(_.node,_.offset),c.addRange(n)))}}for(n=[],c=l;c=c.parentNode;)c.nodeType===1&&n.push({element:c,left:c.scrollLeft,top:c.scrollTop});for(typeof l.focus=="function"&&l.focus(),l=0;l<n.length;l++)c=n[l],c.element.scrollLeft=c.left,c.element.scrollTop=c.top}}var BE=li&&"documentMode"in document&&11>=document.documentMode,Ds=null,Uh=null,Dl=null,Vh=!1;function um(n,l,c){var f=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Vh||Ds==null||Ds!==bu(f)||(f=Ds,"selectionStart"in f&&Ih(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),Dl&&Al(Dl,f)||(Dl=f,f=lc(Uh,"onSelect"),0<f.length&&(l=new Cu("onSelect","select",null,l,c),n.push({event:l,listeners:f}),l.target=Ds)))}function Bn(n,l){var c={};return c[n.toLowerCase()]=l.toLowerCase(),c["Webkit"+n]="webkit"+l,c["Moz"+n]="moz"+l,c}var Fs={animationend:Bn("Animation","AnimationEnd"),animationiteration:Bn("Animation","AnimationIteration"),animationstart:Bn("Animation","AnimationStart"),transitionrun:Bn("Transition","TransitionRun"),transitionstart:Bn("Transition","TransitionStart"),transitioncancel:Bn("Transition","TransitionCancel"),transitionend:Bn("Transition","TransitionEnd")},Gh={},cm={};li&&(cm=document.createElement("div").style,"AnimationEvent"in window||(delete Fs.animationend.animation,delete Fs.animationiteration.animation,delete Fs.animationstart.animation),"TransitionEvent"in window||delete Fs.transitionend.transition);function zn(n){if(Gh[n])return Gh[n];if(!Fs[n])return n;var l=Fs[n],c;for(c in l)if(l.hasOwnProperty(c)&&c in cm)return Gh[n]=l[c];return n}var hm=zn("animationend"),fm=zn("animationiteration"),dm=zn("animationstart"),zE=zn("transitionrun"),HE=zn("transitionstart"),PE=zn("transitioncancel"),pm=zn("transitionend"),mm=new Map,gm="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll scrollEnd toggle touchMove waiting wheel".split(" ");function jr(n,l){mm.set(n,l),Ze(l,[n])}var _r=[],Ms=0,Wh=0;function Su(){for(var n=Ms,l=Wh=Ms=0;l<n;){var c=_r[l];_r[l++]=null;var f=_r[l];_r[l++]=null;var m=_r[l];_r[l++]=null;var x=_r[l];if(_r[l++]=null,f!==null&&m!==null){var _=f.pending;_===null?m.next=m:(m.next=_.next,_.next=m),f.pending=m}x!==0&&vm(c,m,x)}}function Ru(n,l,c,f){_r[Ms++]=n,_r[Ms++]=l,_r[Ms++]=c,_r[Ms++]=f,Wh|=f,n.lanes|=f,n=n.alternate,n!==null&&(n.lanes|=f)}function jh(n,l,c,f){return Ru(n,l,c,f),ku(n)}function Xa(n,l){return Ru(n,null,null,l),ku(n)}function vm(n,l,c){n.lanes|=c;var f=n.alternate;f!==null&&(f.lanes|=c);for(var m=!1,x=n.return;x!==null;)x.childLanes|=c,f=x.alternate,f!==null&&(f.childLanes|=c),x.tag===22&&(n=x.stateNode,n===null||n._visibility&1||(m=!0)),n=x,x=x.return;m&&l!==null&&n.tag===3&&(x=n.stateNode,m=31-ri(c),x=x.hiddenUpdates,n=x[m],n===null?x[m]=[l]:n.push(l),l.lane=c|536870912)}function ku(n){if(50<to)throw to=0,Qf=null,Error(r(185));for(var l=n.return;l!==null;)n=l,l=n.return;return n.tag===3?n.stateNode:null}var Os={},bm=new WeakMap;function Sr(n,l){if(typeof n=="object"&&n!==null){var c=bm.get(n);return c!==void 0?c:(l={value:n,source:l,stack:de(l)},bm.set(n,l),l)}return{value:n,source:l,stack:de(l)}}var Ls=[],Ns=0,Au=null,Du=0,Rr=[],kr=0,Hn=null,ga=1,va="";function Pn(n,l){Ls[Ns++]=Du,Ls[Ns++]=Au,Au=n,Du=l}function xm(n,l,c){Rr[kr++]=ga,Rr[kr++]=va,Rr[kr++]=Hn,Hn=n;var f=ga;n=va;var m=32-ri(f)-1;f&=~(1<<m),c+=1;var x=32-ri(l)+m;if(30<x){var _=m-m%5;x=(f&(1<<_)-1).toString(32),f>>=_,m-=_,ga=1<<32-ri(l)+m|c<<m|f,va=x+n}else ga=1<<x|c<<m|f,va=n}function Xh(n){n.return!==null&&(Pn(n,1),xm(n,1,0))}function Yh(n){for(;n===Au;)Au=Ls[--Ns],Ls[Ns]=null,Du=Ls[--Ns],Ls[Ns]=null;for(;n===Hn;)Hn=Rr[--kr],Rr[kr]=null,va=Rr[--kr],Rr[kr]=null,ga=Rr[--kr],Rr[kr]=null}var Ki=null,Ai=null,Mt=!1,Xr=null,ra=!1,qh=Error(r(519));function In(n){var l=Error(r(418,""));throw Ol(Sr(l,n)),qh}function wm(n){var l=n.stateNode,c=n.type,f=n.memoizedProps;switch(l[A]=n,l[M]=f,c){case"dialog":Et("cancel",l),Et("close",l);break;case"iframe":case"object":case"embed":Et("load",l);break;case"video":case"audio":for(c=0;c<ro.length;c++)Et(ro[c],l);break;case"source":Et("error",l);break;case"img":case"image":case"link":Et("error",l),Et("load",l);break;case"details":Et("toggle",l);break;case"input":Et("invalid",l),Np(l,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0),vu(l);break;case"select":Et("invalid",l);break;case"textarea":Et("invalid",l),zp(l,f.value,f.defaultValue,f.children),vu(l)}c=f.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||l.textContent===""+c||f.suppressHydrationWarning===!0||Av(l.textContent,c)?(f.popover!=null&&(Et("beforetoggle",l),Et("toggle",l)),f.onScroll!=null&&Et("scroll",l),f.onScrollEnd!=null&&Et("scrollend",l),f.onClick!=null&&(l.onclick=oc),l=!0):l=!1,l||In(n)}function ym(n){for(Ki=n.return;Ki;)switch(Ki.tag){case 3:case 27:ra=!0;return;case 5:case 13:ra=!1;return;default:Ki=Ki.return}}function Fl(n){if(n!==Ki)return!1;if(!Mt)return ym(n),Mt=!0,!1;var l=!1,c;if((c=n.tag!==3&&n.tag!==27)&&((c=n.tag===5)&&(c=n.type,c=!(c!=="form"&&c!=="button")||md(n.type,n.memoizedProps)),c=!c),c&&(l=!0),l&&Ai&&In(n),ym(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(r(317));e:{for(n=n.nextSibling,l=0;n;){if(n.nodeType===8)if(c=n.data,c==="/$"){if(l===0){Ai=qr(n.nextSibling);break e}l--}else c!=="$"&&c!=="$!"&&c!=="$?"||l++;n=n.nextSibling}Ai=null}}else Ai=Ki?qr(n.stateNode.nextSibling):null;return!0}function Ml(){Ai=Ki=null,Mt=!1}function Ol(n){Xr===null?Xr=[n]:Xr.push(n)}var Ll=Error(r(460)),Em=Error(r(474)),Kh={then:function(){}};function Cm(n){return n=n.status,n==="fulfilled"||n==="rejected"}function Fu(){}function Tm(n,l,c){switch(c=n[c],c===void 0?n.push(l):c!==l&&(l.then(Fu,Fu),l=c),l.status){case"fulfilled":return l.value;case"rejected":throw n=l.reason,n===Ll?Error(r(483)):n;default:if(typeof l.status=="string")l.then(Fu,Fu);else{if(n=Yt,n!==null&&100<n.shellSuspendCounter)throw Error(r(482));n=l,n.status="pending",n.then(function(f){if(l.status==="pending"){var m=l;m.status="fulfilled",m.value=f}},function(f){if(l.status==="pending"){var m=l;m.status="rejected",m.reason=f}})}switch(l.status){case"fulfilled":return l.value;case"rejected":throw n=l.reason,n===Ll?Error(r(483)):n}throw Nl=l,Ll}}var Nl=null;function _m(){if(Nl===null)throw Error(r(459));var n=Nl;return Nl=null,n}var Bs=null,Bl=0;function Mu(n){var l=Bl;return Bl+=1,Bs===null&&(Bs=[]),Tm(Bs,n,l)}function zl(n,l){l=l.props.ref,n.ref=l!==void 0?l:null}function Ou(n,l){throw l.$$typeof===s?Error(r(525)):(n=Object.prototype.toString.call(l),Error(r(31,n==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":n)))}function Sm(n){var l=n._init;return l(n._payload)}function Rm(n){function l(ie,Q){if(n){var le=ie.deletions;le===null?(ie.deletions=[Q],ie.flags|=16):le.push(Q)}}function c(ie,Q){if(!n)return null;for(;Q!==null;)l(ie,Q),Q=Q.sibling;return null}function f(ie){for(var Q=new Map;ie!==null;)ie.key!==null?Q.set(ie.key,ie):Q.set(ie.index,ie),ie=ie.sibling;return Q}function m(ie,Q){return ie=nn(ie,Q),ie.index=0,ie.sibling=null,ie}function x(ie,Q,le){return ie.index=le,n?(le=ie.alternate,le!==null?(le=le.index,le<Q?(ie.flags|=33554434,Q):le):(ie.flags|=33554434,Q)):(ie.flags|=1048576,Q)}function _(ie){return n&&ie.alternate===null&&(ie.flags|=33554434),ie}function O(ie,Q,le,Ee){return Q===null||Q.tag!==6?(Q=Wf(le,ie.mode,Ee),Q.return=ie,Q):(Q=m(Q,le),Q.return=ie,Q)}function G(ie,Q,le,Ee){var je=le.type;return je===h?xe(ie,Q,le.props.children,Ee,le.key):Q!==null&&(Q.elementType===je||typeof je=="object"&&je!==null&&je.$$typeof===R&&Sm(je)===Q.type)?(Q=m(Q,le.props),zl(Q,le),Q.return=ie,Q):(Q=Zu(le.type,le.key,le.props,null,ie.mode,Ee),zl(Q,le),Q.return=ie,Q)}function J(ie,Q,le,Ee){return Q===null||Q.tag!==4||Q.stateNode.containerInfo!==le.containerInfo||Q.stateNode.implementation!==le.implementation?(Q=jf(le,ie.mode,Ee),Q.return=ie,Q):(Q=m(Q,le.children||[]),Q.return=ie,Q)}function xe(ie,Q,le,Ee,je){return Q===null||Q.tag!==7?(Q=$n(le,ie.mode,Ee,je),Q.return=ie,Q):(Q=m(Q,le),Q.return=ie,Q)}function Re(ie,Q,le){if(typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint")return Q=Wf(""+Q,ie.mode,le),Q.return=ie,Q;if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case o:return le=Zu(Q.type,Q.key,Q.props,null,ie.mode,le),zl(le,Q),le.return=ie,le;case u:return Q=jf(Q,ie.mode,le),Q.return=ie,Q;case R:var Ee=Q._init;return Q=Ee(Q._payload),Re(ie,Q,le)}if(ye(Q)||V(Q))return Q=$n(Q,ie.mode,le,null),Q.return=ie,Q;if(typeof Q.then=="function")return Re(ie,Mu(Q),le);if(Q.$$typeof===v)return Re(ie,qu(ie,Q),le);Ou(ie,Q)}return null}function ue(ie,Q,le,Ee){var je=Q!==null?Q.key:null;if(typeof le=="string"&&le!==""||typeof le=="number"||typeof le=="bigint")return je!==null?null:O(ie,Q,""+le,Ee);if(typeof le=="object"&&le!==null){switch(le.$$typeof){case o:return le.key===je?G(ie,Q,le,Ee):null;case u:return le.key===je?J(ie,Q,le,Ee):null;case R:return je=le._init,le=je(le._payload),ue(ie,Q,le,Ee)}if(ye(le)||V(le))return je!==null?null:xe(ie,Q,le,Ee,null);if(typeof le.then=="function")return ue(ie,Q,Mu(le),Ee);if(le.$$typeof===v)return ue(ie,Q,qu(ie,le),Ee);Ou(ie,le)}return null}function be(ie,Q,le,Ee,je){if(typeof Ee=="string"&&Ee!==""||typeof Ee=="number"||typeof Ee=="bigint")return ie=ie.get(le)||null,O(Q,ie,""+Ee,je);if(typeof Ee=="object"&&Ee!==null){switch(Ee.$$typeof){case o:return ie=ie.get(Ee.key===null?le:Ee.key)||null,G(Q,ie,Ee,je);case u:return ie=ie.get(Ee.key===null?le:Ee.key)||null,J(Q,ie,Ee,je);case R:var dt=Ee._init;return Ee=dt(Ee._payload),be(ie,Q,le,Ee,je)}if(ye(Ee)||V(Ee))return ie=ie.get(le)||null,xe(Q,ie,Ee,je,null);if(typeof Ee.then=="function")return be(ie,Q,le,Mu(Ee),je);if(Ee.$$typeof===v)return be(ie,Q,le,qu(Q,Ee),je);Ou(Q,Ee)}return null}function $e(ie,Q,le,Ee){for(var je=null,dt=null,Qe=Q,at=Q=0,Ei=null;Qe!==null&&at<le.length;at++){Qe.index>at?(Ei=Qe,Qe=null):Ei=Qe.sibling;var Ot=ue(ie,Qe,le[at],Ee);if(Ot===null){Qe===null&&(Qe=Ei);break}n&&Qe&&Ot.alternate===null&&l(ie,Qe),Q=x(Ot,Q,at),dt===null?je=Ot:dt.sibling=Ot,dt=Ot,Qe=Ei}if(at===le.length)return c(ie,Qe),Mt&&Pn(ie,at),je;if(Qe===null){for(;at<le.length;at++)Qe=Re(ie,le[at],Ee),Qe!==null&&(Q=x(Qe,Q,at),dt===null?je=Qe:dt.sibling=Qe,dt=Qe);return Mt&&Pn(ie,at),je}for(Qe=f(Qe);at<le.length;at++)Ei=be(Qe,ie,at,le[at],Ee),Ei!==null&&(n&&Ei.alternate!==null&&Qe.delete(Ei.key===null?at:Ei.key),Q=x(Ei,Q,at),dt===null?je=Ei:dt.sibling=Ei,dt=Ei);return n&&Qe.forEach(function(fn){return l(ie,fn)}),Mt&&Pn(ie,at),je}function lt(ie,Q,le,Ee){if(le==null)throw Error(r(151));for(var je=null,dt=null,Qe=Q,at=Q=0,Ei=null,Ot=le.next();Qe!==null&&!Ot.done;at++,Ot=le.next()){Qe.index>at?(Ei=Qe,Qe=null):Ei=Qe.sibling;var fn=ue(ie,Qe,Ot.value,Ee);if(fn===null){Qe===null&&(Qe=Ei);break}n&&Qe&&fn.alternate===null&&l(ie,Qe),Q=x(fn,Q,at),dt===null?je=fn:dt.sibling=fn,dt=fn,Qe=Ei}if(Ot.done)return c(ie,Qe),Mt&&Pn(ie,at),je;if(Qe===null){for(;!Ot.done;at++,Ot=le.next())Ot=Re(ie,Ot.value,Ee),Ot!==null&&(Q=x(Ot,Q,at),dt===null?je=Ot:dt.sibling=Ot,dt=Ot);return Mt&&Pn(ie,at),je}for(Qe=f(Qe);!Ot.done;at++,Ot=le.next())Ot=be(Qe,ie,at,Ot.value,Ee),Ot!==null&&(n&&Ot.alternate!==null&&Qe.delete(Ot.key===null?at:Ot.key),Q=x(Ot,Q,at),dt===null?je=Ot:dt.sibling=Ot,dt=Ot);return n&&Qe.forEach(function(JC){return l(ie,JC)}),Mt&&Pn(ie,at),je}function Jt(ie,Q,le,Ee){if(typeof le=="object"&&le!==null&&le.type===h&&le.key===null&&(le=le.props.children),typeof le=="object"&&le!==null){switch(le.$$typeof){case o:e:{for(var je=le.key;Q!==null;){if(Q.key===je){if(je=le.type,je===h){if(Q.tag===7){c(ie,Q.sibling),Ee=m(Q,le.props.children),Ee.return=ie,ie=Ee;break e}}else if(Q.elementType===je||typeof je=="object"&&je!==null&&je.$$typeof===R&&Sm(je)===Q.type){c(ie,Q.sibling),Ee=m(Q,le.props),zl(Ee,le),Ee.return=ie,ie=Ee;break e}c(ie,Q);break}else l(ie,Q);Q=Q.sibling}le.type===h?(Ee=$n(le.props.children,ie.mode,Ee,le.key),Ee.return=ie,ie=Ee):(Ee=Zu(le.type,le.key,le.props,null,ie.mode,Ee),zl(Ee,le),Ee.return=ie,ie=Ee)}return _(ie);case u:e:{for(je=le.key;Q!==null;){if(Q.key===je)if(Q.tag===4&&Q.stateNode.containerInfo===le.containerInfo&&Q.stateNode.implementation===le.implementation){c(ie,Q.sibling),Ee=m(Q,le.children||[]),Ee.return=ie,ie=Ee;break e}else{c(ie,Q);break}else l(ie,Q);Q=Q.sibling}Ee=jf(le,ie.mode,Ee),Ee.return=ie,ie=Ee}return _(ie);case R:return je=le._init,le=je(le._payload),Jt(ie,Q,le,Ee)}if(ye(le))return $e(ie,Q,le,Ee);if(V(le)){if(je=V(le),typeof je!="function")throw Error(r(150));return le=je.call(le),lt(ie,Q,le,Ee)}if(typeof le.then=="function")return Jt(ie,Q,Mu(le),Ee);if(le.$$typeof===v)return Jt(ie,Q,qu(ie,le),Ee);Ou(ie,le)}return typeof le=="string"&&le!==""||typeof le=="number"||typeof le=="bigint"?(le=""+le,Q!==null&&Q.tag===6?(c(ie,Q.sibling),Ee=m(Q,le),Ee.return=ie,ie=Ee):(c(ie,Q),Ee=Wf(le,ie.mode,Ee),Ee.return=ie,ie=Ee),_(ie)):c(ie,Q)}return function(ie,Q,le,Ee){try{Bl=0;var je=Jt(ie,Q,le,Ee);return Bs=null,je}catch(Qe){if(Qe===Ll)throw Qe;var dt=Mr(29,Qe,null,ie.mode);return dt.lanes=Ee,dt.return=ie,dt}finally{}}}var Un=Rm(!0),km=Rm(!1),zs=z(null),Lu=z(0);function Am(n,l){n=ka,X(Lu,n),X(zs,l),ka=n|l.baseLanes}function $h(){X(Lu,ka),X(zs,zs.current)}function Zh(){ka=Lu.current,q(zs),q(Lu)}var Ar=z(null),aa=null;function Ya(n){var l=n.alternate;X(gi,gi.current&1),X(Ar,n),aa===null&&(l===null||zs.current!==null||l.memoizedState!==null)&&(aa=n)}function Dm(n){if(n.tag===22){if(X(gi,gi.current),X(Ar,n),aa===null){var l=n.alternate;l!==null&&l.memoizedState!==null&&(aa=n)}}else qa()}function qa(){X(gi,gi.current),X(Ar,Ar.current)}function ba(n){q(Ar),aa===n&&(aa=null),q(gi)}var gi=z(0);function Nu(n){for(var l=n;l!==null;){if(l.tag===13){var c=l.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||c.data==="$!"))return l}else if(l.tag===19&&l.memoizedProps.revealOrder!==void 0){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===n)break;for(;l.sibling===null;){if(l.return===null||l.return===n)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var IE=typeof AbortController<"u"?AbortController:function(){var n=[],l=this.signal={aborted:!1,addEventListener:function(c,f){n.push(f)}};this.abort=function(){l.aborted=!0,n.forEach(function(c){return c()})}},UE=i.unstable_scheduleCallback,VE=i.unstable_NormalPriority,vi={$$typeof:v,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Qh(){return{controller:new IE,data:new Map,refCount:0}}function Hl(n){n.refCount--,n.refCount===0&&UE(VE,function(){n.controller.abort()})}var Pl=null,Jh=0,Hs=0,Ps=null;function GE(n,l){if(Pl===null){var c=Pl=[];Jh=0,Hs=sd(),Ps={status:"pending",value:void 0,then:function(f){c.push(f)}}}return Jh++,l.then(Fm,Fm),l}function Fm(){if(--Jh===0&&Pl!==null){Ps!==null&&(Ps.status="fulfilled");var n=Pl;Pl=null,Hs=0,Ps=null;for(var l=0;l<n.length;l++)(0,n[l])()}}function WE(n,l){var c=[],f={status:"pending",value:null,reason:null,then:function(m){c.push(m)}};return n.then(function(){f.status="fulfilled",f.value=l;for(var m=0;m<c.length;m++)(0,c[m])(l)},function(m){for(f.status="rejected",f.reason=m,m=0;m<c.length;m++)(0,c[m])(void 0)}),f}var Mm=N.S;N.S=function(n,l){typeof l=="object"&&l!==null&&typeof l.then=="function"&&GE(n,l),Mm!==null&&Mm(n,l)};var Vn=z(null);function ef(){var n=Vn.current;return n!==null?n:Yt.pooledCache}function Bu(n,l){l===null?X(Vn,Vn.current):X(Vn,l.pool)}function Om(){var n=ef();return n===null?null:{parent:vi._currentValue,pool:n}}var Ka=0,ft=null,Pt=null,oi=null,zu=!1,Is=!1,Gn=!1,Hu=0,Il=0,Us=null,jE=0;function ai(){throw Error(r(321))}function tf(n,l){if(l===null)return!1;for(var c=0;c<l.length&&c<n.length;c++)if(!or(n[c],l[c]))return!1;return!0}function rf(n,l,c,f,m,x){return Ka=x,ft=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,N.H=n===null||n.memoizedState===null?Wn:$a,Gn=!1,x=c(f,m),Gn=!1,Is&&(x=Nm(l,c,f,m)),Lm(n),x}function Lm(n){N.H=na;var l=Pt!==null&&Pt.next!==null;if(Ka=0,oi=Pt=ft=null,zu=!1,Il=0,Us=null,l)throw Error(r(300));n===null||wi||(n=n.dependencies,n!==null&&Yu(n)&&(wi=!0))}function Nm(n,l,c,f){ft=n;var m=0;do{if(Is&&(Us=null),Il=0,Is=!1,25<=m)throw Error(r(301));if(m+=1,oi=Pt=null,n.updateQueue!=null){var x=n.updateQueue;x.lastEffect=null,x.events=null,x.stores=null,x.memoCache!=null&&(x.memoCache.index=0)}N.H=jn,x=l(c,f)}while(Is);return x}function XE(){var n=N.H,l=n.useState()[0];return l=typeof l.then=="function"?Ul(l):l,n=n.useState()[0],(Pt!==null?Pt.memoizedState:null)!==n&&(ft.flags|=1024),l}function af(){var n=Hu!==0;return Hu=0,n}function nf(n,l,c){l.updateQueue=n.updateQueue,l.flags&=-2053,n.lanes&=~c}function sf(n){if(zu){for(n=n.memoizedState;n!==null;){var l=n.queue;l!==null&&(l.pending=null),n=n.next}zu=!1}Ka=0,oi=Pt=ft=null,Is=!1,Il=Hu=0,Us=null}function ir(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return oi===null?ft.memoizedState=oi=n:oi=oi.next=n,oi}function ui(){if(Pt===null){var n=ft.alternate;n=n!==null?n.memoizedState:null}else n=Pt.next;var l=oi===null?ft.memoizedState:oi.next;if(l!==null)oi=l,Pt=n;else{if(n===null)throw ft.alternate===null?Error(r(467)):Error(r(310));Pt=n,n={memoizedState:Pt.memoizedState,baseState:Pt.baseState,baseQueue:Pt.baseQueue,queue:Pt.queue,next:null},oi===null?ft.memoizedState=oi=n:oi=oi.next=n}return oi}var Pu;Pu=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}};function Ul(n){var l=Il;return Il+=1,Us===null&&(Us=[]),n=Tm(Us,n,l),l=ft,(oi===null?l.memoizedState:oi.next)===null&&(l=l.alternate,N.H=l===null||l.memoizedState===null?Wn:$a),n}function Iu(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return Ul(n);if(n.$$typeof===v)return Pi(n)}throw Error(r(438,String(n)))}function lf(n){var l=null,c=ft.updateQueue;if(c!==null&&(l=c.memoCache),l==null){var f=ft.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(l={data:f.data.map(function(m){return m.slice()}),index:0})))}if(l==null&&(l={data:[],index:0}),c===null&&(c=Pu(),ft.updateQueue=c),c.memoCache=l,c=l.data[l.index],c===void 0)for(c=l.data[l.index]=Array(n),f=0;f<n;f++)c[f]=D;return l.index++,c}function xa(n,l){return typeof l=="function"?l(n):l}function Uu(n){var l=ui();return of(l,Pt,n)}function of(n,l,c){var f=n.queue;if(f===null)throw Error(r(311));f.lastRenderedReducer=c;var m=n.baseQueue,x=f.pending;if(x!==null){if(m!==null){var _=m.next;m.next=x.next,x.next=_}l.baseQueue=m=x,f.pending=null}if(x=n.baseState,m===null)n.memoizedState=x;else{l=m.next;var O=_=null,G=null,J=l,xe=!1;do{var Re=J.lane&-536870913;if(Re!==J.lane?(St&Re)===Re:(Ka&Re)===Re){var ue=J.revertLane;if(ue===0)G!==null&&(G=G.next={lane:0,revertLane:0,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null}),Re===Hs&&(xe=!0);else if((Ka&ue)===ue){J=J.next,ue===Hs&&(xe=!0);continue}else Re={lane:0,revertLane:J.revertLane,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null},G===null?(O=G=Re,_=x):G=G.next=Re,ft.lanes|=ue,sn|=ue;Re=J.action,Gn&&c(x,Re),x=J.hasEagerState?J.eagerState:c(x,Re)}else ue={lane:Re,revertLane:J.revertLane,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null},G===null?(O=G=ue,_=x):G=G.next=ue,ft.lanes|=Re,sn|=Re;J=J.next}while(J!==null&&J!==l);if(G===null?_=x:G.next=O,!or(x,n.memoizedState)&&(wi=!0,xe&&(c=Ps,c!==null)))throw c;n.memoizedState=x,n.baseState=_,n.baseQueue=G,f.lastRenderedState=x}return m===null&&(f.lanes=0),[n.memoizedState,f.dispatch]}function uf(n){var l=ui(),c=l.queue;if(c===null)throw Error(r(311));c.lastRenderedReducer=n;var f=c.dispatch,m=c.pending,x=l.memoizedState;if(m!==null){c.pending=null;var _=m=m.next;do x=n(x,_.action),_=_.next;while(_!==m);or(x,l.memoizedState)||(wi=!0),l.memoizedState=x,l.baseQueue===null&&(l.baseState=x),c.lastRenderedState=x}return[x,f]}function Bm(n,l,c){var f=ft,m=ui(),x=Mt;if(x){if(c===void 0)throw Error(r(407));c=c()}else c=l();var _=!or((Pt||m).memoizedState,c);if(_&&(m.memoizedState=c,wi=!0),m=m.queue,ff(Pm.bind(null,f,m,n),[n]),m.getSnapshot!==l||_||oi!==null&&oi.memoizedState.tag&1){if(f.flags|=2048,Vs(9,Hm.bind(null,f,m,c,l),{destroy:void 0},null),Yt===null)throw Error(r(349));x||(Ka&60)!==0||zm(f,l,c)}return c}function zm(n,l,c){n.flags|=16384,n={getSnapshot:l,value:c},l=ft.updateQueue,l===null?(l=Pu(),ft.updateQueue=l,l.stores=[n]):(c=l.stores,c===null?l.stores=[n]:c.push(n))}function Hm(n,l,c,f){l.value=c,l.getSnapshot=f,Im(l)&&Um(n)}function Pm(n,l,c){return c(function(){Im(l)&&Um(n)})}function Im(n){var l=n.getSnapshot;n=n.value;try{var c=l();return!or(n,c)}catch{return!0}}function Um(n){var l=Xa(n,2);l!==null&&$i(l,n,2)}function cf(n){var l=ir();if(typeof n=="function"){var c=n;if(n=c(),Gn){ii(!0);try{c()}finally{ii(!1)}}}return l.memoizedState=l.baseState=n,l.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:xa,lastRenderedState:n},l}function Vm(n,l,c,f){return n.baseState=c,of(n,Pt,typeof f=="function"?f:xa)}function YE(n,l,c,f,m){if(Wu(n))throw Error(r(485));if(n=l.action,n!==null){var x={payload:m,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(_){x.listeners.push(_)}};N.T!==null?c(!0):x.isTransition=!1,f(x),c=l.pending,c===null?(x.next=l.pending=x,Gm(l,x)):(x.next=c.next,l.pending=c.next=x)}}function Gm(n,l){var c=l.action,f=l.payload,m=n.state;if(l.isTransition){var x=N.T,_={};N.T=_;try{var O=c(m,f),G=N.S;G!==null&&G(_,O),Wm(n,l,O)}catch(J){hf(n,l,J)}finally{N.T=x}}else try{x=c(m,f),Wm(n,l,x)}catch(J){hf(n,l,J)}}function Wm(n,l,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(f){jm(n,l,f)},function(f){return hf(n,l,f)}):jm(n,l,c)}function jm(n,l,c){l.status="fulfilled",l.value=c,Xm(l),n.state=c,l=n.pending,l!==null&&(c=l.next,c===l?n.pending=null:(c=c.next,l.next=c,Gm(n,c)))}function hf(n,l,c){var f=n.pending;if(n.pending=null,f!==null){f=f.next;do l.status="rejected",l.reason=c,Xm(l),l=l.next;while(l!==f)}n.action=null}function Xm(n){n=n.listeners;for(var l=0;l<n.length;l++)(0,n[l])()}function Ym(n,l){return l}function qm(n,l){if(Mt){var c=Yt.formState;if(c!==null){e:{var f=ft;if(Mt){if(Ai){t:{for(var m=Ai,x=ra;m.nodeType!==8;){if(!x){m=null;break t}if(m=qr(m.nextSibling),m===null){m=null;break t}}x=m.data,m=x==="F!"||x==="F"?m:null}if(m){Ai=qr(m.nextSibling),f=m.data==="F!";break e}}In(f)}f=!1}f&&(l=c[0])}}return c=ir(),c.memoizedState=c.baseState=l,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ym,lastRenderedState:l},c.queue=f,c=fg.bind(null,ft,f),f.dispatch=c,f=cf(!1),x=vf.bind(null,ft,!1,f.queue),f=ir(),m={state:l,dispatch:null,action:n,pending:null},f.queue=m,c=YE.bind(null,ft,m,x,c),m.dispatch=c,f.memoizedState=n,[l,c,!1]}function Km(n){var l=ui();return $m(l,Pt,n)}function $m(n,l,c){l=of(n,l,Ym)[0],n=Uu(xa)[0],l=typeof l=="object"&&l!==null&&typeof l.then=="function"?Ul(l):l;var f=ui(),m=f.queue,x=m.dispatch;return c!==f.memoizedState&&(ft.flags|=2048,Vs(9,qE.bind(null,m,c),{destroy:void 0},null)),[l,x,n]}function qE(n,l){n.action=l}function Zm(n){var l=ui(),c=Pt;if(c!==null)return $m(l,c,n);ui(),l=l.memoizedState,c=ui();var f=c.queue.dispatch;return c.memoizedState=n,[l,f,!1]}function Vs(n,l,c,f){return n={tag:n,create:l,inst:c,deps:f,next:null},l=ft.updateQueue,l===null&&(l=Pu(),ft.updateQueue=l),c=l.lastEffect,c===null?l.lastEffect=n.next=n:(f=c.next,c.next=n,n.next=f,l.lastEffect=n),n}function Qm(){return ui().memoizedState}function Vu(n,l,c,f){var m=ir();ft.flags|=n,m.memoizedState=Vs(1|l,c,{destroy:void 0},f===void 0?null:f)}function Gu(n,l,c,f){var m=ui();f=f===void 0?null:f;var x=m.memoizedState.inst;Pt!==null&&f!==null&&tf(f,Pt.memoizedState.deps)?m.memoizedState=Vs(l,c,x,f):(ft.flags|=n,m.memoizedState=Vs(1|l,c,x,f))}function Jm(n,l){Vu(8390656,8,n,l)}function ff(n,l){Gu(2048,8,n,l)}function eg(n,l){return Gu(4,2,n,l)}function tg(n,l){return Gu(4,4,n,l)}function ig(n,l){if(typeof l=="function"){n=n();var c=l(n);return function(){typeof c=="function"?c():l(null)}}if(l!=null)return n=n(),l.current=n,function(){l.current=null}}function rg(n,l,c){c=c!=null?c.concat([n]):null,Gu(4,4,ig.bind(null,l,n),c)}function df(){}function ag(n,l){var c=ui();l=l===void 0?null:l;var f=c.memoizedState;return l!==null&&tf(l,f[1])?f[0]:(c.memoizedState=[n,l],n)}function ng(n,l){var c=ui();l=l===void 0?null:l;var f=c.memoizedState;if(l!==null&&tf(l,f[1]))return f[0];if(f=n(),Gn){ii(!0);try{n()}finally{ii(!1)}}return c.memoizedState=[f,l],f}function pf(n,l,c){return c===void 0||(Ka&1073741824)!==0?n.memoizedState=l:(n.memoizedState=c,n=lv(),ft.lanes|=n,sn|=n,c)}function sg(n,l,c,f){return or(c,l)?c:zs.current!==null?(n=pf(n,c,f),or(n,l)||(wi=!0),n):(Ka&42)===0?(wi=!0,n.memoizedState=c):(n=lv(),ft.lanes|=n,sn|=n,l)}function lg(n,l,c,f,m){var x=pe.p;pe.p=x!==0&&8>x?x:8;var _=N.T,O={};N.T=O,vf(n,!1,l,c);try{var G=m(),J=N.S;if(J!==null&&J(O,G),G!==null&&typeof G=="object"&&typeof G.then=="function"){var xe=WE(G,f);Vl(n,l,xe,fr(n))}else Vl(n,l,f,fr(n))}catch(Re){Vl(n,l,{then:function(){},status:"rejected",reason:Re},fr())}finally{pe.p=x,N.T=_}}function KE(){}function mf(n,l,c,f){if(n.tag!==5)throw Error(r(476));var m=og(n).queue;lg(n,m,l,Ne,c===null?KE:function(){return ug(n),c(f)})}function og(n){var l=n.memoizedState;if(l!==null)return l;l={memoizedState:Ne,baseState:Ne,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:xa,lastRenderedState:Ne},next:null};var c={};return l.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:xa,lastRenderedState:c},next:null},n.memoizedState=l,n=n.alternate,n!==null&&(n.memoizedState=l),l}function ug(n){var l=og(n).next.queue;Vl(n,l,{},fr())}function gf(){return Pi(oo)}function cg(){return ui().memoizedState}function hg(){return ui().memoizedState}function $E(n){for(var l=n.return;l!==null;){switch(l.tag){case 24:case 3:var c=fr();n=Ja(c);var f=en(l,n,c);f!==null&&($i(f,l,c),jl(f,l,c)),l={cache:Qh()},n.payload=l;return}l=l.return}}function ZE(n,l,c){var f=fr();c={lane:f,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null},Wu(n)?dg(l,c):(c=jh(n,l,c,f),c!==null&&($i(c,n,f),pg(c,l,f)))}function fg(n,l,c){var f=fr();Vl(n,l,c,f)}function Vl(n,l,c,f){var m={lane:f,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null};if(Wu(n))dg(l,m);else{var x=n.alternate;if(n.lanes===0&&(x===null||x.lanes===0)&&(x=l.lastRenderedReducer,x!==null))try{var _=l.lastRenderedState,O=x(_,c);if(m.hasEagerState=!0,m.eagerState=O,or(O,_))return Ru(n,l,m,0),Yt===null&&Su(),!1}catch{}finally{}if(c=jh(n,l,m,f),c!==null)return $i(c,n,f),pg(c,l,f),!0}return!1}function vf(n,l,c,f){if(f={lane:2,revertLane:sd(),action:f,hasEagerState:!1,eagerState:null,next:null},Wu(n)){if(l)throw Error(r(479))}else l=jh(n,c,f,2),l!==null&&$i(l,n,2)}function Wu(n){var l=n.alternate;return n===ft||l!==null&&l===ft}function dg(n,l){Is=zu=!0;var c=n.pending;c===null?l.next=l:(l.next=c.next,c.next=l),n.pending=l}function pg(n,l,c){if((c&4194176)!==0){var f=l.lanes;f&=n.pendingLanes,c|=f,l.lanes=c,et(n,c)}}var na={readContext:Pi,use:Iu,useCallback:ai,useContext:ai,useEffect:ai,useImperativeHandle:ai,useLayoutEffect:ai,useInsertionEffect:ai,useMemo:ai,useReducer:ai,useRef:ai,useState:ai,useDebugValue:ai,useDeferredValue:ai,useTransition:ai,useSyncExternalStore:ai,useId:ai};na.useCacheRefresh=ai,na.useMemoCache=ai,na.useHostTransitionStatus=ai,na.useFormState=ai,na.useActionState=ai,na.useOptimistic=ai;var Wn={readContext:Pi,use:Iu,useCallback:function(n,l){return ir().memoizedState=[n,l===void 0?null:l],n},useContext:Pi,useEffect:Jm,useImperativeHandle:function(n,l,c){c=c!=null?c.concat([n]):null,Vu(4194308,4,ig.bind(null,l,n),c)},useLayoutEffect:function(n,l){return Vu(4194308,4,n,l)},useInsertionEffect:function(n,l){Vu(4,2,n,l)},useMemo:function(n,l){var c=ir();l=l===void 0?null:l;var f=n();if(Gn){ii(!0);try{n()}finally{ii(!1)}}return c.memoizedState=[f,l],f},useReducer:function(n,l,c){var f=ir();if(c!==void 0){var m=c(l);if(Gn){ii(!0);try{c(l)}finally{ii(!1)}}}else m=l;return f.memoizedState=f.baseState=m,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:m},f.queue=n,n=n.dispatch=ZE.bind(null,ft,n),[f.memoizedState,n]},useRef:function(n){var l=ir();return n={current:n},l.memoizedState=n},useState:function(n){n=cf(n);var l=n.queue,c=fg.bind(null,ft,l);return l.dispatch=c,[n.memoizedState,c]},useDebugValue:df,useDeferredValue:function(n,l){var c=ir();return pf(c,n,l)},useTransition:function(){var n=cf(!1);return n=lg.bind(null,ft,n.queue,!0,!1),ir().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,l,c){var f=ft,m=ir();if(Mt){if(c===void 0)throw Error(r(407));c=c()}else{if(c=l(),Yt===null)throw Error(r(349));(St&60)!==0||zm(f,l,c)}m.memoizedState=c;var x={value:c,getSnapshot:l};return m.queue=x,Jm(Pm.bind(null,f,x,n),[n]),f.flags|=2048,Vs(9,Hm.bind(null,f,x,c,l),{destroy:void 0},null),c},useId:function(){var n=ir(),l=Yt.identifierPrefix;if(Mt){var c=va,f=ga;c=(f&~(1<<32-ri(f)-1)).toString(32)+c,l=":"+l+"R"+c,c=Hu++,0<c&&(l+="H"+c.toString(32)),l+=":"}else c=jE++,l=":"+l+"r"+c.toString(32)+":";return n.memoizedState=l},useCacheRefresh:function(){return ir().memoizedState=$E.bind(null,ft)}};Wn.useMemoCache=lf,Wn.useHostTransitionStatus=gf,Wn.useFormState=qm,Wn.useActionState=qm,Wn.useOptimistic=function(n){var l=ir();l.memoizedState=l.baseState=n;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return l.queue=c,l=vf.bind(null,ft,!0,c),c.dispatch=l,[n,l]};var $a={readContext:Pi,use:Iu,useCallback:ag,useContext:Pi,useEffect:ff,useImperativeHandle:rg,useInsertionEffect:eg,useLayoutEffect:tg,useMemo:ng,useReducer:Uu,useRef:Qm,useState:function(){return Uu(xa)},useDebugValue:df,useDeferredValue:function(n,l){var c=ui();return sg(c,Pt.memoizedState,n,l)},useTransition:function(){var n=Uu(xa)[0],l=ui().memoizedState;return[typeof n=="boolean"?n:Ul(n),l]},useSyncExternalStore:Bm,useId:cg};$a.useCacheRefresh=hg,$a.useMemoCache=lf,$a.useHostTransitionStatus=gf,$a.useFormState=Km,$a.useActionState=Km,$a.useOptimistic=function(n,l){var c=ui();return Vm(c,Pt,n,l)};var jn={readContext:Pi,use:Iu,useCallback:ag,useContext:Pi,useEffect:ff,useImperativeHandle:rg,useInsertionEffect:eg,useLayoutEffect:tg,useMemo:ng,useReducer:uf,useRef:Qm,useState:function(){return uf(xa)},useDebugValue:df,useDeferredValue:function(n,l){var c=ui();return Pt===null?pf(c,n,l):sg(c,Pt.memoizedState,n,l)},useTransition:function(){var n=uf(xa)[0],l=ui().memoizedState;return[typeof n=="boolean"?n:Ul(n),l]},useSyncExternalStore:Bm,useId:cg};jn.useCacheRefresh=hg,jn.useMemoCache=lf,jn.useHostTransitionStatus=gf,jn.useFormState=Zm,jn.useActionState=Zm,jn.useOptimistic=function(n,l){var c=ui();return Pt!==null?Vm(c,Pt,n,l):(c.baseState=n,[n,c.queue.dispatch])};function bf(n,l,c,f){l=n.memoizedState,c=c(f,l),c=c==null?l:j({},l,c),n.memoizedState=c,n.lanes===0&&(n.updateQueue.baseState=c)}var xf={isMounted:function(n){return(n=n._reactInternals)?ve(n)===n:!1},enqueueSetState:function(n,l,c){n=n._reactInternals;var f=fr(),m=Ja(f);m.payload=l,c!=null&&(m.callback=c),l=en(n,m,f),l!==null&&($i(l,n,f),jl(l,n,f))},enqueueReplaceState:function(n,l,c){n=n._reactInternals;var f=fr(),m=Ja(f);m.tag=1,m.payload=l,c!=null&&(m.callback=c),l=en(n,m,f),l!==null&&($i(l,n,f),jl(l,n,f))},enqueueForceUpdate:function(n,l){n=n._reactInternals;var c=fr(),f=Ja(c);f.tag=2,l!=null&&(f.callback=l),l=en(n,f,c),l!==null&&($i(l,n,c),jl(l,n,c))}};function mg(n,l,c,f,m,x,_){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(f,x,_):l.prototype&&l.prototype.isPureReactComponent?!Al(c,f)||!Al(m,x):!0}function gg(n,l,c,f){n=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(c,f),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(c,f),l.state!==n&&xf.enqueueReplaceState(l,l.state,null)}function Xn(n,l){var c=l;if("ref"in l){c={};for(var f in l)f!=="ref"&&(c[f]=l[f])}if(n=n.defaultProps){c===l&&(c=j({},c));for(var m in n)c[m]===void 0&&(c[m]=n[m])}return c}var ju=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var l=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(l))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)};function vg(n){ju(n)}function bg(n){console.error(n)}function xg(n){ju(n)}function Xu(n,l){try{var c=n.onUncaughtError;c(l.value,{componentStack:l.stack})}catch(f){setTimeout(function(){throw f})}}function wg(n,l,c){try{var f=n.onCaughtError;f(c.value,{componentStack:c.stack,errorBoundary:l.tag===1?l.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function wf(n,l,c){return c=Ja(c),c.tag=3,c.payload={element:null},c.callback=function(){Xu(n,l)},c}function yg(n){return n=Ja(n),n.tag=3,n}function Eg(n,l,c,f){var m=c.type.getDerivedStateFromError;if(typeof m=="function"){var x=f.value;n.payload=function(){return m(x)},n.callback=function(){wg(l,c,f)}}var _=c.stateNode;_!==null&&typeof _.componentDidCatch=="function"&&(n.callback=function(){wg(l,c,f),typeof m!="function"&&(ln===null?ln=new Set([this]):ln.add(this));var O=f.stack;this.componentDidCatch(f.value,{componentStack:O!==null?O:""})})}function QE(n,l,c,f,m){if(c.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(l=c.alternate,l!==null&&Wl(l,c,m,!0),c=Ar.current,c!==null){switch(c.tag){case 13:return aa===null?td():c.alternate===null&&Qt===0&&(Qt=3),c.flags&=-257,c.flags|=65536,c.lanes=m,f===Kh?c.flags|=16384:(l=c.updateQueue,l===null?c.updateQueue=new Set([f]):l.add(f),rd(n,f,m)),!1;case 22:return c.flags|=65536,f===Kh?c.flags|=16384:(l=c.updateQueue,l===null?(l={transitions:null,markerInstances:null,retryQueue:new Set([f])},c.updateQueue=l):(c=l.retryQueue,c===null?l.retryQueue=new Set([f]):c.add(f)),rd(n,f,m)),!1}throw Error(r(435,c.tag))}return rd(n,f,m),td(),!1}if(Mt)return l=Ar.current,l!==null?((l.flags&65536)===0&&(l.flags|=256),l.flags|=65536,l.lanes=m,f!==qh&&(n=Error(r(422),{cause:f}),Ol(Sr(n,c)))):(f!==qh&&(l=Error(r(423),{cause:f}),Ol(Sr(l,c))),n=n.current.alternate,n.flags|=65536,m&=-m,n.lanes|=m,f=Sr(f,c),m=wf(n.stateNode,f,m),Nf(n,m),Qt!==4&&(Qt=2)),!1;var x=Error(r(520),{cause:f});if(x=Sr(x,c),Jl===null?Jl=[x]:Jl.push(x),Qt!==4&&(Qt=2),l===null)return!0;f=Sr(f,c),c=l;do{switch(c.tag){case 3:return c.flags|=65536,n=m&-m,c.lanes|=n,n=wf(c.stateNode,f,n),Nf(c,n),!1;case 1:if(l=c.type,x=c.stateNode,(c.flags&128)===0&&(typeof l.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(ln===null||!ln.has(x))))return c.flags|=65536,m&=-m,c.lanes|=m,m=yg(m),Eg(m,n,c,f),Nf(c,m),!1}c=c.return}while(c!==null);return!1}var Cg=Error(r(461)),wi=!1;function Di(n,l,c,f){l.child=n===null?km(l,null,c,f):Un(l,n.child,c,f)}function Tg(n,l,c,f,m){c=c.render;var x=l.ref;if("ref"in f){var _={};for(var O in f)O!=="ref"&&(_[O]=f[O])}else _=f;return qn(l),f=rf(n,l,c,_,x,m),O=af(),n!==null&&!wi?(nf(n,l,m),wa(n,l,m)):(Mt&&O&&Xh(l),l.flags|=1,Di(n,l,f,m),l.child)}function _g(n,l,c,f,m){if(n===null){var x=c.type;return typeof x=="function"&&!Gf(x)&&x.defaultProps===void 0&&c.compare===null?(l.tag=15,l.type=x,Sg(n,l,x,f,m)):(n=Zu(c.type,null,f,l,l.mode,m),n.ref=l.ref,n.return=l,l.child=n)}if(x=n.child,!Af(n,m)){var _=x.memoizedProps;if(c=c.compare,c=c!==null?c:Al,c(_,f)&&n.ref===l.ref)return wa(n,l,m)}return l.flags|=1,n=nn(x,f),n.ref=l.ref,n.return=l,l.child=n}function Sg(n,l,c,f,m){if(n!==null){var x=n.memoizedProps;if(Al(x,f)&&n.ref===l.ref)if(wi=!1,l.pendingProps=f=x,Af(n,m))(n.flags&131072)!==0&&(wi=!0);else return l.lanes=n.lanes,wa(n,l,m)}return yf(n,l,c,f,m)}function Rg(n,l,c){var f=l.pendingProps,m=f.children,x=(l.stateNode._pendingVisibility&2)!==0,_=n!==null?n.memoizedState:null;if(Gl(n,l),f.mode==="hidden"||x){if((l.flags&128)!==0){if(f=_!==null?_.baseLanes|c:c,n!==null){for(m=l.child=n.child,x=0;m!==null;)x=x|m.lanes|m.childLanes,m=m.sibling;l.childLanes=x&~f}else l.childLanes=0,l.child=null;return kg(n,l,f,c)}if((c&536870912)!==0)l.memoizedState={baseLanes:0,cachePool:null},n!==null&&Bu(l,_!==null?_.cachePool:null),_!==null?Am(l,_):$h(),Dm(l);else return l.lanes=l.childLanes=536870912,kg(n,l,_!==null?_.baseLanes|c:c,c)}else _!==null?(Bu(l,_.cachePool),Am(l,_),qa(),l.memoizedState=null):(n!==null&&Bu(l,null),$h(),qa());return Di(n,l,m,c),l.child}function kg(n,l,c,f){var m=ef();return m=m===null?null:{parent:vi._currentValue,pool:m},l.memoizedState={baseLanes:c,cachePool:m},n!==null&&Bu(l,null),$h(),Dm(l),n!==null&&Wl(n,l,f,!0),null}function Gl(n,l){var c=l.ref;if(c===null)n!==null&&n.ref!==null&&(l.flags|=2097664);else{if(typeof c!="function"&&typeof c!="object")throw Error(r(284));(n===null||n.ref!==c)&&(l.flags|=2097664)}}function yf(n,l,c,f,m){return qn(l),c=rf(n,l,c,f,void 0,m),f=af(),n!==null&&!wi?(nf(n,l,m),wa(n,l,m)):(Mt&&f&&Xh(l),l.flags|=1,Di(n,l,c,m),l.child)}function Ag(n,l,c,f,m,x){return qn(l),l.updateQueue=null,c=Nm(l,f,c,m),Lm(n),f=af(),n!==null&&!wi?(nf(n,l,x),wa(n,l,x)):(Mt&&f&&Xh(l),l.flags|=1,Di(n,l,c,x),l.child)}function Dg(n,l,c,f,m){if(qn(l),l.stateNode===null){var x=Os,_=c.contextType;typeof _=="object"&&_!==null&&(x=Pi(_)),x=new c(f,x),l.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,x.updater=xf,l.stateNode=x,x._reactInternals=l,x=l.stateNode,x.props=f,x.state=l.memoizedState,x.refs={},Of(l),_=c.contextType,x.context=typeof _=="object"&&_!==null?Pi(_):Os,x.state=l.memoizedState,_=c.getDerivedStateFromProps,typeof _=="function"&&(bf(l,c,_,f),x.state=l.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof x.getSnapshotBeforeUpdate=="function"||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(_=x.state,typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount(),_!==x.state&&xf.enqueueReplaceState(x,x.state,null),Yl(l,f,x,m),Xl(),x.state=l.memoizedState),typeof x.componentDidMount=="function"&&(l.flags|=4194308),f=!0}else if(n===null){x=l.stateNode;var O=l.memoizedProps,G=Xn(c,O);x.props=G;var J=x.context,xe=c.contextType;_=Os,typeof xe=="object"&&xe!==null&&(_=Pi(xe));var Re=c.getDerivedStateFromProps;xe=typeof Re=="function"||typeof x.getSnapshotBeforeUpdate=="function",O=l.pendingProps!==O,xe||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(O||J!==_)&&gg(l,x,f,_),Qa=!1;var ue=l.memoizedState;x.state=ue,Yl(l,f,x,m),Xl(),J=l.memoizedState,O||ue!==J||Qa?(typeof Re=="function"&&(bf(l,c,Re,f),J=l.memoizedState),(G=Qa||mg(l,c,G,f,ue,J,_))?(xe||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(l.flags|=4194308)):(typeof x.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=f,l.memoizedState=J),x.props=f,x.state=J,x.context=_,f=G):(typeof x.componentDidMount=="function"&&(l.flags|=4194308),f=!1)}else{x=l.stateNode,Lf(n,l),_=l.memoizedProps,xe=Xn(c,_),x.props=xe,Re=l.pendingProps,ue=x.context,J=c.contextType,G=Os,typeof J=="object"&&J!==null&&(G=Pi(J)),O=c.getDerivedStateFromProps,(J=typeof O=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(_!==Re||ue!==G)&&gg(l,x,f,G),Qa=!1,ue=l.memoizedState,x.state=ue,Yl(l,f,x,m),Xl();var be=l.memoizedState;_!==Re||ue!==be||Qa||n!==null&&n.dependencies!==null&&Yu(n.dependencies)?(typeof O=="function"&&(bf(l,c,O,f),be=l.memoizedState),(xe=Qa||mg(l,c,xe,f,ue,be,G)||n!==null&&n.dependencies!==null&&Yu(n.dependencies))?(J||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(f,be,G),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(f,be,G)),typeof x.componentDidUpdate=="function"&&(l.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof x.componentDidUpdate!="function"||_===n.memoizedProps&&ue===n.memoizedState||(l.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||_===n.memoizedProps&&ue===n.memoizedState||(l.flags|=1024),l.memoizedProps=f,l.memoizedState=be),x.props=f,x.state=be,x.context=G,f=xe):(typeof x.componentDidUpdate!="function"||_===n.memoizedProps&&ue===n.memoizedState||(l.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||_===n.memoizedProps&&ue===n.memoizedState||(l.flags|=1024),f=!1)}return x=f,Gl(n,l),f=(l.flags&128)!==0,x||f?(x=l.stateNode,c=f&&typeof c.getDerivedStateFromError!="function"?null:x.render(),l.flags|=1,n!==null&&f?(l.child=Un(l,n.child,null,m),l.child=Un(l,null,c,m)):Di(n,l,c,m),l.memoizedState=x.state,n=l.child):n=wa(n,l,m),n}function Fg(n,l,c,f){return Ml(),l.flags|=256,Di(n,l,c,f),l.child}var Ef={dehydrated:null,treeContext:null,retryLane:0};function Cf(n){return{baseLanes:n,cachePool:Om()}}function Tf(n,l,c){return n=n!==null?n.childLanes&~c:0,l&&(n|=Or),n}function Mg(n,l,c){var f=l.pendingProps,m=!1,x=(l.flags&128)!==0,_;if((_=x)||(_=n!==null&&n.memoizedState===null?!1:(gi.current&2)!==0),_&&(m=!0,l.flags&=-129),_=(l.flags&32)!==0,l.flags&=-33,n===null){if(Mt){if(m?Ya(l):qa(),Mt){var O=Ai,G;if(G=O){e:{for(G=O,O=ra;G.nodeType!==8;){if(!O){O=null;break e}if(G=qr(G.nextSibling),G===null){O=null;break e}}O=G}O!==null?(l.memoizedState={dehydrated:O,treeContext:Hn!==null?{id:ga,overflow:va}:null,retryLane:536870912},G=Mr(18,null,null,0),G.stateNode=O,G.return=l,l.child=G,Ki=l,Ai=null,G=!0):G=!1}G||In(l)}if(O=l.memoizedState,O!==null&&(O=O.dehydrated,O!==null))return O.data==="$!"?l.lanes=16:l.lanes=536870912,null;ba(l)}return O=f.children,f=f.fallback,m?(qa(),m=l.mode,O=Sf({mode:"hidden",children:O},m),f=$n(f,m,c,null),O.return=l,f.return=l,O.sibling=f,l.child=O,m=l.child,m.memoizedState=Cf(c),m.childLanes=Tf(n,_,c),l.memoizedState=Ef,f):(Ya(l),_f(l,O))}if(G=n.memoizedState,G!==null&&(O=G.dehydrated,O!==null)){if(x)l.flags&256?(Ya(l),l.flags&=-257,l=Rf(n,l,c)):l.memoizedState!==null?(qa(),l.child=n.child,l.flags|=128,l=null):(qa(),m=f.fallback,O=l.mode,f=Sf({mode:"visible",children:f.children},O),m=$n(m,O,c,null),m.flags|=2,f.return=l,m.return=l,f.sibling=m,l.child=f,Un(l,n.child,null,c),f=l.child,f.memoizedState=Cf(c),f.childLanes=Tf(n,_,c),l.memoizedState=Ef,l=m);else if(Ya(l),O.data==="$!"){if(_=O.nextSibling&&O.nextSibling.dataset,_)var J=_.dgst;_=J,f=Error(r(419)),f.stack="",f.digest=_,Ol({value:f,source:null,stack:null}),l=Rf(n,l,c)}else if(wi||Wl(n,l,c,!1),_=(c&n.childLanes)!==0,wi||_){if(_=Yt,_!==null){if(f=c&-c,(f&42)!==0)f=1;else switch(f){case 2:f=1;break;case 8:f=4;break;case 32:f=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:f=64;break;case 268435456:f=134217728;break;default:f=0}if(f=(f&(_.suspendedLanes|c))!==0?0:f,f!==0&&f!==G.retryLane)throw G.retryLane=f,Xa(n,f),$i(_,n,f),Cg}O.data==="$?"||td(),l=Rf(n,l,c)}else O.data==="$?"?(l.flags|=128,l.child=n.child,l=dC.bind(null,n),O._reactRetry=l,l=null):(n=G.treeContext,Ai=qr(O.nextSibling),Ki=l,Mt=!0,Xr=null,ra=!1,n!==null&&(Rr[kr++]=ga,Rr[kr++]=va,Rr[kr++]=Hn,ga=n.id,va=n.overflow,Hn=l),l=_f(l,f.children),l.flags|=4096);return l}return m?(qa(),m=f.fallback,O=l.mode,G=n.child,J=G.sibling,f=nn(G,{mode:"hidden",children:f.children}),f.subtreeFlags=G.subtreeFlags&31457280,J!==null?m=nn(J,m):(m=$n(m,O,c,null),m.flags|=2),m.return=l,f.return=l,f.sibling=m,l.child=f,f=m,m=l.child,O=n.child.memoizedState,O===null?O=Cf(c):(G=O.cachePool,G!==null?(J=vi._currentValue,G=G.parent!==J?{parent:J,pool:J}:G):G=Om(),O={baseLanes:O.baseLanes|c,cachePool:G}),m.memoizedState=O,m.childLanes=Tf(n,_,c),l.memoizedState=Ef,f):(Ya(l),c=n.child,n=c.sibling,c=nn(c,{mode:"visible",children:f.children}),c.return=l,c.sibling=null,n!==null&&(_=l.deletions,_===null?(l.deletions=[n],l.flags|=16):_.push(n)),l.child=c,l.memoizedState=null,c)}function _f(n,l){return l=Sf({mode:"visible",children:l},n.mode),l.return=n,n.child=l}function Sf(n,l){return av(n,l,0,null)}function Rf(n,l,c){return Un(l,n.child,null,c),n=_f(l,l.pendingProps.children),n.flags|=2,l.memoizedState=null,n}function Og(n,l,c){n.lanes|=l;var f=n.alternate;f!==null&&(f.lanes|=l),Ff(n.return,l,c)}function kf(n,l,c,f,m){var x=n.memoizedState;x===null?n.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:f,tail:c,tailMode:m}:(x.isBackwards=l,x.rendering=null,x.renderingStartTime=0,x.last=f,x.tail=c,x.tailMode=m)}function Lg(n,l,c){var f=l.pendingProps,m=f.revealOrder,x=f.tail;if(Di(n,l,f.children,c),f=gi.current,(f&2)!==0)f=f&1|2,l.flags|=128;else{if(n!==null&&(n.flags&128)!==0)e:for(n=l.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&Og(n,c,l);else if(n.tag===19)Og(n,c,l);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===l)break e;for(;n.sibling===null;){if(n.return===null||n.return===l)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}f&=1}switch(X(gi,f),m){case"forwards":for(c=l.child,m=null;c!==null;)n=c.alternate,n!==null&&Nu(n)===null&&(m=c),c=c.sibling;c=m,c===null?(m=l.child,l.child=null):(m=c.sibling,c.sibling=null),kf(l,!1,m,c,x);break;case"backwards":for(c=null,m=l.child,l.child=null;m!==null;){if(n=m.alternate,n!==null&&Nu(n)===null){l.child=m;break}n=m.sibling,m.sibling=c,c=m,m=n}kf(l,!0,c,null,x);break;case"together":kf(l,!1,null,null,void 0);break;default:l.memoizedState=null}return l.child}function wa(n,l,c){if(n!==null&&(l.dependencies=n.dependencies),sn|=l.lanes,(c&l.childLanes)===0)if(n!==null){if(Wl(n,l,c,!1),(c&l.childLanes)===0)return null}else return null;if(n!==null&&l.child!==n.child)throw Error(r(153));if(l.child!==null){for(n=l.child,c=nn(n,n.pendingProps),l.child=c,c.return=l;n.sibling!==null;)n=n.sibling,c=c.sibling=nn(n,n.pendingProps),c.return=l;c.sibling=null}return l.child}function Af(n,l){return(n.lanes&l)!==0?!0:(n=n.dependencies,!!(n!==null&&Yu(n)))}function JE(n,l,c){switch(l.tag){case 3:He(l,l.stateNode.containerInfo),Za(l,vi,n.memoizedState.cache),Ml();break;case 27:case 5:Xe(l);break;case 4:He(l,l.stateNode.containerInfo);break;case 10:Za(l,l.type,l.memoizedProps.value);break;case 13:var f=l.memoizedState;if(f!==null)return f.dehydrated!==null?(Ya(l),l.flags|=128,null):(c&l.child.childLanes)!==0?Mg(n,l,c):(Ya(l),n=wa(n,l,c),n!==null?n.sibling:null);Ya(l);break;case 19:var m=(n.flags&128)!==0;if(f=(c&l.childLanes)!==0,f||(Wl(n,l,c,!1),f=(c&l.childLanes)!==0),m){if(f)return Lg(n,l,c);l.flags|=128}if(m=l.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),X(gi,gi.current),f)break;return null;case 22:case 23:return l.lanes=0,Rg(n,l,c);case 24:Za(l,vi,n.memoizedState.cache)}return wa(n,l,c)}function Ng(n,l,c){if(n!==null)if(n.memoizedProps!==l.pendingProps)wi=!0;else{if(!Af(n,c)&&(l.flags&128)===0)return wi=!1,JE(n,l,c);wi=(n.flags&131072)!==0}else wi=!1,Mt&&(l.flags&1048576)!==0&&xm(l,Du,l.index);switch(l.lanes=0,l.tag){case 16:e:{n=l.pendingProps;var f=l.elementType,m=f._init;if(f=m(f._payload),l.type=f,typeof f=="function")Gf(f)?(n=Xn(f,n),l.tag=1,l=Dg(null,l,f,n,c)):(l.tag=0,l=yf(null,l,f,n,c));else{if(f!=null){if(m=f.$$typeof,m===y){l.tag=11,l=Tg(null,l,f,n,c);break e}else if(m===w){l.tag=14,l=_g(null,l,f,n,c);break e}}throw l=U(f)||f,Error(r(306,l,""))}}return l;case 0:return yf(n,l,l.type,l.pendingProps,c);case 1:return f=l.type,m=Xn(f,l.pendingProps),Dg(n,l,f,m,c);case 3:e:{if(He(l,l.stateNode.containerInfo),n===null)throw Error(r(387));var x=l.pendingProps;m=l.memoizedState,f=m.element,Lf(n,l),Yl(l,x,null,c);var _=l.memoizedState;if(x=_.cache,Za(l,vi,x),x!==m.cache&&Mf(l,[vi],c,!0),Xl(),x=_.element,m.isDehydrated)if(m={element:x,isDehydrated:!1,cache:_.cache},l.updateQueue.baseState=m,l.memoizedState=m,l.flags&256){l=Fg(n,l,x,c);break e}else if(x!==f){f=Sr(Error(r(424)),l),Ol(f),l=Fg(n,l,x,c);break e}else for(Ai=qr(l.stateNode.containerInfo.firstChild),Ki=l,Mt=!0,Xr=null,ra=!0,c=km(l,null,x,c),l.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling;else{if(Ml(),x===f){l=wa(n,l,c);break e}Di(n,l,x,c)}l=l.child}return l;case 26:return Gl(n,l),n===null?(c=Hv(l.type,null,l.pendingProps,null))?l.memoizedState=c:Mt||(c=l.type,n=l.pendingProps,f=uc(H.current).createElement(c),f[A]=l,f[M]=n,Fi(f,c,n),Te(f),l.stateNode=f):l.memoizedState=Hv(l.type,n.memoizedProps,l.pendingProps,n.memoizedState),null;case 27:return Xe(l),n===null&&Mt&&(f=l.stateNode=Nv(l.type,l.pendingProps,H.current),Ki=l,ra=!0,Ai=qr(f.firstChild)),f=l.pendingProps.children,n!==null||Mt?Di(n,l,f,c):l.child=Un(l,null,f,c),Gl(n,l),l.child;case 5:return n===null&&Mt&&((m=f=Ai)&&(f=AC(f,l.type,l.pendingProps,ra),f!==null?(l.stateNode=f,Ki=l,Ai=qr(f.firstChild),ra=!1,m=!0):m=!1),m||In(l)),Xe(l),m=l.type,x=l.pendingProps,_=n!==null?n.memoizedProps:null,f=x.children,md(m,x)?f=null:_!==null&&md(m,_)&&(l.flags|=32),l.memoizedState!==null&&(m=rf(n,l,XE,null,null,c),oo._currentValue=m),Gl(n,l),Di(n,l,f,c),l.child;case 6:return n===null&&Mt&&((n=c=Ai)&&(c=DC(c,l.pendingProps,ra),c!==null?(l.stateNode=c,Ki=l,Ai=null,n=!0):n=!1),n||In(l)),null;case 13:return Mg(n,l,c);case 4:return He(l,l.stateNode.containerInfo),f=l.pendingProps,n===null?l.child=Un(l,null,f,c):Di(n,l,f,c),l.child;case 11:return Tg(n,l,l.type,l.pendingProps,c);case 7:return Di(n,l,l.pendingProps,c),l.child;case 8:return Di(n,l,l.pendingProps.children,c),l.child;case 12:return Di(n,l,l.pendingProps.children,c),l.child;case 10:return f=l.pendingProps,Za(l,l.type,f.value),Di(n,l,f.children,c),l.child;case 9:return m=l.type._context,f=l.pendingProps.children,qn(l),m=Pi(m),f=f(m),l.flags|=1,Di(n,l,f,c),l.child;case 14:return _g(n,l,l.type,l.pendingProps,c);case 15:return Sg(n,l,l.type,l.pendingProps,c);case 19:return Lg(n,l,c);case 22:return Rg(n,l,c);case 24:return qn(l),f=Pi(vi),n===null?(m=ef(),m===null&&(m=Yt,x=Qh(),m.pooledCache=x,x.refCount++,x!==null&&(m.pooledCacheLanes|=c),m=x),l.memoizedState={parent:f,cache:m},Of(l),Za(l,vi,m)):((n.lanes&c)!==0&&(Lf(n,l),Yl(l,null,null,c),Xl()),m=n.memoizedState,x=l.memoizedState,m.parent!==f?(m={parent:f,cache:f},l.memoizedState=m,l.lanes===0&&(l.memoizedState=l.updateQueue.baseState=m),Za(l,vi,f)):(f=x.cache,Za(l,vi,f),f!==m.cache&&Mf(l,[vi],c,!0))),Di(n,l,l.pendingProps.children,c),l.child;case 29:throw l.pendingProps}throw Error(r(156,l.tag))}var Df=z(null),Yn=null,ya=null;function Za(n,l,c){X(Df,l._currentValue),l._currentValue=c}function Ea(n){n._currentValue=Df.current,q(Df)}function Ff(n,l,c){for(;n!==null;){var f=n.alternate;if((n.childLanes&l)!==l?(n.childLanes|=l,f!==null&&(f.childLanes|=l)):f!==null&&(f.childLanes&l)!==l&&(f.childLanes|=l),n===c)break;n=n.return}}function Mf(n,l,c,f){var m=n.child;for(m!==null&&(m.return=n);m!==null;){var x=m.dependencies;if(x!==null){var _=m.child;x=x.firstContext;e:for(;x!==null;){var O=x;x=m;for(var G=0;G<l.length;G++)if(O.context===l[G]){x.lanes|=c,O=x.alternate,O!==null&&(O.lanes|=c),Ff(x.return,c,n),f||(_=null);break e}x=O.next}}else if(m.tag===18){if(_=m.return,_===null)throw Error(r(341));_.lanes|=c,x=_.alternate,x!==null&&(x.lanes|=c),Ff(_,c,n),_=null}else _=m.child;if(_!==null)_.return=m;else for(_=m;_!==null;){if(_===n){_=null;break}if(m=_.sibling,m!==null){m.return=_.return,_=m;break}_=_.return}m=_}}function Wl(n,l,c,f){n=null;for(var m=l,x=!1;m!==null;){if(!x){if((m.flags&524288)!==0)x=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var _=m.alternate;if(_===null)throw Error(r(387));if(_=_.memoizedProps,_!==null){var O=m.type;or(m.pendingProps.value,_.value)||(n!==null?n.push(O):n=[O])}}else if(m===ze.current){if(_=m.alternate,_===null)throw Error(r(387));_.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(n!==null?n.push(oo):n=[oo])}m=m.return}n!==null&&Mf(l,n,c,f),l.flags|=262144}function Yu(n){for(n=n.firstContext;n!==null;){if(!or(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function qn(n){Yn=n,ya=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function Pi(n){return Bg(Yn,n)}function qu(n,l){return Yn===null&&qn(n),Bg(n,l)}function Bg(n,l){var c=l._currentValue;if(l={context:l,memoizedValue:c,next:null},ya===null){if(n===null)throw Error(r(308));ya=l,n.dependencies={lanes:0,firstContext:l},n.flags|=524288}else ya=ya.next=l;return c}var Qa=!1;function Of(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Lf(n,l){n=n.updateQueue,l.updateQueue===n&&(l.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function Ja(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function en(n,l,c){var f=n.updateQueue;if(f===null)return null;if(f=f.shared,($t&2)!==0){var m=f.pending;return m===null?l.next=l:(l.next=m.next,m.next=l),f.pending=l,l=ku(n),vm(n,null,c),l}return Ru(n,f,l,c),ku(n)}function jl(n,l,c){if(l=l.updateQueue,l!==null&&(l=l.shared,(c&4194176)!==0)){var f=l.lanes;f&=n.pendingLanes,c|=f,l.lanes=c,et(n,c)}}function Nf(n,l){var c=n.updateQueue,f=n.alternate;if(f!==null&&(f=f.updateQueue,c===f)){var m=null,x=null;if(c=c.firstBaseUpdate,c!==null){do{var _={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};x===null?m=x=_:x=x.next=_,c=c.next}while(c!==null);x===null?m=x=l:x=x.next=l}else m=x=l;c={baseState:f.baseState,firstBaseUpdate:m,lastBaseUpdate:x,shared:f.shared,callbacks:f.callbacks},n.updateQueue=c;return}n=c.lastBaseUpdate,n===null?c.firstBaseUpdate=l:n.next=l,c.lastBaseUpdate=l}var Bf=!1;function Xl(){if(Bf){var n=Ps;if(n!==null)throw n}}function Yl(n,l,c,f){Bf=!1;var m=n.updateQueue;Qa=!1;var x=m.firstBaseUpdate,_=m.lastBaseUpdate,O=m.shared.pending;if(O!==null){m.shared.pending=null;var G=O,J=G.next;G.next=null,_===null?x=J:_.next=J,_=G;var xe=n.alternate;xe!==null&&(xe=xe.updateQueue,O=xe.lastBaseUpdate,O!==_&&(O===null?xe.firstBaseUpdate=J:O.next=J,xe.lastBaseUpdate=G))}if(x!==null){var Re=m.baseState;_=0,xe=J=G=null,O=x;do{var ue=O.lane&-536870913,be=ue!==O.lane;if(be?(St&ue)===ue:(f&ue)===ue){ue!==0&&ue===Hs&&(Bf=!0),xe!==null&&(xe=xe.next={lane:0,tag:O.tag,payload:O.payload,callback:null,next:null});e:{var $e=n,lt=O;ue=l;var Jt=c;switch(lt.tag){case 1:if($e=lt.payload,typeof $e=="function"){Re=$e.call(Jt,Re,ue);break e}Re=$e;break e;case 3:$e.flags=$e.flags&-65537|128;case 0:if($e=lt.payload,ue=typeof $e=="function"?$e.call(Jt,Re,ue):$e,ue==null)break e;Re=j({},Re,ue);break e;case 2:Qa=!0}}ue=O.callback,ue!==null&&(n.flags|=64,be&&(n.flags|=8192),be=m.callbacks,be===null?m.callbacks=[ue]:be.push(ue))}else be={lane:ue,tag:O.tag,payload:O.payload,callback:O.callback,next:null},xe===null?(J=xe=be,G=Re):xe=xe.next=be,_|=ue;if(O=O.next,O===null){if(O=m.shared.pending,O===null)break;be=O,O=be.next,be.next=null,m.lastBaseUpdate=be,m.shared.pending=null}}while(!0);xe===null&&(G=Re),m.baseState=G,m.firstBaseUpdate=J,m.lastBaseUpdate=xe,x===null&&(m.shared.lanes=0),sn|=_,n.lanes=_,n.memoizedState=Re}}function zg(n,l){if(typeof n!="function")throw Error(r(191,n));n.call(l)}function Hg(n,l){var c=n.callbacks;if(c!==null)for(n.callbacks=null,n=0;n<c.length;n++)zg(c[n],l)}function ql(n,l){try{var c=l.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var m=f.next;c=m;do{if((c.tag&n)===n){f=void 0;var x=c.create,_=c.inst;f=x(),_.destroy=f}c=c.next}while(c!==m)}}catch(O){Gt(l,l.return,O)}}function tn(n,l,c){try{var f=l.updateQueue,m=f!==null?f.lastEffect:null;if(m!==null){var x=m.next;f=x;do{if((f.tag&n)===n){var _=f.inst,O=_.destroy;if(O!==void 0){_.destroy=void 0,m=l;var G=c;try{O()}catch(J){Gt(m,G,J)}}}f=f.next}while(f!==x)}}catch(J){Gt(l,l.return,J)}}function Pg(n){var l=n.updateQueue;if(l!==null){var c=n.stateNode;try{Hg(l,c)}catch(f){Gt(n,n.return,f)}}}function Ig(n,l,c){c.props=Xn(n.type,n.memoizedProps),c.state=n.memoizedState;try{c.componentWillUnmount()}catch(f){Gt(n,l,f)}}function Kn(n,l){try{var c=n.ref;if(c!==null){var f=n.stateNode;switch(n.tag){case 26:case 27:case 5:var m=f;break;default:m=f}typeof c=="function"?n.refCleanup=c(m):c.current=m}}catch(x){Gt(n,l,x)}}function ur(n,l){var c=n.ref,f=n.refCleanup;if(c!==null)if(typeof f=="function")try{f()}catch(m){Gt(n,l,m)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(m){Gt(n,l,m)}else c.current=null}function Ug(n){var l=n.type,c=n.memoizedProps,f=n.stateNode;try{e:switch(l){case"button":case"input":case"select":case"textarea":c.autoFocus&&f.focus();break e;case"img":c.src?f.src=c.src:c.srcSet&&(f.srcset=c.srcSet)}}catch(m){Gt(n,n.return,m)}}function Vg(n,l,c){try{var f=n.stateNode;TC(f,n.type,c,l),f[M]=l}catch(m){Gt(n,n.return,m)}}function Gg(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27||n.tag===4}function zf(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||Gg(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==27&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Hf(n,l,c){var f=n.tag;if(f===5||f===6)n=n.stateNode,l?c.nodeType===8?c.parentNode.insertBefore(n,l):c.insertBefore(n,l):(c.nodeType===8?(l=c.parentNode,l.insertBefore(n,c)):(l=c,l.appendChild(n)),c=c._reactRootContainer,c!=null||l.onclick!==null||(l.onclick=oc));else if(f!==4&&f!==27&&(n=n.child,n!==null))for(Hf(n,l,c),n=n.sibling;n!==null;)Hf(n,l,c),n=n.sibling}function Ku(n,l,c){var f=n.tag;if(f===5||f===6)n=n.stateNode,l?c.insertBefore(n,l):c.appendChild(n);else if(f!==4&&f!==27&&(n=n.child,n!==null))for(Ku(n,l,c),n=n.sibling;n!==null;)Ku(n,l,c),n=n.sibling}var Ca=!1,Zt=!1,Pf=!1,Wg=typeof WeakSet=="function"?WeakSet:Set,yi=null,jg=!1;function eC(n,l){if(n=n.containerInfo,dd=mc,n=om(n),Ih(n)){if("selectionStart"in n)var c={start:n.selectionStart,end:n.selectionEnd};else e:{c=(c=n.ownerDocument)&&c.defaultView||window;var f=c.getSelection&&c.getSelection();if(f&&f.rangeCount!==0){c=f.anchorNode;var m=f.anchorOffset,x=f.focusNode;f=f.focusOffset;try{c.nodeType,x.nodeType}catch{c=null;break e}var _=0,O=-1,G=-1,J=0,xe=0,Re=n,ue=null;t:for(;;){for(var be;Re!==c||m!==0&&Re.nodeType!==3||(O=_+m),Re!==x||f!==0&&Re.nodeType!==3||(G=_+f),Re.nodeType===3&&(_+=Re.nodeValue.length),(be=Re.firstChild)!==null;)ue=Re,Re=be;for(;;){if(Re===n)break t;if(ue===c&&++J===m&&(O=_),ue===x&&++xe===f&&(G=_),(be=Re.nextSibling)!==null)break;Re=ue,ue=Re.parentNode}Re=be}c=O===-1||G===-1?null:{start:O,end:G}}else c=null}c=c||{start:0,end:0}}else c=null;for(pd={focusedElem:n,selectionRange:c},mc=!1,yi=l;yi!==null;)if(l=yi,n=l.child,(l.subtreeFlags&1028)!==0&&n!==null)n.return=l,yi=n;else for(;yi!==null;){switch(l=yi,x=l.alternate,n=l.flags,l.tag){case 0:break;case 11:case 15:break;case 1:if((n&1024)!==0&&x!==null){n=void 0,c=l,m=x.memoizedProps,x=x.memoizedState,f=c.stateNode;try{var $e=Xn(c.type,m,c.elementType===c.type);n=f.getSnapshotBeforeUpdate($e,x),f.__reactInternalSnapshotBeforeUpdate=n}catch(lt){Gt(c,c.return,lt)}}break;case 3:if((n&1024)!==0){if(n=l.stateNode.containerInfo,c=n.nodeType,c===9)bd(n);else if(c===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":bd(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(r(163))}if(n=l.sibling,n!==null){n.return=l.return,yi=n;break}yi=l.return}return $e=jg,jg=!1,$e}function Xg(n,l,c){var f=c.flags;switch(c.tag){case 0:case 11:case 15:_a(n,c),f&4&&ql(5,c);break;case 1:if(_a(n,c),f&4)if(n=c.stateNode,l===null)try{n.componentDidMount()}catch(O){Gt(c,c.return,O)}else{var m=Xn(c.type,l.memoizedProps);l=l.memoizedState;try{n.componentDidUpdate(m,l,n.__reactInternalSnapshotBeforeUpdate)}catch(O){Gt(c,c.return,O)}}f&64&&Pg(c),f&512&&Kn(c,c.return);break;case 3:if(_a(n,c),f&64&&(f=c.updateQueue,f!==null)){if(n=null,c.child!==null)switch(c.child.tag){case 27:case 5:n=c.child.stateNode;break;case 1:n=c.child.stateNode}try{Hg(f,n)}catch(O){Gt(c,c.return,O)}}break;case 26:_a(n,c),f&512&&Kn(c,c.return);break;case 27:case 5:_a(n,c),l===null&&f&4&&Ug(c),f&512&&Kn(c,c.return);break;case 12:_a(n,c);break;case 13:_a(n,c),f&4&&Kg(n,c);break;case 22:if(m=c.memoizedState!==null||Ca,!m){l=l!==null&&l.memoizedState!==null||Zt;var x=Ca,_=Zt;Ca=m,(Zt=l)&&!_?rn(n,c,(c.subtreeFlags&8772)!==0):_a(n,c),Ca=x,Zt=_}f&512&&(c.memoizedProps.mode==="manual"?Kn(c,c.return):ur(c,c.return));break;default:_a(n,c)}}function Yg(n){var l=n.alternate;l!==null&&(n.alternate=null,Yg(l)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(l=n.stateNode,l!==null&&se(l)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var ci=null,cr=!1;function Ta(n,l,c){for(c=c.child;c!==null;)qg(n,l,c),c=c.sibling}function qg(n,l,c){if(xt&&typeof xt.onCommitFiberUnmount=="function")try{xt.onCommitFiberUnmount(zt,c)}catch{}switch(c.tag){case 26:Zt||ur(c,l),Ta(n,l,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:Zt||ur(c,l);var f=ci,m=cr;for(ci=c.stateNode,Ta(n,l,c),c=c.stateNode,l=c.attributes;l.length;)c.removeAttributeNode(l[0]);se(c),ci=f,cr=m;break;case 5:Zt||ur(c,l);case 6:m=ci;var x=cr;if(ci=null,Ta(n,l,c),ci=m,cr=x,ci!==null)if(cr)try{n=ci,f=c.stateNode,n.nodeType===8?n.parentNode.removeChild(f):n.removeChild(f)}catch(_){Gt(c,l,_)}else try{ci.removeChild(c.stateNode)}catch(_){Gt(c,l,_)}break;case 18:ci!==null&&(cr?(l=ci,c=c.stateNode,l.nodeType===8?vd(l.parentNode,c):l.nodeType===1&&vd(l,c),fo(l)):vd(ci,c.stateNode));break;case 4:f=ci,m=cr,ci=c.stateNode.containerInfo,cr=!0,Ta(n,l,c),ci=f,cr=m;break;case 0:case 11:case 14:case 15:Zt||tn(2,c,l),Zt||tn(4,c,l),Ta(n,l,c);break;case 1:Zt||(ur(c,l),f=c.stateNode,typeof f.componentWillUnmount=="function"&&Ig(c,l,f)),Ta(n,l,c);break;case 21:Ta(n,l,c);break;case 22:Zt||ur(c,l),Zt=(f=Zt)||c.memoizedState!==null,Ta(n,l,c),Zt=f;break;default:Ta(n,l,c)}}function Kg(n,l){if(l.memoizedState===null&&(n=l.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{fo(n)}catch(c){Gt(l,l.return,c)}}function tC(n){switch(n.tag){case 13:case 19:var l=n.stateNode;return l===null&&(l=n.stateNode=new Wg),l;case 22:return n=n.stateNode,l=n._retryCache,l===null&&(l=n._retryCache=new Wg),l;default:throw Error(r(435,n.tag))}}function If(n,l){var c=tC(n);l.forEach(function(f){var m=pC.bind(null,n,f);c.has(f)||(c.add(f),f.then(m,m))})}function Dr(n,l){var c=l.deletions;if(c!==null)for(var f=0;f<c.length;f++){var m=c[f],x=n,_=l,O=_;e:for(;O!==null;){switch(O.tag){case 27:case 5:ci=O.stateNode,cr=!1;break e;case 3:ci=O.stateNode.containerInfo,cr=!0;break e;case 4:ci=O.stateNode.containerInfo,cr=!0;break e}O=O.return}if(ci===null)throw Error(r(160));qg(x,_,m),ci=null,cr=!1,x=m.alternate,x!==null&&(x.return=null),m.return=null}if(l.subtreeFlags&13878)for(l=l.child;l!==null;)$g(l,n),l=l.sibling}var Yr=null;function $g(n,l){var c=n.alternate,f=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:Dr(l,n),Fr(n),f&4&&(tn(3,n,n.return),ql(3,n),tn(5,n,n.return));break;case 1:Dr(l,n),Fr(n),f&512&&(Zt||c===null||ur(c,c.return)),f&64&&Ca&&(n=n.updateQueue,n!==null&&(f=n.callbacks,f!==null&&(c=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=c===null?f:c.concat(f))));break;case 26:var m=Yr;if(Dr(l,n),Fr(n),f&512&&(Zt||c===null||ur(c,c.return)),f&4){var x=c!==null?c.memoizedState:null;if(f=n.memoizedState,c===null)if(f===null)if(n.stateNode===null){e:{f=n.type,c=n.memoizedProps,m=m.ownerDocument||m;t:switch(f){case"title":x=m.getElementsByTagName("title")[0],(!x||x[ae]||x[A]||x.namespaceURI==="http://www.w3.org/2000/svg"||x.hasAttribute("itemprop"))&&(x=m.createElement(f),m.head.insertBefore(x,m.querySelector("head > title"))),Fi(x,f,c),x[A]=n,Te(x),f=x;break e;case"link":var _=Uv("link","href",m).get(f+(c.href||""));if(_){for(var O=0;O<_.length;O++)if(x=_[O],x.getAttribute("href")===(c.href==null?null:c.href)&&x.getAttribute("rel")===(c.rel==null?null:c.rel)&&x.getAttribute("title")===(c.title==null?null:c.title)&&x.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){_.splice(O,1);break t}}x=m.createElement(f),Fi(x,f,c),m.head.appendChild(x);break;case"meta":if(_=Uv("meta","content",m).get(f+(c.content||""))){for(O=0;O<_.length;O++)if(x=_[O],x.getAttribute("content")===(c.content==null?null:""+c.content)&&x.getAttribute("name")===(c.name==null?null:c.name)&&x.getAttribute("property")===(c.property==null?null:c.property)&&x.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&x.getAttribute("charset")===(c.charSet==null?null:c.charSet)){_.splice(O,1);break t}}x=m.createElement(f),Fi(x,f,c),m.head.appendChild(x);break;default:throw Error(r(468,f))}x[A]=n,Te(x),f=x}n.stateNode=f}else Vv(m,n.type,n.stateNode);else n.stateNode=Iv(m,f,n.memoizedProps);else x!==f?(x===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):x.count--,f===null?Vv(m,n.type,n.stateNode):Iv(m,f,n.memoizedProps)):f===null&&n.stateNode!==null&&Vg(n,n.memoizedProps,c.memoizedProps)}break;case 27:if(f&4&&n.alternate===null){m=n.stateNode,x=n.memoizedProps;try{for(var G=m.firstChild;G;){var J=G.nextSibling,xe=G.nodeName;G[ae]||xe==="HEAD"||xe==="BODY"||xe==="SCRIPT"||xe==="STYLE"||xe==="LINK"&&G.rel.toLowerCase()==="stylesheet"||m.removeChild(G),G=J}for(var Re=n.type,ue=m.attributes;ue.length;)m.removeAttributeNode(ue[0]);Fi(m,Re,x),m[A]=n,m[M]=x}catch($e){Gt(n,n.return,$e)}}case 5:if(Dr(l,n),Fr(n),f&512&&(Zt||c===null||ur(c,c.return)),n.flags&32){m=n.stateNode;try{Ss(m,"")}catch($e){Gt(n,n.return,$e)}}f&4&&n.stateNode!=null&&(m=n.memoizedProps,Vg(n,m,c!==null?c.memoizedProps:m)),f&1024&&(Pf=!0);break;case 6:if(Dr(l,n),Fr(n),f&4){if(n.stateNode===null)throw Error(r(162));f=n.memoizedProps,c=n.stateNode;try{c.nodeValue=f}catch($e){Gt(n,n.return,$e)}}break;case 3:if(fc=null,m=Yr,Yr=cc(l.containerInfo),Dr(l,n),Yr=m,Fr(n),f&4&&c!==null&&c.memoizedState.isDehydrated)try{fo(l.containerInfo)}catch($e){Gt(n,n.return,$e)}Pf&&(Pf=!1,Zg(n));break;case 4:f=Yr,Yr=cc(n.stateNode.containerInfo),Dr(l,n),Fr(n),Yr=f;break;case 12:Dr(l,n),Fr(n);break;case 13:Dr(l,n),Fr(n),n.child.flags&8192&&n.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(Kf=rt()),f&4&&(f=n.updateQueue,f!==null&&(n.updateQueue=null,If(n,f)));break;case 22:if(f&512&&(Zt||c===null||ur(c,c.return)),G=n.memoizedState!==null,J=c!==null&&c.memoizedState!==null,xe=Ca,Re=Zt,Ca=xe||G,Zt=Re||J,Dr(l,n),Zt=Re,Ca=xe,Fr(n),l=n.stateNode,l._current=n,l._visibility&=-3,l._visibility|=l._pendingVisibility&2,f&8192&&(l._visibility=G?l._visibility&-2:l._visibility|1,G&&(l=Ca||Zt,c===null||J||l||Gs(n)),n.memoizedProps===null||n.memoizedProps.mode!=="manual"))e:for(c=null,l=n;;){if(l.tag===5||l.tag===26||l.tag===27){if(c===null){J=c=l;try{if(m=J.stateNode,G)x=m.style,typeof x.setProperty=="function"?x.setProperty("display","none","important"):x.display="none";else{_=J.stateNode,O=J.memoizedProps.style;var be=O!=null&&O.hasOwnProperty("display")?O.display:null;_.style.display=be==null||typeof be=="boolean"?"":(""+be).trim()}}catch($e){Gt(J,J.return,$e)}}}else if(l.tag===6){if(c===null){J=l;try{J.stateNode.nodeValue=G?"":J.memoizedProps}catch($e){Gt(J,J.return,$e)}}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===n)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===n)break e;for(;l.sibling===null;){if(l.return===null||l.return===n)break e;c===l&&(c=null),l=l.return}c===l&&(c=null),l.sibling.return=l.return,l=l.sibling}f&4&&(f=n.updateQueue,f!==null&&(c=f.retryQueue,c!==null&&(f.retryQueue=null,If(n,c))));break;case 19:Dr(l,n),Fr(n),f&4&&(f=n.updateQueue,f!==null&&(n.updateQueue=null,If(n,f)));break;case 21:break;default:Dr(l,n),Fr(n)}}function Fr(n){var l=n.flags;if(l&2){try{if(n.tag!==27){e:{for(var c=n.return;c!==null;){if(Gg(c)){var f=c;break e}c=c.return}throw Error(r(160))}switch(f.tag){case 27:var m=f.stateNode,x=zf(n);Ku(n,x,m);break;case 5:var _=f.stateNode;f.flags&32&&(Ss(_,""),f.flags&=-33);var O=zf(n);Ku(n,O,_);break;case 3:case 4:var G=f.stateNode.containerInfo,J=zf(n);Hf(n,J,G);break;default:throw Error(r(161))}}}catch(xe){Gt(n,n.return,xe)}n.flags&=-3}l&4096&&(n.flags&=-4097)}function Zg(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var l=n;Zg(l),l.tag===5&&l.flags&1024&&l.stateNode.reset(),n=n.sibling}}function _a(n,l){if(l.subtreeFlags&8772)for(l=l.child;l!==null;)Xg(n,l.alternate,l),l=l.sibling}function Gs(n){for(n=n.child;n!==null;){var l=n;switch(l.tag){case 0:case 11:case 14:case 15:tn(4,l,l.return),Gs(l);break;case 1:ur(l,l.return);var c=l.stateNode;typeof c.componentWillUnmount=="function"&&Ig(l,l.return,c),Gs(l);break;case 26:case 27:case 5:ur(l,l.return),Gs(l);break;case 22:ur(l,l.return),l.memoizedState===null&&Gs(l);break;default:Gs(l)}n=n.sibling}}function rn(n,l,c){for(c=c&&(l.subtreeFlags&8772)!==0,l=l.child;l!==null;){var f=l.alternate,m=n,x=l,_=x.flags;switch(x.tag){case 0:case 11:case 15:rn(m,x,c),ql(4,x);break;case 1:if(rn(m,x,c),f=x,m=f.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(J){Gt(f,f.return,J)}if(f=x,m=f.updateQueue,m!==null){var O=f.stateNode;try{var G=m.shared.hiddenCallbacks;if(G!==null)for(m.shared.hiddenCallbacks=null,m=0;m<G.length;m++)zg(G[m],O)}catch(J){Gt(f,f.return,J)}}c&&_&64&&Pg(x),Kn(x,x.return);break;case 26:case 27:case 5:rn(m,x,c),c&&f===null&&_&4&&Ug(x),Kn(x,x.return);break;case 12:rn(m,x,c);break;case 13:rn(m,x,c),c&&_&4&&Kg(m,x);break;case 22:x.memoizedState===null&&rn(m,x,c),Kn(x,x.return);break;default:rn(m,x,c)}l=l.sibling}}function Uf(n,l){var c=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(c=n.memoizedState.cachePool.pool),n=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(n=l.memoizedState.cachePool.pool),n!==c&&(n!=null&&n.refCount++,c!=null&&Hl(c))}function Vf(n,l){n=null,l.alternate!==null&&(n=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==n&&(l.refCount++,n!=null&&Hl(n))}function an(n,l,c,f){if(l.subtreeFlags&10256)for(l=l.child;l!==null;)Qg(n,l,c,f),l=l.sibling}function Qg(n,l,c,f){var m=l.flags;switch(l.tag){case 0:case 11:case 15:an(n,l,c,f),m&2048&&ql(9,l);break;case 3:an(n,l,c,f),m&2048&&(n=null,l.alternate!==null&&(n=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==n&&(l.refCount++,n!=null&&Hl(n)));break;case 12:if(m&2048){an(n,l,c,f),n=l.stateNode;try{var x=l.memoizedProps,_=x.id,O=x.onPostCommit;typeof O=="function"&&O(_,l.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(G){Gt(l,l.return,G)}}else an(n,l,c,f);break;case 23:break;case 22:x=l.stateNode,l.memoizedState!==null?x._visibility&4?an(n,l,c,f):Kl(n,l):x._visibility&4?an(n,l,c,f):(x._visibility|=4,Ws(n,l,c,f,(l.subtreeFlags&10256)!==0)),m&2048&&Uf(l.alternate,l);break;case 24:an(n,l,c,f),m&2048&&Vf(l.alternate,l);break;default:an(n,l,c,f)}}function Ws(n,l,c,f,m){for(m=m&&(l.subtreeFlags&10256)!==0,l=l.child;l!==null;){var x=n,_=l,O=c,G=f,J=_.flags;switch(_.tag){case 0:case 11:case 15:Ws(x,_,O,G,m),ql(8,_);break;case 23:break;case 22:var xe=_.stateNode;_.memoizedState!==null?xe._visibility&4?Ws(x,_,O,G,m):Kl(x,_):(xe._visibility|=4,Ws(x,_,O,G,m)),m&&J&2048&&Uf(_.alternate,_);break;case 24:Ws(x,_,O,G,m),m&&J&2048&&Vf(_.alternate,_);break;default:Ws(x,_,O,G,m)}l=l.sibling}}function Kl(n,l){if(l.subtreeFlags&10256)for(l=l.child;l!==null;){var c=n,f=l,m=f.flags;switch(f.tag){case 22:Kl(c,f),m&2048&&Uf(f.alternate,f);break;case 24:Kl(c,f),m&2048&&Vf(f.alternate,f);break;default:Kl(c,f)}l=l.sibling}}var $l=8192;function js(n){if(n.subtreeFlags&$l)for(n=n.child;n!==null;)Jg(n),n=n.sibling}function Jg(n){switch(n.tag){case 26:js(n),n.flags&$l&&n.memoizedState!==null&&GC(Yr,n.memoizedState,n.memoizedProps);break;case 5:js(n);break;case 3:case 4:var l=Yr;Yr=cc(n.stateNode.containerInfo),js(n),Yr=l;break;case 22:n.memoizedState===null&&(l=n.alternate,l!==null&&l.memoizedState!==null?(l=$l,$l=16777216,js(n),$l=l):js(n));break;default:js(n)}}function ev(n){var l=n.alternate;if(l!==null&&(n=l.child,n!==null)){l.child=null;do l=n.sibling,n.sibling=null,n=l;while(n!==null)}}function Zl(n){var l=n.deletions;if((n.flags&16)!==0){if(l!==null)for(var c=0;c<l.length;c++){var f=l[c];yi=f,iv(f,n)}ev(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)tv(n),n=n.sibling}function tv(n){switch(n.tag){case 0:case 11:case 15:Zl(n),n.flags&2048&&tn(9,n,n.return);break;case 3:Zl(n);break;case 12:Zl(n);break;case 22:var l=n.stateNode;n.memoizedState!==null&&l._visibility&4&&(n.return===null||n.return.tag!==13)?(l._visibility&=-5,$u(n)):Zl(n);break;default:Zl(n)}}function $u(n){var l=n.deletions;if((n.flags&16)!==0){if(l!==null)for(var c=0;c<l.length;c++){var f=l[c];yi=f,iv(f,n)}ev(n)}for(n=n.child;n!==null;){switch(l=n,l.tag){case 0:case 11:case 15:tn(8,l,l.return),$u(l);break;case 22:c=l.stateNode,c._visibility&4&&(c._visibility&=-5,$u(l));break;default:$u(l)}n=n.sibling}}function iv(n,l){for(;yi!==null;){var c=yi;switch(c.tag){case 0:case 11:case 15:tn(8,c,l);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var f=c.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:Hl(c.memoizedState.cache)}if(f=c.child,f!==null)f.return=c,yi=f;else e:for(c=n;yi!==null;){f=yi;var m=f.sibling,x=f.return;if(Yg(f),f===c){yi=null;break e}if(m!==null){m.return=x,yi=m;break e}yi=x}}}function iC(n,l,c,f){this.tag=n,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Mr(n,l,c,f){return new iC(n,l,c,f)}function Gf(n){return n=n.prototype,!(!n||!n.isReactComponent)}function nn(n,l){var c=n.alternate;return c===null?(c=Mr(n.tag,l,n.key,n.mode),c.elementType=n.elementType,c.type=n.type,c.stateNode=n.stateNode,c.alternate=n,n.alternate=c):(c.pendingProps=l,c.type=n.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=n.flags&31457280,c.childLanes=n.childLanes,c.lanes=n.lanes,c.child=n.child,c.memoizedProps=n.memoizedProps,c.memoizedState=n.memoizedState,c.updateQueue=n.updateQueue,l=n.dependencies,c.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},c.sibling=n.sibling,c.index=n.index,c.ref=n.ref,c.refCleanup=n.refCleanup,c}function rv(n,l){n.flags&=31457282;var c=n.alternate;return c===null?(n.childLanes=0,n.lanes=l,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=c.childLanes,n.lanes=c.lanes,n.child=c.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=c.memoizedProps,n.memoizedState=c.memoizedState,n.updateQueue=c.updateQueue,n.type=c.type,l=c.dependencies,n.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),n}function Zu(n,l,c,f,m,x){var _=0;if(f=n,typeof n=="function")Gf(n)&&(_=1);else if(typeof n=="string")_=UC(n,c,W.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case h:return $n(c.children,m,x,l);case d:_=8,m|=24;break;case p:return n=Mr(12,c,l,m|2),n.elementType=p,n.lanes=x,n;case C:return n=Mr(13,c,l,m),n.elementType=C,n.lanes=x,n;case E:return n=Mr(19,c,l,m),n.elementType=E,n.lanes=x,n;case T:return av(c,m,x,l);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case b:case v:_=10;break e;case g:_=9;break e;case y:_=11;break e;case w:_=14;break e;case R:_=16,f=null;break e}_=29,c=Error(r(130,n===null?"null":typeof n,"")),f=null}return l=Mr(_,c,l,m),l.elementType=n,l.type=f,l.lanes=x,l}function $n(n,l,c,f){return n=Mr(7,n,f,l),n.lanes=c,n}function av(n,l,c,f){n=Mr(22,n,f,l),n.elementType=T,n.lanes=c;var m={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var x=m._current;if(x===null)throw Error(r(456));if((m._pendingVisibility&2)===0){var _=Xa(x,2);_!==null&&(m._pendingVisibility|=2,$i(_,x,2))}},attach:function(){var x=m._current;if(x===null)throw Error(r(456));if((m._pendingVisibility&2)!==0){var _=Xa(x,2);_!==null&&(m._pendingVisibility&=-3,$i(_,x,2))}}};return n.stateNode=m,n}function Wf(n,l,c){return n=Mr(6,n,null,l),n.lanes=c,n}function jf(n,l,c){return l=Mr(4,n.children!==null?n.children:[],n.key,l),l.lanes=c,l.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},l}function Sa(n){n.flags|=4}function nv(n,l){if(l.type!=="stylesheet"||(l.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!Gv(l)){if(l=Ar.current,l!==null&&((St&4194176)===St?aa!==null:(St&62914560)!==St&&(St&536870912)===0||l!==aa))throw Nl=Kh,Em;n.flags|=8192}}function Qu(n,l){l!==null&&(n.flags|=4),n.flags&16384&&(l=n.tag!==22?re():536870912,n.lanes|=l,Ys|=l)}function Ql(n,l){if(!Mt)switch(n.tailMode){case"hidden":l=n.tail;for(var c=null;l!==null;)l.alternate!==null&&(c=l),l=l.sibling;c===null?n.tail=null:c.sibling=null;break;case"collapsed":c=n.tail;for(var f=null;c!==null;)c.alternate!==null&&(f=c),c=c.sibling;f===null?l||n.tail===null?n.tail=null:n.tail.sibling=null:f.sibling=null}}function Kt(n){var l=n.alternate!==null&&n.alternate.child===n.child,c=0,f=0;if(l)for(var m=n.child;m!==null;)c|=m.lanes|m.childLanes,f|=m.subtreeFlags&31457280,f|=m.flags&31457280,m.return=n,m=m.sibling;else for(m=n.child;m!==null;)c|=m.lanes|m.childLanes,f|=m.subtreeFlags,f|=m.flags,m.return=n,m=m.sibling;return n.subtreeFlags|=f,n.childLanes=c,l}function rC(n,l,c){var f=l.pendingProps;switch(Yh(l),l.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Kt(l),null;case 1:return Kt(l),null;case 3:return c=l.stateNode,f=null,n!==null&&(f=n.memoizedState.cache),l.memoizedState.cache!==f&&(l.flags|=2048),Ea(vi),De(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(n===null||n.child===null)&&(Fl(l)?Sa(l):n===null||n.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,Xr!==null&&(Jf(Xr),Xr=null))),Kt(l),null;case 26:return c=l.memoizedState,n===null?(Sa(l),c!==null?(Kt(l),nv(l,c)):(Kt(l),l.flags&=-16777217)):c?c!==n.memoizedState?(Sa(l),Kt(l),nv(l,c)):(Kt(l),l.flags&=-16777217):(n.memoizedProps!==f&&Sa(l),Kt(l),l.flags&=-16777217),null;case 27:We(l),c=H.current;var m=l.type;if(n!==null&&l.stateNode!=null)n.memoizedProps!==f&&Sa(l);else{if(!f){if(l.stateNode===null)throw Error(r(166));return Kt(l),null}n=W.current,Fl(l)?wm(l):(n=Nv(m,f,c),l.stateNode=n,Sa(l))}return Kt(l),null;case 5:if(We(l),c=l.type,n!==null&&l.stateNode!=null)n.memoizedProps!==f&&Sa(l);else{if(!f){if(l.stateNode===null)throw Error(r(166));return Kt(l),null}if(n=W.current,Fl(l))wm(l);else{switch(m=uc(H.current),n){case 1:n=m.createElementNS("http://www.w3.org/2000/svg",c);break;case 2:n=m.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;default:switch(c){case"svg":n=m.createElementNS("http://www.w3.org/2000/svg",c);break;case"math":n=m.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;case"script":n=m.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild);break;case"select":n=typeof f.is=="string"?m.createElement("select",{is:f.is}):m.createElement("select"),f.multiple?n.multiple=!0:f.size&&(n.size=f.size);break;default:n=typeof f.is=="string"?m.createElement(c,{is:f.is}):m.createElement(c)}}n[A]=l,n[M]=f;e:for(m=l.child;m!==null;){if(m.tag===5||m.tag===6)n.appendChild(m.stateNode);else if(m.tag!==4&&m.tag!==27&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===l)break e;for(;m.sibling===null;){if(m.return===null||m.return===l)break e;m=m.return}m.sibling.return=m.return,m=m.sibling}l.stateNode=n;e:switch(Fi(n,c,f),c){case"button":case"input":case"select":case"textarea":n=!!f.autoFocus;break e;case"img":n=!0;break e;default:n=!1}n&&Sa(l)}}return Kt(l),l.flags&=-16777217,null;case 6:if(n&&l.stateNode!=null)n.memoizedProps!==f&&Sa(l);else{if(typeof f!="string"&&l.stateNode===null)throw Error(r(166));if(n=H.current,Fl(l)){if(n=l.stateNode,c=l.memoizedProps,f=null,m=Ki,m!==null)switch(m.tag){case 27:case 5:f=m.memoizedProps}n[A]=l,n=!!(n.nodeValue===c||f!==null&&f.suppressHydrationWarning===!0||Av(n.nodeValue,c)),n||In(l)}else n=uc(n).createTextNode(f),n[A]=l,l.stateNode=n}return Kt(l),null;case 13:if(f=l.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(m=Fl(l),f!==null&&f.dehydrated!==null){if(n===null){if(!m)throw Error(r(318));if(m=l.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(r(317));m[A]=l}else Ml(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;Kt(l),m=!1}else Xr!==null&&(Jf(Xr),Xr=null),m=!0;if(!m)return l.flags&256?(ba(l),l):(ba(l),null)}if(ba(l),(l.flags&128)!==0)return l.lanes=c,l;if(c=f!==null,n=n!==null&&n.memoizedState!==null,c){f=l.child,m=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(m=f.alternate.memoizedState.cachePool.pool);var x=null;f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(x=f.memoizedState.cachePool.pool),x!==m&&(f.flags|=2048)}return c!==n&&c&&(l.child.flags|=8192),Qu(l,l.updateQueue),Kt(l),null;case 4:return De(),n===null&&cd(l.stateNode.containerInfo),Kt(l),null;case 10:return Ea(l.type),Kt(l),null;case 19:if(q(gi),m=l.memoizedState,m===null)return Kt(l),null;if(f=(l.flags&128)!==0,x=m.rendering,x===null)if(f)Ql(m,!1);else{if(Qt!==0||n!==null&&(n.flags&128)!==0)for(n=l.child;n!==null;){if(x=Nu(n),x!==null){for(l.flags|=128,Ql(m,!1),n=x.updateQueue,l.updateQueue=n,Qu(l,n),l.subtreeFlags=0,n=c,c=l.child;c!==null;)rv(c,n),c=c.sibling;return X(gi,gi.current&1|2),l.child}n=n.sibling}m.tail!==null&&rt()>Ju&&(l.flags|=128,f=!0,Ql(m,!1),l.lanes=4194304)}else{if(!f)if(n=Nu(x),n!==null){if(l.flags|=128,f=!0,n=n.updateQueue,l.updateQueue=n,Qu(l,n),Ql(m,!0),m.tail===null&&m.tailMode==="hidden"&&!x.alternate&&!Mt)return Kt(l),null}else 2*rt()-m.renderingStartTime>Ju&&c!==536870912&&(l.flags|=128,f=!0,Ql(m,!1),l.lanes=4194304);m.isBackwards?(x.sibling=l.child,l.child=x):(n=m.last,n!==null?n.sibling=x:l.child=x,m.last=x)}return m.tail!==null?(l=m.tail,m.rendering=l,m.tail=l.sibling,m.renderingStartTime=rt(),l.sibling=null,n=gi.current,X(gi,f?n&1|2:n&1),l):(Kt(l),null);case 22:case 23:return ba(l),Zh(),f=l.memoizedState!==null,n!==null?n.memoizedState!==null!==f&&(l.flags|=8192):f&&(l.flags|=8192),f?(c&536870912)!==0&&(l.flags&128)===0&&(Kt(l),l.subtreeFlags&6&&(l.flags|=8192)):Kt(l),c=l.updateQueue,c!==null&&Qu(l,c.retryQueue),c=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(c=n.memoizedState.cachePool.pool),f=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(f=l.memoizedState.cachePool.pool),f!==c&&(l.flags|=2048),n!==null&&q(Vn),null;case 24:return c=null,n!==null&&(c=n.memoizedState.cache),l.memoizedState.cache!==c&&(l.flags|=2048),Ea(vi),Kt(l),null;case 25:return null}throw Error(r(156,l.tag))}function aC(n,l){switch(Yh(l),l.tag){case 1:return n=l.flags,n&65536?(l.flags=n&-65537|128,l):null;case 3:return Ea(vi),De(),n=l.flags,(n&65536)!==0&&(n&128)===0?(l.flags=n&-65537|128,l):null;case 26:case 27:case 5:return We(l),null;case 13:if(ba(l),n=l.memoizedState,n!==null&&n.dehydrated!==null){if(l.alternate===null)throw Error(r(340));Ml()}return n=l.flags,n&65536?(l.flags=n&-65537|128,l):null;case 19:return q(gi),null;case 4:return De(),null;case 10:return Ea(l.type),null;case 22:case 23:return ba(l),Zh(),n!==null&&q(Vn),n=l.flags,n&65536?(l.flags=n&-65537|128,l):null;case 24:return Ea(vi),null;case 25:return null;default:return null}}function sv(n,l){switch(Yh(l),l.tag){case 3:Ea(vi),De();break;case 26:case 27:case 5:We(l);break;case 4:De();break;case 13:ba(l);break;case 19:q(gi);break;case 10:Ea(l.type);break;case 22:case 23:ba(l),Zh(),n!==null&&q(Vn);break;case 24:Ea(vi)}}var nC={getCacheForType:function(n){var l=Pi(vi),c=l.data.get(n);return c===void 0&&(c=n(),l.data.set(n,c)),c}},sC=typeof WeakMap=="function"?WeakMap:Map,$t=0,Yt=null,mt=null,St=0,qt=0,hr=null,Ra=!1,Xs=!1,Xf=!1,ka=0,Qt=0,sn=0,Zn=0,Yf=0,Or=0,Ys=0,Jl=null,sa=null,qf=!1,Kf=0,Ju=1/0,ec=null,ln=null,tc=!1,Qn=null,eo=0,$f=0,Zf=null,to=0,Qf=null;function fr(){if(($t&2)!==0&&St!==0)return St&-St;if(N.T!==null){var n=Hs;return n!==0?n:sd()}return Ke()}function lv(){Or===0&&(Or=(St&536870912)===0||Mt?K():536870912);var n=Ar.current;return n!==null&&(n.flags|=32),Or}function $i(n,l,c){(n===Yt&&qt===2||n.cancelPendingCommit!==null)&&(qs(n,0),Aa(n,St,Or,!1)),Ae(n,c),(($t&2)===0||n!==Yt)&&(n===Yt&&(($t&2)===0&&(Zn|=c),Qt===4&&Aa(n,St,Or,!1)),la(n))}function ov(n,l,c){if(($t&6)!==0)throw Error(r(327));var f=!c&&(l&60)===0&&(l&n.expiredLanes)===0||pa(n,l),m=f?uC(n,l):id(n,l,!0),x=f;do{if(m===0){Xs&&!f&&Aa(n,l,0,!1);break}else if(m===6)Aa(n,l,0,!Ra);else{if(c=n.current.alternate,x&&!lC(c)){m=id(n,l,!1),x=!1;continue}if(m===2){if(x=l,n.errorRecoveryDisabledLanes&x)var _=0;else _=n.pendingLanes&-536870913,_=_!==0?_:_&536870912?536870912:0;if(_!==0){l=_;e:{var O=n;m=Jl;var G=O.current.memoizedState.isDehydrated;if(G&&(qs(O,_).flags|=256),_=id(O,_,!1),_!==2){if(Xf&&!G){O.errorRecoveryDisabledLanes|=x,Zn|=x,m=4;break e}x=sa,sa=m,x!==null&&Jf(x)}m=_}if(x=!1,m!==2)continue}}if(m===1){qs(n,0),Aa(n,l,0,!0);break}e:{switch(f=n,m){case 0:case 1:throw Error(r(345));case 4:if((l&4194176)===l){Aa(f,l,Or,!Ra);break e}break;case 2:sa=null;break;case 3:case 5:break;default:throw Error(r(329))}if(f.finishedWork=c,f.finishedLanes=l,(l&62914560)===l&&(x=Kf+300-rt(),10<x)){if(Aa(f,l,Or,!Ra),Wr(f,0)!==0)break e;f.timeoutHandle=Mv(uv.bind(null,f,c,sa,ec,qf,l,Or,Zn,Ys,Ra,2,-0,0),x);break e}uv(f,c,sa,ec,qf,l,Or,Zn,Ys,Ra,0,-0,0)}}break}while(!0);la(n)}function Jf(n){sa===null?sa=n:sa.push.apply(sa,n)}function uv(n,l,c,f,m,x,_,O,G,J,xe,Re,ue){var be=l.subtreeFlags;if((be&8192||(be&16785408)===16785408)&&(lo={stylesheets:null,count:0,unsuspend:VC},Jg(l),l=WC(),l!==null)){n.cancelPendingCommit=l(gv.bind(null,n,c,f,m,_,O,G,1,Re,ue)),Aa(n,x,_,!J);return}gv(n,c,f,m,_,O,G,xe,Re,ue)}function lC(n){for(var l=n;;){var c=l.tag;if((c===0||c===11||c===15)&&l.flags&16384&&(c=l.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var f=0;f<c.length;f++){var m=c[f],x=m.getSnapshot;m=m.value;try{if(!or(x(),m))return!1}catch{return!1}}if(c=l.child,l.subtreeFlags&16384&&c!==null)c.return=l,l=c;else{if(l===n)break;for(;l.sibling===null;){if(l.return===null||l.return===n)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function Aa(n,l,c,f){l&=~Yf,l&=~Zn,n.suspendedLanes|=l,n.pingedLanes&=~l,f&&(n.warmLanes|=l),f=n.expirationTimes;for(var m=l;0<m;){var x=31-ri(m),_=1<<x;f[x]=-1,m&=~_}c!==0&&Je(n,c,l)}function ic(){return($t&6)===0?(io(0),!1):!0}function ed(){if(mt!==null){if(qt===0)var n=mt.return;else n=mt,ya=Yn=null,sf(n),Bs=null,Bl=0,n=mt;for(;n!==null;)sv(n.alternate,n),n=n.return;mt=null}}function qs(n,l){n.finishedWork=null,n.finishedLanes=0;var c=n.timeoutHandle;c!==-1&&(n.timeoutHandle=-1,SC(c)),c=n.cancelPendingCommit,c!==null&&(n.cancelPendingCommit=null,c()),ed(),Yt=n,mt=c=nn(n.current,null),St=l,qt=0,hr=null,Ra=!1,Xs=pa(n,l),Xf=!1,Ys=Or=Yf=Zn=sn=Qt=0,sa=Jl=null,qf=!1,(l&8)!==0&&(l|=l&32);var f=n.entangledLanes;if(f!==0)for(n=n.entanglements,f&=l;0<f;){var m=31-ri(f),x=1<<m;l|=n[m],f&=~x}return ka=l,Su(),c}function cv(n,l){ft=null,N.H=na,l===Ll?(l=_m(),qt=3):l===Em?(l=_m(),qt=4):qt=l===Cg?8:l!==null&&typeof l=="object"&&typeof l.then=="function"?6:1,hr=l,mt===null&&(Qt=1,Xu(n,Sr(l,n.current)))}function hv(){var n=N.H;return N.H=na,n===null?na:n}function fv(){var n=N.A;return N.A=nC,n}function td(){Qt=4,Ra||(St&4194176)!==St&&Ar.current!==null||(Xs=!0),(sn&134217727)===0&&(Zn&134217727)===0||Yt===null||Aa(Yt,St,Or,!1)}function id(n,l,c){var f=$t;$t|=2;var m=hv(),x=fv();(Yt!==n||St!==l)&&(ec=null,qs(n,l)),l=!1;var _=Qt;e:do try{if(qt!==0&&mt!==null){var O=mt,G=hr;switch(qt){case 8:ed(),_=6;break e;case 3:case 2:case 6:Ar.current===null&&(l=!0);var J=qt;if(qt=0,hr=null,Ks(n,O,G,J),c&&Xs){_=0;break e}break;default:J=qt,qt=0,hr=null,Ks(n,O,G,J)}}oC(),_=Qt;break}catch(xe){cv(n,xe)}while(!0);return l&&n.shellSuspendCounter++,ya=Yn=null,$t=f,N.H=m,N.A=x,mt===null&&(Yt=null,St=0,Su()),_}function oC(){for(;mt!==null;)dv(mt)}function uC(n,l){var c=$t;$t|=2;var f=hv(),m=fv();Yt!==n||St!==l?(ec=null,Ju=rt()+500,qs(n,l)):Xs=pa(n,l);e:do try{if(qt!==0&&mt!==null){l=mt;var x=hr;t:switch(qt){case 1:qt=0,hr=null,Ks(n,l,x,1);break;case 2:if(Cm(x)){qt=0,hr=null,pv(l);break}l=function(){qt===2&&Yt===n&&(qt=7),la(n)},x.then(l,l);break e;case 3:qt=7;break e;case 4:qt=5;break e;case 7:Cm(x)?(qt=0,hr=null,pv(l)):(qt=0,hr=null,Ks(n,l,x,7));break;case 5:var _=null;switch(mt.tag){case 26:_=mt.memoizedState;case 5:case 27:var O=mt;if(!_||Gv(_)){qt=0,hr=null;var G=O.sibling;if(G!==null)mt=G;else{var J=O.return;J!==null?(mt=J,rc(J)):mt=null}break t}}qt=0,hr=null,Ks(n,l,x,5);break;case 6:qt=0,hr=null,Ks(n,l,x,6);break;case 8:ed(),Qt=6;break e;default:throw Error(r(462))}}cC();break}catch(xe){cv(n,xe)}while(!0);return ya=Yn=null,N.H=f,N.A=m,$t=c,mt!==null?0:(Yt=null,St=0,Su(),Qt)}function cC(){for(;mt!==null&&!Lt();)dv(mt)}function dv(n){var l=Ng(n.alternate,n,ka);n.memoizedProps=n.pendingProps,l===null?rc(n):mt=l}function pv(n){var l=n,c=l.alternate;switch(l.tag){case 15:case 0:l=Ag(c,l,l.pendingProps,l.type,void 0,St);break;case 11:l=Ag(c,l,l.pendingProps,l.type.render,l.ref,St);break;case 5:sf(l);default:sv(c,l),l=mt=rv(l,ka),l=Ng(c,l,ka)}n.memoizedProps=n.pendingProps,l===null?rc(n):mt=l}function Ks(n,l,c,f){ya=Yn=null,sf(l),Bs=null,Bl=0;var m=l.return;try{if(QE(n,m,l,c,St)){Qt=1,Xu(n,Sr(c,n.current)),mt=null;return}}catch(x){if(m!==null)throw mt=m,x;Qt=1,Xu(n,Sr(c,n.current)),mt=null;return}l.flags&32768?(Mt||f===1?n=!0:Xs||(St&536870912)!==0?n=!1:(Ra=n=!0,(f===2||f===3||f===6)&&(f=Ar.current,f!==null&&f.tag===13&&(f.flags|=16384))),mv(l,n)):rc(l)}function rc(n){var l=n;do{if((l.flags&32768)!==0){mv(l,Ra);return}n=l.return;var c=rC(l.alternate,l,ka);if(c!==null){mt=c;return}if(l=l.sibling,l!==null){mt=l;return}mt=l=n}while(l!==null);Qt===0&&(Qt=5)}function mv(n,l){do{var c=aC(n.alternate,n);if(c!==null){c.flags&=32767,mt=c;return}if(c=n.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!l&&(n=n.sibling,n!==null)){mt=n;return}mt=n=c}while(n!==null);Qt=6,mt=null}function gv(n,l,c,f,m,x,_,O,G,J){var xe=N.T,Re=pe.p;try{pe.p=2,N.T=null,hC(n,l,c,f,Re,m,x,_,O,G,J)}finally{N.T=xe,pe.p=Re}}function hC(n,l,c,f,m,x,_,O){do $s();while(Qn!==null);if(($t&6)!==0)throw Error(r(327));var G=n.finishedWork;if(f=n.finishedLanes,G===null)return null;if(n.finishedWork=null,n.finishedLanes=0,G===n.current)throw Error(r(177));n.callbackNode=null,n.callbackPriority=0,n.cancelPendingCommit=null;var J=G.lanes|G.childLanes;if(J|=Wh,Ue(n,f,J,x,_,O),n===Yt&&(mt=Yt=null,St=0),(G.subtreeFlags&10256)===0&&(G.flags&10256)===0||tc||(tc=!0,$f=J,Zf=c,mC(At,function(){return $s(),null})),c=(G.flags&15990)!==0,(G.subtreeFlags&15990)!==0||c?(c=N.T,N.T=null,x=pe.p,pe.p=2,_=$t,$t|=4,eC(n,G),$g(G,n),NE(pd,n.containerInfo),mc=!!dd,pd=dd=null,n.current=G,Xg(n,G.alternate,G),Ve(),$t=_,pe.p=x,N.T=c):n.current=G,tc?(tc=!1,Qn=n,eo=f):vv(n,J),J=n.pendingLanes,J===0&&(ln=null),er(G.stateNode),la(n),l!==null)for(m=n.onRecoverableError,G=0;G<l.length;G++)J=l[G],m(J.value,{componentStack:J.stack});return(eo&3)!==0&&$s(),J=n.pendingLanes,(f&4194218)!==0&&(J&42)!==0?n===Qf?to++:(to=0,Qf=n):to=0,io(0),null}function vv(n,l){(n.pooledCacheLanes&=l)===0&&(l=n.pooledCache,l!=null&&(n.pooledCache=null,Hl(l)))}function $s(){if(Qn!==null){var n=Qn,l=$f;$f=0;var c=Ye(eo),f=N.T,m=pe.p;try{if(pe.p=32>c?32:c,N.T=null,Qn===null)var x=!1;else{c=Zf,Zf=null;var _=Qn,O=eo;if(Qn=null,eo=0,($t&6)!==0)throw Error(r(331));var G=$t;if($t|=4,tv(_.current),Qg(_,_.current,O,c),$t=G,io(0,!1),xt&&typeof xt.onPostCommitFiberRoot=="function")try{xt.onPostCommitFiberRoot(zt,_)}catch{}x=!0}return x}finally{pe.p=m,N.T=f,vv(n,l)}}return!1}function bv(n,l,c){l=Sr(c,l),l=wf(n.stateNode,l,2),n=en(n,l,2),n!==null&&(Ae(n,2),la(n))}function Gt(n,l,c){if(n.tag===3)bv(n,n,c);else for(;l!==null;){if(l.tag===3){bv(l,n,c);break}else if(l.tag===1){var f=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(ln===null||!ln.has(f))){n=Sr(c,n),c=yg(2),f=en(l,c,2),f!==null&&(Eg(c,f,l,n),Ae(f,2),la(f));break}}l=l.return}}function rd(n,l,c){var f=n.pingCache;if(f===null){f=n.pingCache=new sC;var m=new Set;f.set(l,m)}else m=f.get(l),m===void 0&&(m=new Set,f.set(l,m));m.has(c)||(Xf=!0,m.add(c),n=fC.bind(null,n,l,c),l.then(n,n))}function fC(n,l,c){var f=n.pingCache;f!==null&&f.delete(l),n.pingedLanes|=n.suspendedLanes&c,n.warmLanes&=~c,Yt===n&&(St&c)===c&&(Qt===4||Qt===3&&(St&62914560)===St&&300>rt()-Kf?($t&2)===0&&qs(n,0):Yf|=c,Ys===St&&(Ys=0)),la(n)}function xv(n,l){l===0&&(l=re()),n=Xa(n,l),n!==null&&(Ae(n,l),la(n))}function dC(n){var l=n.memoizedState,c=0;l!==null&&(c=l.retryLane),xv(n,c)}function pC(n,l){var c=0;switch(n.tag){case 13:var f=n.stateNode,m=n.memoizedState;m!==null&&(c=m.retryLane);break;case 19:f=n.stateNode;break;case 22:f=n.stateNode._retryCache;break;default:throw Error(r(314))}f!==null&&f.delete(l),xv(n,c)}function mC(n,l){return vt(n,l)}var ac=null,Zs=null,ad=!1,nc=!1,nd=!1,Jn=0;function la(n){n!==Zs&&n.next===null&&(Zs===null?ac=Zs=n:Zs=Zs.next=n),nc=!0,ad||(ad=!0,vC(gC))}function io(n,l){if(!nd&&nc){nd=!0;do for(var c=!1,f=ac;f!==null;){if(n!==0){var m=f.pendingLanes;if(m===0)var x=0;else{var _=f.suspendedLanes,O=f.pingedLanes;x=(1<<31-ri(42|n)+1)-1,x&=m&~(_&~O),x=x&201326677?x&201326677|1:x?x|2:0}x!==0&&(c=!0,Ev(f,x))}else x=St,x=Wr(f,f===Yt?x:0),(x&3)===0||pa(f,x)||(c=!0,Ev(f,x));f=f.next}while(c);nd=!1}}function gC(){nc=ad=!1;var n=0;Jn!==0&&(_C()&&(n=Jn),Jn=0);for(var l=rt(),c=null,f=ac;f!==null;){var m=f.next,x=wv(f,l);x===0?(f.next=null,c===null?ac=m:c.next=m,m===null&&(Zs=c)):(c=f,(n!==0||(x&3)!==0)&&(nc=!0)),f=m}io(n)}function wv(n,l){for(var c=n.suspendedLanes,f=n.pingedLanes,m=n.expirationTimes,x=n.pendingLanes&-62914561;0<x;){var _=31-ri(x),O=1<<_,G=m[_];G===-1?((O&c)===0||(O&f)!==0)&&(m[_]=yl(O,l)):G<=l&&(n.expiredLanes|=O),x&=~O}if(l=Yt,c=St,c=Wr(n,n===l?c:0),f=n.callbackNode,c===0||n===l&&qt===2||n.cancelPendingCommit!==null)return f!==null&&f!==null&&ht(f),n.callbackNode=null,n.callbackPriority=0;if((c&3)===0||pa(n,c)){if(l=c&-c,l===n.callbackPriority)return l;switch(f!==null&&ht(f),Ye(c)){case 2:case 8:c=ti;break;case 32:c=At;break;case 268435456:c=Xt;break;default:c=At}return f=yv.bind(null,n),c=vt(c,f),n.callbackPriority=l,n.callbackNode=c,l}return f!==null&&f!==null&&ht(f),n.callbackPriority=2,n.callbackNode=null,2}function yv(n,l){var c=n.callbackNode;if($s()&&n.callbackNode!==c)return null;var f=St;return f=Wr(n,n===Yt?f:0),f===0?null:(ov(n,f,l),wv(n,rt()),n.callbackNode!=null&&n.callbackNode===c?yv.bind(null,n):null)}function Ev(n,l){if($s())return null;ov(n,l,!0)}function vC(n){RC(function(){($t&6)!==0?vt(jt,n):n()})}function sd(){return Jn===0&&(Jn=K()),Jn}function Cv(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:xu(""+n)}function Tv(n,l){var c=l.ownerDocument.createElement("input");return c.name=l.name,c.value=l.value,n.id&&c.setAttribute("form",n.id),l.parentNode.insertBefore(c,l),n=new FormData(n),c.parentNode.removeChild(c),n}function bC(n,l,c,f,m){if(l==="submit"&&c&&c.stateNode===m){var x=Cv((m[M]||null).action),_=f.submitter;_&&(l=(l=_[M]||null)?Cv(l.formAction):_.getAttribute("formAction"),l!==null&&(x=l,_=null));var O=new Cu("action","action",null,f,m);n.push({event:O,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(Jn!==0){var G=_?Tv(m,_):new FormData(m);mf(c,{pending:!0,data:G,method:m.method,action:x},null,G)}}else typeof x=="function"&&(O.preventDefault(),G=_?Tv(m,_):new FormData(m),mf(c,{pending:!0,data:G,method:m.method,action:x},x,G))},currentTarget:m}]})}}for(var ld=0;ld<gm.length;ld++){var od=gm[ld],xC=od.toLowerCase(),wC=od[0].toUpperCase()+od.slice(1);jr(xC,"on"+wC)}jr(hm,"onAnimationEnd"),jr(fm,"onAnimationIteration"),jr(dm,"onAnimationStart"),jr("dblclick","onDoubleClick"),jr("focusin","onFocus"),jr("focusout","onBlur"),jr(zE,"onTransitionRun"),jr(HE,"onTransitionStart"),jr(PE,"onTransitionCancel"),jr(pm,"onTransitionEnd"),ut("onMouseEnter",["mouseout","mouseover"]),ut("onMouseLeave",["mouseout","mouseover"]),ut("onPointerEnter",["pointerout","pointerover"]),ut("onPointerLeave",["pointerout","pointerover"]),Ze("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ze("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ze("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ze("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ze("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ze("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ro="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),yC=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ro));function _v(n,l){l=(l&4)!==0;for(var c=0;c<n.length;c++){var f=n[c],m=f.event;f=f.listeners;e:{var x=void 0;if(l)for(var _=f.length-1;0<=_;_--){var O=f[_],G=O.instance,J=O.currentTarget;if(O=O.listener,G!==x&&m.isPropagationStopped())break e;x=O,m.currentTarget=J;try{x(m)}catch(xe){ju(xe)}m.currentTarget=null,x=G}else for(_=0;_<f.length;_++){if(O=f[_],G=O.instance,J=O.currentTarget,O=O.listener,G!==x&&m.isPropagationStopped())break e;x=O,m.currentTarget=J;try{x(m)}catch(xe){ju(xe)}m.currentTarget=null,x=G}}}}function Et(n,l){var c=l[I];c===void 0&&(c=l[I]=new Set);var f=n+"__bubble";c.has(f)||(Sv(l,n,2,!1),c.add(f))}function ud(n,l,c){var f=0;l&&(f|=4),Sv(c,n,f,l)}var sc="_reactListening"+Math.random().toString(36).slice(2);function cd(n){if(!n[sc]){n[sc]=!0,it.forEach(function(c){c!=="selectionchange"&&(yC.has(c)||ud(c,!1,n),ud(c,!0,n))});var l=n.nodeType===9?n:n.ownerDocument;l===null||l[sc]||(l[sc]=!0,ud("selectionchange",!1,l))}}function Sv(n,l,c,f){switch(Kv(l)){case 2:var m=YC;break;case 8:m=qC;break;default:m=Cd}c=m.bind(null,l,c,n),m=void 0,!Fh||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(m=!0),f?m!==void 0?n.addEventListener(l,c,{capture:!0,passive:m}):n.addEventListener(l,c,!0):m!==void 0?n.addEventListener(l,c,{passive:m}):n.addEventListener(l,c,!1)}function hd(n,l,c,f,m){var x=f;if((l&1)===0&&(l&2)===0&&f!==null)e:for(;;){if(f===null)return;var _=f.tag;if(_===3||_===4){var O=f.stateNode.containerInfo;if(O===m||O.nodeType===8&&O.parentNode===m)break;if(_===4)for(_=f.return;_!==null;){var G=_.tag;if((G===3||G===4)&&(G=_.stateNode.containerInfo,G===m||G.nodeType===8&&G.parentNode===m))return;_=_.return}for(;O!==null;){if(_=Ce(O),_===null)return;if(G=_.tag,G===5||G===6||G===26||G===27){f=x=_;continue e}O=O.parentNode}}f=f.return}Up(function(){var J=x,xe=Ah(c),Re=[];e:{var ue=mm.get(n);if(ue!==void 0){var be=Cu,$e=n;switch(n){case"keypress":if(yu(c)===0)break e;case"keydown":case"keyup":be=pE;break;case"focusin":$e="focus",be=Nh;break;case"focusout":$e="blur",be=Nh;break;case"beforeblur":case"afterblur":be=Nh;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":be=Wp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":be=iE;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":be=vE;break;case hm:case fm:case dm:be=nE;break;case pm:be=xE;break;case"scroll":case"scrollend":be=eE;break;case"wheel":be=yE;break;case"copy":case"cut":case"paste":be=lE;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":be=Xp;break;case"toggle":case"beforetoggle":be=CE}var lt=(l&4)!==0,Jt=!lt&&(n==="scroll"||n==="scrollend"),ie=lt?ue!==null?ue+"Capture":null:ue;lt=[];for(var Q=J,le;Q!==null;){var Ee=Q;if(le=Ee.stateNode,Ee=Ee.tag,Ee!==5&&Ee!==26&&Ee!==27||le===null||ie===null||(Ee=El(Q,ie),Ee!=null&&lt.push(ao(Q,Ee,le))),Jt)break;Q=Q.return}0<lt.length&&(ue=new be(ue,$e,null,c,xe),Re.push({event:ue,listeners:lt}))}}if((l&7)===0){e:{if(ue=n==="mouseover"||n==="pointerover",be=n==="mouseout"||n==="pointerout",ue&&c!==kh&&($e=c.relatedTarget||c.fromElement)&&(Ce($e)||$e[B]))break e;if((be||ue)&&(ue=xe.window===xe?xe:(ue=xe.ownerDocument)?ue.defaultView||ue.parentWindow:window,be?($e=c.relatedTarget||c.toElement,be=J,$e=$e?Ce($e):null,$e!==null&&(Jt=ve($e),lt=$e.tag,$e!==Jt||lt!==5&&lt!==27&&lt!==6)&&($e=null)):(be=null,$e=J),be!==$e)){if(lt=Wp,Ee="onMouseLeave",ie="onMouseEnter",Q="mouse",(n==="pointerout"||n==="pointerover")&&(lt=Xp,Ee="onPointerLeave",ie="onPointerEnter",Q="pointer"),Jt=be==null?ue:Pe(be),le=$e==null?ue:Pe($e),ue=new lt(Ee,Q+"leave",be,c,xe),ue.target=Jt,ue.relatedTarget=le,Ee=null,Ce(xe)===J&&(lt=new lt(ie,Q+"enter",$e,c,xe),lt.target=le,lt.relatedTarget=Jt,Ee=lt),Jt=Ee,be&&$e)t:{for(lt=be,ie=$e,Q=0,le=lt;le;le=Qs(le))Q++;for(le=0,Ee=ie;Ee;Ee=Qs(Ee))le++;for(;0<Q-le;)lt=Qs(lt),Q--;for(;0<le-Q;)ie=Qs(ie),le--;for(;Q--;){if(lt===ie||ie!==null&&lt===ie.alternate)break t;lt=Qs(lt),ie=Qs(ie)}lt=null}else lt=null;be!==null&&Rv(Re,ue,be,lt,!1),$e!==null&&Jt!==null&&Rv(Re,Jt,$e,lt,!0)}}e:{if(ue=J?Pe(J):window,be=ue.nodeName&&ue.nodeName.toLowerCase(),be==="select"||be==="input"&&ue.type==="file")var je=em;else if(Qp(ue))if(tm)je=OE;else{je=FE;var dt=DE}else be=ue.nodeName,!be||be.toLowerCase()!=="input"||ue.type!=="checkbox"&&ue.type!=="radio"?J&&Rh(J.elementType)&&(je=em):je=ME;if(je&&(je=je(n,J))){Jp(Re,je,c,xe);break e}dt&&dt(n,ue,J),n==="focusout"&&J&&ue.type==="number"&&J.memoizedProps.value!=null&&Sh(ue,"number",ue.value)}switch(dt=J?Pe(J):window,n){case"focusin":(Qp(dt)||dt.contentEditable==="true")&&(Ds=dt,Uh=J,Dl=null);break;case"focusout":Dl=Uh=Ds=null;break;case"mousedown":Vh=!0;break;case"contextmenu":case"mouseup":case"dragend":Vh=!1,um(Re,c,xe);break;case"selectionchange":if(BE)break;case"keydown":case"keyup":um(Re,c,xe)}var Qe;if(zh)e:{switch(n){case"compositionstart":var at="onCompositionStart";break e;case"compositionend":at="onCompositionEnd";break e;case"compositionupdate":at="onCompositionUpdate";break e}at=void 0}else As?$p(n,c)&&(at="onCompositionEnd"):n==="keydown"&&c.keyCode===229&&(at="onCompositionStart");at&&(Yp&&c.locale!=="ko"&&(As||at!=="onCompositionStart"?at==="onCompositionEnd"&&As&&(Qe=Vp()):(ja=xe,Mh="value"in ja?ja.value:ja.textContent,As=!0)),dt=lc(J,at),0<dt.length&&(at=new jp(at,n,null,c,xe),Re.push({event:at,listeners:dt}),Qe?at.data=Qe:(Qe=Zp(c),Qe!==null&&(at.data=Qe)))),(Qe=_E?SE(n,c):RE(n,c))&&(at=lc(J,"onBeforeInput"),0<at.length&&(dt=new jp("onBeforeInput","beforeinput",null,c,xe),Re.push({event:dt,listeners:at}),dt.data=Qe)),bC(Re,n,J,c,xe)}_v(Re,l)})}function ao(n,l,c){return{instance:n,listener:l,currentTarget:c}}function lc(n,l){for(var c=l+"Capture",f=[];n!==null;){var m=n,x=m.stateNode;m=m.tag,m!==5&&m!==26&&m!==27||x===null||(m=El(n,c),m!=null&&f.unshift(ao(n,m,x)),m=El(n,l),m!=null&&f.push(ao(n,m,x))),n=n.return}return f}function Qs(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function Rv(n,l,c,f,m){for(var x=l._reactName,_=[];c!==null&&c!==f;){var O=c,G=O.alternate,J=O.stateNode;if(O=O.tag,G!==null&&G===f)break;O!==5&&O!==26&&O!==27||J===null||(G=J,m?(J=El(c,x),J!=null&&_.unshift(ao(c,J,G))):m||(J=El(c,x),J!=null&&_.push(ao(c,J,G)))),c=c.return}_.length!==0&&n.push({event:l,listeners:_})}var EC=/\r\n?/g,CC=/\u0000|\uFFFD/g;function kv(n){return(typeof n=="string"?n:""+n).replace(EC,`
`).replace(CC,"")}function Av(n,l){return l=kv(l),kv(n)===l}function oc(){}function It(n,l,c,f,m,x){switch(c){case"children":typeof f=="string"?l==="body"||l==="textarea"&&f===""||Ss(n,f):(typeof f=="number"||typeof f=="bigint")&&l!=="body"&&Ss(n,""+f);break;case"className":gu(n,"class",f);break;case"tabIndex":gu(n,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":gu(n,c,f);break;case"style":Pp(n,f,x);break;case"data":if(l!=="object"){gu(n,"data",f);break}case"src":case"href":if(f===""&&(l!=="a"||c!=="href")){n.removeAttribute(c);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){n.removeAttribute(c);break}f=xu(""+f),n.setAttribute(c,f);break;case"action":case"formAction":if(typeof f=="function"){n.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof x=="function"&&(c==="formAction"?(l!=="input"&&It(n,l,"name",m.name,m,null),It(n,l,"formEncType",m.formEncType,m,null),It(n,l,"formMethod",m.formMethod,m,null),It(n,l,"formTarget",m.formTarget,m,null)):(It(n,l,"encType",m.encType,m,null),It(n,l,"method",m.method,m,null),It(n,l,"target",m.target,m,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){n.removeAttribute(c);break}f=xu(""+f),n.setAttribute(c,f);break;case"onClick":f!=null&&(n.onclick=oc);break;case"onScroll":f!=null&&Et("scroll",n);break;case"onScrollEnd":f!=null&&Et("scrollend",n);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(r(61));if(c=f.__html,c!=null){if(m.children!=null)throw Error(r(60));n.innerHTML=c}}break;case"multiple":n.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":n.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){n.removeAttribute("xlink:href");break}c=xu(""+f),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?n.setAttribute(c,""+f):n.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?n.setAttribute(c,""):n.removeAttribute(c);break;case"capture":case"download":f===!0?n.setAttribute(c,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?n.setAttribute(c,f):n.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?n.setAttribute(c,f):n.removeAttribute(c);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?n.removeAttribute(c):n.setAttribute(c,f);break;case"popover":Et("beforetoggle",n),Et("toggle",n),Hi(n,"popover",f);break;case"xlinkActuate":ma(n,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":ma(n,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":ma(n,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":ma(n,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":ma(n,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":ma(n,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":ma(n,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":ma(n,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":ma(n,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":Hi(n,"is",f);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=Qy.get(c)||c,Hi(n,c,f))}}function fd(n,l,c,f,m,x){switch(c){case"style":Pp(n,f,x);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(r(61));if(c=f.__html,c!=null){if(m.children!=null)throw Error(r(60));n.innerHTML=c}}break;case"children":typeof f=="string"?Ss(n,f):(typeof f=="number"||typeof f=="bigint")&&Ss(n,""+f);break;case"onScroll":f!=null&&Et("scroll",n);break;case"onScrollEnd":f!=null&&Et("scrollend",n);break;case"onClick":f!=null&&(n.onclick=oc);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ft.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(m=c.endsWith("Capture"),l=c.slice(2,m?c.length-7:void 0),x=n[M]||null,x=x!=null?x[c]:null,typeof x=="function"&&n.removeEventListener(l,x,m),typeof f=="function")){typeof x!="function"&&x!==null&&(c in n?n[c]=null:n.hasAttribute(c)&&n.removeAttribute(c)),n.addEventListener(l,f,m);break e}c in n?n[c]=f:f===!0?n.setAttribute(c,""):Hi(n,c,f)}}}function Fi(n,l,c){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Et("error",n),Et("load",n);var f=!1,m=!1,x;for(x in c)if(c.hasOwnProperty(x)){var _=c[x];if(_!=null)switch(x){case"src":f=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,l));default:It(n,l,x,_,c,null)}}m&&It(n,l,"srcSet",c.srcSet,c,null),f&&It(n,l,"src",c.src,c,null);return;case"input":Et("invalid",n);var O=x=_=m=null,G=null,J=null;for(f in c)if(c.hasOwnProperty(f)){var xe=c[f];if(xe!=null)switch(f){case"name":m=xe;break;case"type":_=xe;break;case"checked":G=xe;break;case"defaultChecked":J=xe;break;case"value":x=xe;break;case"defaultValue":O=xe;break;case"children":case"dangerouslySetInnerHTML":if(xe!=null)throw Error(r(137,l));break;default:It(n,l,f,xe,c,null)}}Np(n,x,O,G,J,_,m,!1),vu(n);return;case"select":Et("invalid",n),f=_=x=null;for(m in c)if(c.hasOwnProperty(m)&&(O=c[m],O!=null))switch(m){case"value":x=O;break;case"defaultValue":_=O;break;case"multiple":f=O;default:It(n,l,m,O,c,null)}l=x,c=_,n.multiple=!!f,l!=null?_s(n,!!f,l,!1):c!=null&&_s(n,!!f,c,!0);return;case"textarea":Et("invalid",n),x=m=f=null;for(_ in c)if(c.hasOwnProperty(_)&&(O=c[_],O!=null))switch(_){case"value":f=O;break;case"defaultValue":m=O;break;case"children":x=O;break;case"dangerouslySetInnerHTML":if(O!=null)throw Error(r(91));break;default:It(n,l,_,O,c,null)}zp(n,f,m,x),vu(n);return;case"option":for(G in c)if(c.hasOwnProperty(G)&&(f=c[G],f!=null))switch(G){case"selected":n.selected=f&&typeof f!="function"&&typeof f!="symbol";break;default:It(n,l,G,f,c,null)}return;case"dialog":Et("cancel",n),Et("close",n);break;case"iframe":case"object":Et("load",n);break;case"video":case"audio":for(f=0;f<ro.length;f++)Et(ro[f],n);break;case"image":Et("error",n),Et("load",n);break;case"details":Et("toggle",n);break;case"embed":case"source":case"link":Et("error",n),Et("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(J in c)if(c.hasOwnProperty(J)&&(f=c[J],f!=null))switch(J){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,l));default:It(n,l,J,f,c,null)}return;default:if(Rh(l)){for(xe in c)c.hasOwnProperty(xe)&&(f=c[xe],f!==void 0&&fd(n,l,xe,f,c,void 0));return}}for(O in c)c.hasOwnProperty(O)&&(f=c[O],f!=null&&It(n,l,O,f,c,null))}function TC(n,l,c,f){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,x=null,_=null,O=null,G=null,J=null,xe=null;for(be in c){var Re=c[be];if(c.hasOwnProperty(be)&&Re!=null)switch(be){case"checked":break;case"value":break;case"defaultValue":G=Re;default:f.hasOwnProperty(be)||It(n,l,be,null,f,Re)}}for(var ue in f){var be=f[ue];if(Re=c[ue],f.hasOwnProperty(ue)&&(be!=null||Re!=null))switch(ue){case"type":x=be;break;case"name":m=be;break;case"checked":J=be;break;case"defaultChecked":xe=be;break;case"value":_=be;break;case"defaultValue":O=be;break;case"children":case"dangerouslySetInnerHTML":if(be!=null)throw Error(r(137,l));break;default:be!==Re&&It(n,l,ue,be,f,Re)}}_h(n,_,O,G,J,xe,x,m);return;case"select":be=_=O=ue=null;for(x in c)if(G=c[x],c.hasOwnProperty(x)&&G!=null)switch(x){case"value":break;case"multiple":be=G;default:f.hasOwnProperty(x)||It(n,l,x,null,f,G)}for(m in f)if(x=f[m],G=c[m],f.hasOwnProperty(m)&&(x!=null||G!=null))switch(m){case"value":ue=x;break;case"defaultValue":O=x;break;case"multiple":_=x;default:x!==G&&It(n,l,m,x,f,G)}l=O,c=_,f=be,ue!=null?_s(n,!!c,ue,!1):!!f!=!!c&&(l!=null?_s(n,!!c,l,!0):_s(n,!!c,c?[]:"",!1));return;case"textarea":be=ue=null;for(O in c)if(m=c[O],c.hasOwnProperty(O)&&m!=null&&!f.hasOwnProperty(O))switch(O){case"value":break;case"children":break;default:It(n,l,O,null,f,m)}for(_ in f)if(m=f[_],x=c[_],f.hasOwnProperty(_)&&(m!=null||x!=null))switch(_){case"value":ue=m;break;case"defaultValue":be=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(r(91));break;default:m!==x&&It(n,l,_,m,f,x)}Bp(n,ue,be);return;case"option":for(var $e in c)if(ue=c[$e],c.hasOwnProperty($e)&&ue!=null&&!f.hasOwnProperty($e))switch($e){case"selected":n.selected=!1;break;default:It(n,l,$e,null,f,ue)}for(G in f)if(ue=f[G],be=c[G],f.hasOwnProperty(G)&&ue!==be&&(ue!=null||be!=null))switch(G){case"selected":n.selected=ue&&typeof ue!="function"&&typeof ue!="symbol";break;default:It(n,l,G,ue,f,be)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var lt in c)ue=c[lt],c.hasOwnProperty(lt)&&ue!=null&&!f.hasOwnProperty(lt)&&It(n,l,lt,null,f,ue);for(J in f)if(ue=f[J],be=c[J],f.hasOwnProperty(J)&&ue!==be&&(ue!=null||be!=null))switch(J){case"children":case"dangerouslySetInnerHTML":if(ue!=null)throw Error(r(137,l));break;default:It(n,l,J,ue,f,be)}return;default:if(Rh(l)){for(var Jt in c)ue=c[Jt],c.hasOwnProperty(Jt)&&ue!==void 0&&!f.hasOwnProperty(Jt)&&fd(n,l,Jt,void 0,f,ue);for(xe in f)ue=f[xe],be=c[xe],!f.hasOwnProperty(xe)||ue===be||ue===void 0&&be===void 0||fd(n,l,xe,ue,f,be);return}}for(var ie in c)ue=c[ie],c.hasOwnProperty(ie)&&ue!=null&&!f.hasOwnProperty(ie)&&It(n,l,ie,null,f,ue);for(Re in f)ue=f[Re],be=c[Re],!f.hasOwnProperty(Re)||ue===be||ue==null&&be==null||It(n,l,Re,ue,f,be)}var dd=null,pd=null;function uc(n){return n.nodeType===9?n:n.ownerDocument}function Dv(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Fv(n,l){if(n===0)switch(l){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&l==="foreignObject"?0:n}function md(n,l){return n==="textarea"||n==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.children=="bigint"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var gd=null;function _C(){var n=window.event;return n&&n.type==="popstate"?n===gd?!1:(gd=n,!0):(gd=null,!1)}var Mv=typeof setTimeout=="function"?setTimeout:void 0,SC=typeof clearTimeout=="function"?clearTimeout:void 0,Ov=typeof Promise=="function"?Promise:void 0,RC=typeof queueMicrotask=="function"?queueMicrotask:typeof Ov<"u"?function(n){return Ov.resolve(null).then(n).catch(kC)}:Mv;function kC(n){setTimeout(function(){throw n})}function vd(n,l){var c=l,f=0;do{var m=c.nextSibling;if(n.removeChild(c),m&&m.nodeType===8)if(c=m.data,c==="/$"){if(f===0){n.removeChild(m),fo(l);return}f--}else c!=="$"&&c!=="$?"&&c!=="$!"||f++;c=m}while(c);fo(l)}function bd(n){var l=n.firstChild;for(l&&l.nodeType===10&&(l=l.nextSibling);l;){var c=l;switch(l=l.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":bd(c),se(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}n.removeChild(c)}}function AC(n,l,c,f){for(;n.nodeType===1;){var m=c;if(n.nodeName.toLowerCase()!==l.toLowerCase()){if(!f&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(f){if(!n[ae])switch(l){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(x=n.getAttribute("rel"),x==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(x!==m.rel||n.getAttribute("href")!==(m.href==null?null:m.href)||n.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||n.getAttribute("title")!==(m.title==null?null:m.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(x=n.getAttribute("src"),(x!==(m.src==null?null:m.src)||n.getAttribute("type")!==(m.type==null?null:m.type)||n.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&x&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(l==="input"&&n.type==="hidden"){var x=m.name==null?null:""+m.name;if(m.type==="hidden"&&n.getAttribute("name")===x)return n}else return n;if(n=qr(n.nextSibling),n===null)break}return null}function DC(n,l,c){if(l==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!c||(n=qr(n.nextSibling),n===null))return null;return n}function qr(n){for(;n!=null;n=n.nextSibling){var l=n.nodeType;if(l===1||l===3)break;if(l===8){if(l=n.data,l==="$"||l==="$!"||l==="$?"||l==="F!"||l==="F")break;if(l==="/$")return null}}return n}function Lv(n){n=n.previousSibling;for(var l=0;n;){if(n.nodeType===8){var c=n.data;if(c==="$"||c==="$!"||c==="$?"){if(l===0)return n;l--}else c==="/$"&&l++}n=n.previousSibling}return null}function Nv(n,l,c){switch(l=uc(c),n){case"html":if(n=l.documentElement,!n)throw Error(r(452));return n;case"head":if(n=l.head,!n)throw Error(r(453));return n;case"body":if(n=l.body,!n)throw Error(r(454));return n;default:throw Error(r(451))}}var Lr=new Map,Bv=new Set;function cc(n){return typeof n.getRootNode=="function"?n.getRootNode():n.ownerDocument}var Da=pe.d;pe.d={f:FC,r:MC,D:OC,C:LC,L:NC,m:BC,X:HC,S:zC,M:PC};function FC(){var n=Da.f(),l=ic();return n||l}function MC(n){var l=ke(n);l!==null&&l.tag===5&&l.type==="form"?ug(l):Da.r(n)}var Js=typeof document>"u"?null:document;function zv(n,l,c){var f=Js;if(f&&typeof l=="string"&&l){var m=Tr(l);m='link[rel="'+n+'"][href="'+m+'"]',typeof c=="string"&&(m+='[crossorigin="'+c+'"]'),Bv.has(m)||(Bv.add(m),n={rel:n,crossOrigin:c,href:l},f.querySelector(m)===null&&(l=f.createElement("link"),Fi(l,"link",n),Te(l),f.head.appendChild(l)))}}function OC(n){Da.D(n),zv("dns-prefetch",n,null)}function LC(n,l){Da.C(n,l),zv("preconnect",n,l)}function NC(n,l,c){Da.L(n,l,c);var f=Js;if(f&&n&&l){var m='link[rel="preload"][as="'+Tr(l)+'"]';l==="image"&&c&&c.imageSrcSet?(m+='[imagesrcset="'+Tr(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(m+='[imagesizes="'+Tr(c.imageSizes)+'"]')):m+='[href="'+Tr(n)+'"]';var x=m;switch(l){case"style":x=el(n);break;case"script":x=tl(n)}Lr.has(x)||(n=j({rel:"preload",href:l==="image"&&c&&c.imageSrcSet?void 0:n,as:l},c),Lr.set(x,n),f.querySelector(m)!==null||l==="style"&&f.querySelector(no(x))||l==="script"&&f.querySelector(so(x))||(l=f.createElement("link"),Fi(l,"link",n),Te(l),f.head.appendChild(l)))}}function BC(n,l){Da.m(n,l);var c=Js;if(c&&n){var f=l&&typeof l.as=="string"?l.as:"script",m='link[rel="modulepreload"][as="'+Tr(f)+'"][href="'+Tr(n)+'"]',x=m;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":x=tl(n)}if(!Lr.has(x)&&(n=j({rel:"modulepreload",href:n},l),Lr.set(x,n),c.querySelector(m)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(so(x)))return}f=c.createElement("link"),Fi(f,"link",n),Te(f),c.head.appendChild(f)}}}function zC(n,l,c){Da.S(n,l,c);var f=Js;if(f&&n){var m=Se(f).hoistableStyles,x=el(n);l=l||"default";var _=m.get(x);if(!_){var O={loading:0,preload:null};if(_=f.querySelector(no(x)))O.loading=5;else{n=j({rel:"stylesheet",href:n,"data-precedence":l},c),(c=Lr.get(x))&&xd(n,c);var G=_=f.createElement("link");Te(G),Fi(G,"link",n),G._p=new Promise(function(J,xe){G.onload=J,G.onerror=xe}),G.addEventListener("load",function(){O.loading|=1}),G.addEventListener("error",function(){O.loading|=2}),O.loading|=4,hc(_,l,f)}_={type:"stylesheet",instance:_,count:1,state:O},m.set(x,_)}}}function HC(n,l){Da.X(n,l);var c=Js;if(c&&n){var f=Se(c).hoistableScripts,m=tl(n),x=f.get(m);x||(x=c.querySelector(so(m)),x||(n=j({src:n,async:!0},l),(l=Lr.get(m))&&wd(n,l),x=c.createElement("script"),Te(x),Fi(x,"link",n),c.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},f.set(m,x))}}function PC(n,l){Da.M(n,l);var c=Js;if(c&&n){var f=Se(c).hoistableScripts,m=tl(n),x=f.get(m);x||(x=c.querySelector(so(m)),x||(n=j({src:n,async:!0,type:"module"},l),(l=Lr.get(m))&&wd(n,l),x=c.createElement("script"),Te(x),Fi(x,"link",n),c.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},f.set(m,x))}}function Hv(n,l,c,f){var m=(m=H.current)?cc(m):null;if(!m)throw Error(r(446));switch(n){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(l=el(c.href),c=Se(m).hoistableStyles,f=c.get(l),f||(f={type:"style",instance:null,count:0,state:null},c.set(l,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){n=el(c.href);var x=Se(m).hoistableStyles,_=x.get(n);if(_||(m=m.ownerDocument||m,_={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},x.set(n,_),(x=m.querySelector(no(n)))&&!x._p&&(_.instance=x,_.state.loading=5),Lr.has(n)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},Lr.set(n,c),x||IC(m,n,c,_.state))),l&&f===null)throw Error(r(528,""));return _}if(l&&f!==null)throw Error(r(529,""));return null;case"script":return l=c.async,c=c.src,typeof c=="string"&&l&&typeof l!="function"&&typeof l!="symbol"?(l=tl(c),c=Se(m).hoistableScripts,f=c.get(l),f||(f={type:"script",instance:null,count:0,state:null},c.set(l,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,n))}}function el(n){return'href="'+Tr(n)+'"'}function no(n){return'link[rel="stylesheet"]['+n+"]"}function Pv(n){return j({},n,{"data-precedence":n.precedence,precedence:null})}function IC(n,l,c,f){n.querySelector('link[rel="preload"][as="style"]['+l+"]")?f.loading=1:(l=n.createElement("link"),f.preload=l,l.addEventListener("load",function(){return f.loading|=1}),l.addEventListener("error",function(){return f.loading|=2}),Fi(l,"link",c),Te(l),n.head.appendChild(l))}function tl(n){return'[src="'+Tr(n)+'"]'}function so(n){return"script[async]"+n}function Iv(n,l,c){if(l.count++,l.instance===null)switch(l.type){case"style":var f=n.querySelector('style[data-href~="'+Tr(c.href)+'"]');if(f)return l.instance=f,Te(f),f;var m=j({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return f=(n.ownerDocument||n).createElement("style"),Te(f),Fi(f,"style",m),hc(f,c.precedence,n),l.instance=f;case"stylesheet":m=el(c.href);var x=n.querySelector(no(m));if(x)return l.state.loading|=4,l.instance=x,Te(x),x;f=Pv(c),(m=Lr.get(m))&&xd(f,m),x=(n.ownerDocument||n).createElement("link"),Te(x);var _=x;return _._p=new Promise(function(O,G){_.onload=O,_.onerror=G}),Fi(x,"link",f),l.state.loading|=4,hc(x,c.precedence,n),l.instance=x;case"script":return x=tl(c.src),(m=n.querySelector(so(x)))?(l.instance=m,Te(m),m):(f=c,(m=Lr.get(x))&&(f=j({},c),wd(f,m)),n=n.ownerDocument||n,m=n.createElement("script"),Te(m),Fi(m,"link",f),n.head.appendChild(m),l.instance=m);case"void":return null;default:throw Error(r(443,l.type))}else l.type==="stylesheet"&&(l.state.loading&4)===0&&(f=l.instance,l.state.loading|=4,hc(f,c.precedence,n));return l.instance}function hc(n,l,c){for(var f=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=f.length?f[f.length-1]:null,x=m,_=0;_<f.length;_++){var O=f[_];if(O.dataset.precedence===l)x=O;else if(x!==m)break}x?x.parentNode.insertBefore(n,x.nextSibling):(l=c.nodeType===9?c.head:c,l.insertBefore(n,l.firstChild))}function xd(n,l){n.crossOrigin==null&&(n.crossOrigin=l.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=l.referrerPolicy),n.title==null&&(n.title=l.title)}function wd(n,l){n.crossOrigin==null&&(n.crossOrigin=l.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=l.referrerPolicy),n.integrity==null&&(n.integrity=l.integrity)}var fc=null;function Uv(n,l,c){if(fc===null){var f=new Map,m=fc=new Map;m.set(c,f)}else m=fc,f=m.get(c),f||(f=new Map,m.set(c,f));if(f.has(n))return f;for(f.set(n,null),c=c.getElementsByTagName(n),m=0;m<c.length;m++){var x=c[m];if(!(x[ae]||x[A]||n==="link"&&x.getAttribute("rel")==="stylesheet")&&x.namespaceURI!=="http://www.w3.org/2000/svg"){var _=x.getAttribute(l)||"";_=n+_;var O=f.get(_);O?O.push(x):f.set(_,[x])}}return f}function Vv(n,l,c){n=n.ownerDocument||n,n.head.insertBefore(c,l==="title"?n.querySelector("head > title"):null)}function UC(n,l,c){if(c===1||l.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof l.precedence!="string"||typeof l.href!="string"||l.href==="")break;return!0;case"link":if(typeof l.rel!="string"||typeof l.href!="string"||l.href===""||l.onLoad||l.onError)break;switch(l.rel){case"stylesheet":return n=l.disabled,typeof l.precedence=="string"&&n==null;default:return!0}case"script":if(l.async&&typeof l.async!="function"&&typeof l.async!="symbol"&&!l.onLoad&&!l.onError&&l.src&&typeof l.src=="string")return!0}return!1}function Gv(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}var lo=null;function VC(){}function GC(n,l,c){if(lo===null)throw Error(r(475));var f=lo;if(l.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var m=el(c.href),x=n.querySelector(no(m));if(x){n=x._p,n!==null&&typeof n=="object"&&typeof n.then=="function"&&(f.count++,f=dc.bind(f),n.then(f,f)),l.state.loading|=4,l.instance=x,Te(x);return}x=n.ownerDocument||n,c=Pv(c),(m=Lr.get(m))&&xd(c,m),x=x.createElement("link"),Te(x);var _=x;_._p=new Promise(function(O,G){_.onload=O,_.onerror=G}),Fi(x,"link",c),l.instance=x}f.stylesheets===null&&(f.stylesheets=new Map),f.stylesheets.set(l,n),(n=l.state.preload)&&(l.state.loading&3)===0&&(f.count++,l=dc.bind(f),n.addEventListener("load",l),n.addEventListener("error",l))}}function WC(){if(lo===null)throw Error(r(475));var n=lo;return n.stylesheets&&n.count===0&&yd(n,n.stylesheets),0<n.count?function(l){var c=setTimeout(function(){if(n.stylesheets&&yd(n,n.stylesheets),n.unsuspend){var f=n.unsuspend;n.unsuspend=null,f()}},6e4);return n.unsuspend=l,function(){n.unsuspend=null,clearTimeout(c)}}:null}function dc(){if(this.count--,this.count===0){if(this.stylesheets)yd(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var pc=null;function yd(n,l){n.stylesheets=null,n.unsuspend!==null&&(n.count++,pc=new Map,l.forEach(jC,n),pc=null,dc.call(n))}function jC(n,l){if(!(l.state.loading&4)){var c=pc.get(n);if(c)var f=c.get(null);else{c=new Map,pc.set(n,c);for(var m=n.querySelectorAll("link[data-precedence],style[data-precedence]"),x=0;x<m.length;x++){var _=m[x];(_.nodeName==="LINK"||_.getAttribute("media")!=="not all")&&(c.set(_.dataset.precedence,_),f=_)}f&&c.set(null,f)}m=l.instance,_=m.getAttribute("data-precedence"),x=c.get(_)||f,x===f&&c.set(null,m),c.set(_,m),this.count++,f=dc.bind(this),m.addEventListener("load",f),m.addEventListener("error",f),x?x.parentNode.insertBefore(m,x.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(m,n.firstChild)),l.state.loading|=4}}var oo={$$typeof:v,Provider:null,Consumer:null,_currentValue:Ne,_currentValue2:Ne,_threadCount:0};function XC(n,l,c,f,m,x,_,O){this.tag=1,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=fe(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=fe(0),this.hiddenUpdates=fe(null),this.identifierPrefix=f,this.onUncaughtError=m,this.onCaughtError=x,this.onRecoverableError=_,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=O,this.incompleteTransitions=new Map}function Wv(n,l,c,f,m,x,_,O,G,J,xe,Re){return n=new XC(n,l,c,_,O,G,J,Re),l=1,x===!0&&(l|=24),x=Mr(3,null,null,l),n.current=x,x.stateNode=n,l=Qh(),l.refCount++,n.pooledCache=l,l.refCount++,x.memoizedState={element:f,isDehydrated:c,cache:l},Of(x),n}function jv(n){return n?(n=Os,n):Os}function Xv(n,l,c,f,m,x){m=jv(m),f.context===null?f.context=m:f.pendingContext=m,f=Ja(l),f.payload={element:c},x=x===void 0?null:x,x!==null&&(f.callback=x),c=en(n,f,l),c!==null&&($i(c,n,l),jl(c,n,l))}function Yv(n,l){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var c=n.retryLane;n.retryLane=c!==0&&c<l?c:l}}function Ed(n,l){Yv(n,l),(n=n.alternate)&&Yv(n,l)}function qv(n){if(n.tag===13){var l=Xa(n,67108864);l!==null&&$i(l,n,67108864),Ed(n,67108864)}}var mc=!0;function YC(n,l,c,f){var m=N.T;N.T=null;var x=pe.p;try{pe.p=2,Cd(n,l,c,f)}finally{pe.p=x,N.T=m}}function qC(n,l,c,f){var m=N.T;N.T=null;var x=pe.p;try{pe.p=8,Cd(n,l,c,f)}finally{pe.p=x,N.T=m}}function Cd(n,l,c,f){if(mc){var m=Td(f);if(m===null)hd(n,l,f,gc,c),$v(n,f);else if($C(m,n,l,c,f))f.stopPropagation();else if($v(n,f),l&4&&-1<KC.indexOf(n)){for(;m!==null;){var x=ke(m);if(x!==null)switch(x.tag){case 3:if(x=x.stateNode,x.current.memoizedState.isDehydrated){var _=Ri(x.pendingLanes);if(_!==0){var O=x;for(O.pendingLanes|=2,O.entangledLanes|=2;_;){var G=1<<31-ri(_);O.entanglements[1]|=G,_&=~G}la(x),($t&6)===0&&(Ju=rt()+500,io(0))}}break;case 13:O=Xa(x,2),O!==null&&$i(O,x,2),ic(),Ed(x,2)}if(x=Td(f),x===null&&hd(n,l,f,gc,c),x===m)break;m=x}m!==null&&f.stopPropagation()}else hd(n,l,f,null,c)}}function Td(n){return n=Ah(n),_d(n)}var gc=null;function _d(n){if(gc=null,n=Ce(n),n!==null){var l=ve(n);if(l===null)n=null;else{var c=l.tag;if(c===13){if(n=Me(l),n!==null)return n;n=null}else if(c===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;n=null}else l!==n&&(n=null)}}return gc=n,null}function Kv(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Fe()){case jt:return 2;case ti:return 8;case At:case qi:return 32;case Xt:return 268435456;default:return 32}default:return 32}}var Sd=!1,on=null,un=null,cn=null,uo=new Map,co=new Map,hn=[],KC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function $v(n,l){switch(n){case"focusin":case"focusout":on=null;break;case"dragenter":case"dragleave":un=null;break;case"mouseover":case"mouseout":cn=null;break;case"pointerover":case"pointerout":uo.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":co.delete(l.pointerId)}}function ho(n,l,c,f,m,x){return n===null||n.nativeEvent!==x?(n={blockedOn:l,domEventName:c,eventSystemFlags:f,nativeEvent:x,targetContainers:[m]},l!==null&&(l=ke(l),l!==null&&qv(l)),n):(n.eventSystemFlags|=f,l=n.targetContainers,m!==null&&l.indexOf(m)===-1&&l.push(m),n)}function $C(n,l,c,f,m){switch(l){case"focusin":return on=ho(on,n,l,c,f,m),!0;case"dragenter":return un=ho(un,n,l,c,f,m),!0;case"mouseover":return cn=ho(cn,n,l,c,f,m),!0;case"pointerover":var x=m.pointerId;return uo.set(x,ho(uo.get(x)||null,n,l,c,f,m)),!0;case"gotpointercapture":return x=m.pointerId,co.set(x,ho(co.get(x)||null,n,l,c,f,m)),!0}return!1}function Zv(n){var l=Ce(n.target);if(l!==null){var c=ve(l);if(c!==null){if(l=c.tag,l===13){if(l=Me(c),l!==null){n.blockedOn=l,S(n.priority,function(){if(c.tag===13){var f=fr(),m=Xa(c,f);m!==null&&$i(m,c,f),Ed(c,f)}});return}}else if(l===3&&c.stateNode.current.memoizedState.isDehydrated){n.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}n.blockedOn=null}function vc(n){if(n.blockedOn!==null)return!1;for(var l=n.targetContainers;0<l.length;){var c=Td(n.nativeEvent);if(c===null){c=n.nativeEvent;var f=new c.constructor(c.type,c);kh=f,c.target.dispatchEvent(f),kh=null}else return l=ke(c),l!==null&&qv(l),n.blockedOn=c,!1;l.shift()}return!0}function Qv(n,l,c){vc(n)&&c.delete(l)}function ZC(){Sd=!1,on!==null&&vc(on)&&(on=null),un!==null&&vc(un)&&(un=null),cn!==null&&vc(cn)&&(cn=null),uo.forEach(Qv),co.forEach(Qv)}function bc(n,l){n.blockedOn===l&&(n.blockedOn=null,Sd||(Sd=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,ZC)))}var xc=null;function Jv(n){xc!==n&&(xc=n,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){xc===n&&(xc=null);for(var l=0;l<n.length;l+=3){var c=n[l],f=n[l+1],m=n[l+2];if(typeof f!="function"){if(_d(f||c)===null)continue;break}var x=ke(c);x!==null&&(n.splice(l,3),l-=3,mf(x,{pending:!0,data:m,method:c.method,action:f},f,m))}}))}function fo(n){function l(G){return bc(G,n)}on!==null&&bc(on,n),un!==null&&bc(un,n),cn!==null&&bc(cn,n),uo.forEach(l),co.forEach(l);for(var c=0;c<hn.length;c++){var f=hn[c];f.blockedOn===n&&(f.blockedOn=null)}for(;0<hn.length&&(c=hn[0],c.blockedOn===null);)Zv(c),c.blockedOn===null&&hn.shift();if(c=(n.ownerDocument||n).$$reactFormReplay,c!=null)for(f=0;f<c.length;f+=3){var m=c[f],x=c[f+1],_=m[M]||null;if(typeof x=="function")_||Jv(c);else if(_){var O=null;if(x&&x.hasAttribute("formAction")){if(m=x,_=x[M]||null)O=_.formAction;else if(_d(m)!==null)continue}else O=_.action;typeof O=="function"?c[f+1]=O:(c.splice(f,3),f-=3),Jv(c)}}}function Rd(n){this._internalRoot=n}wc.prototype.render=Rd.prototype.render=function(n){var l=this._internalRoot;if(l===null)throw Error(r(409));var c=l.current,f=fr();Xv(c,f,n,l,null,null)},wc.prototype.unmount=Rd.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var l=n.containerInfo;n.tag===0&&$s(),Xv(n.current,2,null,n,null,null),ic(),l[B]=null}};function wc(n){this._internalRoot=n}wc.prototype.unstable_scheduleHydration=function(n){if(n){var l=Ke();n={blockedOn:null,target:n,priority:l};for(var c=0;c<hn.length&&l!==0&&l<hn[c].priority;c++);hn.splice(c,0,n),c===0&&Zv(n)}};var e1=e.version;if(e1!=="19.0.0")throw Error(r(527,e1,"19.0.0"));pe.findDOMNode=function(n){var l=n._reactInternals;if(l===void 0)throw typeof n.render=="function"?Error(r(188)):(n=Object.keys(n).join(","),Error(r(268,n)));return n=he(l),n=n!==null?_e(n):null,n=n===null?null:n.stateNode,n};var QC={bundleType:0,version:"19.0.0",rendererPackageName:"react-dom",currentDispatcherRef:N,findFiberByHostInstance:Ce,reconcilerVersion:"19.0.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var yc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!yc.isDisabled&&yc.supportsFiber)try{zt=yc.inject(QC),xt=yc}catch{}}return mo.createRoot=function(n,l){if(!a(n))throw Error(r(299));var c=!1,f="",m=vg,x=bg,_=xg,O=null;return l!=null&&(l.unstable_strictMode===!0&&(c=!0),l.identifierPrefix!==void 0&&(f=l.identifierPrefix),l.onUncaughtError!==void 0&&(m=l.onUncaughtError),l.onCaughtError!==void 0&&(x=l.onCaughtError),l.onRecoverableError!==void 0&&(_=l.onRecoverableError),l.unstable_transitionCallbacks!==void 0&&(O=l.unstable_transitionCallbacks)),l=Wv(n,1,!1,null,null,c,f,m,x,_,O,null),n[B]=l.current,cd(n.nodeType===8?n.parentNode:n),new Rd(l)},mo.hydrateRoot=function(n,l,c){if(!a(n))throw Error(r(299));var f=!1,m="",x=vg,_=bg,O=xg,G=null,J=null;return c!=null&&(c.unstable_strictMode===!0&&(f=!0),c.identifierPrefix!==void 0&&(m=c.identifierPrefix),c.onUncaughtError!==void 0&&(x=c.onUncaughtError),c.onCaughtError!==void 0&&(_=c.onCaughtError),c.onRecoverableError!==void 0&&(O=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(G=c.unstable_transitionCallbacks),c.formState!==void 0&&(J=c.formState)),l=Wv(n,1,!0,l,c??null,f,m,x,_,O,G,J),l.context=jv(null),c=l.current,f=fr(),m=Ja(f),m.callback=null,en(c,m,f),l.current.lanes=f,Ae(l,f),la(l),n[B]=l.current,cd(n),new wc(l)},mo.version="19.0.0",mo}var c1;function u2(){if(c1)return Dd.exports;c1=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),Dd.exports=o2(),Dd.exports}var c2=u2(),Ld={exports:{}},Nd={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var h1;function h2(){if(h1)return Nd;h1=1;var i=sh();function e(h,d){return h===d&&(h!==0||1/h===1/d)||h!==h&&d!==d}var t=typeof Object.is=="function"?Object.is:e,r=i.useSyncExternalStore,a=i.useRef,s=i.useEffect,o=i.useMemo,u=i.useDebugValue;return Nd.useSyncExternalStoreWithSelector=function(h,d,p,b,g){var v=a(null);if(v.current===null){var y={hasValue:!1,value:null};v.current=y}else y=v.current;v=o(function(){function E(k){if(!w){if(w=!0,R=k,k=b(k),g!==void 0&&y.hasValue){var V=y.value;if(g(V,k))return T=V}return T=k}if(V=T,t(R,k))return V;var P=b(k);return g!==void 0&&g(V,P)?(R=k,V):(R=k,T=P)}var w=!1,R,T,D=p===void 0?null:p;return[function(){return E(d())},D===null?void 0:function(){return E(D())}]},[d,p,b,g]);var C=r(h,v[0],v[1]);return s(function(){y.hasValue=!0,y.value=C},[C]),u(C),C},Nd}var f1;function f2(){return f1||(f1=1,Ld.exports=h2()),Ld.exports}var d2=f2();function p2(i){i()}function m2(){let i=null,e=null;return{clear(){i=null,e=null},notify(){p2(()=>{let t=i;for(;t;)t.callback(),t=t.next})},get(){const t=[];let r=i;for(;r;)t.push(r),r=r.next;return t},subscribe(t){let r=!0;const a=e={callback:t,next:null,prev:e};return a.prev?a.prev.next=a:i=a,function(){!r||i===null||(r=!1,a.next?a.next.prev=a.prev:e=a.prev,a.prev?a.prev.next=a.next:i=a.next)}}}}var d1={notify(){},get:()=>[]};function g2(i,e){let t,r=d1,a=0,s=!1;function o(C){p();const E=r.subscribe(C);let w=!1;return()=>{w||(w=!0,E(),b())}}function u(){r.notify()}function h(){y.onStateChange&&y.onStateChange()}function d(){return s}function p(){a++,t||(t=i.subscribe(h),r=m2())}function b(){a--,t&&a===0&&(t(),t=void 0,r.clear(),r=d1)}function g(){s||(s=!0,p())}function v(){s&&(s=!1,b())}const y={addNestedSub:o,notifyNestedSubs:u,handleChangeWrapper:h,isSubscribed:d,trySubscribe:g,tryUnsubscribe:v,getListeners:()=>r};return y}var v2=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",b2=v2(),x2=()=>typeof navigator<"u"&&navigator.product==="ReactNative",w2=x2(),y2=()=>b2||w2?ne.useLayoutEffect:ne.useEffect,E2=y2(),Bd=Symbol.for("react-redux-context"),zd=typeof globalThis<"u"?globalThis:{};function C2(){if(!ne.createContext)return{};const i=zd[Bd]??(zd[Bd]=new Map);let e=i.get(ne.createContext);return e||(e=ne.createContext(null),i.set(ne.createContext,e)),e}var _n=C2();function T2(i){const{children:e,context:t,serverState:r,store:a}=i,s=ne.useMemo(()=>{const h=g2(a);return{store:a,subscription:h,getServerState:r?()=>r:void 0}},[a,r]),o=ne.useMemo(()=>a.getState(),[a]);E2(()=>{const{subscription:h}=s;return h.onStateChange=h.notifyNestedSubs,h.trySubscribe(),o!==a.getState()&&h.notifyNestedSubs(),()=>{h.tryUnsubscribe(),h.onStateChange=void 0}},[s,o]);const u=t||_n;return ne.createElement(u.Provider,{value:s},e)}var _2=T2;function $0(i=_n){return function(){return ne.useContext(i)}}var tx=$0();function ix(i=_n){const e=i===_n?tx:$0(i),t=()=>{const{store:r}=e();return r};return Object.assign(t,{withTypes:()=>t}),t}var S2=ix();function R2(i=_n){const e=i===_n?S2:ix(i),t=()=>e().dispatch;return Object.assign(t,{withTypes:()=>t}),t}var k2=R2(),A2=(i,e)=>i===e;function D2(i=_n){const e=i===_n?tx:$0(i),t=(r,a={})=>{const{equalityFn:s=A2}=typeof a=="function"?{equalityFn:a}:a,o=e(),{store:u,subscription:h,getServerState:d}=o;ne.useRef(!0);const p=ne.useCallback({[r.name](g){return r(g)}}[r.name],[r]),b=d2.useSyncExternalStoreWithSelector(h.addNestedSub,u.getState,d||u.getState,p,s);return ne.useDebugValue(b),b};return Object.assign(t,{withTypes:()=>t}),t}var F2=D2();function Mi(i){return`Minified Redux error #${i}; visit https://redux.js.org/Errors?code=${i} for the full message or use the non-minified dev environment for full errors. `}var M2=typeof Symbol=="function"&&Symbol.observable||"@@observable",p1=M2,Hd=()=>Math.random().toString(36).substring(7).split("").join("."),O2={INIT:`@@redux/INIT${Hd()}`,REPLACE:`@@redux/REPLACE${Hd()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Hd()}`},Pc=O2;function Z0(i){if(typeof i!="object"||i===null)return!1;let e=i;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(i)===e||Object.getPrototypeOf(i)===null}function rx(i,e,t){if(typeof i!="function")throw new Error(Mi(2));if(typeof e=="function"&&typeof t=="function"||typeof t=="function"&&typeof arguments[3]=="function")throw new Error(Mi(0));if(typeof e=="function"&&typeof t>"u"&&(t=e,e=void 0),typeof t<"u"){if(typeof t!="function")throw new Error(Mi(1));return t(rx)(i,e)}let r=i,a=e,s=new Map,o=s,u=0,h=!1;function d(){o===s&&(o=new Map,s.forEach((E,w)=>{o.set(w,E)}))}function p(){if(h)throw new Error(Mi(3));return a}function b(E){if(typeof E!="function")throw new Error(Mi(4));if(h)throw new Error(Mi(5));let w=!0;d();const R=u++;return o.set(R,E),function(){if(w){if(h)throw new Error(Mi(6));w=!1,d(),o.delete(R),s=null}}}function g(E){if(!Z0(E))throw new Error(Mi(7));if(typeof E.type>"u")throw new Error(Mi(8));if(typeof E.type!="string")throw new Error(Mi(17));if(h)throw new Error(Mi(9));try{h=!0,a=r(a,E)}finally{h=!1}return(s=o).forEach(R=>{R()}),E}function v(E){if(typeof E!="function")throw new Error(Mi(10));r=E,g({type:Pc.REPLACE})}function y(){const E=b;return{subscribe(w){if(typeof w!="object"||w===null)throw new Error(Mi(11));function R(){const D=w;D.next&&D.next(p())}return R(),{unsubscribe:E(R)}},[p1](){return this}}}return g({type:Pc.INIT}),{dispatch:g,subscribe:b,getState:p,replaceReducer:v,[p1]:y}}function L2(i){Object.keys(i).forEach(e=>{const t=i[e];if(typeof t(void 0,{type:Pc.INIT})>"u")throw new Error(Mi(12));if(typeof t(void 0,{type:Pc.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Mi(13))})}function N2(i){const e=Object.keys(i),t={};for(let s=0;s<e.length;s++){const o=e[s];typeof i[o]=="function"&&(t[o]=i[o])}const r=Object.keys(t);let a;try{L2(t)}catch(s){a=s}return function(o={},u){if(a)throw a;let h=!1;const d={};for(let p=0;p<r.length;p++){const b=r[p],g=t[b],v=o[b],y=g(v,u);if(typeof y>"u")throw u&&u.type,new Error(Mi(14));d[b]=y,h=h||y!==v}return h=h||r.length!==Object.keys(o).length,h?d:o}}function Ic(...i){return i.length===0?e=>e:i.length===1?i[0]:i.reduce((e,t)=>(...r)=>e(t(...r)))}function B2(...i){return e=>(t,r)=>{const a=e(t,r);let s=()=>{throw new Error(Mi(15))};const o={getState:a.getState,dispatch:(h,...d)=>s(h,...d)},u=i.map(h=>h(o));return s=Ic(...u)(a.dispatch),{...a,dispatch:s}}}function z2(i){return Z0(i)&&"type"in i&&typeof i.type=="string"}var ax=Symbol.for("immer-nothing"),m1=Symbol.for("immer-draftable"),xr=Symbol.for("immer-state");function Qr(i,...e){throw new Error(`[Immer] minified error nr: ${i}. Full error at: https://bit.ly/3cXEKWf`)}var gl=Object.getPrototypeOf;function ds(i){return!!i&&!!i[xr]}function Pa(i){var e;return i?nx(i)||Array.isArray(i)||!!i[m1]||!!((e=i.constructor)!=null&&e[m1])||oh(i)||uh(i):!1}var H2=Object.prototype.constructor.toString();function nx(i){if(!i||typeof i!="object")return!1;const e=gl(i);if(e===null)return!0;const t=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return t===Object?!0:typeof t=="function"&&Function.toString.call(t)===H2}function Uc(i,e){lh(i)===0?Reflect.ownKeys(i).forEach(t=>{e(t,i[t],i)}):i.forEach((t,r)=>e(r,t,i))}function lh(i){const e=i[xr];return e?e.type_:Array.isArray(i)?1:oh(i)?2:uh(i)?3:0}function n0(i,e){return lh(i)===2?i.has(e):Object.prototype.hasOwnProperty.call(i,e)}function sx(i,e,t){const r=lh(i);r===2?i.set(e,t):r===3?i.add(t):i[e]=t}function P2(i,e){return i===e?i!==0||1/i===1/e:i!==i&&e!==e}function oh(i){return i instanceof Map}function uh(i){return i instanceof Set}function ts(i){return i.copy_||i.base_}function s0(i,e){if(oh(i))return new Map(i);if(uh(i))return new Set(i);if(Array.isArray(i))return Array.prototype.slice.call(i);const t=nx(i);if(e===!0||e==="class_only"&&!t){const r=Object.getOwnPropertyDescriptors(i);delete r[xr];let a=Reflect.ownKeys(r);for(let s=0;s<a.length;s++){const o=a[s],u=r[o];u.writable===!1&&(u.writable=!0,u.configurable=!0),(u.get||u.set)&&(r[o]={configurable:!0,writable:!0,enumerable:u.enumerable,value:i[o]})}return Object.create(gl(i),r)}else{const r=gl(i);if(r!==null&&t)return{...i};const a=Object.create(r);return Object.assign(a,i)}}function Q0(i,e=!1){return ch(i)||ds(i)||!Pa(i)||(lh(i)>1&&(i.set=i.add=i.clear=i.delete=I2),Object.freeze(i),e&&Object.entries(i).forEach(([t,r])=>Q0(r,!0))),i}function I2(){Qr(2)}function ch(i){return Object.isFrozen(i)}var U2={};function ps(i){const e=U2[i];return e||Qr(0,i),e}var Xo;function lx(){return Xo}function V2(i,e){return{drafts_:[],parent_:i,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function g1(i,e){e&&(ps("Patches"),i.patches_=[],i.inversePatches_=[],i.patchListener_=e)}function l0(i){o0(i),i.drafts_.forEach(G2),i.drafts_=null}function o0(i){i===Xo&&(Xo=i.parent_)}function v1(i){return Xo=V2(Xo,i)}function G2(i){const e=i[xr];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function b1(i,e){e.unfinalizedDrafts_=e.drafts_.length;const t=e.drafts_[0];return i!==void 0&&i!==t?(t[xr].modified_&&(l0(e),Qr(4)),Pa(i)&&(i=Vc(e,i),e.parent_||Gc(e,i)),e.patches_&&ps("Patches").generateReplacementPatches_(t[xr].base_,i,e.patches_,e.inversePatches_)):i=Vc(e,t,[]),l0(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),i!==ax?i:void 0}function Vc(i,e,t){if(ch(e))return e;const r=e[xr];if(!r)return Uc(e,(a,s)=>x1(i,r,e,a,s,t)),e;if(r.scope_!==i)return e;if(!r.modified_)return Gc(i,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const a=r.copy_;let s=a,o=!1;r.type_===3&&(s=new Set(a),a.clear(),o=!0),Uc(s,(u,h)=>x1(i,r,a,u,h,t,o)),Gc(i,a,!1),t&&i.patches_&&ps("Patches").generatePatches_(r,t,i.patches_,i.inversePatches_)}return r.copy_}function x1(i,e,t,r,a,s,o){if(ds(a)){const u=s&&e&&e.type_!==3&&!n0(e.assigned_,r)?s.concat(r):void 0,h=Vc(i,a,u);if(sx(t,r,h),ds(h))i.canAutoFreeze_=!1;else return}else o&&t.add(a);if(Pa(a)&&!ch(a)){if(!i.immer_.autoFreeze_&&i.unfinalizedDrafts_<1)return;Vc(i,a),(!e||!e.scope_.parent_)&&typeof r!="symbol"&&Object.prototype.propertyIsEnumerable.call(t,r)&&Gc(i,a)}}function Gc(i,e,t=!1){!i.parent_&&i.immer_.autoFreeze_&&i.canAutoFreeze_&&Q0(e,t)}function W2(i,e){const t=Array.isArray(i),r={type_:t?1:0,scope_:e?e.scope_:lx(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:i,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=r,s=J0;t&&(a=[r],s=Yo);const{revoke:o,proxy:u}=Proxy.revocable(a,s);return r.draft_=u,r.revoke_=o,u}var J0={get(i,e){if(e===xr)return i;const t=ts(i);if(!n0(t,e))return j2(i,t,e);const r=t[e];return i.finalized_||!Pa(r)?r:r===Pd(i.base_,e)?(Id(i),i.copy_[e]=c0(r,i)):r},has(i,e){return e in ts(i)},ownKeys(i){return Reflect.ownKeys(ts(i))},set(i,e,t){const r=ox(ts(i),e);if(r!=null&&r.set)return r.set.call(i.draft_,t),!0;if(!i.modified_){const a=Pd(ts(i),e),s=a==null?void 0:a[xr];if(s&&s.base_===t)return i.copy_[e]=t,i.assigned_[e]=!1,!0;if(P2(t,a)&&(t!==void 0||n0(i.base_,e)))return!0;Id(i),u0(i)}return i.copy_[e]===t&&(t!==void 0||e in i.copy_)||Number.isNaN(t)&&Number.isNaN(i.copy_[e])||(i.copy_[e]=t,i.assigned_[e]=!0),!0},deleteProperty(i,e){return Pd(i.base_,e)!==void 0||e in i.base_?(i.assigned_[e]=!1,Id(i),u0(i)):delete i.assigned_[e],i.copy_&&delete i.copy_[e],!0},getOwnPropertyDescriptor(i,e){const t=ts(i),r=Reflect.getOwnPropertyDescriptor(t,e);return r&&{writable:!0,configurable:i.type_!==1||e!=="length",enumerable:r.enumerable,value:t[e]}},defineProperty(){Qr(11)},getPrototypeOf(i){return gl(i.base_)},setPrototypeOf(){Qr(12)}},Yo={};Uc(J0,(i,e)=>{Yo[i]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});Yo.deleteProperty=function(i,e){return Yo.set.call(this,i,e,void 0)};Yo.set=function(i,e,t){return J0.set.call(this,i[0],e,t,i[0])};function Pd(i,e){const t=i[xr];return(t?ts(t):i)[e]}function j2(i,e,t){var a;const r=ox(e,t);return r?"value"in r?r.value:(a=r.get)==null?void 0:a.call(i.draft_):void 0}function ox(i,e){if(!(e in i))return;let t=gl(i);for(;t;){const r=Object.getOwnPropertyDescriptor(t,e);if(r)return r;t=gl(t)}}function u0(i){i.modified_||(i.modified_=!0,i.parent_&&u0(i.parent_))}function Id(i){i.copy_||(i.copy_=s0(i.base_,i.scope_.immer_.useStrictShallowCopy_))}var X2=class{constructor(i){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,t,r)=>{if(typeof e=="function"&&typeof t!="function"){const s=t;t=e;const o=this;return function(h=s,...d){return o.produce(h,p=>t.call(this,p,...d))}}typeof t!="function"&&Qr(6),r!==void 0&&typeof r!="function"&&Qr(7);let a;if(Pa(e)){const s=v1(this),o=c0(e,void 0);let u=!0;try{a=t(o),u=!1}finally{u?l0(s):o0(s)}return g1(s,r),b1(a,s)}else if(!e||typeof e!="object"){if(a=t(e),a===void 0&&(a=e),a===ax&&(a=void 0),this.autoFreeze_&&Q0(a,!0),r){const s=[],o=[];ps("Patches").generateReplacementPatches_(e,a,s,o),r(s,o)}return a}else Qr(1,e)},this.produceWithPatches=(e,t)=>{if(typeof e=="function")return(o,...u)=>this.produceWithPatches(o,h=>e(h,...u));let r,a;return[this.produce(e,t,(o,u)=>{r=o,a=u}),r,a]},typeof(i==null?void 0:i.autoFreeze)=="boolean"&&this.setAutoFreeze(i.autoFreeze),typeof(i==null?void 0:i.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(i.useStrictShallowCopy)}createDraft(i){Pa(i)||Qr(8),ds(i)&&(i=Y2(i));const e=v1(this),t=c0(i,void 0);return t[xr].isManual_=!0,o0(e),t}finishDraft(i,e){const t=i&&i[xr];(!t||!t.isManual_)&&Qr(9);const{scope_:r}=t;return g1(r,e),b1(void 0,r)}setAutoFreeze(i){this.autoFreeze_=i}setUseStrictShallowCopy(i){this.useStrictShallowCopy_=i}applyPatches(i,e){let t;for(t=e.length-1;t>=0;t--){const a=e[t];if(a.path.length===0&&a.op==="replace"){i=a.value;break}}t>-1&&(e=e.slice(t+1));const r=ps("Patches").applyPatches_;return ds(i)?r(i,e):this.produce(i,a=>r(a,e))}};function c0(i,e){const t=oh(i)?ps("MapSet").proxyMap_(i,e):uh(i)?ps("MapSet").proxySet_(i,e):W2(i,e);return(e?e.scope_:lx()).drafts_.push(t),t}function Y2(i){return ds(i)||Qr(10,i),ux(i)}function ux(i){if(!Pa(i)||ch(i))return i;const e=i[xr];let t;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,t=s0(i,e.scope_.immer_.useStrictShallowCopy_)}else t=s0(i,!0);return Uc(t,(r,a)=>{sx(t,r,ux(a))}),e&&(e.finalized_=!1),t}var wr=new X2,cx=wr.produce;wr.produceWithPatches.bind(wr);wr.setAutoFreeze.bind(wr);wr.setUseStrictShallowCopy.bind(wr);wr.applyPatches.bind(wr);wr.createDraft.bind(wr);wr.finishDraft.bind(wr);function hx(i){return({dispatch:t,getState:r})=>a=>s=>typeof s=="function"?s(t,r,i):a(s)}var q2=hx(),K2=hx,$2=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?Ic:Ic.apply(null,arguments)},Z2=i=>i&&typeof i.match=="function";function Ro(i,e){function t(...r){if(e){let a=e(...r);if(!a)throw new Error(Ba(0));return{type:i,payload:a.payload,..."meta"in a&&{meta:a.meta},..."error"in a&&{error:a.error}}}return{type:i,payload:r[0]}}return t.toString=()=>`${i}`,t.type=i,t.match=r=>z2(r)&&r.type===i,t}var fx=class yo extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,yo.prototype)}static get[Symbol.species](){return yo}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new yo(...e[0].concat(this)):new yo(...e.concat(this))}};function w1(i){return Pa(i)?cx(i,()=>{}):i}function y1(i,e,t){return i.has(e)?i.get(e):i.set(e,t(e)).get(e)}function Q2(i){return typeof i=="boolean"}var J2=()=>function(e){const{thunk:t=!0,immutableCheck:r=!0,serializableCheck:a=!0,actionCreatorCheck:s=!0}=e??{};let o=new fx;return t&&(Q2(t)?o.push(q2):o.push(K2(t.extraArgument))),o},eT="RTK_autoBatch",E1=i=>e=>{setTimeout(e,i)},tT=(i={type:"raf"})=>e=>(...t)=>{const r=e(...t);let a=!0,s=!1,o=!1;const u=new Set,h=i.type==="tick"?queueMicrotask:i.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:E1(10):i.type==="callback"?i.queueNotification:E1(i.timeout),d=()=>{o=!1,s&&(s=!1,u.forEach(p=>p()))};return Object.assign({},r,{subscribe(p){const b=()=>a&&p(),g=r.subscribe(b);return u.add(p),()=>{g(),u.delete(p)}},dispatch(p){var b;try{return a=!((b=p==null?void 0:p.meta)!=null&&b[eT]),s=!a,s&&(o||(o=!0,h(d))),r.dispatch(p)}finally{a=!0}}})},iT=i=>function(t){const{autoBatch:r=!0}=t??{};let a=new fx(i);return r&&a.push(tT(typeof r=="object"?r:void 0)),a};function rT(i){const e=J2(),{reducer:t=void 0,middleware:r,devTools:a=!0,preloadedState:s=void 0,enhancers:o=void 0}=i||{};let u;if(typeof t=="function")u=t;else if(Z0(t))u=N2(t);else throw new Error(Ba(1));let h;typeof r=="function"?h=r(e):h=e();let d=Ic;a&&(d=$2({trace:!1,...typeof a=="object"&&a}));const p=B2(...h),b=iT(p);let g=typeof o=="function"?o(b):b();const v=d(...g);return rx(u,s,v)}function dx(i){const e={},t=[];let r;const a={addCase(s,o){const u=typeof s=="string"?s:s.type;if(!u)throw new Error(Ba(28));if(u in e)throw new Error(Ba(29));return e[u]=o,a},addMatcher(s,o){return t.push({matcher:s,reducer:o}),a},addDefaultCase(s){return r=s,a}};return i(a),[e,t,r]}function aT(i){return typeof i=="function"}function nT(i,e){let[t,r,a]=dx(e),s;if(aT(i))s=()=>w1(i());else{const u=w1(i);s=()=>u}function o(u=s(),h){let d=[t[h.type],...r.filter(({matcher:p})=>p(h)).map(({reducer:p})=>p)];return d.filter(p=>!!p).length===0&&(d=[a]),d.reduce((p,b)=>{if(b)if(ds(p)){const v=b(p,h);return v===void 0?p:v}else{if(Pa(p))return cx(p,g=>b(g,h));{const g=b(p,h);if(g===void 0){if(p===null)return p;throw Error("A case reducer on a non-draftable value must not return undefined")}return g}}return p},u)}return o.getInitialState=s,o}var sT=(i,e)=>Z2(i)?i.match(e):i(e);function lT(...i){return e=>i.some(t=>sT(t,e))}var oT="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",uT=(i=21)=>{let e="",t=i;for(;t--;)e+=oT[Math.random()*64|0];return e},cT=["name","message","stack","code"],Ud=class{constructor(i,e){Be(this,"_type");this.payload=i,this.meta=e}},C1=class{constructor(i,e){Be(this,"_type");this.payload=i,this.meta=e}},hT=i=>{if(typeof i=="object"&&i!==null){const e={};for(const t of cT)typeof i[t]=="string"&&(e[t]=i[t]);return e}return{message:String(i)}},T1="External signal was aborted",px=(()=>{function i(e,t,r){const a=Ro(e+"/fulfilled",(h,d,p,b)=>({payload:h,meta:{...b||{},arg:p,requestId:d,requestStatus:"fulfilled"}})),s=Ro(e+"/pending",(h,d,p)=>({payload:void 0,meta:{...p||{},arg:d,requestId:h,requestStatus:"pending"}})),o=Ro(e+"/rejected",(h,d,p,b,g)=>({payload:b,error:(r&&r.serializeError||hT)(h||"Rejected"),meta:{...g||{},arg:p,requestId:d,rejectedWithValue:!!b,requestStatus:"rejected",aborted:(h==null?void 0:h.name)==="AbortError",condition:(h==null?void 0:h.name)==="ConditionError"}}));function u(h,{signal:d}={}){return(p,b,g)=>{const v=r!=null&&r.idGenerator?r.idGenerator(h):uT(),y=new AbortController;let C,E;function w(T){E=T,y.abort()}d&&(d.aborted?w(T1):d.addEventListener("abort",()=>w(T1),{once:!0}));const R=async function(){var k,V;let T;try{let P=(k=r==null?void 0:r.condition)==null?void 0:k.call(r,h,{getState:b,extra:g});if(dT(P)&&(P=await P),P===!1||y.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};const U=new Promise((N,j)=>{C=()=>{j({name:"AbortError",message:E||"Aborted"})},y.signal.addEventListener("abort",C)});p(s(v,h,(V=r==null?void 0:r.getPendingMeta)==null?void 0:V.call(r,{requestId:v,arg:h},{getState:b,extra:g}))),T=await Promise.race([U,Promise.resolve(t(h,{dispatch:p,getState:b,extra:g,requestId:v,signal:y.signal,abort:w,rejectWithValue:(N,j)=>new Ud(N,j),fulfillWithValue:(N,j)=>new C1(N,j)})).then(N=>{if(N instanceof Ud)throw N;return N instanceof C1?a(N.payload,v,h,N.meta):a(N,v,h)})])}catch(P){T=P instanceof Ud?o(null,v,h,P.payload,P.meta):o(P,v,h)}finally{C&&y.signal.removeEventListener("abort",C)}return r&&!r.dispatchConditionRejection&&o.match(T)&&T.meta.condition||p(T),T}();return Object.assign(R,{abort:w,requestId:v,arg:h,unwrap(){return R.then(fT)}})}}return Object.assign(u,{pending:s,rejected:o,fulfilled:a,settled:lT(o,a),typePrefix:e})}return i.withTypes=()=>i,i})();function fT(i){if(i.meta&&i.meta.rejectedWithValue)throw i.payload;if(i.error)throw i.error;return i.payload}function dT(i){return i!==null&&typeof i=="object"&&typeof i.then=="function"}var pT=Symbol.for("rtk-slice-createasyncthunk");function mT(i,e){return`${i}/${e}`}function gT({creators:i}={}){var t;const e=(t=i==null?void 0:i.asyncThunk)==null?void 0:t[pT];return function(a){const{name:s,reducerPath:o=s}=a;if(!s)throw new Error(Ba(11));const u=(typeof a.reducers=="function"?a.reducers(bT()):a.reducers)||{},h=Object.keys(u),d={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},p={addCase(T,D){const k=typeof T=="string"?T:T.type;if(!k)throw new Error(Ba(12));if(k in d.sliceCaseReducersByType)throw new Error(Ba(13));return d.sliceCaseReducersByType[k]=D,p},addMatcher(T,D){return d.sliceMatchers.push({matcher:T,reducer:D}),p},exposeAction(T,D){return d.actionCreators[T]=D,p},exposeCaseReducer(T,D){return d.sliceCaseReducersByName[T]=D,p}};h.forEach(T=>{const D=u[T],k={reducerName:T,type:mT(s,T),createNotation:typeof a.reducers=="function"};wT(D)?ET(k,D,p,e):xT(k,D,p)});function b(){const[T={},D=[],k=void 0]=typeof a.extraReducers=="function"?dx(a.extraReducers):[a.extraReducers],V={...T,...d.sliceCaseReducersByType};return nT(a.initialState,P=>{for(let U in V)P.addCase(U,V[U]);for(let U of d.sliceMatchers)P.addMatcher(U.matcher,U.reducer);for(let U of D)P.addMatcher(U.matcher,U.reducer);k&&P.addDefaultCase(k)})}const g=T=>T,v=new Map;let y;function C(T,D){return y||(y=b()),y(T,D)}function E(){return y||(y=b()),y.getInitialState()}function w(T,D=!1){function k(P){let U=P[T];return typeof U>"u"&&D&&(U=E()),U}function V(P=g){const U=y1(v,D,()=>new WeakMap);return y1(U,P,()=>{const N={};for(const[j,Y]of Object.entries(a.selectors??{}))N[j]=vT(Y,P,E,D);return N})}return{reducerPath:T,getSelectors:V,get selectors(){return V(k)},selectSlice:k}}const R={name:s,reducer:C,actions:d.actionCreators,caseReducers:d.sliceCaseReducersByName,getInitialState:E,...w(o),injectInto(T,{reducerPath:D,...k}={}){const V=D??o;return T.inject({reducerPath:V,reducer:C},k),{...R,...w(V,!0)}}};return R}}function vT(i,e,t,r){function a(s,...o){let u=e(s);return typeof u>"u"&&r&&(u=t()),i(u,...o)}return a.unwrapped=i,a}var mx=gT();function bT(){function i(e,t){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...t}}return i.withTypes=()=>i,{reducer(e){return Object.assign({[e.name](...t){return e(...t)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,t){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:t}},asyncThunk:i}}function xT({type:i,reducerName:e,createNotation:t},r,a){let s,o;if("reducer"in r){if(t&&!yT(r))throw new Error(Ba(17));s=r.reducer,o=r.prepare}else s=r;a.addCase(i,s).exposeCaseReducer(e,s).exposeAction(e,o?Ro(i,o):Ro(i))}function wT(i){return i._reducerDefinitionType==="asyncThunk"}function yT(i){return i._reducerDefinitionType==="reducerWithPrepare"}function ET({type:i,reducerName:e},t,r,a){if(!a)throw new Error(Ba(18));const{payloadCreator:s,fulfilled:o,pending:u,rejected:h,settled:d,options:p}=t,b=a(i,s,p);r.exposeAction(e,b),o&&r.addCase(b.fulfilled,o),u&&r.addCase(b.pending,u),h&&r.addCase(b.rejected,h),d&&r.addMatcher(b.settled,d),r.exposeCaseReducer(e,{fulfilled:o||Ec,pending:u||Ec,rejected:h||Ec,settled:d||Ec})}function Ec(){}function Ba(i){return`Minified Redux Toolkit error #${i}; visit https://redux-toolkit.js.org/Errors?code=${i} for the full message or use the non-minified dev environment for full errors. `}const CT={value:0},gx=mx({name:"counter",initialState:CT,reducers:{incremented:i=>{i.value+=1},amountAdded:(i,e)=>{i.value+=e.payload}}}),{incremented:vx,amountAdded:bx}=gx.actions,TT=gx.reducer;/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Pr=1200,_T=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],ep={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},tp=function(i){_T.indexOf(i)!=-1&&(ep[0]=i)};function ST(){tp(1252)}var Jr=function(i){Pr=i,tp(i)};function xx(){Jr(1200),ST()}function _1(i){for(var e=[],t=0,r=i.length;t<r;++t)e[t]=i.charCodeAt(t);return e}function wx(i){for(var e=[],t=0;t<i.length>>1;++t)e[t]=String.fromCharCode(i.charCodeAt(2*t)+(i.charCodeAt(2*t+1)<<8));return e.join("")}function RT(i){for(var e=[],t=0;t<i.length>>1;++t)e[t]=String.fromCharCode(i[2*t]+(i[2*t+1]<<8));return e.join("")}function yx(i){for(var e=[],t=0;t<i.length>>1;++t)e[t]=String.fromCharCode(i.charCodeAt(2*t+1)+(i.charCodeAt(2*t)<<8));return e.join("")}var Eo=function(i){var e=i.charCodeAt(0),t=i.charCodeAt(1);return e==255&&t==254?wx(i.slice(2)):e==254&&t==255?yx(i.slice(2)):e==65279?i.slice(1):i},Cc=function(e){return String.fromCharCode(e)},S1=function(e){return String.fromCharCode(e)},kT=null,Cn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function R1(i){for(var e="",t=0,r=0,a=0,s=0,o=0,u=0,h=0,d=0;d<i.length;)t=i.charCodeAt(d++),s=t>>2,r=i.charCodeAt(d++),o=(t&3)<<4|r>>4,a=i.charCodeAt(d++),u=(r&15)<<2|a>>6,h=a&63,isNaN(r)?u=h=64:isNaN(a)&&(h=64),e+=Cn.charAt(s)+Cn.charAt(o)+Cn.charAt(u)+Cn.charAt(h);return e}function yr(i){var e="",t=0,r=0,a=0,s=0,o=0,u=0,h=0;if(i.slice(0,5)=="data:"){var d=i.slice(0,1024).indexOf(";base64,");d>-1&&(i=i.slice(d+8))}i=i.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<i.length;)s=Cn.indexOf(i.charAt(d++)),o=Cn.indexOf(i.charAt(d++)),t=s<<2|o>>4,e+=String.fromCharCode(t),u=Cn.indexOf(i.charAt(d++)),r=(o&15)<<4|u>>2,u!==64&&(e+=String.fromCharCode(r)),h=Cn.indexOf(i.charAt(d++)),a=(u&3)<<6|h,h!==64&&(e+=String.fromCharCode(a));return e}var gt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Dn=function(){if(typeof Buffer<"u"){var i=!Buffer.from;if(!i)try{Buffer.from("foo","utf8")}catch{i=!0}return i?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}(),qo=function(){if(typeof Buffer>"u")return!1;var i=Dn([65,0]);if(!i)return!1;var e=i.toString("utf16le");return e.length==1}();function Sn(i){return gt?Buffer.alloc?Buffer.alloc(i):new Buffer(i):typeof Uint8Array<"u"?new Uint8Array(i):new Array(i)}function k1(i){return gt?Buffer.allocUnsafe?Buffer.allocUnsafe(i):new Buffer(i):typeof Uint8Array<"u"?new Uint8Array(i):new Array(i)}var gr=function(e){return gt?Dn(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)&255})};function Ia(i){if(Array.isArray(i))return i.map(function(r){return String.fromCharCode(r)}).join("");for(var e=[],t=0;t<i.length;++t)e[t]=String.fromCharCode(i[t]);return e.join("")}function ip(i){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(i instanceof ArrayBuffer)return ip(new Uint8Array(i));for(var e=new Array(i.length),t=0;t<i.length;++t)e[t]=i[t];return e}var yn=gt?function(i){return Buffer.concat(i.map(function(e){return Buffer.isBuffer(e)?e:Dn(e)}))}:function(i){if(typeof Uint8Array<"u"){var e=0,t=0;for(e=0;e<i.length;++e)t+=i[e].length;var r=new Uint8Array(t),a=0;for(e=0,t=0;e<i.length;t+=a,++e)a=i[e].length,i[e]instanceof Uint8Array?r.set(i[e],t):typeof i[e]=="string"?r.set(new Uint8Array(gr(i[e])),t):r.set(new Uint8Array(i[e]),t);return r}return[].concat.apply([],i.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function AT(i){for(var e=[],t=0,r=i.length+250,a=Sn(i.length+255),s=0;s<i.length;++s){var o=i.charCodeAt(s);if(o<128)a[t++]=o;else if(o<2048)a[t++]=192|o>>6&31,a[t++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var u=i.charCodeAt(++s)&1023;a[t++]=240|o>>8&7,a[t++]=128|o>>2&63,a[t++]=128|u>>6&15|(o&3)<<4,a[t++]=128|u&63}else a[t++]=224|o>>12&15,a[t++]=128|o>>6&63,a[t++]=128|o&63;t>r&&(e.push(a.slice(0,t)),t=0,a=Sn(65535),r=65530)}return e.push(a.slice(0,t)),yn(e)}var nr=/\u0000/g,Co=/[\u0001-\u0006]/g;function fl(i){for(var e="",t=i.length-1;t>=0;)e+=i.charAt(t--);return e}function ea(i,e){var t=""+i;return t.length>=e?t:Ct("0",e-t.length)+t}function rp(i,e){var t=""+i;return t.length>=e?t:Ct(" ",e-t.length)+t}function Wc(i,e){var t=""+i;return t.length>=e?t:t+Ct(" ",e-t.length)}function DT(i,e){var t=""+Math.round(i);return t.length>=e?t:Ct("0",e-t.length)+t}function FT(i,e){var t=""+i;return t.length>=e?t:Ct("0",e-t.length)+t}var A1=Math.pow(2,32);function il(i,e){if(i>A1||i<-A1)return DT(i,e);var t=Math.round(i);return FT(t,e)}function jc(i,e){return e=e||0,i.length>=7+e&&(i.charCodeAt(e)|32)===103&&(i.charCodeAt(e+1)|32)===101&&(i.charCodeAt(e+2)|32)===110&&(i.charCodeAt(e+3)|32)===101&&(i.charCodeAt(e+4)|32)===114&&(i.charCodeAt(e+5)|32)===97&&(i.charCodeAt(e+6)|32)===108}var D1=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Vd=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function MT(i){return i||(i={}),i[0]="General",i[1]="0",i[2]="0.00",i[3]="#,##0",i[4]="#,##0.00",i[9]="0%",i[10]="0.00%",i[11]="0.00E+00",i[12]="# ?/?",i[13]="# ??/??",i[14]="m/d/yy",i[15]="d-mmm-yy",i[16]="d-mmm",i[17]="mmm-yy",i[18]="h:mm AM/PM",i[19]="h:mm:ss AM/PM",i[20]="h:mm",i[21]="h:mm:ss",i[22]="m/d/yy h:mm",i[37]="#,##0 ;(#,##0)",i[38]="#,##0 ;[Red](#,##0)",i[39]="#,##0.00;(#,##0.00)",i[40]="#,##0.00;[Red](#,##0.00)",i[45]="mm:ss",i[46]="[h]:mm:ss",i[47]="mmss.0",i[48]="##0.0E+0",i[49]="@",i[56]='"/ "hh""mm""ss" "',i}var st={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},F1={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},OT={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Xc(i,e,t){for(var r=i<0?-1:1,a=i*r,s=0,o=1,u=0,h=1,d=0,p=0,b=Math.floor(a);d<e&&(b=Math.floor(a),u=b*o+s,p=b*d+h,!(a-b<5e-8));)a=1/(a-b),s=o,o=u,h=d,d=p;if(p>e&&(d>e?(p=h,u=s):(p=d,u=o)),!t)return[0,r*u,p];var g=Math.floor(r*u/p);return[g,r*u-g*p,p]}function LT(i){var e=i.toPrecision(16);if(e.indexOf("e")>-1){var t=e.slice(0,e.indexOf("e"));return t=t.indexOf(".")>-1?t.slice(0,t.slice(0,2)=="0."?17:16):t.slice(0,15)+Ct("0",t.length-15),t+e.slice(e.indexOf("e"))}var r=e.indexOf(".")>-1?e.slice(0,e.slice(0,2)=="0."?17:16):e.slice(0,15)+Ct("0",e.length-15);return Number(r)}function Oa(i,e,t){if(i>2958465||i<0)return null;i=LT(i);var r=i|0,a=Math.floor(86400*(i-r)),s=0,o=[],u={D:r,T:a,u:86400*(i-r)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),e&&e.date1904&&(r+=1462),u.u>.9999&&(u.u=0,++a==86400&&(u.T=a=0,++r,++u.D)),r===60)o=t?[1317,10,29]:[1900,2,29],s=3;else if(r===0)o=t?[1317,8,29]:[1900,1,0],s=6;else{r>60&&--r;var h=new Date(1900,0,1);h.setDate(h.getDate()+r-1),o=[h.getFullYear(),h.getMonth()+1,h.getDate()],s=h.getDay(),r<60&&(s=(s+6)%7),t&&(s=HT(h,o))}return u.y=o[0],u.m=o[1],u.d=o[2],u.S=a%60,a=Math.floor(a/60),u.M=a%60,a=Math.floor(a/60),u.H=a,u.q=s,u}function ap(i){return i.indexOf(".")==-1?i:i.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function NT(i){return i.indexOf("E")==-1?i:i.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function BT(i){var e=i<0?12:11,t=ap(i.toFixed(12));return t.length<=e||(t=i.toPrecision(10),t.length<=e)?t:i.toExponential(5)}function zT(i){var e=ap(i.toFixed(11));return e.length>(i<0?12:11)||e==="0"||e==="-0"?i.toPrecision(6):e}function Ko(i){if(!isFinite(i))return isNaN(i)?"#NUM!":"#DIV/0!";var e=Math.floor(Math.log(Math.abs(i))*Math.LOG10E),t;return e>=-4&&e<=-1?t=i.toPrecision(10+e):Math.abs(e)<=9?t=BT(i):e===10?t=i.toFixed(10).substr(0,12):t=zT(i),ap(NT(t.toUpperCase()))}function ms(i,e){switch(typeof i){case"string":return i;case"boolean":return i?"TRUE":"FALSE";case"number":return(i|0)===i?i.toString(10):Ko(i);case"undefined":return"";case"object":if(i==null)return"";if(i instanceof Date)return Er(14,xi(i,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+i)}function HT(i,e){e[0]-=581;var t=i.getDay();return i<60&&(t=(t+6)%7),t}function PT(i,e,t,r){var a="",s=0,o=0,u=t.y,h,d=0;switch(i){case 98:u=t.y+543;case 121:switch(e.length){case 1:case 2:h=u%100,d=2;break;default:h=u%1e4,d=4;break}break;case 109:switch(e.length){case 1:case 2:h=t.m,d=e.length;break;case 3:return Vd[t.m-1][1];case 5:return Vd[t.m-1][0];default:return Vd[t.m-1][2]}break;case 100:switch(e.length){case 1:case 2:h=t.d,d=e.length;break;case 3:return D1[t.q][0];default:return D1[t.q][1]}break;case 104:switch(e.length){case 1:case 2:h=1+(t.H+11)%12,d=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:h=t.H,d=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:h=t.M,d=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return t.u===0&&(e=="s"||e=="ss")?ea(t.S,e.length):(r>=2?o=r===3?1e3:100:o=r===1?10:1,s=Math.round(o*(t.S+t.u)),s>=60*o&&(s=0),e==="s"?s===0?"0":""+s/o:(a=ea(s,2+r),e==="ss"?a.substr(0,2):"."+a.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":h=t.D*24+t.H;break;case"[m]":case"[mm]":h=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":h=((t.D*24+t.H)*60+t.M)*60+(r==0?Math.round(t.S+t.u):t.S);break;default:throw"bad abstime format: "+e}d=e.length===3?1:2;break;case 101:h=u,d=1;break}var p=d>0?ea(h,d):"";return p}function La(i){var e=3;if(i.length<=e)return i;for(var t=i.length%e,r=i.substr(0,t);t!=i.length;t+=e)r+=(r.length>0?",":"")+i.substr(t,e);return r}var Ex=/%/g;function IT(i,e,t){var r=e.replace(Ex,""),a=e.length-r.length;return za(i,r,t*Math.pow(10,2*a))+Ct("%",a)}function UT(i,e,t){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return za(i,e.substr(0,r),t/Math.pow(10,3*(e.length-r)))}function Cx(i,e){var t,r=i.indexOf("E")-i.indexOf(".")-1;if(i.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+Cx(i,-e);var a=i.indexOf(".");a===-1&&(a=i.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%a;if(s<0&&(s+=a),t=(e/Math.pow(10,s)).toPrecision(r+1+(a+s)%a),t.indexOf("e")===-1){var o=Math.floor(Math.log(e)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(o-t.length+s):t+="E+"+(o-s);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,a)+"."+t.substr(2+a),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,h,d,p){return h+d+p.substr(0,(a+s)%a)+"."+p.substr(s)+"E"})}else t=e.toExponential(r);return i.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),i.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var Tx=/# (\?+)( ?)\/( ?)(\d+)/;function VT(i,e,t){var r=parseInt(i[4],10),a=Math.round(e*r),s=Math.floor(a/r),o=a-s*r,u=r;return t+(s===0?"":""+s)+" "+(o===0?Ct(" ",i[1].length+1+i[4].length):rp(o,i[1].length)+i[2]+"/"+i[3]+ea(u,i[4].length))}function GT(i,e,t){return t+(e===0?"":""+e)+Ct(" ",i[1].length+2+i[4].length)}var _x=/^#*0*\.([0#]+)/,Sx=/\)[^)]*[0#]/,Rx=/\(###\) ###\\?-####/;function Zi(i){for(var e="",t,r=0;r!=i.length;++r)switch(t=i.charCodeAt(r)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(t)}return e}function M1(i,e){var t=Math.pow(10,e);return""+Math.round(i*t)/t}function O1(i,e){var t=i-Math.floor(i),r=Math.pow(10,e);return e<(""+Math.round(t*r)).length?0:Math.round(t*r)}function WT(i,e){return e<(""+Math.round((i-Math.floor(i))*Math.pow(10,e))).length?1:0}function jT(i){return i<2147483647&&i>-2147483648?""+(i>=0?i|0:i-1|0):""+Math.floor(i)}function Br(i,e,t){if(i.charCodeAt(0)===40&&!e.match(Sx)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Br("n",r,t):"("+Br("n",r,-t)+")"}if(e.charCodeAt(e.length-1)===44)return UT(i,e,t);if(e.indexOf("%")!==-1)return IT(i,e,t);if(e.indexOf("E")!==-1)return Cx(e,t);if(e.charCodeAt(0)===36)return"$"+Br(i,e.substr(e.charAt(1)==" "?2:1),t);var a,s,o,u,h=Math.abs(t),d=t<0?"-":"";if(e.match(/^00+$/))return d+il(h,e.length);if(e.match(/^[#?]+$/))return a=il(t,0),a==="0"&&(a=""),a.length>e.length?a:Zi(e.substr(0,e.length-a.length))+a;if(s=e.match(Tx))return VT(s,h,d);if(e.match(/^#+0+$/))return d+il(h,e.length-e.indexOf("0"));if(s=e.match(_x))return a=M1(t,s[1].length).replace(/^([^\.]+)$/,"$1."+Zi(s[1])).replace(/\.$/,"."+Zi(s[1])).replace(/\.(\d*)$/,function(y,C){return"."+C+Ct("0",Zi(s[1]).length-C.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return d+M1(h,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return d+La(il(h,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Br(i,e,-t):La(""+(Math.floor(t)+WT(t,s[1].length)))+"."+ea(O1(t,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return Br(i,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=fl(Br(i,e.replace(/[\\-]/g,""),t)),o=0,fl(fl(e.replace(/\\/g,"")).replace(/[0#]/g,function(y){return o<a.length?a.charAt(o++):y==="0"?"0":""}));if(e.match(Rx))return a=Br(i,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var p="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),u=Xc(h,Math.pow(10,o)-1,!1),a=""+d,p=za("n",s[1],u[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),a+=p+s[2]+"/"+s[3],p=Wc(u[2],o),p.length<s[4].length&&(p=Zi(s[4].substr(s[4].length-p.length))+p),a+=p,a;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),u=Xc(h,Math.pow(10,o)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?rp(u[1],o)+s[2]+"/"+s[3]+Wc(u[2],o):Ct(" ",2*o+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return a=il(t,0),e.length<=a.length?a:Zi(e.substr(0,e.length-a.length))+a;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var b=e.indexOf(".")-o,g=e.length-a.length-b;return Zi(e.substr(0,b)+a+e.substr(e.length-g))}if(s=e.match(/^00,000\.([#0]*0)$/))return o=O1(t,s[1].length),t<0?"-"+Br(i,e,-t):La(jT(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?ea(0,3-y.length):"")+y})+"."+ea(o,s[1].length);switch(e){case"###,##0.00":return Br(i,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var v=La(il(h,0));return v!=="0"?d+v:"";case"###,###.00":return Br(i,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return Br(i,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function XT(i,e,t){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return za(i,e.substr(0,r),t/Math.pow(10,3*(e.length-r)))}function YT(i,e,t){var r=e.replace(Ex,""),a=e.length-r.length;return za(i,r,t*Math.pow(10,2*a))+Ct("%",a)}function kx(i,e){var t,r=i.indexOf("E")-i.indexOf(".")-1;if(i.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+kx(i,-e);var a=i.indexOf(".");a===-1&&(a=i.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%a;if(s<0&&(s+=a),t=(e/Math.pow(10,s)).toPrecision(r+1+(a+s)%a),!t.match(/[Ee]/)){var o=Math.floor(Math.log(e)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(o-t.length+s):t+="E+"+(o-s),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,h,d,p){return h+d+p.substr(0,(a+s)%a)+"."+p.substr(s)+"E"})}else t=e.toExponential(r);return i.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),i.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function ua(i,e,t){if(i.charCodeAt(0)===40&&!e.match(Sx)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?ua("n",r,t):"("+ua("n",r,-t)+")"}if(e.charCodeAt(e.length-1)===44)return XT(i,e,t);if(e.indexOf("%")!==-1)return YT(i,e,t);if(e.indexOf("E")!==-1)return kx(e,t);if(e.charCodeAt(0)===36)return"$"+ua(i,e.substr(e.charAt(1)==" "?2:1),t);var a,s,o,u,h=Math.abs(t),d=t<0?"-":"";if(e.match(/^00+$/))return d+ea(h,e.length);if(e.match(/^[#?]+$/))return a=""+t,t===0&&(a=""),a.length>e.length?a:Zi(e.substr(0,e.length-a.length))+a;if(s=e.match(Tx))return GT(s,h,d);if(e.match(/^#+0+$/))return d+ea(h,e.length-e.indexOf("0"));if(s=e.match(_x))return a=(""+t).replace(/^([^\.]+)$/,"$1."+Zi(s[1])).replace(/\.$/,"."+Zi(s[1])),a=a.replace(/\.(\d*)$/,function(y,C){return"."+C+Ct("0",Zi(s[1]).length-C.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return d+(""+h).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return d+La(""+h);if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+ua(i,e,-t):La(""+t)+"."+Ct("0",s[1].length);if(s=e.match(/^#,#*,#0/))return ua(i,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=fl(ua(i,e.replace(/[\\-]/g,""),t)),o=0,fl(fl(e.replace(/\\/g,"")).replace(/[0#]/g,function(y){return o<a.length?a.charAt(o++):y==="0"?"0":""}));if(e.match(Rx))return a=ua(i,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var p="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),u=Xc(h,Math.pow(10,o)-1,!1),a=""+d,p=za("n",s[1],u[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),a+=p+s[2]+"/"+s[3],p=Wc(u[2],o),p.length<s[4].length&&(p=Zi(s[4].substr(s[4].length-p.length))+p),a+=p,a;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),u=Xc(h,Math.pow(10,o)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?rp(u[1],o)+s[2]+"/"+s[3]+Wc(u[2],o):Ct(" ",2*o+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return a=""+t,e.length<=a.length?a:Zi(e.substr(0,e.length-a.length))+a;if(s=e.match(/^([#0]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var b=e.indexOf(".")-o,g=e.length-a.length-b;return Zi(e.substr(0,b)+a+e.substr(e.length-g))}if(s=e.match(/^00,000\.([#0]*0)$/))return t<0?"-"+ua(i,e,-t):La(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?ea(0,3-y.length):"")+y})+"."+ea(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var v=La(""+h);return v!=="0"?d+v:"";default:if(e.match(/\.[0#?]*$/))return ua(i,e.slice(0,e.lastIndexOf(".")),t)+Zi(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function za(i,e,t){return(t|0)===t?ua(i,e,t):Br(i,e,t)}function qT(i){for(var e=[],t=!1,r=0,a=0;r<i.length;++r)switch(i.charCodeAt(r)){case 34:t=!t;break;case 95:case 42:case 92:++r;break;case 59:e[e.length]=i.substr(a,r-a),a=r+1}if(e[e.length]=i.substr(a),t===!0)throw new Error("Format |"+i+"| unterminated string ");return e}var Ax=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function ta(i){for(var e=0,t="",r="";e<i.length;)switch(t=i.charAt(e)){case"G":jc(i,e)&&(e+=6),e++;break;case'"':for(;i.charCodeAt(++e)!==34&&e<i.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(i.charAt(e+1)==="1"||i.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(i.substr(e,3).toUpperCase()==="A/P"||i.substr(e,5).toUpperCase()==="AM/PM"||i.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(r=t;i.charAt(e++)!=="]"&&e<i.length;)r+=i.charAt(e);if(r.match(Ax))return!0;break;case".":case"0":case"#":for(;e<i.length&&("0#?.,E+-%".indexOf(t=i.charAt(++e))>-1||t=="\\"&&i.charAt(e+1)=="-"&&"0#".indexOf(i.charAt(e+2))>-1););break;case"?":for(;i.charAt(++e)===t;);break;case"*":++e,(i.charAt(e)==" "||i.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<i.length&&"0123456789".indexOf(i.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function KT(i,e,t,r){for(var a=[],s="",o=0,u="",h="t",d,p,b,g="H";o<i.length;)switch(u=i.charAt(o)){case"G":if(!jc(i,o))throw new Error("unrecognized character "+u+" in "+i);a[a.length]={t:"G",v:"General"},o+=7;break;case'"':for(s="";(b=i.charCodeAt(++o))!==34&&o<i.length;)s+=String.fromCharCode(b);a[a.length]={t:"t",v:s},++o;break;case"\\":var v=i.charAt(++o),y=v==="("||v===")"?v:"t";a[a.length]={t:y,v},++o;break;case"_":a[a.length]={t:"t",v:" "},o+=2;break;case"@":a[a.length]={t:"T",v:e},++o;break;case"B":case"b":if(i.charAt(o+1)==="1"||i.charAt(o+1)==="2"){if(d==null&&(d=Oa(e,t,i.charAt(o+1)==="2"),d==null))return"";a[a.length]={t:"X",v:i.substr(o,2)},h=u,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||d==null&&(d=Oa(e,t),d==null))return"";for(s=u;++o<i.length&&i.charAt(o).toLowerCase()===u;)s+=u;u==="m"&&h.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=g),a[a.length]={t:u,v:s},h=u;break;case"A":case"a":case"":var C={t:u,v:u};if(d==null&&(d=Oa(e,t)),i.substr(o,3).toUpperCase()==="A/P"?(d!=null&&(C.v=d.H>=12?i.charAt(o+2):u),C.t="T",g="h",o+=3):i.substr(o,5).toUpperCase()==="AM/PM"?(d!=null&&(C.v=d.H>=12?"PM":"AM"),C.t="T",o+=5,g="h"):i.substr(o,5).toUpperCase()==="/"?(d!=null&&(C.v=d.H>=12?"":""),C.t="T",o+=5,g="h"):(C.t="t",++o),d==null&&C.t==="T")return"";a[a.length]=C,h=u;break;case"[":for(s=u;i.charAt(o++)!=="]"&&o<i.length;)s+=i.charAt(o);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(Ax)){if(d==null&&(d=Oa(e,t),d==null))return"";a[a.length]={t:"Z",v:s.toLowerCase()},h=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",ta(i)||(a[a.length]={t:"t",v:s}));break;case".":if(d!=null){for(s=u;++o<i.length&&(u=i.charAt(o))==="0";)s+=u;a[a.length]={t:"s",v:s};break}case"0":case"#":for(s=u;++o<i.length&&"0#?.,E+-%".indexOf(u=i.charAt(o))>-1;)s+=u;a[a.length]={t:"n",v:s};break;case"?":for(s=u;i.charAt(++o)===u;)s+=u;a[a.length]={t:u,v:s},h=u;break;case"*":++o,(i.charAt(o)==" "||i.charAt(o)=="*")&&++o;break;case"(":case")":a[a.length]={t:r===1?"t":u,v:u},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=u;o<i.length&&"0123456789".indexOf(i.charAt(++o))>-1;)s+=i.charAt(o);a[a.length]={t:"D",v:s};break;case" ":a[a.length]={t:u,v:u},++o;break;case"$":a[a.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+i);a[a.length]={t:"t",v:u},++o;break}var E=0,w=0,R;for(o=a.length-1,h="t";o>=0;--o)switch(a[o].t){case"h":case"H":a[o].t=g,h="h",E<1&&(E=1);break;case"s":(R=a[o].v.match(/\.0+$/))&&(w=Math.max(w,R[0].length-1),E=4),E<3&&(E=3);case"d":case"y":case"e":h=a[o].t;break;case"M":h=a[o].t,E<2&&(E=2);break;case"m":h==="s"&&(a[o].t="M",E<2&&(E=2));break;case"X":break;case"Z":E<1&&a[o].v.match(/[Hh]/)&&(E=1),E<2&&a[o].v.match(/[Mm]/)&&(E=2),E<3&&a[o].v.match(/[Ss]/)&&(E=3)}var T;switch(E){case 0:break;case 1:case 2:case 3:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H),d.H>=24&&(d.H=0,++d.D,T=Oa(d.D),T.u=d.u,T.S=d.S,T.M=d.M,T.H=d.H,d=T);break;case 4:switch(w){case 1:d.u=Math.round(d.u*10)/10;break;case 2:d.u=Math.round(d.u*100)/100;break;case 3:d.u=Math.round(d.u*1e3)/1e3;break}d.u>=1&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H),d.H>=24&&(d.H=0,++d.D,T=Oa(d.D),T.u=d.u,T.S=d.S,T.M=d.M,T.H=d.H,d=T);break}var D="",k;for(o=0;o<a.length;++o)switch(a[o].t){case"t":case"T":case" ":case"D":break;case"X":a[o].v="",a[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[o].v=PT(a[o].t.charCodeAt(0),a[o].v,d,w),a[o].t="t";break;case"n":case"?":for(k=o+1;a[k]!=null&&((u=a[k].t)==="?"||u==="D"||(u===" "||u==="t")&&a[k+1]!=null&&(a[k+1].t==="?"||a[k+1].t==="t"&&a[k+1].v==="/")||a[o].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(a[k].v==="/"||a[k].v===" "&&a[k+1]!=null&&a[k+1].t=="?"));)a[o].v+=a[k].v,a[k]={v:"",t:";"},++k;D+=a[o].v,o=k-1;break;case"G":a[o].t="t",a[o].v=ms(e,t);break}var V="",P,U;if(D.length>0){D.charCodeAt(0)==40?(P=e<0&&D.charCodeAt(0)===45?-e:e,U=za("n",D,P)):(P=e<0&&r>1?-e:e,U=za("n",D,P),P<0&&a[0]&&a[0].t=="t"&&(U=U.substr(1),a[0].v="-"+a[0].v)),k=U.length-1;var N=a.length;for(o=0;o<a.length;++o)if(a[o]!=null&&a[o].t!="t"&&a[o].v.indexOf(".")>-1){N=o;break}var j=a.length;if(N===a.length&&U.indexOf("E")===-1){for(o=a.length-1;o>=0;--o)a[o]==null||"n?".indexOf(a[o].t)===-1||(k>=a[o].v.length-1?(k-=a[o].v.length,a[o].v=U.substr(k+1,a[o].v.length)):k<0?a[o].v="":(a[o].v=U.substr(0,k+1),k=-1),a[o].t="t",j=o);k>=0&&j<a.length&&(a[j].v=U.substr(0,k+1)+a[j].v)}else if(N!==a.length&&U.indexOf("E")===-1){for(k=U.indexOf(".")-1,o=N;o>=0;--o)if(!(a[o]==null||"n?".indexOf(a[o].t)===-1)){for(p=a[o].v.indexOf(".")>-1&&o===N?a[o].v.indexOf(".")-1:a[o].v.length-1,V=a[o].v.substr(p+1);p>=0;--p)k>=0&&(a[o].v.charAt(p)==="0"||a[o].v.charAt(p)==="#")&&(V=U.charAt(k--)+V);a[o].v=V,a[o].t="t",j=o}for(k>=0&&j<a.length&&(a[j].v=U.substr(0,k+1)+a[j].v),k=U.indexOf(".")+1,o=N;o<a.length;++o)if(!(a[o]==null||"n?(".indexOf(a[o].t)===-1&&o!==N)){for(p=a[o].v.indexOf(".")>-1&&o===N?a[o].v.indexOf(".")+1:0,V=a[o].v.substr(0,p);p<a[o].v.length;++p)k<U.length&&(V+=U.charAt(k++));a[o].v=V,a[o].t="t",j=o}}}for(o=0;o<a.length;++o)a[o]!=null&&"n?".indexOf(a[o].t)>-1&&(P=r>1&&e<0&&o>0&&a[o-1].v==="-"?-e:e,a[o].v=za(a[o].t,a[o].v,P),a[o].t="t");var Y="";for(o=0;o!==a.length;++o)a[o]!=null&&(Y+=a[o].v);return Y}var L1=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function N1(i,e){if(e==null)return!1;var t=parseFloat(e[2]);switch(e[1]){case"=":if(i==t)return!0;break;case">":if(i>t)return!0;break;case"<":if(i<t)return!0;break;case"<>":if(i!=t)return!0;break;case">=":if(i>=t)return!0;break;case"<=":if(i<=t)return!0;break}return!1}function $T(i,e){var t=qT(i),r=t.length,a=t[r-1].indexOf("@");if(r<4&&a>-1&&--r,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof e!="number")return[4,t.length===4||a>-1?t[t.length-1]:"@"];switch(typeof e=="number"&&!isFinite(e)&&(e=0),t.length){case 1:t=a>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=a>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=a>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var s=e>0?t[0]:e<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[r,s];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var o=t[0].match(L1),u=t[1].match(L1);return N1(e,o)?[r,t[0]]:N1(e,u)?[r,t[1]]:[r,t[o!=null&&u!=null?2:1]]}return[r,s]}function Er(i,e,t){t==null&&(t={});var r="";switch(typeof i){case"string":i=="m/d/yy"&&t.dateNF?r=t.dateNF:r=i;break;case"number":i==14&&t.dateNF?r=t.dateNF:r=(t.table!=null?t.table:st)[i],r==null&&(r=t.table&&t.table[F1[i]]||st[F1[i]]),r==null&&(r=OT[i]||"General");break}if(jc(r,0))return ms(e,t);e instanceof Date&&(e=xi(e,t.date1904));var a=$T(r,e);if(jc(a[1]))return ms(e,t);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else{if(e===""||e==null)return"";if(isNaN(e)&&a[1].indexOf("0")>-1)return"#NUM!";if(!isFinite(e)&&a[1].indexOf("0")>-1)return"#DIV/0!"}return KT(a[1],e,t,a[0])}function ZT(i,e){if(typeof e!="number"){e=+e||-1;for(var t=0;t<392;++t){if(st[t]==null){e<0&&(e=t);continue}if(st[t]==i){e=t;break}}e<0&&(e=391)}return st[e]=i,e}function Dx(){st=MT()}var QT={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Yc=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function JT(i){var e=typeof i=="number"?st[i]:i;return e=e.replace(Yc,"(\\d+)"),Yc.lastIndex=0,new RegExp("^"+e+"$")}function e_(i,e,t){var r=-1,a=-1,s=-1,o=-1,u=-1,h=-1;(e.match(Yc)||[]).forEach(function(b,g){var v=parseInt(t[g+1],10);switch(b.toLowerCase().charAt(0)){case"y":r=v;break;case"d":s=v;break;case"h":o=v;break;case"s":h=v;break;case"m":o>=0?u=v:a=v;break}}),Yc.lastIndex=0,h>=0&&u==-1&&a>=0&&(u=a,a=-1);var d=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var p=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(h>=0?h:0)).slice(-2);return o==-1&&u==-1&&h==-1?d:r==-1&&a==-1&&s==-1?p:d+"T"+p}var t_={"d.m":"d\\.m"};function os(i,e){return ZT(t_[i]||i,e)}var B1=function(){var i={};i.version="1.2.0";function e(){for(var P=0,U=new Array(256),N=0;N!=256;++N)P=N,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,U[N]=P;return typeof Int32Array<"u"?new Int32Array(U):U}var t=e();function r(P){var U=0,N=0,j=0,Y=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(j=0;j!=256;++j)Y[j]=P[j];for(j=0;j!=256;++j)for(N=P[j],U=256+j;U<4096;U+=256)N=Y[U]=N>>>8^P[N&255];var Z=[];for(j=1;j!=16;++j)Z[j-1]=typeof Int32Array<"u"&&typeof Y.subarray=="function"?Y.subarray(j*256,j*256+256):Y.slice(j*256,j*256+256);return Z}var a=r(t),s=a[0],o=a[1],u=a[2],h=a[3],d=a[4],p=a[5],b=a[6],g=a[7],v=a[8],y=a[9],C=a[10],E=a[11],w=a[12],R=a[13],T=a[14];function D(P,U){for(var N=U^-1,j=0,Y=P.length;j<Y;)N=N>>>8^t[(N^P.charCodeAt(j++))&255];return~N}function k(P,U){for(var N=U^-1,j=P.length-15,Y=0;Y<j;)N=T[P[Y++]^N&255]^R[P[Y++]^N>>8&255]^w[P[Y++]^N>>16&255]^E[P[Y++]^N>>>24]^C[P[Y++]]^y[P[Y++]]^v[P[Y++]]^g[P[Y++]]^b[P[Y++]]^p[P[Y++]]^d[P[Y++]]^h[P[Y++]]^u[P[Y++]]^o[P[Y++]]^s[P[Y++]]^t[P[Y++]];for(j+=15;Y<j;)N=N>>>8^t[(N^P[Y++])&255];return~N}function V(P,U){for(var N=U^-1,j=0,Y=P.length,Z=0,ce=0;j<Y;)Z=P.charCodeAt(j++),Z<128?N=N>>>8^t[(N^Z)&255]:Z<2048?(N=N>>>8^t[(N^(192|Z>>6&31))&255],N=N>>>8^t[(N^(128|Z&63))&255]):Z>=55296&&Z<57344?(Z=(Z&1023)+64,ce=P.charCodeAt(j++)&1023,N=N>>>8^t[(N^(240|Z>>8&7))&255],N=N>>>8^t[(N^(128|Z>>2&63))&255],N=N>>>8^t[(N^(128|ce>>6&15|(Z&3)<<4))&255],N=N>>>8^t[(N^(128|ce&63))&255]):(N=N>>>8^t[(N^(224|Z>>12&15))&255],N=N>>>8^t[(N^(128|Z>>6&63))&255],N=N>>>8^t[(N^(128|Z&63))&255]);return~N}return i.table=t,i.bstr=D,i.buf=k,i.str=V,i}(),Tt=function(){var e={};e.version="1.2.2";function t(S,L){for(var A=S.split("/"),M=L.split("/"),B=0,I=0,te=Math.min(A.length,M.length);B<te;++B){if(I=A[B].length-M[B].length)return I;if(A[B]!=M[B])return A[B]<M[B]?-1:1}return A.length-M.length}function r(S){if(S.charAt(S.length-1)=="/")return S.slice(0,-1).indexOf("/")===-1?S:r(S.slice(0,-1));var L=S.lastIndexOf("/");return L===-1?S:S.slice(0,L+1)}function a(S){if(S.charAt(S.length-1)=="/")return a(S.slice(0,-1));var L=S.lastIndexOf("/");return L===-1?S:S.slice(L+1)}function s(S,L){typeof L=="string"&&(L=new Date(L));var A=L.getHours();A=A<<6|L.getMinutes(),A=A<<5|L.getSeconds()>>>1,S.write_shift(2,A);var M=L.getFullYear()-1980;M=M<<4|L.getMonth()+1,M=M<<5|L.getDate(),S.write_shift(2,M)}function o(S){var L=S.read_shift(2)&65535,A=S.read_shift(2)&65535,M=new Date,B=A&31;A>>>=5;var I=A&15;A>>>=4,M.setMilliseconds(0),M.setFullYear(A+1980),M.setMonth(I-1),M.setDate(B);var te=L&31;L>>>=5;var oe=L&63;return L>>>=6,M.setHours(L),M.setMinutes(oe),M.setSeconds(te<<1),M}function u(S){bi(S,0);for(var L={},A=0;S.l<=S.length-4;){var M=S.read_shift(2),B=S.read_shift(2),I=S.l+B,te={};switch(M){case 21589:A=S.read_shift(1),A&1&&(te.mtime=S.read_shift(4)),B>5&&(A&2&&(te.atime=S.read_shift(4)),A&4&&(te.ctime=S.read_shift(4))),te.mtime&&(te.mt=new Date(te.mtime*1e3));break;case 1:{var oe=S.read_shift(4),ee=S.read_shift(4);te.usz=ee*Math.pow(2,32)+oe,oe=S.read_shift(4),ee=S.read_shift(4),te.csz=ee*Math.pow(2,32)+oe}break}S.l=I,L[M]=te}return L}var h;function d(){return h||(h=i_)}function p(S,L){if(S[0]==80&&S[1]==75)return Ln(S,L);if((S[0]|32)==109&&(S[1]|32)==105)return fe(S,L);if(S.length<512)throw new Error("CFB file size "+S.length+" < 512");var A=3,M=512,B=0,I=0,te=0,oe=0,ee=0,ae=[],se=S.slice(0,512);bi(se,0);var Ce=b(se);switch(A=Ce[0],A){case 3:M=512;break;case 4:M=4096;break;case 0:if(Ce[1]==0)return Ln(S,L);default:throw new Error("Major Version: Expected 3 or 4 saw "+A)}M!==512&&(se=S.slice(0,M),bi(se,28));var ke=S.slice(0,M);g(se,A);var Pe=se.read_shift(4,"i");if(A===3&&Pe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Pe);se.l+=4,te=se.read_shift(4,"i"),se.l+=4,se.chk("00100000","Mini Stream Cutoff Size: "),oe=se.read_shift(4,"i"),B=se.read_shift(4,"i"),ee=se.read_shift(4,"i"),I=se.read_shift(4,"i");for(var Se=-1,Te=0;Te<109&&(Se=se.read_shift(4,"i"),!(Se<0));++Te)ae[Te]=Se;var it=v(S,M);E(ee,I,it,M,ae);var Ft=R(it,te,ae,M);te<Ft.length&&(Ft[te].name="!Directory"),B>0&&oe!==ce&&(Ft[oe].name="!MiniFAT"),Ft[ae[0]].name="!FAT",Ft.fat_addrs=ae,Ft.ssz=M;var Ze={},ut=[],li=[],lr=[];T(te,Ft,it,ut,B,Ze,li,oe),y(li,lr,ut),ut.shift();var Ht={FileIndex:li,FullPaths:lr};return L&&L.raw&&(Ht.raw={header:ke,sectors:it}),Ht}function b(S){if(S[S.l]==80&&S[S.l+1]==75)return[0,0];S.chk(Le,"Header Signature: "),S.l+=16;var L=S.read_shift(2,"u");return[S.read_shift(2,"u"),L]}function g(S,L){var A=9;switch(S.l+=2,A=S.read_shift(2)){case 9:if(L!=3)throw new Error("Sector Shift: Expected 9 saw "+A);break;case 12:if(L!=4)throw new Error("Sector Shift: Expected 12 saw "+A);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+A)}S.chk("0600","Mini Sector Shift: "),S.chk("000000000000","Reserved: ")}function v(S,L){for(var A=Math.ceil(S.length/L)-1,M=[],B=1;B<A;++B)M[B-1]=S.slice(B*L,(B+1)*L);return M[A-1]=S.slice(A*L),M}function y(S,L,A){for(var M=0,B=0,I=0,te=0,oe=0,ee=A.length,ae=[],se=[];M<ee;++M)ae[M]=se[M]=M,L[M]=A[M];for(;oe<se.length;++oe)M=se[oe],B=S[M].L,I=S[M].R,te=S[M].C,ae[M]===M&&(B!==-1&&ae[B]!==B&&(ae[M]=ae[B]),I!==-1&&ae[I]!==I&&(ae[M]=ae[I])),te!==-1&&(ae[te]=M),B!==-1&&M!=ae[M]&&(ae[B]=ae[M],se.lastIndexOf(B)<oe&&se.push(B)),I!==-1&&M!=ae[M]&&(ae[I]=ae[M],se.lastIndexOf(I)<oe&&se.push(I));for(M=1;M<ee;++M)ae[M]===M&&(I!==-1&&ae[I]!==I?ae[M]=ae[I]:B!==-1&&ae[B]!==B&&(ae[M]=ae[B]));for(M=1;M<ee;++M)if(S[M].type!==0){if(oe=M,oe!=ae[oe])do oe=ae[oe],L[M]=L[oe]+"/"+L[M];while(oe!==0&&ae[oe]!==-1&&oe!=ae[oe]);ae[M]=-1}for(L[0]+="/",M=1;M<ee;++M)S[M].type!==2&&(L[M]+="/")}function C(S,L,A){for(var M=S.start,B=S.size,I=[],te=M;A&&B>0&&te>=0;)I.push(L.slice(te*Z,te*Z+Z)),B-=Z,te=is(A,te*4);return I.length===0?pi(0):yn(I).slice(0,S.size)}function E(S,L,A,M,B){var I=ce;if(S===ce){if(L!==0)throw new Error("DIFAT chain shorter than expected")}else if(S!==-1){var te=A[S],oe=(M>>>2)-1;if(!te)return;for(var ee=0;ee<oe&&(I=is(te,ee*4))!==ce;++ee)B.push(I);L>=1&&E(is(te,M-4),L-1,A,M,B)}}function w(S,L,A,M,B){var I=[],te=[];B||(B=[]);var oe=M-1,ee=0,ae=0;for(ee=L;ee>=0;){B[ee]=!0,I[I.length]=ee,te.push(S[ee]);var se=A[Math.floor(ee*4/M)];if(ae=ee*4&oe,M<4+ae)throw new Error("FAT boundary crossed: "+ee+" 4 "+M);if(!S[se])break;ee=is(S[se],ae)}return{nodes:I,data:W1([te])}}function R(S,L,A,M){var B=S.length,I=[],te=[],oe=[],ee=[],ae=M-1,se=0,Ce=0,ke=0,Pe=0;for(se=0;se<B;++se)if(oe=[],ke=se+L,ke>=B&&(ke-=B),!te[ke]){ee=[];var Se=[];for(Ce=ke;Ce>=0;){Se[Ce]=!0,te[Ce]=!0,oe[oe.length]=Ce,ee.push(S[Ce]);var Te=A[Math.floor(Ce*4/M)];if(Pe=Ce*4&ae,M<4+Pe)throw new Error("FAT boundary crossed: "+Ce+" 4 "+M);if(!S[Te]||(Ce=is(S[Te],Pe),Se[Ce]))break}I[ke]={nodes:oe,data:W1([ee])}}return I}function T(S,L,A,M,B,I,te,oe){for(var ee=0,ae=M.length?2:0,se=L[S].data,Ce=0,ke=0,Pe;Ce<se.length;Ce+=128){var Se=se.slice(Ce,Ce+128);bi(Se,64),ke=Se.read_shift(2),Pe=up(Se,0,ke-ae),M.push(Pe);var Te={name:Pe,type:Se.read_shift(1),color:Se.read_shift(1),L:Se.read_shift(4,"i"),R:Se.read_shift(4,"i"),C:Se.read_shift(4,"i"),clsid:Se.read_shift(16),state:Se.read_shift(4,"i"),start:0,size:0},it=Se.read_shift(2)+Se.read_shift(2)+Se.read_shift(2)+Se.read_shift(2);it!==0&&(Te.ct=D(Se,Se.l-8));var Ft=Se.read_shift(2)+Se.read_shift(2)+Se.read_shift(2)+Se.read_shift(2);Ft!==0&&(Te.mt=D(Se,Se.l-8)),Te.start=Se.read_shift(4,"i"),Te.size=Se.read_shift(4,"i"),Te.size<0&&Te.start<0&&(Te.size=Te.type=0,Te.start=ce,Te.name=""),Te.type===5?(ee=Te.start,B>0&&ee!==ce&&(L[ee].name="!StreamData")):Te.size>=4096?(Te.storage="fat",L[Te.start]===void 0&&(L[Te.start]=w(A,Te.start,L.fat_addrs,L.ssz)),L[Te.start].name=Te.name,Te.content=L[Te.start].data.slice(0,Te.size)):(Te.storage="minifat",Te.size<0?Te.size=0:ee!==ce&&Te.start!==ce&&L[ee]&&(Te.content=C(Te,L[ee].data,(L[oe]||{}).data))),Te.content&&bi(Te.content,0),I[Pe]=Te,te.push(Te)}}function D(S,L){return new Date((vr(S,L+4)/1e7*Math.pow(2,32)+vr(S,L)/1e7-11644473600)*1e3)}function k(S,L){return d(),p(h.readFileSync(S),L)}function V(S,L){var A=L&&L.type;switch(A||gt&&Buffer.isBuffer(S)&&(A="buffer"),A||"base64"){case"file":return k(S,L);case"base64":return p(gr(yr(S)),L);case"binary":return p(gr(S),L)}return p(S,L)}function P(S,L){var A=L||{},M=A.root||"Root Entry";if(S.FullPaths||(S.FullPaths=[]),S.FileIndex||(S.FileIndex=[]),S.FullPaths.length!==S.FileIndex.length)throw new Error("inconsistent CFB structure");S.FullPaths.length===0&&(S.FullPaths[0]=M+"/",S.FileIndex[0]={name:M,type:5}),A.CLSID&&(S.FileIndex[0].clsid=A.CLSID),U(S)}function U(S){var L="Sh33tJ5";if(!Tt.find(S,"/"+L)){var A=pi(4);A[0]=55,A[1]=A[3]=50,A[2]=54,S.FileIndex.push({name:L,type:2,content:A,size:4,L:69,R:69,C:69}),S.FullPaths.push(S.FullPaths[0]+L),N(S)}}function N(S,L){P(S);for(var A=!1,M=!1,B=S.FullPaths.length-1;B>=0;--B){var I=S.FileIndex[B];switch(I.type){case 0:M?A=!0:(S.FileIndex.pop(),S.FullPaths.pop());break;case 1:case 2:case 5:M=!0,isNaN(I.R*I.L*I.C)&&(A=!0),I.R>-1&&I.L>-1&&I.R==I.L&&(A=!0);break;default:A=!0;break}}if(!(!A&&!L)){var te=new Date(1987,1,19),oe=0,ee=Object.create?Object.create(null):{},ae=[];for(B=0;B<S.FullPaths.length;++B)ee[S.FullPaths[B]]=!0,S.FileIndex[B].type!==0&&ae.push([S.FullPaths[B],S.FileIndex[B]]);for(B=0;B<ae.length;++B){var se=r(ae[B][0]);for(M=ee[se];!M;){for(;r(se)&&!ee[r(se)];)se=r(se);ae.push([se,{name:a(se).replace("/",""),type:1,clsid:me,ct:te,mt:te,content:null}]),ee[se]=!0,se=r(ae[B][0]),M=ee[se]}}for(ae.sort(function(Pe,Se){return t(Pe[0],Se[0])}),S.FullPaths=[],S.FileIndex=[],B=0;B<ae.length;++B)S.FullPaths[B]=ae[B][0],S.FileIndex[B]=ae[B][1];for(B=0;B<ae.length;++B){var Ce=S.FileIndex[B],ke=S.FullPaths[B];if(Ce.name=a(ke).replace("/",""),Ce.L=Ce.R=Ce.C=-(Ce.color=1),Ce.size=Ce.content?Ce.content.length:0,Ce.start=0,Ce.clsid=Ce.clsid||me,B===0)Ce.C=ae.length>1?1:-1,Ce.size=0,Ce.type=5;else if(ke.slice(-1)=="/"){for(oe=B+1;oe<ae.length&&r(S.FullPaths[oe])!=ke;++oe);for(Ce.C=oe>=ae.length?-1:oe,oe=B+1;oe<ae.length&&r(S.FullPaths[oe])!=r(ke);++oe);Ce.R=oe>=ae.length?-1:oe,Ce.type=1}else r(S.FullPaths[B+1]||"")==r(ke)&&(Ce.R=B+1),Ce.type=2}}}function j(S,L){var A=L||{};if(A.fileType=="mad")return Ae(S,A);switch(N(S),A.fileType){case"zip":return da(S,A)}var M=function(Pe){for(var Se=0,Te=0,it=0;it<Pe.FileIndex.length;++it){var Ft=Pe.FileIndex[it];if(Ft.content){var Ze=Ft.content.length;Ze>0&&(Ze<4096?Se+=Ze+63>>6:Te+=Ze+511>>9)}}for(var ut=Pe.FullPaths.length+3>>2,li=Se+7>>3,lr=Se+127>>7,Ht=li+Te+ut+lr,ki=Ht+127>>7,Wa=ki<=109?0:Math.ceil((ki-109)/127);Ht+ki+Wa+127>>7>ki;)Wa=++ki<=109?0:Math.ceil((ki-109)/127);var Hi=[1,Wa,ki,lr,ut,Te,Se,0];return Pe.FileIndex[0].size=Se<<6,Hi[7]=(Pe.FileIndex[0].start=Hi[0]+Hi[1]+Hi[2]+Hi[3]+Hi[4]+Hi[5])+(Hi[6]+7>>3),Hi}(S),B=pi(M[7]<<9),I=0,te=0;{for(I=0;I<8;++I)B.write_shift(1,ge[I]);for(I=0;I<8;++I)B.write_shift(2,0);for(B.write_shift(2,62),B.write_shift(2,3),B.write_shift(2,65534),B.write_shift(2,9),B.write_shift(2,6),I=0;I<3;++I)B.write_shift(2,0);for(B.write_shift(4,0),B.write_shift(4,M[2]),B.write_shift(4,M[0]+M[1]+M[2]+M[3]-1),B.write_shift(4,0),B.write_shift(4,4096),B.write_shift(4,M[3]?M[0]+M[1]+M[2]-1:ce),B.write_shift(4,M[3]),B.write_shift(-4,M[1]?M[0]-1:ce),B.write_shift(4,M[1]),I=0;I<109;++I)B.write_shift(-4,I<M[2]?M[1]+I:-1)}if(M[1])for(te=0;te<M[1];++te){for(;I<236+te*127;++I)B.write_shift(-4,I<M[2]?M[1]+I:-1);B.write_shift(-4,te===M[1]-1?ce:te+1)}var oe=function(Pe){for(te+=Pe;I<te-1;++I)B.write_shift(-4,I+1);Pe&&(++I,B.write_shift(-4,ce))};for(te=I=0,te+=M[1];I<te;++I)B.write_shift(-4,de.DIFSECT);for(te+=M[2];I<te;++I)B.write_shift(-4,de.FATSECT);oe(M[3]),oe(M[4]);for(var ee=0,ae=0,se=S.FileIndex[0];ee<S.FileIndex.length;++ee)se=S.FileIndex[ee],se.content&&(ae=se.content.length,!(ae<4096)&&(se.start=te,oe(ae+511>>9)));for(oe(M[6]+7>>3);B.l&511;)B.write_shift(-4,de.ENDOFCHAIN);for(te=I=0,ee=0;ee<S.FileIndex.length;++ee)se=S.FileIndex[ee],se.content&&(ae=se.content.length,!(!ae||ae>=4096)&&(se.start=te,oe(ae+63>>6)));for(;B.l&511;)B.write_shift(-4,de.ENDOFCHAIN);for(I=0;I<M[4]<<2;++I){var Ce=S.FullPaths[I];if(!Ce||Ce.length===0){for(ee=0;ee<17;++ee)B.write_shift(4,0);for(ee=0;ee<3;++ee)B.write_shift(4,-1);for(ee=0;ee<12;++ee)B.write_shift(4,0);continue}se=S.FileIndex[I],I===0&&(se.start=se.size?se.start-1:ce);var ke=I===0&&A.root||se.name;if(ke.length>31&&(console.error("Name "+ke+" will be truncated to "+ke.slice(0,31)),ke=ke.slice(0,31)),ae=2*(ke.length+1),B.write_shift(64,ke,"utf16le"),B.write_shift(2,ae),B.write_shift(1,se.type),B.write_shift(1,se.color),B.write_shift(-4,se.L),B.write_shift(-4,se.R),B.write_shift(-4,se.C),se.clsid)B.write_shift(16,se.clsid,"hex");else for(ee=0;ee<4;++ee)B.write_shift(4,0);B.write_shift(4,se.state||0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,se.start),B.write_shift(4,se.size),B.write_shift(4,0)}for(I=1;I<S.FileIndex.length;++I)if(se=S.FileIndex[I],se.size>=4096)if(B.l=se.start+1<<9,gt&&Buffer.isBuffer(se.content))se.content.copy(B,B.l,0,se.size),B.l+=se.size+511&-512;else{for(ee=0;ee<se.size;++ee)B.write_shift(1,se.content[ee]);for(;ee&511;++ee)B.write_shift(1,0)}for(I=1;I<S.FileIndex.length;++I)if(se=S.FileIndex[I],se.size>0&&se.size<4096)if(gt&&Buffer.isBuffer(se.content))se.content.copy(B,B.l,0,se.size),B.l+=se.size+63&-64;else{for(ee=0;ee<se.size;++ee)B.write_shift(1,se.content[ee]);for(;ee&63;++ee)B.write_shift(1,0)}if(gt)B.l=B.length;else for(;B.l<B.length;)B.write_shift(1,0);return B}function Y(S,L){var A=S.FullPaths.map(function(ee){return ee.toUpperCase()}),M=A.map(function(ee){var ae=ee.split("/");return ae[ae.length-(ee.slice(-1)=="/"?2:1)]}),B=!1;L.charCodeAt(0)===47?(B=!0,L=A[0].slice(0,-1)+L):B=L.indexOf("/")!==-1;var I=L.toUpperCase(),te=B===!0?A.indexOf(I):M.indexOf(I);if(te!==-1)return S.FileIndex[te];var oe=!I.match(Co);for(I=I.replace(nr,""),oe&&(I=I.replace(Co,"!")),te=0;te<A.length;++te)if((oe?A[te].replace(Co,"!"):A[te]).replace(nr,"")==I||(oe?M[te].replace(Co,"!"):M[te]).replace(nr,"")==I)return S.FileIndex[te];return null}var Z=64,ce=-2,Le="d0cf11e0a1b11ae1",ge=[208,207,17,224,161,177,26,225],me="00000000000000000000000000000000",de={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ce,FREESECT:-1,HEADER_SIGNATURE:Le,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:me,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ve(S,L,A){d();var M=j(S,A);h.writeFileSync(L,M)}function Me(S){for(var L=new Array(S.length),A=0;A<S.length;++A)L[A]=String.fromCharCode(S[A]);return L.join("")}function F(S,L){var A=j(S,L);switch(L&&L.type||"buffer"){case"file":return d(),h.writeFileSync(L.filename,A),A;case"binary":return typeof A=="string"?A:Me(A);case"base64":return R1(typeof A=="string"?A:Me(A));case"buffer":if(gt)return Buffer.isBuffer(A)?A:Dn(A);case"array":return typeof A=="string"?gr(A):A}return A}var he;function _e(S){try{var L=S.InflateRaw,A=new L;if(A._processChunk(new Uint8Array([3,0]),A._finishFlushFlag),A.bytesRead)he=S;else throw new Error("zlib does not expose bytesRead")}catch(M){console.error("cannot use native zlib: "+(M.message||M))}}function ye(S,L){if(!he)return Va(S,L);var A=he.InflateRaw,M=new A,B=M._processChunk(S.slice(S.l),M._finishFlushFlag);return S.l+=M.bytesRead,B}function pe(S){return he?he.deflateRawSync(S):Xt(S)}var Ne=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Oe=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],qe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function z(S){var L=(S<<1|S<<11)&139536|(S<<5|S<<15)&558144;return(L>>16|L>>8|L)&255}for(var q=typeof Uint8Array<"u",X=q?new Uint8Array(256):[],W=0;W<256;++W)X[W]=z(W);function we(S,L){var A=X[S&255];return L<=8?A>>>8-L:(A=A<<8|X[S>>8&255],L<=16?A>>>16-L:(A=A<<8|X[S>>16&255],A>>>24-L))}function H(S,L){var A=L&7,M=L>>>3;return(S[M]|(A<=6?0:S[M+1]<<8))>>>A&3}function ze(S,L){var A=L&7,M=L>>>3;return(S[M]|(A<=5?0:S[M+1]<<8))>>>A&7}function He(S,L){var A=L&7,M=L>>>3;return(S[M]|(A<=4?0:S[M+1]<<8))>>>A&15}function De(S,L){var A=L&7,M=L>>>3;return(S[M]|(A<=3?0:S[M+1]<<8))>>>A&31}function Xe(S,L){var A=L&7,M=L>>>3;return(S[M]|(A<=1?0:S[M+1]<<8))>>>A&127}function We(S,L,A){var M=L&7,B=L>>>3,I=(1<<A)-1,te=S[B]>>>M;return A<8-M||(te|=S[B+1]<<8-M,A<16-M)||(te|=S[B+2]<<16-M,A<24-M)||(te|=S[B+3]<<24-M),te&I}function tt(S,L,A){var M=L&7,B=L>>>3;return M<=5?S[B]|=(A&7)<<M:(S[B]|=A<<M&255,S[B+1]=(A&7)>>8-M),L+3}function vt(S,L,A){var M=L&7,B=L>>>3;return A=(A&1)<<M,S[B]|=A,L+1}function ht(S,L,A){var M=L&7,B=L>>>3;return A<<=M,S[B]|=A&255,A>>>=8,S[B+1]=A,L+8}function Lt(S,L,A){var M=L&7,B=L>>>3;return A<<=M,S[B]|=A&255,A>>>=8,S[B+1]=A&255,S[B+2]=A>>>8,L+16}function Ve(S,L){var A=S.length,M=2*A>L?2*A:L+5,B=0;if(A>=L)return S;if(gt){var I=k1(M);if(S.copy)S.copy(I);else for(;B<S.length;++B)I[B]=S[B];return I}else if(q){var te=new Uint8Array(M);if(te.set)te.set(S);else for(;B<A;++B)te[B]=S[B];return te}return S.length=M,S}function rt(S){for(var L=new Array(S),A=0;A<S;++A)L[A]=0;return L}function Fe(S,L,A){var M=1,B=0,I=0,te=0,oe=0,ee=S.length,ae=q?new Uint16Array(32):rt(32);for(I=0;I<32;++I)ae[I]=0;for(I=ee;I<A;++I)S[I]=0;ee=S.length;var se=q?new Uint16Array(ee):rt(ee);for(I=0;I<ee;++I)ae[B=S[I]]++,M<B&&(M=B),se[I]=0;for(ae[0]=0,I=1;I<=M;++I)ae[I+16]=oe=oe+ae[I-1]<<1;for(I=0;I<ee;++I)oe=S[I],oe!=0&&(se[I]=ae[oe+16]++);var Ce=0;for(I=0;I<ee;++I)if(Ce=S[I],Ce!=0)for(oe=we(se[I],M)>>M-Ce,te=(1<<M+4-Ce)-1;te>=0;--te)L[oe|te<<Ce]=Ce&15|I<<4;return M}var jt=q?new Uint16Array(512):rt(512),ti=q?new Uint16Array(32):rt(32);if(!q){for(var At=0;At<512;++At)jt[At]=0;for(At=0;At<32;++At)ti[At]=0}(function(){for(var S=[],L=0;L<32;L++)S.push(5);Fe(S,ti,32);var A=[];for(L=0;L<=143;L++)A.push(8);for(;L<=255;L++)A.push(9);for(;L<=279;L++)A.push(7);for(;L<=287;L++)A.push(8);Fe(A,jt,288)})();var qi=function(){for(var L=q?new Uint8Array(32768):[],A=0,M=0;A<qe.length-1;++A)for(;M<qe[A+1];++M)L[M]=A;for(;M<32768;++M)L[M]=29;var B=q?new Uint8Array(259):[];for(A=0,M=0;A<Oe.length-1;++A)for(;M<Oe[A+1];++M)B[M]=A;function I(oe,ee){for(var ae=0;ae<oe.length;){var se=Math.min(65535,oe.length-ae),Ce=ae+se==oe.length;for(ee.write_shift(1,+Ce),ee.write_shift(2,se),ee.write_shift(2,~se&65535);se-- >0;)ee[ee.l++]=oe[ae++]}return ee.l}function te(oe,ee){for(var ae=0,se=0,Ce=q?new Uint16Array(32768):[];se<oe.length;){var ke=Math.min(65535,oe.length-se);if(ke<10){for(ae=tt(ee,ae,+(se+ke==oe.length)),ae&7&&(ae+=8-(ae&7)),ee.l=ae/8|0,ee.write_shift(2,ke),ee.write_shift(2,~ke&65535);ke-- >0;)ee[ee.l++]=oe[se++];ae=ee.l*8;continue}ae=tt(ee,ae,+(se+ke==oe.length)+2);for(var Pe=0;ke-- >0;){var Se=oe[se];Pe=(Pe<<5^Se)&32767;var Te=-1,it=0;if((Te=Ce[Pe])&&(Te|=se&-32768,Te>se&&(Te-=32768),Te<se))for(;oe[Te+it]==oe[se+it]&&it<250;)++it;if(it>2){Se=B[it],Se<=22?ae=ht(ee,ae,X[Se+1]>>1)-1:(ht(ee,ae,3),ae+=5,ht(ee,ae,X[Se-23]>>5),ae+=3);var Ft=Se<8?0:Se-4>>2;Ft>0&&(Lt(ee,ae,it-Oe[Se]),ae+=Ft),Se=L[se-Te],ae=ht(ee,ae,X[Se]>>3),ae-=3;var Ze=Se<4?0:Se-2>>1;Ze>0&&(Lt(ee,ae,se-Te-qe[Se]),ae+=Ze);for(var ut=0;ut<it;++ut)Ce[Pe]=se&32767,Pe=(Pe<<5^oe[se])&32767,++se;ke-=it-1}else Se<=143?Se=Se+48:ae=vt(ee,ae,1),ae=ht(ee,ae,X[Se]),Ce[Pe]=se&32767,++se}ae=ht(ee,ae,0)-1}return ee.l=(ae+7)/8|0,ee.l}return function(ee,ae){return ee.length<8?I(ee,ae):te(ee,ae)}}();function Xt(S){var L=pi(50+Math.floor(S.length*1.1)),A=qi(S,L);return L.slice(0,A)}var Ie=q?new Uint16Array(32768):rt(32768),bt=q?new Uint16Array(32768):rt(32768),zt=q?new Uint16Array(128):rt(128),xt=1,er=1;function ii(S,L){var A=De(S,L)+257;L+=5;var M=De(S,L)+1;L+=5;var B=He(S,L)+4;L+=4;for(var I=0,te=q?new Uint8Array(19):rt(19),oe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ee=1,ae=q?new Uint8Array(8):rt(8),se=q?new Uint8Array(8):rt(8),Ce=te.length,ke=0;ke<B;++ke)te[Ne[ke]]=I=ze(S,L),ee<I&&(ee=I),ae[I]++,L+=3;var Pe=0;for(ae[0]=0,ke=1;ke<=ee;++ke)se[ke]=Pe=Pe+ae[ke-1]<<1;for(ke=0;ke<Ce;++ke)(Pe=te[ke])!=0&&(oe[ke]=se[Pe]++);var Se=0;for(ke=0;ke<Ce;++ke)if(Se=te[ke],Se!=0){Pe=X[oe[ke]]>>8-Se;for(var Te=(1<<7-Se)-1;Te>=0;--Te)zt[Pe|Te<<Se]=Se&7|ke<<3}var it=[];for(ee=1;it.length<A+M;)switch(Pe=zt[Xe(S,L)],L+=Pe&7,Pe>>>=3){case 16:for(I=3+H(S,L),L+=2,Pe=it[it.length-1];I-- >0;)it.push(Pe);break;case 17:for(I=3+ze(S,L),L+=3;I-- >0;)it.push(0);break;case 18:for(I=11+Xe(S,L),L+=7;I-- >0;)it.push(0);break;default:it.push(Pe),ee<Pe&&(ee=Pe);break}var Ft=it.slice(0,A),Ze=it.slice(A);for(ke=A;ke<286;++ke)Ft[ke]=0;for(ke=M;ke<30;++ke)Ze[ke]=0;return xt=Fe(Ft,Ie,286),er=Fe(Ze,bt,30),L}function ri(S,L){if(S[0]==3&&!(S[1]&3))return[Sn(L),2];for(var A=0,M=0,B=k1(L||1<<18),I=0,te=B.length>>>0,oe=0,ee=0;(M&1)==0;){if(M=ze(S,A),A+=3,M>>>1)M>>1==1?(oe=9,ee=5):(A=ii(S,A),oe=xt,ee=er);else{A&7&&(A+=8-(A&7));var ae=S[A>>>3]|S[(A>>>3)+1]<<8;if(A+=32,ae>0)for(!L&&te<I+ae&&(B=Ve(B,I+ae),te=B.length);ae-- >0;)B[I++]=S[A>>>3],A+=8;continue}for(;;){!L&&te<I+32767&&(B=Ve(B,I+32767),te=B.length);var se=We(S,A,oe),Ce=M>>>1==1?jt[se]:Ie[se];if(A+=Ce&15,Ce>>>=4,(Ce>>>8&255)===0)B[I++]=Ce;else{if(Ce==256)break;Ce-=257;var ke=Ce<8?0:Ce-4>>2;ke>5&&(ke=0);var Pe=I+Oe[Ce];ke>0&&(Pe+=We(S,A,ke),A+=ke),se=We(S,A,ee),Ce=M>>>1==1?ti[se]:bt[se],A+=Ce&15,Ce>>>=4;var Se=Ce<4?0:Ce-2>>1,Te=qe[Ce];for(Se>0&&(Te+=We(S,A,Se),A+=Se),!L&&te<Pe&&(B=Ve(B,Pe+100),te=B.length);I<Pe;)B[I]=B[I-Te],++I}}}return L?[B,A+7>>>3]:[B.slice(0,I),A+7>>>3]}function Va(S,L){var A=S.slice(S.l||0),M=ri(A,L);return S.l+=M[1],M[0]}function Ts(S,L){if(S)typeof console<"u"&&console.error(L);else throw new Error(L)}function Ln(S,L){var A=S;bi(A,0);var M=[],B=[],I={FileIndex:M,FullPaths:B};P(I,{root:L.root});for(var te=A.length-4;(A[te]!=80||A[te+1]!=75||A[te+2]!=5||A[te+3]!=6)&&te>=0;)--te;A.l=te+4,A.l+=4;var oe=A.read_shift(2);A.l+=6;var ee=A.read_shift(4);for(A.l=ee,te=0;te<oe;++te){A.l+=20;var ae=A.read_shift(4),se=A.read_shift(4),Ce=A.read_shift(2),ke=A.read_shift(2),Pe=A.read_shift(2);A.l+=8;var Se=A.read_shift(4),Te=u(A.slice(A.l+Ce,A.l+Ce+ke));A.l+=Ce+ke+Pe;var it=A.l;A.l=Se+4,Te&&Te[1]&&((Te[1]||{}).usz&&(se=Te[1].usz),(Te[1]||{}).csz&&(ae=Te[1].csz)),Ga(A,ae,se,I,Te),A.l=it}return I}function Ga(S,L,A,M,B){S.l+=2;var I=S.read_shift(2),te=S.read_shift(2),oe=o(S);if(I&8257)throw new Error("Unsupported ZIP encryption");for(var ee=S.read_shift(4),ae=S.read_shift(4),se=S.read_shift(4),Ce=S.read_shift(2),ke=S.read_shift(2),Pe="",Se=0;Se<Ce;++Se)Pe+=String.fromCharCode(S[S.l++]);if(ke){var Te=u(S.slice(S.l,S.l+ke));(Te[21589]||{}).mt&&(oe=Te[21589].mt),(Te[1]||{}).usz&&(se=Te[1].usz),(Te[1]||{}).csz&&(ae=Te[1].csz),B&&((B[21589]||{}).mt&&(oe=B[21589].mt),(B[1]||{}).usz&&(se=B[1].usz),(B[1]||{}).csz&&(ae=B[1].csz))}S.l+=ke;var it=S.slice(S.l,S.l+ae);switch(te){case 8:it=ye(S,se);break;case 0:S.l+=ae;break;default:throw new Error("Unsupported ZIP Compression method "+te)}var Ft=!1;I&8&&(ee=S.read_shift(4),ee==134695760&&(ee=S.read_shift(4),Ft=!0),ae=S.read_shift(4),se=S.read_shift(4)),ae!=L&&Ts(Ft,"Bad compressed size: "+L+" != "+ae),se!=A&&Ts(Ft,"Bad uncompressed size: "+A+" != "+se),Je(M,Pe,it,{unsafe:!0,mt:oe})}function da(S,L){var A=L||{},M=[],B=[],I=pi(1),te=A.compression?8:0,oe=0,ee=0,ae=0,se=0,Ce=0,ke=S.FullPaths[0],Pe=ke,Se=S.FileIndex[0],Te=[],it=0;for(ee=1;ee<S.FullPaths.length;++ee)if(Pe=S.FullPaths[ee].slice(ke.length),Se=S.FileIndex[ee],!(!Se.size||!Se.content||Array.isArray(Se.content)&&Se.content.length==0||Pe=="Sh33tJ5")){var Ft=se,Ze=pi(Pe.length);for(ae=0;ae<Pe.length;++ae)Ze.write_shift(1,Pe.charCodeAt(ae)&127);Ze=Ze.slice(0,Ze.l),Te[Ce]=typeof Se.content=="string"?B1.bstr(Se.content,0):B1.buf(Se.content,0);var ut=typeof Se.content=="string"?gr(Se.content):Se.content;te==8&&(ut=pe(ut)),I=pi(30),I.write_shift(4,67324752),I.write_shift(2,20),I.write_shift(2,oe),I.write_shift(2,te),Se.mt?s(I,Se.mt):I.write_shift(4,0),I.write_shift(-4,Te[Ce]),I.write_shift(4,ut.length),I.write_shift(4,Se.content.length),I.write_shift(2,Ze.length),I.write_shift(2,0),se+=I.length,M.push(I),se+=Ze.length,M.push(Ze),se+=ut.length,M.push(ut),I=pi(46),I.write_shift(4,33639248),I.write_shift(2,0),I.write_shift(2,20),I.write_shift(2,oe),I.write_shift(2,te),I.write_shift(4,0),I.write_shift(-4,Te[Ce]),I.write_shift(4,ut.length),I.write_shift(4,Se.content.length),I.write_shift(2,Ze.length),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(4,0),I.write_shift(4,Ft),it+=I.l,B.push(I),it+=Ze.length,B.push(Ze),++Ce}return I=pi(22),I.write_shift(4,101010256),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(2,Ce),I.write_shift(2,Ce),I.write_shift(4,it),I.write_shift(4,se),I.write_shift(2,0),yn([yn(M),yn(B),I])}var Ri={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Wr(S,L){if(S.ctype)return S.ctype;var A=S.name||"",M=A.match(/\.([^\.]+)$/);return M&&Ri[M[1]]||L&&(M=(A=L).match(/[\.\\]([^\.\\])+$/),M&&Ri[M[1]])?Ri[M[1]]:"application/octet-stream"}function pa(S){for(var L=R1(S),A=[],M=0;M<L.length;M+=76)A.push(L.slice(M,M+76));return A.join(`\r
`)+`\r
`}function yl(S){var L=S.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ae){var se=ae.charCodeAt(0).toString(16).toUpperCase();return"="+(se.length==1?"0"+se:se)});L=L.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),L.charAt(0)==`
`&&(L="=0D"+L.slice(1)),L=L.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var A=[],M=L.split(`\r
`),B=0;B<M.length;++B){var I=M[B];if(I.length==0){A.push("");continue}for(var te=0;te<I.length;){var oe=76,ee=I.slice(te,te+oe);ee.charAt(oe-1)=="="?oe--:ee.charAt(oe-2)=="="?oe-=2:ee.charAt(oe-3)=="="&&(oe-=3),ee=I.slice(te,te+oe),te+=oe,te<I.length&&(ee+="="),A.push(ee)}}return A.join(`\r
`)}function K(S){for(var L=[],A=0;A<S.length;++A){for(var M=S[A];A<=S.length&&M.charAt(M.length-1)=="=";)M=M.slice(0,M.length-1)+S[++A];L.push(M)}for(var B=0;B<L.length;++B)L[B]=L[B].replace(/[=][0-9A-Fa-f]{2}/g,function(I){return String.fromCharCode(parseInt(I.slice(1),16))});return gr(L.join(`\r
`))}function re(S,L,A){for(var M="",B="",I="",te,oe=0;oe<10;++oe){var ee=L[oe];if(!ee||ee.match(/^\s*$/))break;var ae=ee.match(/^([^:]*?):\s*([^\s].*)$/);if(ae)switch(ae[1].toLowerCase()){case"content-location":M=ae[2].trim();break;case"content-type":I=ae[2].trim();break;case"content-transfer-encoding":B=ae[2].trim();break}}switch(++oe,B.toLowerCase()){case"base64":te=gr(yr(L.slice(oe).join("")));break;case"quoted-printable":te=K(L.slice(oe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+B)}var se=Je(S,M.slice(A.length),te,{unsafe:!0});I&&(se.ctype=I)}function fe(S,L){if(Me(S.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var A=L&&L.root||"",M=(gt&&Buffer.isBuffer(S)?S.toString("binary"):Me(S)).split(`\r
`),B=0,I="";for(B=0;B<M.length;++B)if(I=M[B],!!/^Content-Location:/i.test(I)&&(I=I.slice(I.indexOf("file")),A||(A=I.slice(0,I.lastIndexOf("/")+1)),I.slice(0,A.length)!=A))for(;A.length>0&&(A=A.slice(0,A.length-1),A=A.slice(0,A.lastIndexOf("/")+1),I.slice(0,A.length)!=A););var te=(M[1]||"").match(/boundary="(.*?)"/);if(!te)throw new Error("MAD cannot find boundary");var oe="--"+(te[1]||""),ee=[],ae=[],se={FileIndex:ee,FullPaths:ae};P(se);var Ce,ke=0;for(B=0;B<M.length;++B){var Pe=M[B];Pe!==oe&&Pe!==oe+"--"||(ke++&&re(se,M.slice(Ce,B),A),Ce=B)}return se}function Ae(S,L){var A=L||{},M=A.boundary||"SheetJS";M="------="+M;for(var B=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+M.slice(2)+'"',"","",""],I=S.FullPaths[0],te=I,oe=S.FileIndex[0],ee=1;ee<S.FullPaths.length;++ee)if(te=S.FullPaths[ee].slice(I.length),oe=S.FileIndex[ee],!(!oe.size||!oe.content||te=="Sh33tJ5")){te=te.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(it){return"_x"+it.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(it){return"_u"+it.charCodeAt(0).toString(16)+"_"});for(var ae=oe.content,se=gt&&Buffer.isBuffer(ae)?ae.toString("binary"):Me(ae),Ce=0,ke=Math.min(1024,se.length),Pe=0,Se=0;Se<=ke;++Se)(Pe=se.charCodeAt(Se))>=32&&Pe<128&&++Ce;var Te=Ce>=ke*4/5;B.push(M),B.push("Content-Location: "+(A.root||"file:///C:/SheetJS/")+te),B.push("Content-Transfer-Encoding: "+(Te?"quoted-printable":"base64")),B.push("Content-Type: "+Wr(oe,te)),B.push(""),B.push(Te?yl(se):pa(se))}return B.push(M+`--\r
`),B.join(`\r
`)}function Ue(S){var L={};return P(L,S),L}function Je(S,L,A,M){var B=M&&M.unsafe;B||P(S);var I=!B&&Tt.find(S,L);if(!I){var te=S.FullPaths[0];L.slice(0,te.length)==te?te=L:(te.slice(-1)!="/"&&(te+="/"),te=(te+L).replace("//","/")),I={name:a(L),type:2},S.FileIndex.push(I),S.FullPaths.push(te),B||Tt.utils.cfb_gc(S)}return I.content=A,I.size=A?A.length:0,M&&(M.CLSID&&(I.clsid=M.CLSID),M.mt&&(I.mt=M.mt),M.ct&&(I.ct=M.ct)),I}function et(S,L){P(S);var A=Tt.find(S,L);if(A){for(var M=0;M<S.FileIndex.length;++M)if(S.FileIndex[M]==A)return S.FileIndex.splice(M,1),S.FullPaths.splice(M,1),!0}return!1}function Ye(S,L,A){P(S);var M=Tt.find(S,L);if(M){for(var B=0;B<S.FileIndex.length;++B)if(S.FileIndex[B]==M)return S.FileIndex[B].name=a(A),S.FullPaths[B]=A,!0}return!1}function Ke(S){N(S,!0)}return e.find=Y,e.read=V,e.parse=p,e.write=F,e.writeFile=ve,e.utils={cfb_new:Ue,cfb_add:Je,cfb_del:et,cfb_mov:Ye,cfb_gc:Ke,ReadShift:Ao,CheckField:ew,prep_blob:bi,bconcat:yn,use_zlib:_e,_deflateRaw:Xt,_inflateRaw:Va,consts:de},e}(),i_;function r_(i){if(typeof Deno<"u")return Deno.readFileSync(i);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(i);e.open("r"),e.encoding="binary";var t=e.read();return e.close(),t}catch(r){if(!r.message||r.message.indexOf("onstruct")==-1)throw r}throw new Error("Cannot access file "+i)}function Ir(i){for(var e=Object.keys(i),t=[],r=0;r<e.length;++r)Object.prototype.hasOwnProperty.call(i,e[r])&&t.push(e[r]);return t}function np(i){for(var e=[],t=Ir(i),r=0;r!==t.length;++r)e[i[t[r]]]=t[r];return e}var Fx=Date.UTC(1899,11,30,0,0,0),a_=Date.UTC(1899,11,31,0,0,0),n_=Date.UTC(1904,0,1,0,0,0);function xi(i,e){var t=i.getTime(),r=(t-Fx)/(24*60*60*1e3);return e?(r-=1462,r<-1402?r-1:r):r<60?r-1:r}function Tn(i){if(i>=60&&i<61)return i;var e=new Date;return e.setTime((i>60?i:i+1)*24*60*60*1e3+Fx),e}function s_(i){var e=0,t=0,r=!1,a=i.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+i+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(t=1,s>3&&(r=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":t*=24;case"H":t*=60;case"M":if(r)t*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=t*parseInt(a[s],10)}return e}var l_=/^(\d+):(\d+)(:\d+)?(\.\d+)?$/,o_=/^(\d+)-(\d+)-(\d+)$/,Mx=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)?(\.\d+)?$/;function Ni(i,e){if(i instanceof Date)return i;var t=i.match(l_);if(t)return new Date((e?n_:a_)+((parseInt(t[1],10)*60+parseInt(t[2],10))*60+(t[3]?parseInt(t[3].slice(1),10):0))*1e3+(t[4]?parseInt((t[4]+"000").slice(1,4),10):0));if(t=i.match(o_),t)return new Date(Date.UTC(+t[1],+t[2]-1,+t[3],0,0,0,0));if(t=i.match(Mx),t)return new Date(Date.UTC(+t[1],+t[2]-1,+t[3],+t[4],+t[5],t[6]&&parseInt(t[6].slice(1),10)||0,t[7]&&parseInt((t[7]+"0000").slice(1,4),10)||0));var r=new Date(i);return r}function gs(i,e){if(gt&&Buffer.isBuffer(i)){if(e&&qo){if(i[0]==255&&i[1]==254)return To(i.slice(2).toString("utf16le"));if(i[1]==254&&i[2]==255)return To(yx(i.slice(2).toString("binary")))}return i.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(i[0]==255&&i[1]==254)return To(new TextDecoder("utf-16le").decode(i.slice(2)));if(i[0]==254&&i[1]==255)return To(new TextDecoder("utf-16be").decode(i.slice(2)))}var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(i)&&(i=new Uint8Array(i)),new TextDecoder("latin1").decode(i).replace(/[]/g,function(s){return t[s]||s})}catch{}var r=[],a=0;try{for(a=0;a<i.length-65536;a+=65536)r.push(String.fromCharCode.apply(0,i.slice(a,a+65536)));r.push(String.fromCharCode.apply(0,i.slice(a)))}catch{try{for(;a<i.length-16384;a+=16384)r.push(String.fromCharCode.apply(0,i.slice(a,a+16384)));r.push(String.fromCharCode.apply(0,i.slice(a)))}catch{for(;a!=i.length;++a)r.push(String.fromCharCode(i[a]))}}return r.join("")}function mi(i){if(typeof JSON<"u"&&!Array.isArray(i))return JSON.parse(JSON.stringify(i));if(typeof i!="object"||i==null)return i;if(i instanceof Date)return new Date(i.getTime());var e={};for(var t in i)Object.prototype.hasOwnProperty.call(i,t)&&(e[t]=mi(i[t]));return e}function Ct(i,e){for(var t="";t.length<e;)t+=i;return t}function br(i){var e=Number(i);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(i))return e;var t=1,r=i.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(e=Number(r))||(r=r.replace(/[(]([^()]*)[)]/,function(a,s){return t=-t,s}),!isNaN(e=Number(r)))?e/t:e}var u_=/^(0?\d|1[0-2])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))\s+([ap])m?$/,c_=/^([01]?\d|2[0-3])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))$/,h_=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)(\.\d+)?[Z]?$/,f_=new Date("6/9/69 00:00 UTC").valueOf()==-177984e5;function d_(i){return i[2]?i[3]?i[4]?new Date(Date.UTC(1899,11,31,+i[1]%12+(i[7]=="p"?12:0),+i[2],+i[4],parseFloat(i[3])*1e3)):new Date(Date.UTC(1899,11,31,i[7]=="p"?12:0,+i[1],+i[2],parseFloat(i[3])*1e3)):i[5]?new Date(Date.UTC(1899,11,31,+i[1]%12+(i[7]=="p"?12:0),+i[2],+i[5],i[6]?parseFloat(i[6])*1e3:0)):new Date(Date.UTC(1899,11,31,+i[1]%12+(i[7]=="p"?12:0),+i[2],0,0)):new Date(Date.UTC(1899,11,31,+i[1]%12+(i[7]=="p"?12:0),0,0,0))}function p_(i){return i[2]?i[3]?i[4]?new Date(Date.UTC(1899,11,31,+i[1],+i[2],+i[4],parseFloat(i[3])*1e3)):new Date(Date.UTC(1899,11,31,0,+i[1],+i[2],parseFloat(i[3])*1e3)):i[5]?new Date(Date.UTC(1899,11,31,+i[1],+i[2],+i[5],i[6]?parseFloat(i[6])*1e3:0)):new Date(Date.UTC(1899,11,31,+i[1],+i[2],0,0)):new Date(Date.UTC(1899,11,31,+i[1],0,0,0))}var m_=["january","february","march","april","may","june","july","august","september","october","november","december"];function $o(i){if(h_.test(i))return i.indexOf("Z")==-1?hh(new Date(i)):new Date(i);var e=i.toLowerCase(),t=e.replace(/\s+/g," ").trim(),r=t.match(u_);if(r)return d_(r);if(r=t.match(c_),r)return p_(r);if(r=t.match(Mx),r)return new Date(Date.UTC(+r[1],+r[2]-1,+r[3],+r[4],+r[5],r[6]&&parseInt(r[6].slice(1),10)||0,r[7]&&parseInt((r[7]+"0000").slice(1,4),10)||0));var a=new Date(f_&&i.indexOf("UTC")==-1?i+" UTC":i),s=new Date(NaN),o=a.getYear();a.getMonth();var u=a.getDate();if(isNaN(u))return s;if(e.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(e=e.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),e.length>3&&m_.indexOf(e)==-1)return s}else if(e.replace(/[ap]m?/,"").match(/[a-z]/))return s;return o<0||o>8099||i.match(/[^-0-9:,\/\\\ ]/)?s:a}var g_=function(){var i="abacaba".split(/(:?b)/i).length==5;return function(t,r,a){if(i||typeof r=="string")return t.split(r);for(var s=t.split(r),o=[s[0]],u=1;u<s.length;++u)o.push(a),o.push(s[u]);return o}}();function vs(i){return new Date(i.getUTCFullYear(),i.getUTCMonth(),i.getUTCDate(),i.getUTCHours(),i.getUTCMinutes(),i.getUTCSeconds(),i.getUTCMilliseconds())}function hh(i){return new Date(Date.UTC(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds()))}function sp(i){var e=i.slice(0,1024),t=e.indexOf("<!DOCTYPE");if(t==-1)return i;var r=i.match(/<[\w]/);return r?i.slice(0,t)+i.slice(r.index):i}function lp(i,e,t){for(var r=[],a=i.indexOf(e);a>-1;){var s=i.indexOf(t,a+e.length);if(s==-1)break;r.push(i.slice(a,s+t.length)),a=i.indexOf(e,s+t.length)}return r.length>0?r:null}function ru(i,e,t){var r=[],a=0,s=i.indexOf(e);if(s==-1)return i;for(;s>-1;){r.push(i.slice(a,s));var o=i.indexOf(t,s+e.length);if(o==-1)break;(s=i.indexOf(e,a=o+t.length))==-1&&r.push(i.slice(a))}return r.join("")}var v_={" ":1,"	":1,"\r":1,"\n":1,">":1};function us(i,e){for(var t=i.indexOf("<"+e),r=e.length+1,a=i.length;t>=0&&t<=a-r&&!v_[i.charAt(t+r)];)t=i.indexOf("<"+e,t+1);if(t===-1)return null;var s=i.indexOf(">",t+e.length);if(s===-1)return null;var o="</"+e+">",u=i.indexOf(o,s);return u==-1?null:[i.slice(t,u+o.length),i.slice(s+1,u)]}var _i=function(){var i={};return function(t,r){var a=i[r];a||(i[r]=a=[new RegExp("<(?:\\w+:)?"+r+"\\b[^<>]*>","g"),new RegExp("</(?:\\w+:)?"+r+">","g")]),a[0].lastIndex=a[1].lastIndex=0;var s=a[0].exec(t);if(!s)return null;var o=s.index,u=a[0].lastIndex;if(a[1].lastIndex=a[0].lastIndex,s=a[1].exec(t),!s)return null;var h=s.index,d=a[1].lastIndex;return[t.slice(o,d),t.slice(u,h)]}}(),Ox=function(){var i={};return function(t,r){var a=[],s=i[r];s||(i[r]=s=[new RegExp("<(?:\\w+:)?"+r+"\\b[^<>]*>","g"),new RegExp("</(?:\\w+:)?"+r+">","g")]),s[0].lastIndex=s[1].lastIndex=0;for(var o;o=s[0].exec(t);){var u=o.index;if(s[1].lastIndex=s[0].lastIndex,o=s[1].exec(t),!o)return null;var h=s[1].lastIndex;a.push(t.slice(u,h)),s[0].lastIndex=s[1].lastIndex}return a.length==0?null:a}}(),b_=function(){var i={};return function(t,r){var a=[],s=i[r];s||(i[r]=s=[new RegExp("<(?:\\w+:)?"+r+"\\b[^<>]*>","g"),new RegExp("</(?:\\w+:)?"+r+">","g")]),s[0].lastIndex=s[1].lastIndex=0;for(var o,u=0,h=0;o=s[0].exec(t);){if(u=o.index,a.push(t.slice(h,u)),h=u,s[1].lastIndex=s[0].lastIndex,o=s[1].exec(t),!o)return null;h=s[1].lastIndex,s[0].lastIndex=s[1].lastIndex}return a.push(t.slice(h)),a.length==0?"":a.join("")}}(),x_=function(){var i={};return function(t,r){var a=[],s=i[r];s||(i[r]=s=[new RegExp("<"+r+"\\b[^<>]*>","ig"),new RegExp("</"+r+">","ig")]),s[0].lastIndex=s[1].lastIndex=0;for(var o;o=s[0].exec(t);){var u=o.index;if(s[1].lastIndex=s[0].lastIndex,o=s[1].exec(t),!o)return null;var h=s[1].lastIndex;a.push(t.slice(u,h)),s[0].lastIndex=s[1].lastIndex}return a.length==0?null:a}}();function Lx(i){return i?i.content&&i.type?gs(i.content,!0):i.data?Eo(i.data):i.asNodeBuffer&&gt?Eo(i.asNodeBuffer().toString("binary")):i.asBinary?Eo(i.asBinary()):i._data&&i._data.getContent?Eo(gs(Array.prototype.slice.call(i._data.getContent(),0))):null:null}function Nx(i){if(!i)return null;if(i.data)return _1(i.data);if(i.asNodeBuffer&&gt)return i.asNodeBuffer();if(i._data&&i._data.getContent){var e=i._data.getContent();return typeof e=="string"?_1(e):Array.prototype.slice.call(e)}return i.content&&i.type?i.content:null}function w_(i){return i&&i.name.slice(-4)===".bin"?Nx(i):Lx(i)}function zr(i,e){for(var t=i.FullPaths||Ir(i.files),r=e.toLowerCase().replace(/[\/]/g,"\\"),a=r.replace(/\\/g,"/"),s=0;s<t.length;++s){var o=t[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(r==o||a==o)return i.files?i.files[t[s]]:i.FileIndex[s]}return null}function op(i,e){var t=zr(i,e);if(t==null)throw new Error("Cannot find file "+e+" in zip");return t}function fi(i,e,t){if(!t)return w_(op(i,e));if(!e)return null;try{return fi(i,e)}catch{return null}}function Ji(i,e,t){if(!t)return Lx(op(i,e));if(!e)return null;try{return Ji(i,e)}catch{return null}}function y_(i,e,t){return Nx(op(i,e))}function z1(i){for(var e=i.FullPaths||Ir(i.files),t=[],r=0;r<e.length;++r)e[r].slice(-1)!="/"&&t.push(e[r].replace(/^Root Entry[\/]/,""));return t.sort()}function E_(i,e,t){if(i.FullPaths){if(Array.isArray(t)&&typeof t[0]=="string"&&(t=t.join("")),typeof t=="string"){var r;return gt?r=Dn(t):r=AT(t),Tt.utils.cfb_add(i,e,r)}Tt.utils.cfb_add(i,e,t)}else i.file(e,t)}function Bx(i,e){switch(e.type){case"base64":return Tt.read(i,{type:"base64"});case"binary":return Tt.read(i,{type:"binary"});case"buffer":case"array":return Tt.read(i,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function nl(i,e){if(i.charAt(0)=="/")return i.slice(1);var t=e.split("/");e.slice(-1)!="/"&&t.pop();for(var r=i.split("/");r.length!==0;){var a=r.shift();a===".."?t.pop():a!=="."&&t.push(a)}return t.join("/")}var zx=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Hx=/\s([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,H1=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?<>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'"<>\s=]+))*\s*[\/\?]?>/mg,C_=/<[^<>]*>/g,Bi=zx.match(H1)?H1:C_,T_=/<\w*:/,__=/<(\/?)\w+:/;function Ge(i,e,t){for(var r={},a=0,s=0;a!==i.length&&!((s=i.charCodeAt(a))===32||s===10||s===13);++a);if(e||(r[0]=i.slice(0,a)),a===i.length)return r;var o=i.match(Hx),u=0,h="",d=0,p="",b="",g=1;if(o)for(d=0;d!=o.length;++d){for(b=o[d].slice(1),s=0;s!=b.length&&b.charCodeAt(s)!==61;++s);for(p=b.slice(0,s).trim();b.charCodeAt(s+1)==32;)++s;for(g=(a=b.charCodeAt(s+1))==34||a==39?1:0,h=b.slice(s+1+g,b.length-g),u=0;u!=p.length&&p.charCodeAt(u)!==58;++u);if(u===p.length)p.indexOf("_")>0&&(p=p.slice(0,p.indexOf("_"))),r[p]=h,r[p.toLowerCase()]=h;else{var v=(u===5&&p.slice(0,5)==="xmlns"?"xmlns":"")+p.slice(u+1);if(r[v]&&p.slice(u-3,u)=="ext")continue;r[v]=h,r[v.toLowerCase()]=h}}return r}function S_(i,e,t){for(var r={},a=0,s=0;a!==i.length&&!((s=i.charCodeAt(a))===32||s===10||s===13);++a);if(a===i.length)return r;var o=i.match(Hx),u="",h=0,d="",p="",b=1;if(o)for(h=0;h!=o.length;++h){for(p=o[h].slice(1),s=0;s!=p.length&&p.charCodeAt(s)!==61;++s);for(d=p.slice(0,s).trim();p.charCodeAt(s+1)==32;)++s;b=(a=p.charCodeAt(s+1))==34||a==39?1:0,u=p.slice(s+1+b,p.length-b),d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),r[d]=u,r[d.toLowerCase()]=u}return r}function Vr(i){return i.replace(__,"<$1")}var Px={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},R_=np(Px),wt=function(){var i=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;function t(r){var a=r+"",s=a.indexOf("<![CDATA[");if(s==-1)return a.replace(i,function(u,h){return Px[u]||String.fromCharCode(parseInt(h,u.indexOf("x")>-1?16:10))||u}).replace(e,function(u,h){return String.fromCharCode(parseInt(h,16))});var o=a.indexOf("]]>");return t(a.slice(0,s))+a.slice(s+9,o)+t(a.slice(o+3))}return function(a,s){var o=t(a);return s?o.replace(/\r\n/g,`
`):o}}(),k_=/[&<>'"]/g,A_=/[\u0000-\u001f]/g;function ko(i){var e=i+"";return e.replace(k_,function(t){return R_[t]}).replace(/\n/g,"<br/>").replace(A_,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}var P1=function(){var i=/&#(\d+);/g;function e(t,r){return String.fromCharCode(parseInt(r,10))}return function(r){return r.replace(i,e)}}();function Nt(i){switch(i){case 1:case!0:case"1":case"true":return!0;case 0:case!1:case"0":case"false":return!1}return!1}function Gd(i){for(var e="",t=0,r=0,a=0,s=0,o=0,u=0;t<i.length;){if(r=i.charCodeAt(t++),r<128){e+=String.fromCharCode(r);continue}if(a=i.charCodeAt(t++),r>191&&r<224){o=(r&31)<<6,o|=a&63,e+=String.fromCharCode(o);continue}if(s=i.charCodeAt(t++),r<240){e+=String.fromCharCode((r&15)<<12|(a&63)<<6|s&63);continue}o=i.charCodeAt(t++),u=((r&7)<<18|(a&63)<<12|(s&63)<<6|o&63)-65536,e+=String.fromCharCode(55296+(u>>>10&1023)),e+=String.fromCharCode(56320+(u&1023))}return e}function I1(i){var e=Sn(2*i.length),t,r,a=1,s=0,o=0,u;for(r=0;r<i.length;r+=a)a=1,(u=i.charCodeAt(r))<128?t=u:u<224?(t=(u&31)*64+(i.charCodeAt(r+1)&63),a=2):u<240?(t=(u&15)*4096+(i.charCodeAt(r+1)&63)*64+(i.charCodeAt(r+2)&63),a=3):(a=4,t=(u&7)*262144+(i.charCodeAt(r+1)&63)*4096+(i.charCodeAt(r+2)&63)*64+(i.charCodeAt(r+3)&63),t-=65536,o=55296+(t>>>10&1023),t=56320+(t&1023)),o!==0&&(e[s++]=o&255,e[s++]=o>>>8,o=0),e[s++]=t%256,e[s++]=t>>>8;return e.slice(0,s).toString("ucs2")}function U1(i){return Dn(i,"binary").toString("utf8")}var Tc="foo bar baz",Vt=gt&&(U1(Tc)==Gd(Tc)&&U1||I1(Tc)==Gd(Tc)&&I1)||Gd,To=gt?function(i){return Dn(i,"utf8").toString("binary")}:function(i){for(var e=[],t=0,r=0,a=0;t<i.length;)switch(r=i.charCodeAt(t++),!0){case r<128:e.push(String.fromCharCode(r));break;case r<2048:e.push(String.fromCharCode(192+(r>>6))),e.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,a=i.charCodeAt(t++)-56320+(r<<10),e.push(String.fromCharCode(240+(a>>18&7))),e.push(String.fromCharCode(144+(a>>12&63))),e.push(String.fromCharCode(128+(a>>6&63))),e.push(String.fromCharCode(128+(a&63)));break;default:e.push(String.fromCharCode(224+(r>>12))),e.push(String.fromCharCode(128+(r>>6&63))),e.push(String.fromCharCode(128+(r&63)))}return e.join("")},Ix=function(){var i=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var r=t.replace(/^[\t\n\r ]+/,"").replace(/(^|[^\t\n\r ])[\t\n\r ]+$/,"$1").replace(/>\s+/g,">").replace(/\b\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^<>]*>/g,""),a=0;a<i.length;++a)r=r.replace(i[a][0],i[a][1]);return r}}(),D_=/<\/?(?:vt:)?variant>/g,F_=/<(?:vt:)([^<"'>]*)>([\s\S]*)</;function V1(i,e){var t=Ge(i),r=Ox(i,t.baseType)||[],a=[];if(r.length!=t.size){if(e.WTF)throw new Error("unexpected vector length "+r.length+" != "+t.size);return a}return r.forEach(function(s){var o=s.replace(D_,"").match(F_);o&&a.push({v:Vt(o[2]),t:o[1]})}),a}var M_=/(^\s|\s$|\n)/;function O_(i){return Ir(i).map(function(e){return" "+e+'="'+i[e]+'"'}).join("")}function L_(i,e,t){return"<"+i+(t!=null?O_(t):"")+(e!=null?(e.match(M_)?' xml:space="preserve"':"")+">"+e+"</"+i:"/")+">"}function fh(i){if(gt&&Buffer.isBuffer(i))return i.toString("utf8");if(typeof i=="string")return i;if(typeof Uint8Array<"u"&&i instanceof Uint8Array)return Vt(Ia(ip(i)));throw new Error("Bad input format: expected Buffer or string")}var di=/<([\/]?)([^\s?><!\/:"]*:|)([^\s?<>:\/"]+)(?:\s+[^<>=?"'\s]+="[^"]*?")*\s*[\/]?>/mg,N_={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},B_=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function z_(i,e){for(var t=1-2*(i[e+7]>>>7),r=((i[e+7]&127)<<4)+(i[e+6]>>>4&15),a=i[e+6]&15,s=5;s>=0;--s)a=a*256+i[e+s];return r==2047?a==0?t*(1/0):NaN:(r==0?r=-1022:(r-=1023,a+=Math.pow(2,52)),t*Math.pow(2,r-52)*a)}function H_(i,e,t){var r=(e<0||1/e==-1/0?1:0)<<7,a=0,s=0,o=r?-e:e;isFinite(o)?o==0?a=s=0:(a=Math.floor(Math.log(o)/Math.LN2),s=o*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(e)?26985:0);for(var u=0;u<=5;++u,s/=256)i[t+u]=s&255;i[t+6]=(a&15)<<4|s&15,i[t+7]=a>>4|r}var G1=function(i){for(var e=[],t=10240,r=0;r<i[0].length;++r)if(i[0][r])for(var a=0,s=i[0][r].length;a<s;a+=t)e.push.apply(e,i[0][r].slice(a,a+t));return e},W1=gt?function(i){return i[0].length>0&&Buffer.isBuffer(i[0][0])?Buffer.concat(i[0].map(function(e){return Buffer.isBuffer(e)?e:Dn(e)})):G1(i)}:G1,j1=function(i,e,t){for(var r=[],a=e;a<t;a+=2)r.push(String.fromCharCode(Na(i,a)));return r.join("").replace(nr,"")},up=gt?function(i,e,t){return!Buffer.isBuffer(i)||!qo?j1(i,e,t):i.toString("utf16le",e,t).replace(nr,"")}:j1,X1=function(i,e,t){for(var r=[],a=e;a<e+t;++a)r.push(("0"+i[a].toString(16)).slice(-2));return r.join("")},Ux=gt?function(i,e,t){return Buffer.isBuffer(i)?i.toString("hex",e,e+t):X1(i,e,t)}:X1,Y1=function(i,e,t){for(var r=[],a=e;a<t;a++)r.push(String.fromCharCode(al(i,a)));return r.join("")},au=gt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf8",t,r):Y1(e,t,r)}:Y1,Vx=function(i,e){var t=vr(i,e);return t>0?au(i,e+4,e+4+t-1):""},Gx=Vx,Wx=function(i,e){var t=vr(i,e);return t>0?au(i,e+4,e+4+t-1):""},jx=Wx,Xx=function(i,e){var t=2*vr(i,e);return t>0?au(i,e+4,e+4+t-1):""},Yx=Xx,qx=function(e,t){var r=vr(e,t);return r>0?up(e,t+4,t+4+r):""},Kx=qx,$x=function(i,e){var t=vr(i,e);return t>0?au(i,e+4,e+4+t):""},Zx=$x,Qx=function(i,e){return z_(i,e)},qc=Qx,Jx=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};gt&&(Gx=function(e,t){if(!Buffer.isBuffer(e))return Vx(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},jx=function(e,t){if(!Buffer.isBuffer(e))return Wx(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},Yx=function(e,t){if(!Buffer.isBuffer(e)||!qo)return Xx(e,t);var r=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r-1)},Kx=function(e,t){if(!Buffer.isBuffer(e)||!qo)return qx(e,t);var r=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r)},Zx=function(e,t){if(!Buffer.isBuffer(e))return $x(e,t);var r=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+r)},qc=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):Qx(e,t)},Jx=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var al=function(i,e){return i[e]},Na=function(i,e){return i[e+1]*256+i[e]},P_=function(i,e){var t=i[e+1]*256+i[e];return t<32768?t:(65535-t+1)*-1},vr=function(i,e){return i[e+3]*(1<<24)+(i[e+2]<<16)+(i[e+1]<<8)+i[e]},is=function(i,e){return i[e+3]<<24|i[e+2]<<16|i[e+1]<<8|i[e]},I_=function(i,e){return i[e]<<24|i[e+1]<<16|i[e+2]<<8|i[e+3]};function Ao(i,e){var t="",r,a,s=[],o,u,h,d;switch(e){case"dbcs":if(d=this.l,gt&&Buffer.isBuffer(this)&&qo)t=this.slice(this.l,this.l+2*i).toString("utf16le");else for(h=0;h<i;++h)t+=String.fromCharCode(Na(this,d)),d+=2;i*=2;break;case"utf8":t=au(this,this.l,this.l+i);break;case"utf16le":i*=2,t=up(this,this.l,this.l+i);break;case"wstr":return Ao.call(this,i,"dbcs");case"lpstr-ansi":t=Gx(this,this.l),i=4+vr(this,this.l);break;case"lpstr-cp":t=jx(this,this.l),i=4+vr(this,this.l);break;case"lpwstr":t=Yx(this,this.l),i=4+2*vr(this,this.l);break;case"lpp4":i=4+vr(this,this.l),t=Kx(this,this.l),i&2&&(i+=2);break;case"8lpp4":i=4+vr(this,this.l),t=Zx(this,this.l),i&3&&(i+=4-(i&3));break;case"cstr":for(i=0,t="";(o=al(this,this.l+i++))!==0;)s.push(Cc(o));t=s.join("");break;case"_wstr":for(i=0,t="";(o=Na(this,this.l+i))!==0;)s.push(Cc(o)),i+=2;i+=2,t=s.join("");break;case"dbcs-cont":for(t="",d=this.l,h=0;h<i;++h){if(this.lens&&this.lens.indexOf(d)!==-1)return o=al(this,d),this.l=d+1,u=Ao.call(this,i-h,o?"dbcs-cont":"sbcs-cont"),s.join("")+u;s.push(Cc(Na(this,d))),d+=2}t=s.join(""),i*=2;break;case"cpstr":case"sbcs-cont":for(t="",d=this.l,h=0;h!=i;++h){if(this.lens&&this.lens.indexOf(d)!==-1)return o=al(this,d),this.l=d+1,u=Ao.call(this,i-h,o?"dbcs-cont":"sbcs-cont"),s.join("")+u;s.push(Cc(al(this,d))),d+=1}t=s.join("");break;default:switch(i){case 1:return r=al(this,this.l),this.l++,r;case 2:return r=(e==="i"?P_:Na)(this,this.l),this.l+=2,r;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(r=(i>0?is:I_)(this,this.l),this.l+=4,r):(a=vr(this,this.l),this.l+=4,a);case 8:case-8:if(e==="f")return i==8?a=qc(this,this.l):a=qc([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;i=8;case 16:t=Ux(this,this.l,i);break}}return this.l+=i,t}var U_=function(i,e,t){i[t]=e&255,i[t+1]=e>>>8&255,i[t+2]=e>>>16&255,i[t+3]=e>>>24&255},V_=function(i,e,t){i[t]=e&255,i[t+1]=e>>8&255,i[t+2]=e>>16&255,i[t+3]=e>>24&255},G_=function(i,e,t){i[t]=e&255,i[t+1]=e>>>8&255};function W_(i,e,t){var r=0,a=0;if(t==="dbcs"){for(a=0;a!=e.length;++a)G_(this,e.charCodeAt(a),this.l+2*a);r=2*e.length}else if(t==="sbcs"||t=="cpstr"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=e.length;++a)this[this.l+a]=e.charCodeAt(a)&255;r=e.length}else if(t==="hex"){for(;a<i;++a)this[this.l++]=parseInt(e.slice(2*a,2*a+2),16)||0;return this}else if(t==="utf16le"){var s=Math.min(this.l+i,this.length);for(a=0;a<Math.min(e.length,i);++a){var o=e.charCodeAt(a);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(i){case 1:r=1,this[this.l]=e&255;break;case 2:r=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:r=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:r=4,U_(this,e,this.l);break;case 8:if(r=8,t==="f"){H_(this,e,this.l);break}case 16:break;case-4:r=4,V_(this,e,this.l);break}return this.l+=r,this}function ew(i,e){var t=Ux(this,this.l,i.length>>1);if(t!==i)throw new Error(e+"Expected "+i+" saw "+t);this.l+=i.length>>1}function bi(i,e){i.l=e,i.read_shift=Ao,i.chk=ew,i.write_shift=W_}function Yi(i,e){i.l+=e}function pi(i){var e=Sn(i);return bi(e,0),e}function Ua(i,e,t){if(i){var r,a,s;bi(i,i.l||0);for(var o=i.length,u=0,h=0;i.l<o;){u=i.read_shift(1),u&128&&(u=(u&127)+((i.read_shift(1)&127)<<7));var d=eh[u]||eh[65535];for(r=i.read_shift(1),s=r&127,a=1;a<4&&r&128;++a)s+=((r=i.read_shift(1))&127)<<7*a;h=i.l+s;var p=d.f&&d.f(i,s,t);if(i.l=h,e(p,d,u))return}}}function h0(){var i=[],e=gt?16384:2048;gt&&pi(e).copy;var t=function(p){var b=pi(p);return bi(b,0),b},r=t(e),a=function(){r&&(r.l&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&i.push(r)),r=null)},s=function(p){return r&&p<r.length-r.l?r:(a(),r=t(Math.max(p+1,e)))},o=function(){return a(),yn(i)},u=function(){return a(),i},h=function(p){a(),r=p,r.l==null&&(r.l=r.length),s(e)};return{next:s,push:h,end:o,_bufs:i,end2:u}}function Do(i,e,t){var r=mi(i);if(e.s?(r.cRel&&(r.c+=e.s.c),r.rRel&&(r.r+=e.s.r)):(r.cRel&&(r.c+=e.c),r.rRel&&(r.r+=e.r)),!t||t.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function q1(i,e,t){var r=mi(i);return r.s=Do(r.s,e.s,t),r.e=Do(r.e,e.s,t),r}function Fo(i,e){if(i.cRel&&i.c<0)for(i=mi(i);i.c<0;)i.c+=e>8?16384:256;if(i.rRel&&i.r<0)for(i=mi(i);i.r<0;)i.r+=e>8?1048576:e>5?65536:16384;var t=kt(i);return!i.cRel&&i.cRel!=null&&(t=Y_(t)),!i.rRel&&i.rRel!=null&&(t=j_(t)),t}function Wd(i,e){return i.s.r==0&&!i.s.rRel&&i.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!i.e.rRel?(i.s.cRel?"":"$")+Dt(i.s.c)+":"+(i.e.cRel?"":"$")+Dt(i.e.c):i.s.c==0&&!i.s.cRel&&i.e.c==(e.biff>=12?16383:255)&&!i.e.cRel?(i.s.rRel?"":"$")+Bt(i.s.r)+":"+(i.e.rRel?"":"$")+Bt(i.e.r):Fo(i.s,e.biff)+":"+Fo(i.e,e.biff)}function cp(i){return parseInt(X_(i),10)-1}function Bt(i){return""+(i+1)}function j_(i){return i.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function X_(i){return i.replace(/\$(\d+)$/,"$1")}function hp(i){for(var e=q_(i),t=0,r=0;r!==e.length;++r)t=26*t+e.charCodeAt(r)-64;return t-1}function Dt(i){if(i<0)throw new Error("invalid column "+i);var e="";for(++i;i;i=Math.floor((i-1)/26))e=String.fromCharCode((i-1)%26+65)+e;return e}function Y_(i){return i.replace(/^([A-Z])/,"$$$1")}function q_(i){return i.replace(/^\$([A-Z])/,"$1")}function K_(i){return i.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ji(i){for(var e=0,t=0,r=0;r<i.length;++r){var a=i.charCodeAt(r);a>=48&&a<=57?e=10*e+(a-48):a>=65&&a<=90&&(t=26*t+(a-64))}return{c:t-1,r:e-1}}function kt(i){for(var e=i.c+1,t="";e;e=(e-1)/26|0)t=String.fromCharCode((e-1)%26+65)+t;return t+(i.r+1)}function xs(i){var e=i.indexOf(":");return e==-1?{s:ji(i),e:ji(i)}:{s:ji(i.slice(0,e)),e:ji(i.slice(e+1))}}function yt(i,e){return typeof e>"u"||typeof e=="number"?yt(i.s,i.e):(typeof i!="string"&&(i=kt(i)),typeof e!="string"&&(e=kt(e)),i==e?i:i+":"+e)}function $_(i,e){if(!i&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(i)?"'"+i.replace(/'/g,"''")+"'":i}function si(i){var e={s:{c:0,r:0},e:{c:0,r:0}},t=0,r=0,a=0,s=i.length;for(t=0;r<s&&!((a=i.charCodeAt(r)-64)<1||a>26);++r)t=26*t+a;for(e.s.c=--t,t=0;r<s&&!((a=i.charCodeAt(r)-48)<0||a>9);++r)t=10*t+a;if(e.s.r=--t,r===s||a!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++r,t=0;r!=s&&!((a=i.charCodeAt(r)-64)<1||a>26);++r)t=26*t+a;for(e.e.c=--t,t=0;r!=s&&!((a=i.charCodeAt(r)-48)<0||a>9);++r)t=10*t+a;return e.e.r=--t,e}function K1(i,e){var t=i.t=="d"&&e instanceof Date;if(i.z!=null)try{return i.w=Er(i.z,t?xi(e):e)}catch{}try{return i.w=Er((i.XF||{}).numFmtId||(t?14:0),t?xi(e):e)}catch{return""+e}}function Rn(i,e,t){return i==null||i.t==null||i.t=="z"?"":i.w!==void 0?i.w:(i.t=="d"&&!i.z&&t&&t.dateNF&&(i.z=t.dateNF),i.t=="e"?sr[i.v]||i.v:e==null?K1(i,i.v):K1(i,e))}function Fn(i,e){var t=e&&e.sheet?e.sheet:"Sheet1",r={};return r[t]=i,{SheetNames:[t],Sheets:r}}function Z_(i){var e={},t=i||{};return t.dense&&(e["!data"]=[]),e}function tw(i,e,t){var r=t||{},a=i?i["!data"]!=null:r.dense,s=i||(a?{"!data":[]}:{});a&&!s["!data"]&&(s["!data"]=[]);var o=0,u=0;if(s&&r.origin!=null)if(typeof r.origin=="number")o=r.origin;else{var h=typeof r.origin=="string"?ji(r.origin):r.origin;o=h.r,u=h.c}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var p=si(s["!ref"]);d.s.c=p.s.c,d.s.r=p.s.r,d.e.c=Math.max(d.e.c,p.e.c),d.e.r=Math.max(d.e.r,p.e.r),o==-1&&(d.e.r=o=s["!ref"]?p.e.r+1:0)}else d.s.c=d.e.c=d.s.r=d.e.r=0;for(var b=[],g=!1,v=0;v!=e.length;++v)if(e[v]){if(!Array.isArray(e[v]))throw new Error("aoa_to_sheet expects an array of arrays");var y=o+v;a&&(s["!data"][y]||(s["!data"][y]=[]),b=s["!data"][y]);for(var C=e[v],E=0;E!=C.length;++E)if(!(typeof C[E]>"u")){var w={v:C[E],t:""},R=u+E;if(d.s.r>y&&(d.s.r=y),d.s.c>R&&(d.s.c=R),d.e.r<y&&(d.e.r=y),d.e.c<R&&(d.e.c=R),g=!0,C[E]&&typeof C[E]=="object"&&!Array.isArray(C[E])&&!(C[E]instanceof Date))w=C[E];else if(Array.isArray(w.v)&&(w.f=C[E][1],w.v=w.v[0]),w.v===null)if(w.f)w.t="n";else if(r.nullError)w.t="e",w.v=0;else if(r.sheetStubs)w.t="z";else continue;else typeof w.v=="number"?isFinite(w.v)?w.t="n":isNaN(w.v)?(w.t="e",w.v=15):(w.t="e",w.v=7):typeof w.v=="boolean"?w.t="b":w.v instanceof Date?(w.z=r.dateNF||st[14],r.UTC||(w.v=hh(w.v)),r.cellDates?(w.t="d",w.w=Er(w.z,xi(w.v,r.date1904))):(w.t="n",w.v=xi(w.v,r.date1904),w.w=Er(w.z,w.v))):w.t="s";if(a)b[R]&&b[R].z&&(w.z=b[R].z),b[R]=w;else{var T=Dt(R)+(y+1);s[T]&&s[T].z&&(w.z=s[T].z),s[T]=w}}}return g&&d.s.c<104e5&&(s["!ref"]=yt(d)),s}function wl(i,e){return tw(null,i,e)}function Q_(i){return i.read_shift(4,"i")}function Xi(i){var e=i.read_shift(4);return e===0?"":i.read_shift(e,"dbcs")}function J_(i){return{ich:i.read_shift(2),ifnt:i.read_shift(2)}}function fp(i,e){var t=i.l,r=i.read_shift(1),a=Xi(i),s=[],o={t:a,h:a};if((r&1)!==0){for(var u=i.read_shift(4),h=0;h!=u;++h)s.push(J_(i));o.r=s}else o.r=[{ich:0,ifnt:0}];return i.l=t+e,o}var eS=fp;function Gr(i){var e=i.read_shift(4),t=i.read_shift(2);return t+=i.read_shift(1)<<16,i.l++,{c:e,iStyleRef:t}}function ws(i){var e=i.read_shift(2);return e+=i.read_shift(1)<<16,i.l++,{c:-1,iStyleRef:e}}var tS=Xi;function dh(i){var e=i.read_shift(4);return e===0||e===4294967295?"":i.read_shift(e,"dbcs")}var iS=Xi,f0=dh;function ph(i){var e=i.slice(i.l,i.l+4),t=e[0]&1,r=e[0]&2;i.l+=4;var a=r===0?qc([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):is(e,0)>>2;return t?a/100:a}function iw(i){var e={s:{},e:{}};return e.s.r=i.read_shift(4),e.e.r=i.read_shift(4),e.s.c=i.read_shift(4),e.e.c=i.read_shift(4),e}var ys=iw;function Wi(i){if(i.length-i.l<8)throw"XLS Xnum Buffer underflow";return i.read_shift(8,"f")}function rS(i){var e={},t=i.read_shift(1),r=t>>>1,a=i.read_shift(1),s=i.read_shift(2,"i"),o=i.read_shift(1),u=i.read_shift(1),h=i.read_shift(1);switch(i.l++,r){case 0:e.auto=1;break;case 1:e.index=a;var d=cs[a];d&&(e.rgb=Qo(d));break;case 2:e.rgb=Qo([o,u,h]);break;case 3:e.theme=a;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function aS(i){var e=i.read_shift(1);i.l++;var t={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return t}function rw(i,e){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},r=i.read_shift(4);switch(r){case 0:return"";case 4294967295:case 4294967294:return t[i.read_shift(4)]||""}if(r>400)throw new Error("Unsupported Clipboard: "+r.toString(16));return i.l-=4,i.read_shift(0,e==1?"lpstr":"lpwstr")}function nS(i){return rw(i,1)}function sS(i){return rw(i,2)}var dp=2,ar=3,_c=11,$1=12,Kc=19,Sc=64,lS=65,oS=71,uS=4108,cS=4126,Ci=80,aw=81,hS=[Ci,aw],fS={1:{n:"CodePage",t:dp},2:{n:"Category",t:Ci},3:{n:"PresentationFormat",t:Ci},4:{n:"ByteCount",t:ar},5:{n:"LineCount",t:ar},6:{n:"ParagraphCount",t:ar},7:{n:"SlideCount",t:ar},8:{n:"NoteCount",t:ar},9:{n:"HiddenCount",t:ar},10:{n:"MultimediaClipCount",t:ar},11:{n:"ScaleCrop",t:_c},12:{n:"HeadingPairs",t:uS},13:{n:"TitlesOfParts",t:cS},14:{n:"Manager",t:Ci},15:{n:"Company",t:Ci},16:{n:"LinksUpToDate",t:_c},17:{n:"CharacterCount",t:ar},19:{n:"SharedDoc",t:_c},22:{n:"HyperlinksChanged",t:_c},23:{n:"AppVersion",t:ar,p:"version"},24:{n:"DigSig",t:lS},26:{n:"ContentType",t:Ci},27:{n:"ContentStatus",t:Ci},28:{n:"Language",t:Ci},29:{n:"Version",t:Ci},255:{},2147483648:{n:"Locale",t:Kc},2147483651:{n:"Behavior",t:Kc},1919054434:{}},dS={1:{n:"CodePage",t:dp},2:{n:"Title",t:Ci},3:{n:"Subject",t:Ci},4:{n:"Author",t:Ci},5:{n:"Keywords",t:Ci},6:{n:"Comments",t:Ci},7:{n:"Template",t:Ci},8:{n:"LastAuthor",t:Ci},9:{n:"RevNumber",t:Ci},10:{n:"EditTime",t:Sc},11:{n:"LastPrinted",t:Sc},12:{n:"CreatedDate",t:Sc},13:{n:"ModifiedDate",t:Sc},14:{n:"PageCount",t:ar},15:{n:"WordCount",t:ar},16:{n:"CharCount",t:ar},17:{n:"Thumbnail",t:oS},18:{n:"Application",t:Ci},19:{n:"DocSecurity",t:ar},255:{},2147483648:{n:"Locale",t:Kc},2147483651:{n:"Behavior",t:Kc},1919054434:{}},Z1={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},pS=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function mS(i){return i.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var gS=mS([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,0,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),cs=mi(gS),sr={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Oi={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},nw=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"],Q1={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function vS(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function bS(i){var e=vS();if(!i||!i.match)return e;var t={};if((i.match(Bi)||[]).forEach(function(r){var a=Ge(r);switch(a[0].replace(T_,"<")){case"<?xml":break;case"<Types":e.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[a.Extension.toLowerCase()]=a.ContentType;break;case"<Override":e[Q1[a.ContentType]]!==void 0&&e[Q1[a.ContentType]].push(a.PartName);break}}),e.xmlns!==N_.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=t,delete e.calcchains,e}var sl={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",CONN:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/connections",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function d0(i){var e=i.lastIndexOf("/");return i.slice(0,e+1)+"_rels/"+i.slice(e+1)+".rels"}function Mo(i,e){var t={"!id":{}};if(!i)return t;e.charAt(0)!=="/"&&(e="/"+e);var r={};return(i.match(Bi)||[]).forEach(function(a){var s=Ge(a);if(s[0]==="<Relationship"){var o={};o.Type=s.Type,o.Target=wt(s.Target),o.Id=s.Id,s.TargetMode&&(o.TargetMode=s.TargetMode);var u=s.TargetMode==="External"?s.Target:nl(s.Target,e);t[u]=o,r[s.Id]=o}}),t["!id"]=r,t}var xS="application/vnd.oasis.opendocument.spreadsheet";function wS(i,e){for(var t=fh(i),r,a;r=di.exec(t);)switch(r[3]){case"manifest":break;case"file-entry":if(a=Ge(r[0],!1),a.path=="/"&&a.type!==xS)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw r}}var J1=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function sw(i){var e={};i=Vt(i);for(var t=0;t<J1.length;++t){var r=J1[t],a=us(i,r[0]);a!=null&&a.length>0&&(e[r[1]]=wt(a[1])),r[2]==="date"&&e[r[1]]&&(e[r[1]]=Ni(e[r[1]]))}return e}var yS=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function lw(i,e,t,r){var a=[];if(typeof i=="string")a=V1(i,r);else for(var s=0;s<i.length;++s)a=a.concat(i[s].map(function(p){return{v:p}}));var o=typeof e=="string"?V1(e,r).map(function(p){return p.v}):e,u=0,h=0;if(o.length>0)for(var d=0;d!==a.length;d+=2){switch(h=+a[d+1].v,a[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":t.Worksheets=h,t.SheetNames=o.slice(u,u+h);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":t.NamedRanges=h,t.DefinedNames=o.slice(u,u+h);break;case"Charts":case"Diagramme":t.Chartsheets=h,t.ChartNames=o.slice(u,u+h);break}u+=h}}function ES(i,e,t){var r={};return e||(e={}),i=Vt(i),yS.forEach(function(a){var s=(_i(i,a[0])||[])[1];switch(a[2]){case"string":s&&(e[a[1]]=wt(s));break;case"bool":e[a[1]]=s==="true";break;case"raw":var o=us(i,a[0]);o&&o.length>0&&(r[a[1]]=o[1]);break}}),r.HeadingPairs&&r.TitlesOfParts&&lw(r.HeadingPairs,r.TitlesOfParts,e,t),e}var CS=/<[^<>]+>[^<]*/g;function TS(i,e){var t={},r="",a=i.match(CS);if(a)for(var s=0;s!=a.length;++s){var o=a[s],u=Ge(o);switch(Vr(u[0])){case"<?xml":break;case"<Properties":break;case"<property":r=wt(u.name);break;case"</property>":r=null;break;default:if(o.indexOf("<vt:")===0){var h=o.split(">"),d=h[0].slice(4),p=h[1];switch(d){case"lpstr":case"bstr":case"lpwstr":t[r]=wt(p);break;case"bool":t[r]=Nt(p);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[r]=parseInt(p,10);break;case"r4":case"r8":case"decimal":t[r]=parseFloat(p);break;case"filetime":case"date":t[r]=Ni(p);break;case"cy":case"error":t[r]=wt(p);break;default:if(d.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",o,d,h)}}else if(o.slice(0,2)!=="</"){if(e.WTF)throw new Error(o)}}}return t}var _S={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},jd;function SS(i,e,t){jd||(jd=np(_S)),e=jd[e]||e,i[e]=t}function pp(i){var e=i.read_shift(4),t=i.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function RS(i,e,t){var r=i.l,a=i.read_shift(0,"lpstr-cp");if(t)for(;i.l-r&3;)++i.l;return a}function kS(i,e,t){var r=i.read_shift(0,"lpwstr");return r}function ow(i,e,t){return e===31?kS(i):RS(i,e,t)}function Oo(i,e,t){return ow(i,e,t===!1?0:4)}function AS(i,e){if(!e)throw new Error("VtUnalignedString must have positive length");return ow(i,e,0)}function DS(i){for(var e=i.read_shift(4),t=[],r=0;r!=e;++r){var a=i.l;t[r]=i.read_shift(0,"lpwstr").replace(nr,""),i.l-a&2&&(i.l+=2)}return t}function FS(i){for(var e=i.read_shift(4),t=[],r=0;r!=e;++r)t[r]=i.read_shift(0,"lpstr-cp").replace(nr,"");return t}function MS(i){var e=i.l,t=$c(i,aw);i[i.l]==0&&i[i.l+1]==0&&i.l-e&2&&(i.l+=2);var r=$c(i,ar);return[t,r]}function OS(i){for(var e=i.read_shift(4),t=[],r=0;r<e/2;++r)t.push(MS(i));return t}function eb(i,e){for(var t=i.read_shift(4),r={},a=0;a!=t;++a){var s=i.read_shift(4),o=i.read_shift(4);r[s]=i.read_shift(o,e===1200?"utf16le":"utf8").replace(nr,"").replace(Co,"!"),e===1200&&o%2&&(i.l+=2)}return i.l&3&&(i.l=i.l>>3<<2),r}function uw(i){var e=i.read_shift(4),t=i.slice(i.l,i.l+e);return i.l+=e,(e&3)>0&&(i.l+=4-(e&3)&3),t}function LS(i){var e={};return e.Size=i.read_shift(4),i.l+=e.Size+3-(e.Size-1)%4,e}function $c(i,e,t){var r=i.read_shift(2),a,s=t||{};if(i.l+=2,e!==$1&&r!==e&&hS.indexOf(e)===-1&&!((e&65534)==4126&&(r&65534)==4126))throw new Error("Expected type "+e+" saw "+r);switch(e===$1?r:e){case 2:return a=i.read_shift(2,"i"),s.raw||(i.l+=2),a;case 3:return a=i.read_shift(4,"i"),a;case 11:return i.read_shift(4)!==0;case 19:return a=i.read_shift(4),a;case 30:i.l+=4,val=Oo(i,i[i.l-4]).replace(/(^|[^\u0000])\u0000+$/,"$1");break;case 31:i.l+=4,val=Oo(i,i[i.l-4]).replace(/(^|[^\u0000])\u0000+$/,"$1");break;case 64:return pp(i);case 65:return uw(i);case 71:return LS(i);case 80:return Oo(i,r,!s.raw).replace(nr,"");case 81:return AS(i,r).replace(nr,"");case 4108:return OS(i);case 4126:case 4127:return r==4127?DS(i):FS(i);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+r)}}function tb(i,e){var t=i.l,r=i.read_shift(4),a=i.read_shift(4),s=[],o=0,u=0,h=-1,d={};for(o=0;o!=a;++o){var p=i.read_shift(4),b=i.read_shift(4);s[o]=[p,b+t]}s.sort(function(R,T){return R[1]-T[1]});var g={};for(o=0;o!=a;++o){if(i.l!==s[o][1]){var v=!0;if(o>0&&e)switch(e[s[o-1][0]].t){case 2:i.l+2===s[o][1]&&(i.l+=2,v=!1);break;case 80:i.l<=s[o][1]&&(i.l=s[o][1],v=!1);break;case 4108:i.l<=s[o][1]&&(i.l=s[o][1],v=!1);break}if((!e||o==0)&&i.l<=s[o][1]&&(v=!1,i.l=s[o][1]),v)throw new Error("Read Error: Expected address "+s[o][1]+" at "+i.l+" :"+o)}if(e){if(s[o][0]==0&&s.length>o+1&&s[o][1]==s[o+1][1])continue;var y=e[s[o][0]];if(g[y.n]=$c(i,y.t,{raw:!0}),y.p==="version"&&(g[y.n]=String(g[y.n]>>16)+"."+("0000"+String(g[y.n]&65535)).slice(-4)),y.n=="CodePage")switch(g[y.n]){case 0:g[y.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Jr(u=g[y.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+g[y.n])}}else if(s[o][0]===1){if(u=g.CodePage=$c(i,dp),Jr(u),h!==-1){var C=i.l;i.l=s[h][1],d=eb(i,u),i.l=C}}else if(s[o][0]===0){if(u===0){h=o,i.l=s[o+1][1];continue}d=eb(i,u)}else{var E=d[s[o][0]],w;switch(i[i.l]){case 65:i.l+=4,w=uw(i);break;case 30:i.l+=4,w=Oo(i,i[i.l-4]).replace(/(^|[^\u0000])\u0000+$/,"$1");break;case 31:i.l+=4,w=Oo(i,i[i.l-4]).replace(/(^|[^\u0000])\u0000+$/,"$1");break;case 3:i.l+=4,w=i.read_shift(4,"i");break;case 19:i.l+=4,w=i.read_shift(4);break;case 5:i.l+=4,w=i.read_shift(8,"f");break;case 11:i.l+=4,w=ni(i,4);break;case 64:i.l+=4,w=Ni(pp(i));break;default:throw new Error("unparsed value: "+i[i.l])}g[E]=w}}return i.l=t+r,g}function ib(i,e,t){var r=i.content;if(!r)return{};bi(r,0);var a,s,o,u,h=0;r.chk("feff","Byte Order: "),r.read_shift(2);var d=r.read_shift(4),p=r.read_shift(16);if(p!==Tt.utils.consts.HEADER_CLSID&&p!==t)throw new Error("Bad PropertySet CLSID "+p);if(a=r.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(s=r.read_shift(16),u=r.read_shift(4),a===1&&u!==r.l)throw new Error("Length mismatch: "+u+" !== "+r.l);a===2&&(o=r.read_shift(16),h=r.read_shift(4));var b=tb(r,e),g={SystemIdentifier:d};for(var v in b)g[v]=b[v];if(g.FMTID=s,a===1)return g;if(h-r.l==2&&(r.l+=2),r.l!==h)throw new Error("Length mismatch 2: "+r.l+" !== "+h);var y;try{y=tb(r,null)}catch{}for(v in y)g[v]=y[v];return g.FMTID=[s,o],g}function dn(i,e){return i.read_shift(e),null}function NS(i,e,t){for(var r=[],a=i.l+e;i.l<a;)r.push(t(i,a-i.l));if(a!==i.l)throw new Error("Slurp error");return r}function ni(i,e){return i.read_shift(e)===1}function ei(i){return i.read_shift(2,"u")}function cw(i,e){return NS(i,e,ei)}function hw(i){var e=i.read_shift(1),t=i.read_shift(1);return t===1?e:e===1}function vl(i,e,t){var r=i.read_shift(t&&t.biff>=12?2:1),a="sbcs-cont",s=Pr;if(t&&t.biff>=8&&(Pr=1200),!t||t.biff==8){var o=i.read_shift(1);o&&(a="dbcs-cont")}else t.biff==12&&(a="wstr");t.biff>=2&&t.biff<=5&&(a="cpstr");var u=r?i.read_shift(r,a):"";return Pr=s,u}function BS(i){var e=Pr;Pr=1200;var t=i.read_shift(2),r=i.read_shift(1),a=r&4,s=r&8,o=1+(r&1),u=0,h,d={};s&&(u=i.read_shift(2)),a&&(h=i.read_shift(4));var p=o==2?"dbcs-cont":"sbcs-cont",b=t===0?"":i.read_shift(t,p);return s&&(i.l+=4*u),a&&(i.l+=h),d.t=b,s||(d.raw="<t>"+d.t+"</t>",d.r=d.t),Pr=e,d}function bs(i,e,t){var r;if(t){if(t.biff>=2&&t.biff<=5)return i.read_shift(e,"cpstr");if(t.biff>=12)return i.read_shift(e,"dbcs-cont")}var a=i.read_shift(1);return a===0?r=i.read_shift(e,"sbcs-cont"):r=i.read_shift(e,"dbcs-cont"),r}function nu(i,e,t){var r=i.read_shift(t&&t.biff==2?1:2);return r===0?(i.l++,""):bs(i,r,t)}function Es(i,e,t){if(t.biff>5)return nu(i,e,t);var r=i.read_shift(1);return r===0?(i.l++,""):i.read_shift(r,t.biff<=4||!i.lens?"cpstr":"sbcs-cont")}function zS(i){var e=i.read_shift(1);i.l++;var t=i.read_shift(2);return i.l+=2,[e,t]}function HS(i){var e=i.read_shift(4),t=i.l,r=!1;e>24&&(i.l+=e-24,i.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(r=!0),i.l=t);var a=i.read_shift((r?e-24:e)>>1,"utf16le").replace(nr,"");return r&&(i.l+=24),a}function PS(i){for(var e=i.read_shift(2),t="";e-- >0;)t+="../";var r=i.read_shift(0,"lpstr-ansi");if(i.l+=2,i.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=i.read_shift(4);if(a===0)return t+r.replace(/\\/g,"/");var s=i.read_shift(4);if(i.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=i.read_shift(s>>1,"utf16le").replace(nr,"");return t+o}function IS(i,e){var t=i.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return HS(i);case"0303000000000000c000000000000046":return PS(i);default:throw new Error("Unsupported Moniker "+t)}}function Rc(i){var e=i.read_shift(4),t=e>0?i.read_shift(e,"utf16le").replace(nr,""):"";return t}function US(i,e){var t=i.l+e,r=i.read_shift(4);if(r!==2)throw new Error("Unrecognized streamVersion: "+r);var a=i.read_shift(2);i.l+=2;var s,o,u,h,d="",p,b;a&16&&(s=Rc(i,t-i.l)),a&128&&(o=Rc(i,t-i.l)),(a&257)===257&&(u=Rc(i,t-i.l)),(a&257)===1&&(h=IS(i,t-i.l)),a&8&&(d=Rc(i,t-i.l)),a&32&&(p=i.read_shift(16)),a&64&&(b=pp(i)),i.l=t;var g=o||u||h||"";g&&d&&(g+="#"+d),g||(g="#"+d),a&2&&g.charAt(0)=="/"&&g.charAt(1)!="/"&&(g="file://"+g);var v={Target:g};return p&&(v.guid=p),b&&(v.time=b),s&&(v.Tooltip=s),v}function fw(i){var e=i.read_shift(1),t=i.read_shift(1),r=i.read_shift(1),a=i.read_shift(1);return[e,t,r,a]}function dw(i,e){var t=fw(i);return t[3]=0,t}function ia(i,e,t){var r=i.read_shift(2),a=i.read_shift(2),s={r,c:a,ixfe:0};if(t&&t.biff==2||e==7){var o=i.read_shift(1);s.ixfe=o&63,i.l+=2}else s.ixfe=i.read_shift(2);return s}function VS(i){var e=i.read_shift(2),t=i.read_shift(2);return i.l+=8,{type:e,flags:t}}function GS(i,e,t){return e===0?"":Es(i,e,t)}function WS(i,e,t){var r=t.biff>8?4:2,a=i.read_shift(r),s=i.read_shift(r,"i"),o=i.read_shift(r,"i");return[a,s,o]}function pw(i){var e=i.read_shift(2),t=ph(i);return[e,t]}function jS(i,e,t){i.l+=4,e-=4;var r=i.l+e,a=vl(i,e,t),s=i.read_shift(2);if(r-=i.l,s!==r)throw new Error("Malformed AddinUdf: padding = "+r+" != "+s);return i.l+=s,a}function mh(i){var e=i.read_shift(2),t=i.read_shift(2),r=i.read_shift(2),a=i.read_shift(2);return{s:{c:r,r:e},e:{c:a,r:t}}}function mw(i){var e=i.read_shift(2),t=i.read_shift(2),r=i.read_shift(1),a=i.read_shift(1);return{s:{c:r,r:e},e:{c:a,r:t}}}var XS=mw;function gw(i){i.l+=4;var e=i.read_shift(2),t=i.read_shift(2),r=i.read_shift(2);return i.l+=12,[t,e,r]}function YS(i){var e={};return i.l+=4,i.l+=16,e.fSharedNote=i.read_shift(2),i.l+=4,e}function qS(i){var e={};return i.l+=4,i.cf=i.read_shift(2),e}function Ui(i){i.l+=2,i.l+=i.read_shift(2)}var KS={0:Ui,4:Ui,5:Ui,6:Ui,7:qS,8:Ui,9:Ui,10:Ui,11:Ui,12:Ui,13:YS,14:Ui,15:Ui,16:Ui,17:Ui,18:Ui,19:Ui,20:Ui,21:gw};function $S(i,e){for(var t=i.l+e,r=[];i.l<t;){var a=i.read_shift(2);i.l-=2;try{r[a]=KS[a](i,t-i.l)}catch{return i.l=t,r}}return i.l!=t&&(i.l=t),r}function kc(i,e){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=i.read_shift(2),e-=2,e>=2&&(t.dt=i.read_shift(2),i.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return i.read_shift(e),t}function ZS(i,e){return e===0||i.read_shift(2),1200}function QS(i,e,t){if(t.enc)return i.l+=e,"";var r=i.l,a=Es(i,0,t);return i.read_shift(e+r-i.l),a}function JS(i,e,t){var r=t&&t.biff==8||e==2?i.read_shift(2):(i.l+=e,0);return{fDialog:r&16,fBelow:r&64,fRight:r&128}}function eR(i,e,t){var r="";if(t.biff==4)return r=vl(i,0,t),r.length===0&&(r="Sheet1"),{name:r};var a=i.read_shift(4),s=i.read_shift(1)&3,o=i.read_shift(1);switch(o){case 0:o="Worksheet";break;case 1:o="Macrosheet";break;case 2:o="Chartsheet";break;case 6:o="VBAModule";break}return r=vl(i,0,t),r.length===0&&(r="Sheet1"),{pos:a,hs:s,dt:o,name:r}}function tR(i,e){for(var t=i.l+e,r=i.read_shift(4),a=i.read_shift(4),s=[],o=0;o!=a&&i.l<t;++o)s.push(BS(i));return s.Count=r,s.Unique=a,s}function iR(i,e){var t={};return t.dsst=i.read_shift(2),i.l+=e-2,t}function rR(i){var e={};e.r=i.read_shift(2),e.c=i.read_shift(2),e.cnt=i.read_shift(2)-e.c;var t=i.read_shift(2);i.l+=4;var r=i.read_shift(1);return i.l+=3,r&7&&(e.level=r&7),r&32&&(e.hidden=!0),r&64&&(e.hpt=t/20),e}function aR(i){var e=VS(i);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var t=i.read_shift(4);return t!==0}function nR(i){return i.read_shift(2),i.read_shift(4)}function rb(i,e,t){var r=0;t&&t.biff==2||(r=i.read_shift(2));var a=i.read_shift(2);t&&t.biff==2&&(r=1-(a>>15),a&=32767);var s={Unsynced:r&1,DyZero:(r&2)>>1,ExAsc:(r&4)>>2,ExDsc:(r&8)>>3};return[s,a]}function sR(i){var e=i.read_shift(2),t=i.read_shift(2),r=i.read_shift(2),a=i.read_shift(2),s=i.read_shift(2),o=i.read_shift(2),u=i.read_shift(2),h=i.read_shift(2),d=i.read_shift(2);return{Pos:[e,t],Dim:[r,a],Flags:s,CurTab:o,FirstTab:u,Selected:h,TabRatio:d}}function lR(i,e,t){if(t&&t.biff>=2&&t.biff<5)return{};var r=i.read_shift(2);return{RTL:r&64}}function oR(){}function uR(i,e,t){var r={dyHeight:i.read_shift(2),fl:i.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:i.l+=2;break;default:i.l+=10;break}return r.name=vl(i,0,t),r}function cR(i,e,t){var r=ia(i,e,t);return r.isst=i.read_shift(4),r}function hR(i,e,t){t.biffguess&&t.biff==2&&(t.biff=5);var r=i.l+e,a=ia(i,e,t),s=nu(i,r-i.l,t);return a.val=s,a}function fR(i,e,t){var r=i.read_shift(2),a=Es(i,0,t);return[r,a]}var dR=Es;function ab(i,e,t){var r=i.l+e,a=t.biff==8||!t.biff?4:2,s=i.read_shift(a),o=i.read_shift(a),u=i.read_shift(2),h=i.read_shift(2);return i.l=r,{s:{r:s,c:u},e:{r:o,c:h}}}function pR(i){var e=i.read_shift(2),t=i.read_shift(2),r=pw(i);return{r:e,c:t,ixfe:r[0],rknum:r[1]}}function mR(i,e){for(var t=i.l+e-2,r=i.read_shift(2),a=i.read_shift(2),s=[];i.l<t;)s.push(pw(i));if(i.l!==t)throw new Error("MulRK read error");var o=i.read_shift(2);if(s.length!=o-a+1)throw new Error("MulRK length mismatch");return{r,c:a,C:o,rkrec:s}}function gR(i,e){for(var t=i.l+e-2,r=i.read_shift(2),a=i.read_shift(2),s=[];i.l<t;)s.push(i.read_shift(2));if(i.l!==t)throw new Error("MulBlank read error");var o=i.read_shift(2);if(s.length!=o-a+1)throw new Error("MulBlank length mismatch");return{r,c:a,C:o,ixfe:s}}function vR(i,e,t,r){var a={},s=i.read_shift(4),o=i.read_shift(4),u=i.read_shift(4),h=i.read_shift(2);return a.patternType=pS[u>>26],r.cellStyles&&(a.alc=s&7,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=o&15,a.dgRight=o>>4&15,a.dgTop=o>>8&15,a.dgBottom=o>>12&15,a.icvLeft=o>>16&127,a.icvRight=o>>23&127,a.grbitDiag=o>>30&3,a.icvTop=u&127,a.icvBottom=u>>7&127,a.icvDiag=u>>14&127,a.dgDiag=u>>21&15,a.icvFore=h&127,a.icvBack=h>>7&127,a.fsxButton=h>>14&1),a}function bR(i,e,t){var r={};return r.ifnt=i.read_shift(2),r.numFmtId=i.read_shift(2),r.flags=i.read_shift(2),r.fStyle=r.flags>>2&1,e-=6,r.data=vR(i,e,r.fStyle,t),r}function xR(i){var e={};return e.ifnt=i.read_shift(1),i.l++,e.flags=i.read_shift(1),e.numFmtId=e.flags&63,e.flags>>=6,e.fStyle=0,e.data={},e}function wR(i){var e={};return e.ifnt=i.read_shift(1),e.numFmtId=i.read_shift(1),e.flags=i.read_shift(2),e.fStyle=e.flags>>2&1,e.data={},e}function yR(i){var e={};return e.ifnt=i.read_shift(1),e.numFmtId=i.read_shift(1),e.flags=i.read_shift(2),e.fStyle=e.flags>>2&1,e.data={},e}function ER(i){i.l+=4;var e=[i.read_shift(2),i.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function CR(i,e,t){var r=ia(i,6,t),a=hw(i);return r.val=a,r.t=a===!0||a===!1?"b":"e",r}function TR(i,e,t){t.biffguess&&t.biff==2&&(t.biff=5);var r=ia(i,6,t),a=Wi(i);return r.val=a,r}var nb=GS;function _R(i,e,t){var r=i.l+e,a=i.read_shift(2),s=i.read_shift(2);if(t.sbcch=s,s==1025||s==14849)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var o=bs(i,s),u=[];r>i.l;)u.push(nu(i));return[s,a,o,u]}function sb(i,e,t){var r=i.read_shift(2),a,s={fBuiltIn:r&1,fWantAdvise:r>>>1&1,fWantPict:r>>>2&1,fOle:r>>>3&1,fOleLink:r>>>4&1,cf:r>>>5&1023,fIcon:r>>>15&1};return t.sbcch===14849&&(a=jS(i,e-2,t)),s.body=a||i.read_shift(e-2),typeof a=="string"&&(s.Name=a),s}function lb(i,e,t){var r=i.l+e,a=i.read_shift(2),s=i.read_shift(1),o=i.read_shift(1),u=i.read_shift(t&&t.biff==2?1:2),h=0;(!t||t.biff>=5)&&(t.biff!=5&&(i.l+=2),h=i.read_shift(2),t.biff==5&&(i.l+=2),i.l+=4);var d=bs(i,o,t);a&32&&(d=nw[d.charCodeAt(0)]);var p=r-i.l;t&&t.biff==2&&--p;var b=r==i.l||u===0||!(p>0)?[]:eD(i,p,t,u);return{chKey:s,Name:d,itab:h,rgce:b}}function vw(i,e,t){if(t.biff<8||!(t.biff>8)&&e==i[i.l]+(i[i.l+1]==3?1:0)+1)return ob(i,e,t);for(var r=[],a=i.l+e,s=i.read_shift(t.biff>8?4:2);s--!==0;)r.push(WS(i,t.biff>8?12:6,t));if(i.l!=a)throw new Error("Bad ExternSheet: "+i.l+" != "+a);return r}function ob(i,e,t){i[i.l+1]==3&&i[i.l]++;var r=vl(i,e,t);return r.charCodeAt(0)==3?r.slice(1):r}function SR(i,e,t){if(t.biff<8){i.l+=e;return}var r=i.read_shift(2),a=i.read_shift(2),s=bs(i,r,t),o=bs(i,a,t);return[s,o]}function RR(i,e,t){var r=mw(i);i.l++;var a=i.read_shift(1);return e-=8,[tD(i,e,t),a,r]}function ub(i,e,t){var r=XS(i);switch(t.biff){case 2:i.l++,e-=7;break;case 3:case 4:i.l+=2,e-=8;break;default:i.l+=6,e-=12}return[r,Q4(i,e,t)]}function kR(i){var e=i.read_shift(4)!==0,t=i.read_shift(4)!==0,r=i.read_shift(4);return[e,t,r]}function AR(i,e,t){var r=i.read_shift(2),a=i.read_shift(2),s=i.read_shift(2),o=i.read_shift(2),u=Es(i,0,t);return[{r,c:a},u,o,s]}function DR(i,e,t){if(t&&t.biff<8){var r=i.read_shift(2),a=i.read_shift(2);if(r==65535||r==-1)return;var s=i.read_shift(2),o=i.read_shift(Math.min(s,2048),"cpstr");return[{r,c:a},o]}return AR(i,e,t)}function FR(i,e){for(var t=[],r=i.read_shift(2);r--;)t.push(mh(i));return t}function MR(i,e,t){if(t&&t.biff<8)return LR(i,e,t);var r=gw(i),a=$S(i,e-22,r[1]);return{cmo:r,ft:a}}var OR={8:function(i,e){var t=i.l+e;i.l+=10;var r=i.read_shift(2);i.l+=4,i.l+=2,i.l+=2,i.l+=2,i.l+=4;var a=i.read_shift(1);return i.l+=a,i.l=t,{fmt:r}}};function LR(i,e,t){i.l+=4;var r=i.read_shift(2),a=i.read_shift(2),s=i.read_shift(2);i.l+=2,i.l+=2,i.l+=2,i.l+=2,i.l+=2,i.l+=2,i.l+=2,i.l+=2,i.l+=2,i.l+=6,e-=36;var o=[];return o.push((OR[r]||Yi)(i,e,t)),{cmo:[a,r,s],ft:o}}function NR(i,e,t){var r=i.l,a="";try{i.l+=4;var s=(t.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(s)==-1?i.l+=6:o=zS(i,6,t);var u=i.read_shift(2);i.read_shift(2),ei(i,2);var h=i.read_shift(2);i.l+=h;for(var d=1;d<i.lens.length-1;++d){if(i.l-r!=i.lens[d])throw new Error("TxO: bad continue record");var p=i[i.l],b=bs(i,i.lens[d+1]-i.lens[d]-1);if(a+=b,a.length>=(p?u:2*u))break}if(a.length!==u&&a.length!==u*2)throw new Error("cchText: "+u+" != "+a.length);return i.l=r+e,{t:a}}catch{return i.l=r+e,{t:a}}}function BR(i,e){var t=mh(i);i.l+=16;var r=US(i,e-24);return[t,r]}function zR(i,e){i.read_shift(2);var t=mh(i),r=i.read_shift((e-10)/2,"dbcs-cont");return r=r.replace(nr,""),[t,r]}function HR(i){var e=[0,0],t;return t=i.read_shift(2),e[0]=Z1[t]||t,t=i.read_shift(2),e[1]=Z1[t]||t,e}function PR(i){for(var e=i.read_shift(2),t=[];e-- >0;)t.push(dw(i));return t}function IR(i){for(var e=i.read_shift(2),t=[];e-- >0;)t.push(dw(i));return t}function UR(i){i.l+=2;var e={cxfs:0,crc:0};return e.cxfs=i.read_shift(2),e.crc=i.read_shift(4),e}function bw(i,e,t){if(!t.cellStyles)return Yi(i,e);var r=t&&t.biff>=12?4:2,a=i.read_shift(r),s=i.read_shift(r),o=i.read_shift(r),u=i.read_shift(r),h=i.read_shift(2);r==2&&(i.l+=2);var d={s:a,e:s,w:o,ixfe:u,flags:h};return(t.biff>=5||!t.biff)&&(d.level=h>>8&7),d}function VR(i,e){var t={};return e<32||(i.l+=16,t.header=Wi(i),t.footer=Wi(i),i.l+=2),t}function GR(i,e,t){var r={area:!1};if(t.biff!=5)return i.l+=e,r;var a=i.read_shift(1);return i.l+=3,a&16&&(r.area=!0),r}var WR=ia,jR=cw,XR=nu;function YR(i){var e=i.read_shift(2),t=i.read_shift(2),r=i.read_shift(4),a={fmt:e,env:t,len:r,data:i.slice(i.l,i.l+r)};return i.l+=r,a}function qR(i,e,t){t.biffguess&&t.biff==5&&(t.biff=2);var r=ia(i,7,t),a=Es(i,e-7,t);return r.t="str",r.val=a,r}function KR(i,e,t){var r=ia(i,7,t),a=Wi(i);return r.t="n",r.val=a,r}function $R(i,e,t){var r=ia(i,7,t),a=i.read_shift(2);return r.t="n",r.val=a,r}function ZR(i){var e=i.read_shift(1);return e===0?(i.l++,""):i.read_shift(e,"sbcs-cont")}function QR(i,e,t){var r=i.l+7,a=ia(i,6,t);i.l=r;var s=hw(i);return a.val=s,a.t=s===!0||s===!1?"b":"e",a}function JR(i,e){i.l+=6,i.l+=2,i.l+=1,i.l+=3,i.l+=1,i.l+=e-13}function ek(i,e,t){var r=i.l+e,a=ia(i,6,t),s=i.read_shift(2),o=bs(i,s,t);return i.l=r,a.t="str",a.val=o,a}function tk(i){var e=i.read_shift(4),t=i.read_shift(1),r=i.read_shift(t,"sbcs");return r.length===0&&(r="Sheet1"),{flags:e,name:r}}var ik=[2,3,48,49,131,139,140,245],cb=function(){var i={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=np({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(u,h){var d=[],p=Sn(1);switch(h.type){case"base64":p=gr(yr(u));break;case"binary":p=gr(u);break;case"buffer":case"array":p=u;break}bi(p,0);var b=p.read_shift(1),g=!!(b&136),v=!1,y=!1;switch(b){case 2:break;case 3:break;case 48:v=!0,g=!0;break;case 49:v=!0,g=!0;break;case 131:break;case 139:break;case 140:y=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+b.toString(16))}var C=0,E=521;b==2&&(C=p.read_shift(2)),p.l+=3,b!=2&&(C=p.read_shift(4)),C>1048576&&(C=1e6),b!=2&&(E=p.read_shift(2));var w=p.read_shift(2);h.codepage,b!=2&&(p.l+=16,p.read_shift(1),p[p.l]!==0&&i[p[p.l]],p.l+=1,p.l+=2),y&&(p.l+=36);for(var R=[],T={},D=Math.min(p.length,b==2?521:E-10-(v?264:0)),k=y?32:11;p.l<D&&p[p.l]!=13;)switch(T={},T.name=Ia(p.slice(p.l,p.l+k)).replace(/[\u0000\r\n][\S\s]*$/g,""),p.l+=k,T.type=String.fromCharCode(p.read_shift(1)),b!=2&&!y&&(T.offset=p.read_shift(4)),T.len=p.read_shift(1),b==2&&(T.offset=p.read_shift(2)),T.dec=p.read_shift(1),T.name.length&&R.push(T),b!=2&&(p.l+=y?13:14),T.type){case"B":(!v||T.len!=8)&&h.WTF&&console.log("Skipping "+T.name+":"+T.type);break;case"G":case"P":h.WTF&&console.log("Skipping "+T.name+":"+T.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+T.type)}if(p[p.l]!==13&&(p.l=E-1),p.read_shift(1)!==13)throw new Error("DBF Terminator not found "+p.l+" "+p[p.l]);p.l=E;var V=0,P=0;for(d[0]=[],P=0;P!=R.length;++P)d[0][P]=R[P].name;for(;C-- >0;){if(p[p.l]===42){p.l+=w;continue}for(++p.l,d[++V]=[],P=0,P=0;P!=R.length;++P){var U=p.slice(p.l,p.l+R[P].len);p.l+=R[P].len,bi(U,0);var N=Ia(U);switch(R[P].type){case"C":N.trim().length&&(d[V][P]=N.replace(/([^\s])\s+$/,"$1"));break;case"D":N.length===8?(d[V][P]=new Date(Date.UTC(+N.slice(0,4),+N.slice(4,6)-1,+N.slice(6,8),0,0,0,0)),h&&h.UTC||(d[V][P]=vs(d[V][P]))):d[V][P]=N;break;case"F":d[V][P]=parseFloat(N.trim());break;case"+":case"I":d[V][P]=y?U.read_shift(-4,"i")^2147483648:U.read_shift(4,"i");break;case"L":switch(N.trim().toUpperCase()){case"Y":case"T":d[V][P]=!0;break;case"N":case"F":d[V][P]=!1;break;case"":case"\0":case"?":break;default:throw new Error("DBF Unrecognized L:|"+N+"|")}break;case"M":if(!g)throw new Error("DBF Unexpected MEMO for type "+b.toString(16));d[V][P]="##MEMO##"+(y?parseInt(N.trim(),10):U.read_shift(4));break;case"N":N=N.replace(/\u0000/g,"").trim(),N&&N!="."&&(d[V][P]=+N||0);break;case"@":d[V][P]=new Date(U.read_shift(-8,"f")-621356832e5);break;case"T":{var j=U.read_shift(4),Y=U.read_shift(4);if(j==0&&Y==0)break;d[V][P]=new Date((j-2440588)*864e5+Y),h&&h.UTC||(d[V][P]=vs(d[V][P]))}break;case"Y":d[V][P]=U.read_shift(4,"i")/1e4+U.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[V][P]=-U.read_shift(-8,"f");break;case"B":if(v&&R[P].len==8){d[V][P]=U.read_shift(8,"f");break}case"G":case"P":U.l+=R[P].len;break;case"0":if(R[P].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+R[P].type)}}}if(b!=2&&p.l<p.length&&p[p.l++]!=26)throw new Error("DBF EOF Marker missing "+(p.l-1)+" of "+p.length+" "+p[p.l-1].toString(16));return h&&h.sheetRows&&(d=d.slice(0,h.sheetRows)),h.DBF=R,d}function r(u,h){var d=h||{};d.dateNF||(d.dateNF="yyyymmdd");var p=wl(t(u,d),d);return p["!cols"]=d.DBF.map(function(b){return{wch:b.len,DBF:b}}),delete d.DBF,p}function a(u,h){try{var d=Fn(r(u,h),h);return d.bookType="dbf",d}catch(p){if(h&&h.WTF)throw p}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function o(u,h){if(!u["!ref"])throw new Error("Cannot export empty sheet to DBF");var d=h||{},p=Pr;if(+d.codepage>=0&&Jr(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var b=h0(),g=v0(u,{header:1,raw:!0,cellDates:!0}),v=g[0],y=g.slice(1),C=u["!cols"]||[],E=0,w=0,R=0,T=1;for(E=0;E<v.length;++E){if(((C[E]||{}).DBF||{}).name){v[E]=C[E].DBF.name,++R;continue}if(v[E]!=null){if(++R,typeof v[E]=="number"&&(v[E]=v[E].toString(10)),typeof v[E]!="string")throw new Error("DBF Invalid column name "+v[E]+" |"+typeof v[E]+"|");if(v.indexOf(v[E])!==E){for(w=0;w<1024;++w)if(v.indexOf(v[E]+"_"+w)==-1){v[E]+="_"+w;break}}}}var D=si(u["!ref"]),k=[],V=[],P=[];for(E=0;E<=D.e.c-D.s.c;++E){var U="",N="",j=0,Y=[];for(w=0;w<y.length;++w)y[w][E]!=null&&Y.push(y[w][E]);if(Y.length==0||v[E]==null){k[E]="?";continue}for(w=0;w<Y.length;++w){switch(typeof Y[w]){case"number":N="B";break;case"string":N="C";break;case"boolean":N="L";break;case"object":N=Y[w]instanceof Date?"D":"C";break;default:N="C"}j=Math.max(j,String(Y[w]).length),U=U&&U!=N?"C":N}j>250&&(j=250),N=((C[E]||{}).DBF||{}).type,N=="C"&&C[E].DBF.len>j&&(j=C[E].DBF.len),U=="B"&&N=="N"&&(U="N",P[E]=C[E].DBF.dec,j=C[E].DBF.len),V[E]=U=="C"||N=="N"?j:s[U]||0,T+=V[E],k[E]=U}var Z=b.next(32);for(Z.write_shift(4,318902576),Z.write_shift(4,y.length),Z.write_shift(2,296+32*R),Z.write_shift(2,T),E=0;E<4;++E)Z.write_shift(4,0);var ce=+e[Pr]||3;for(Z.write_shift(4,0|ce<<8),i[ce]!=+d.codepage&&(d.codepage&&console.error("DBF Unsupported codepage "+Pr+", using 1252"),Pr=1252),E=0,w=0;E<v.length;++E)if(v[E]!=null){var Le=b.next(32),ge=(v[E].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);Le.write_shift(1,ge,"sbcs"),Le.write_shift(1,k[E]=="?"?"C":k[E],"sbcs"),Le.write_shift(4,w),Le.write_shift(1,V[E]||s[k[E]]||0),Le.write_shift(1,P[E]||0),Le.write_shift(1,2),Le.write_shift(4,0),Le.write_shift(1,0),Le.write_shift(4,0),Le.write_shift(4,0),w+=V[E]||s[k[E]]||0}var me=b.next(264);for(me.write_shift(4,13),E=0;E<65;++E)me.write_shift(4,0);for(E=0;E<y.length;++E){var de=b.next(T);for(de.write_shift(1,0),w=0;w<v.length;++w)if(v[w]!=null)switch(k[w]){case"L":de.write_shift(1,y[E][w]==null?63:y[E][w]?84:70);break;case"B":de.write_shift(8,y[E][w]||0,"f");break;case"N":var ve="0";for(typeof y[E][w]=="number"&&(ve=y[E][w].toFixed(P[w]||0)),ve.length>V[w]&&(ve=ve.slice(0,V[w])),R=0;R<V[w]-ve.length;++R)de.write_shift(1,32);de.write_shift(1,ve,"sbcs");break;case"D":y[E][w]?(de.write_shift(4,("0000"+y[E][w].getFullYear()).slice(-4),"sbcs"),de.write_shift(2,("00"+(y[E][w].getMonth()+1)).slice(-2),"sbcs"),de.write_shift(2,("00"+y[E][w].getDate()).slice(-2),"sbcs")):de.write_shift(8,"00000000","sbcs");break;case"C":var Me=de.l,F=String(y[E][w]!=null?y[E][w]:"").slice(0,V[w]);for(de.write_shift(1,F,"cpstr"),Me+=V[w]-de.l,R=0;R<Me;++R)de.write_shift(1,32);break}}return Pr=p,b.next(1).write_shift(1,26),b.end()}return{to_workbook:a,to_sheet:r,from_sheet:o}}(),rk=function(){var i={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Ir(i).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1").replace("{","\\{")+"|\\|)","gm");try{e=new RegExp("\x1BN("+Ir(i).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm")}catch{}var t=function(v,y){var C=i[y];return typeof C=="number"?S1(C):C},r=function(v,y,C){var E=y.charCodeAt(0)-32<<4|C.charCodeAt(0)-48;return E==59?v:S1(E)};i["|"]=254;var a=function(v){return v.replace(/\n/g,"\x1B :").replace(/\r/g,"\x1B =")};function s(v,y){switch(y.type){case"base64":return o(yr(v),y);case"binary":return o(v,y);case"buffer":return o(gt&&Buffer.isBuffer(v)?v.toString("binary"):Ia(v),y);case"array":return o(gs(v),y)}throw new Error("Unrecognized type "+y.type)}function o(v,y){var C=v.split(/[\n\r]+/),E=-1,w=-1,R=0,T=0,D=[],k=[],V=null,P={},U=[],N=[],j=[],Y=0,Z,ce={Workbook:{WBProps:{},Names:[]}};for(+y.codepage>=0&&Jr(+y.codepage);R!==C.length;++R){Y=0;var Le=C[R].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(e,t),ge=Le.replace(/;;/g,"\0").split(";").map(function(W){return W.replace(/\u0000/g,";")}),me=ge[0],de;if(Le.length>0)switch(me){case"ID":break;case"E":break;case"B":break;case"O":for(T=1;T<ge.length;++T)switch(ge[T].charAt(0)){case"V":{var ve=parseInt(ge[T].slice(1),10);ve>=1&&ve<=4&&(ce.Workbook.WBProps.date1904=!0)}break}break;case"W":break;case"P":switch(ge[1].charAt(0)){case"P":k.push(Le.slice(3).replace(/;;/g,";"));break}break;case"NN":{var Me={Sheet:0};for(T=1;T<ge.length;++T)switch(ge[T].charAt(0)){case"N":Me.Name=ge[T].slice(1);break;case"E":Me.Ref=(y&&y.sheet||"Sheet1")+"!"+hs(ge[T].slice(1));break}ce.Workbook.Names.push(Me)}break;case"C":var F=!1,he=!1,_e=!1,ye=!1,pe=-1,Ne=-1,Oe="",qe="z",z="";for(T=1;T<ge.length;++T)switch(ge[T].charAt(0)){case"A":z=ge[T].slice(1);break;case"X":w=parseInt(ge[T].slice(1),10)-1,he=!0;break;case"Y":for(E=parseInt(ge[T].slice(1),10)-1,he||(w=0),Z=D.length;Z<=E;++Z)D[Z]=[];break;case"K":de=ge[T].slice(1),de.charAt(0)==='"'?(de=de.slice(1,de.length-1),qe="s"):de==="TRUE"||de==="FALSE"?(de=de==="TRUE",qe="b"):de.charAt(0)=="#"&&Oi[de]!=null?(qe="e",de=Oi[de]):isNaN(br(de))||(de=br(de),qe="n",V!==null&&ta(V)&&y.cellDates&&(de=Tn(ce.Workbook.WBProps.date1904?de+1462:de),qe=typeof de=="number"?"n":"d")),F=!0;break;case"E":ye=!0,Oe=hs(ge[T].slice(1),{r:E,c:w});break;case"S":_e=!0;break;case"G":break;case"R":pe=parseInt(ge[T].slice(1),10)-1;break;case"C":Ne=parseInt(ge[T].slice(1),10)-1;break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+Le)}if(F&&(D[E][w]?(D[E][w].t=qe,D[E][w].v=de):D[E][w]={t:qe,v:de},V&&(D[E][w].z=V),y.cellText!==!1&&V&&(D[E][w].w=Er(D[E][w].z,D[E][w].v,{date1904:ce.Workbook.WBProps.date1904})),V=null),_e){if(ye)throw new Error("SYLK shared formula cannot have own formula");var q=pe>-1&&D[pe][Ne];if(!q||!q[1])throw new Error("SYLK shared formula cannot find base");Oe=Rw(q[1],{r:E-pe,c:w-Ne})}Oe&&(D[E][w]?D[E][w].f=Oe:D[E][w]={t:"n",f:Oe}),z&&(D[E][w]||(D[E][w]={t:"z"}),D[E][w].c=[{a:"SheetJSYLK",t:z}]);break;case"F":var X=0;for(T=1;T<ge.length;++T)switch(ge[T].charAt(0)){case"X":w=parseInt(ge[T].slice(1),10)-1,++X;break;case"Y":for(E=parseInt(ge[T].slice(1),10)-1,Z=D.length;Z<=E;++Z)D[Z]=[];break;case"M":Y=parseInt(ge[T].slice(1),10)/20;break;case"F":break;case"G":break;case"P":V=k[parseInt(ge[T].slice(1),10)];break;case"S":break;case"D":break;case"N":break;case"W":for(j=ge[T].slice(1).split(" "),Z=parseInt(j[0],10);Z<=parseInt(j[1],10);++Z)Y=parseInt(j[2],10),N[Z-1]=Y===0?{hidden:!0}:{wch:Y};break;case"C":w=parseInt(ge[T].slice(1),10)-1,N[w]||(N[w]={});break;case"R":E=parseInt(ge[T].slice(1),10)-1,U[E]||(U[E]={}),Y>0?(U[E].hpt=Y,U[E].hpx=Jo(Y)):Y===0&&(U[E].hidden=!0);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+Le)}X<1&&(V=null);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+Le)}}return U.length>0&&(P["!rows"]=U),N.length>0&&(P["!cols"]=N),N.forEach(function(W){bl(W)}),y&&y.sheetRows&&(D=D.slice(0,y.sheetRows)),[D,P,ce]}function u(v,y){var C=s(v,y),E=C[0],w=C[1],R=C[2],T=mi(y);T.date1904=(((R||{}).Workbook||{}).WBProps||{}).date1904;var D=wl(E,T);Ir(w).forEach(function(V){D[V]=w[V]});var k=Fn(D,y);return Ir(R).forEach(function(V){k[V]=R[V]}),k.bookType="sylk",k}function h(v,y,C,E,w,R){var T="C;Y"+(C+1)+";X"+(E+1)+";K";switch(v.t){case"n":T+=isFinite(v.v)?v.v||0:sr[isNaN(v.v)?36:7],v.f&&!v.F&&(T+=";E"+zA(v.f,{r:C,c:E}));break;case"b":T+=v.v?"TRUE":"FALSE";break;case"e":T+=v.w||sr[v.v]||v.v;break;case"d":T+=xi(Ni(v.v,R),R);break;case"s":T+='"'+(v.v==null?"":String(v.v)).replace(/"/g,"").replace(/;/g,";;")+'"';break}return T}function d(v,y,C){var E="C;Y"+(y+1)+";X"+(C+1)+";A";return E+=a(v.map(function(w){return w.t}).join("")),E}function p(v,y){y.forEach(function(C,E){var w="F;W"+(E+1)+" "+(E+1)+" ";C.hidden?w+="0":(typeof C.width=="number"&&!C.wpx&&(C.wpx=Qc(C.width)),typeof C.wpx=="number"&&!C.wch&&(C.wch=Jc(C.wpx)),typeof C.wch=="number"&&(w+=Math.round(C.wch))),w.charAt(w.length-1)!=" "&&v.push(w)})}function b(v,y){y.forEach(function(C,E){var w="F;";C.hidden?w+="M0;":C.hpt?w+="M"+20*C.hpt+";":C.hpx&&(w+="M"+20*_w(C.hpx)+";"),w.length>2&&v.push(w+"R"+(E+1))})}function g(v,y,C){y||(y={}),y._formats=["General"];var E=["ID;PSheetJS;N;E"],w=[],R=si(v["!ref"]||"A1"),T,D=v["!data"]!=null,k=`\r
`,V=(((C||{}).Workbook||{}).WBProps||{}).date1904,P="General";E.push("P;PGeneral");var U=R.s.r,N=R.s.c,j=[];if(v["!ref"]){for(U=R.s.r;U<=R.e.r;++U)if(!(D&&!v["!data"][U])){for(j=[],N=R.s.c;N<=R.e.c;++N)T=D?v["!data"][U][N]:v[Dt(N)+Bt(U)],!(!T||!T.c)&&j.push(d(T.c,U,N));j.length&&w.push(j.join(k))}}if(v["!ref"]){for(U=R.s.r;U<=R.e.r;++U)if(!(D&&!v["!data"][U])){for(j=[],N=R.s.c;N<=R.e.c;++N)if(T=D?v["!data"][U][N]:v[Dt(N)+Bt(U)],!(!T||T.v==null&&(!T.f||T.F))){if((T.z||(T.t=="d"?st[14]:"General"))!=P){var Y=y._formats.indexOf(T.z);Y==-1&&(y._formats.push(T.z),Y=y._formats.length-1,E.push("P;P"+T.z.replace(/;/g,";;"))),j.push("F;P"+Y+";Y"+(U+1)+";X"+(N+1))}j.push(h(T,v,U,N,y,V))}w.push(j.join(k))}}return E.push("F;P0;DG0G8;M255"),v["!cols"]&&p(E,v["!cols"]),v["!rows"]&&b(E,v["!rows"]),v["!ref"]&&E.push("B;Y"+(R.e.r-R.s.r+1)+";X"+(R.e.c-R.s.c+1)+";D"+[R.s.c,R.s.r,R.e.c,R.e.r].join(" ")),E.push("O;L;D;B"+(V?";V4":"")+";K47;G100 0.001"),delete y._formats,E.join(k)+k+w.join(k)+k+"E"+k}return{to_workbook:u,from_sheet:g}}(),ak=function(){function i(u,h){switch(h.type){case"base64":return e(yr(u),h);case"binary":return e(u,h);case"buffer":return e(gt&&Buffer.isBuffer(u)?u.toString("binary"):Ia(u),h);case"array":return e(gs(u),h)}throw new Error("Unrecognized type "+h.type)}function e(u,h){for(var d=u.split(`
`),p=-1,b=-1,g=0,v=[];g!==d.length;++g){if(d[g].trim()==="BOT"){v[++p]=[],b=0;continue}if(!(p<0)){var y=d[g].trim().split(","),C=y[0],E=y[1];++g;for(var w=d[g]||"";(w.match(/["]/g)||[]).length&1&&g<d.length-1;)w+=`
`+d[++g];switch(w=w.trim(),+C){case-1:if(w==="BOT"){v[++p]=[],b=0;continue}else if(w!=="EOD")throw new Error("Unrecognized DIF special command "+w);break;case 0:w==="TRUE"?v[p][b]=!0:w==="FALSE"?v[p][b]=!1:isNaN(br(E))?isNaN($o(E).getDate())?v[p][b]=E:(v[p][b]=Ni(E),h&&h.UTC||(v[p][b]=vs(v[p][b]))):v[p][b]=br(E),++b;break;case 1:w=w.slice(1,w.length-1),w=w.replace(/""/g,'"'),w&&w.match(/^=".*"$/)&&(w=w.slice(2,-1)),v[p][b++]=w!==""?w:null;break}if(w==="EOD")break}}return h&&h.sheetRows&&(v=v.slice(0,h.sheetRows)),v}function t(u,h){return wl(i(u,h),h)}function r(u,h){var d=Fn(t(u,h),h);return d.bookType="dif",d}function a(u,h){return"0,"+String(u)+`\r
`+h}function s(u){return`1,0\r
"`+u.replace(/"/g,'""')+'"'}function o(u){if(!u["!ref"])throw new Error("Cannot export empty sheet to DIF");for(var h=si(u["!ref"]),d=u["!data"]!=null,p=[`TABLE\r
0,1\r
"sheetjs"\r
`,`VECTORS\r
0,`+(h.e.r-h.s.r+1)+`\r
""\r
`,`TUPLES\r
0,`+(h.e.c-h.s.c+1)+`\r
""\r
`,`DATA\r
0,0\r
""\r
`],b=h.s.r;b<=h.e.r;++b){for(var g=d?u["!data"][b]:[],v=`-1,0\r
BOT\r
`,y=h.s.c;y<=h.e.c;++y){var C=d?g&&g[y]:u[kt({r:b,c:y})];if(C==null){v+=`1,0\r
""\r
`;continue}switch(C.t){case"n":C.w!=null?v+="0,"+C.w+`\r
V`:C.v!=null?v+=a(C.v,"V"):C.f!=null&&!C.F?v+=s("="+C.f):v+=`1,0\r
""`;break;case"b":v+=C.v?a(1,"TRUE"):a(0,"FALSE");break;case"s":v+=s(isNaN(+C.v)?C.v:'="'+C.v+'"');break;case"d":C.w||(C.w=Er(C.z||st[14],xi(Ni(C.v)))),v+=a(C.w,"V");break;default:v+=`1,0\r
""`}v+=`\r
`}p.push(v)}return p.join("")+`-1,0\r
EOD`}return{to_workbook:r,to_sheet:t,from_sheet:o}}(),nk=function(){function i(b){return b.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(b){return b.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(b,g){for(var v=b.split(`
`),y=-1,C=-1,E=0,w=[];E!==v.length;++E){var R=v[E].trim().split(":");if(R[0]==="cell"){var T=ji(R[1]);if(w.length<=T.r)for(y=w.length;y<=T.r;++y)w[y]||(w[y]=[]);switch(y=T.r,C=T.c,R[2]){case"t":w[y][C]=i(R[3]);break;case"v":w[y][C]=+R[3];break;case"vtf":var D=R[R.length-1];case"vtc":switch(R[3]){case"nl":w[y][C]=!!+R[4];break;default:w[y][C]=R[R.length-1].charAt(0)=="#"?{t:"e",v:Oi[R[R.length-1]]}:+R[4];break}R[2]=="vtf"&&(w[y][C]=[w[y][C],D])}}}return g&&g.sheetRows&&(w=w.slice(0,g.sheetRows)),w}function r(b,g){return wl(t(b,g),g)}function a(b,g){return Fn(r(b,g),g)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),h="--SocialCalcSpreadsheetControlSave--";function d(b){if(!b||!b["!ref"])return"";for(var g=[],v=[],y,C="",E=xs(b["!ref"]),w=b["!data"]!=null,R=E.s.r;R<=E.e.r;++R)for(var T=E.s.c;T<=E.e.c;++T)if(C=kt({r:R,c:T}),y=w?(b["!data"][R]||[])[T]:b[C],!(!y||y.v==null||y.t==="z")){switch(v=["cell",C,"t"],y.t){case"s":v.push(e(y.v));break;case"b":v[2]="vt"+(y.f?"f":"c"),v[3]="nl",v[4]=y.v?"1":"0",v[5]=e(y.f||(y.v?"TRUE":"FALSE"));break;case"d":var D=xi(Ni(y.v));v[2]="vtc",v[3]="nd",v[4]=""+D,v[5]=y.w||Er(y.z||st[14],D);break;case"n":isFinite(y.v)?y.f?(v[2]="vtf",v[3]="n",v[4]=y.v,v[5]=e(y.f)):(v[2]="v",v[3]=y.v):(v[2]="vt"+(y.f?"f":"c"),v[3]="e"+sr[isNaN(y.v)?36:7],v[4]="0",v[5]=y.f||v[3].slice(1),v[6]="e",v[7]=v[3].slice(1));break;case"e":continue}g.push(v.join(":"))}return g.push("sheet:c:"+(E.e.c-E.s.c+1)+":r:"+(E.e.r-E.s.r+1)+":tvf:1"),g.push("valueformat:1:text-wiki"),g.join(`
`)}function p(b){return[s,o,u,o,d(b),h].join(`
`)}return{to_workbook:a,to_sheet:r,from_sheet:p}}(),Zo=function(){function i(p,b,g,v,y){y.raw?b[g][v]=p:p===""||(p==="TRUE"?b[g][v]=!0:p==="FALSE"?b[g][v]=!1:isNaN(br(p))?isNaN($o(p).getDate())?p.charCodeAt(0)==35&&Oi[p]!=null?b[g][v]={t:"e",v:Oi[p],w:p}:b[g][v]=p:b[g][v]=Ni(p):b[g][v]=br(p))}function e(p,b){var g=b||{},v=[];if(!p||p.length===0)return v;for(var y=p.split(/[\r\n]/),C=y.length-1;C>=0&&y[C].length===0;)--C;for(var E=10,w=0,R=0;R<=C;++R)w=y[R].indexOf(" "),w==-1?w=y[R].length:w++,E=Math.max(E,w);for(R=0;R<=C;++R){v[R]=[];var T=0;for(i(y[R].slice(0,E).trim(),v,R,T,g),T=1;T<=(y[R].length-E)/10+1;++T)i(y[R].slice(E+(T-1)*10,E+T*10).trim(),v,R,T,g)}return g.sheetRows&&(v=v.slice(0,g.sheetRows)),v}var t={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function a(p){for(var b={},g=!1,v=0,y=0;v<p.length;++v)(y=p.charCodeAt(v))==34?g=!g:!g&&y in t&&(b[y]=(b[y]||0)+1);y=[];for(v in b)Object.prototype.hasOwnProperty.call(b,v)&&y.push([b[v],v]);if(!y.length){b=r;for(v in b)Object.prototype.hasOwnProperty.call(b,v)&&y.push([b[v],v])}return y.sort(function(C,E){return C[0]-E[0]||r[C[1]]-r[E[1]]}),t[y.pop()[1]]||44}function s(p,b){var g=b||{},v="",y={};g.dense&&(y["!data"]=[]);var C={s:{c:0,r:0},e:{c:0,r:0}};p.slice(0,4)=="sep="?p.charCodeAt(5)==13&&p.charCodeAt(6)==10?(v=p.charAt(4),p=p.slice(7)):p.charCodeAt(5)==13||p.charCodeAt(5)==10?(v=p.charAt(4),p=p.slice(6)):v=a(p.slice(0,1024)):g&&g.FS?v=g.FS:v=a(p.slice(0,1024));var E=0,w=0,R=0,T=0,D=0,k=v.charCodeAt(0),V=!1,P=0,U=p.charCodeAt(0),N=g.dateNF!=null?JT(g.dateNF):null;function j(){var Y=p.slice(T,D);Y.slice(-1)=="\r"&&(Y=Y.slice(0,-1));var Z={};if(Y.charAt(0)=='"'&&Y.charAt(Y.length-1)=='"'&&(Y=Y.slice(1,-1).replace(/""/g,'"')),g.cellText!==!1&&(Z.w=Y),Y.length===0)Z.t="z";else if(g.raw)Z.t="s",Z.v=Y;else if(Y.trim().length===0)Z.t="s",Z.v=Y;else if(Y.charCodeAt(0)==61)Y.charCodeAt(1)==34&&Y.charCodeAt(Y.length-1)==34?(Z.t="s",Z.v=Y.slice(2,-1).replace(/""/g,'"')):HA(Y)?(Z.t="s",Z.f=Y.slice(1),Z.v=Y):(Z.t="s",Z.v=Y);else if(Y=="TRUE")Z.t="b",Z.v=!0;else if(Y=="FALSE")Z.t="b",Z.v=!1;else if(!isNaN(R=br(Y)))Z.t="n",Z.v=R;else if(!isNaN((R=$o(Y)).getDate())||N&&Y.match(N)){if(Z.z=g.dateNF||st[14],N&&Y.match(N)){var ce=e_(Y,g.dateNF,Y.match(N)||[]);R=Ni(ce),g&&g.UTC===!1&&(R=vs(R))}else g&&g.UTC===!1?R=vs(R):g.cellText!==!1&&g.dateNF&&(Z.w=Er(Z.z,R));g.cellDates?(Z.t="d",Z.v=R):(Z.t="n",Z.v=xi(R)),g.cellNF||delete Z.z}else Y.charCodeAt(0)==35&&Oi[Y]!=null?(Z.t="e",Z.w=Y,Z.v=Oi[Y]):(Z.t="s",Z.v=Y);if(Z.t=="z"||(g.dense?(y["!data"][E]||(y["!data"][E]=[]),y["!data"][E][w]=Z):y[kt({c:w,r:E})]=Z),T=D+1,U=p.charCodeAt(T),C.e.c<w&&(C.e.c=w),C.e.r<E&&(C.e.r=E),P==k)++w;else if(w=0,++E,g.sheetRows&&g.sheetRows<=E)return!0}e:for(;D<p.length;++D)switch(P=p.charCodeAt(D)){case 34:U===34&&(V=!V);break;case 13:if(V)break;p.charCodeAt(D+1)==10&&++D;case k:case 10:if(!V&&j())break e;break}return D-T>0&&j(),y["!ref"]=yt(C),y}function o(p,b){return!(b&&b.PRN)||b.FS||p.slice(0,4)=="sep="||p.indexOf("	")>=0||p.indexOf(",")>=0||p.indexOf(";")>=0?s(p,b):wl(e(p,b),b)}function u(p,b){var g="",v=b.type=="string"?[0,0,0,0]:yp(p,b);switch(b.type){case"base64":g=yr(p);break;case"binary":g=p;break;case"buffer":b.codepage==65001?g=p.toString("utf8"):(b.codepage,g=gt&&Buffer.isBuffer(p)?p.toString("binary"):Ia(p));break;case"array":g=gs(p);break;case"string":g=p;break;default:throw new Error("Unrecognized type "+b.type)}return v[0]==239&&v[1]==187&&v[2]==191?g=Vt(g.slice(3)):b.type!="string"&&b.type!="buffer"&&b.codepage==65001?g=Vt(g):b.type=="binary",g.slice(0,19)=="socialcalc:version:"?nk.to_sheet(b.type=="string"?g:Vt(g),b):o(g,b)}function h(p,b){return Fn(u(p,b),b)}function d(p){var b=[];if(!p["!ref"])return"";for(var g=si(p["!ref"]),v,y=p["!data"]!=null,C=g.s.r;C<=g.e.r;++C){for(var E=[],w=g.s.c;w<=g.e.c;++w){var R=kt({r:C,c:w});if(v=y?(p["!data"][C]||[])[w]:p[R],!v||v.v==null){E.push("          ");continue}for(var T=(v.w||(Rn(v),v.w)||"").slice(0,10);T.length<10;)T+=" ";E.push(T+(w===0?" ":""))}b.push(E.join(""))}return b.join(`
`)}return{to_workbook:h,to_sheet:u,from_sheet:d}}();function sk(i,e){var t=e||{},r=!!t.WTF;t.WTF=!0;try{var a=rk.to_workbook(i,t);return t.WTF=r,a}catch(s){if(t.WTF=r,s.message.indexOf("SYLK bad record ID")==-1&&r)throw s;return Zo.to_workbook(i,e)}}var Lo=function(){function i(z,q,X){if(z){bi(z,z.l||0);for(var W=X.Enum||ye;z.l<z.length;){var we=z.read_shift(2),H=W[we]||W[65535],ze=z.read_shift(2),He=z.l+ze,De=H.f&&H.f(z,ze,X);if(z.l=He,q(De,H,we))return}}}function e(z,q){switch(q.type){case"base64":return r(gr(yr(z)),q);case"binary":return r(gr(z),q);case"buffer":case"array":return r(z,q)}throw"Unsupported type "+q.type}var t=["mmmm","dd-mmm-yyyy","dd-mmm","mmm-yyyy","@","mm/dd","hh:mm:ss AM/PM","hh:mm AM/PM","mm/dd/yyyy","mm/dd","hh:mm:ss","hh:mm"];function r(z,q){if(!z)return z;var X=q||{},W={},we="Sheet1",H="",ze=0,He={},De=[],Xe=[],We=[];X.dense&&(We=W["!data"]=[]);var tt={s:{r:0,c:0},e:{r:0,c:0}},vt=X.sheetRows||0,ht={};if(z[4]==81&&z[5]==80&&z[6]==87)return qe(z,q);if(z[2]==0&&(z[3]==8||z[3]==9)&&z.length>=16&&z[14]==5&&z[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(z[2]==2)X.Enum=ye,i(z,function(Fe,jt,ti){switch(ti){case 0:X.vers=Fe,Fe>=4096&&(X.qpro=!0);break;case 255:X.vers=Fe,X.works=!0;break;case 6:tt=Fe;break;case 204:Fe&&(H=Fe);break;case 222:H=Fe;break;case 15:case 51:(!X.qpro&&!X.works||ti==51)&&Fe[1].v.charCodeAt(0)<48&&(Fe[1].v=Fe[1].v.slice(1)),(X.works||X.works2)&&(Fe[1].v=Fe[1].v.replace(/\r\n/g,`
`));case 13:case 14:case 16:(Fe[2]&112)==112&&(Fe[2]&15)>1&&(Fe[2]&15)<15&&(Fe[1].z=X.dateNF||t[(Fe[2]&15)-1]||st[14],X.cellDates&&(Fe[1].v=Tn(Fe[1].v),Fe[1].t=typeof Fe[1].v=="number"?"n":"d")),X.qpro&&Fe[3]>ze&&(W["!ref"]=yt(tt),He[we]=W,De.push(we),W={},X.dense&&(We=W["!data"]=[]),tt={s:{r:0,c:0},e:{r:0,c:0}},ze=Fe[3],we=H||"Sheet"+(ze+1),H="");var At=X.dense?(We[Fe[0].r]||[])[Fe[0].c]:W[kt(Fe[0])];if(At){At.t=Fe[1].t,At.v=Fe[1].v,Fe[1].z!=null&&(At.z=Fe[1].z),Fe[1].f!=null&&(At.f=Fe[1].f),ht=At;break}X.dense?(We[Fe[0].r]||(We[Fe[0].r]=[]),We[Fe[0].r][Fe[0].c]=Fe[1]):W[kt(Fe[0])]=Fe[1],ht=Fe[1];break;case 21509:X.works2=!0;break;case 21506:Fe==5281&&(ht.z="hh:mm:ss",X.cellDates&&ht.t=="n"&&(ht.v=Tn(ht.v),ht.t=typeof ht.v=="number"?"n":"d"));break}},X);else if(z[2]==26||z[2]==14)X.Enum=pe,z[2]==14&&(X.qpro=!0,z.l=0),i(z,function(Fe,jt,ti){switch(ti){case 204:we=Fe;break;case 22:Fe[1].v.charCodeAt(0)<48&&(Fe[1].v=Fe[1].v.slice(1)),Fe[1].v=Fe[1].v.replace(/\x0F./g,function(At){return String.fromCharCode(At.charCodeAt(1)-32)}).replace(/\r\n/g,`
`);case 23:case 24:case 25:case 37:case 39:case 40:if(Fe[3]>ze&&(W["!ref"]=yt(tt),He[we]=W,De.push(we),W={},X.dense&&(We=W["!data"]=[]),tt={s:{r:0,c:0},e:{r:0,c:0}},ze=Fe[3],we="Sheet"+(ze+1)),vt>0&&Fe[0].r>=vt)break;X.dense?(We[Fe[0].r]||(We[Fe[0].r]=[]),We[Fe[0].r][Fe[0].c]=Fe[1]):W[kt(Fe[0])]=Fe[1],tt.e.c<Fe[0].c&&(tt.e.c=Fe[0].c),tt.e.r<Fe[0].r&&(tt.e.r=Fe[0].r);break;case 27:Fe[14e3]&&(Xe[Fe[14e3][0]]=Fe[14e3][1]);break;case 1537:Xe[Fe[0]]=Fe[1],Fe[0]==ze&&(we=Fe[1]);break}},X);else throw new Error("Unrecognized LOTUS BOF "+z[2]);if(W["!ref"]=yt(tt),He[H||we]=W,De.push(H||we),!Xe.length)return{SheetNames:De,Sheets:He};for(var Lt={},Ve=[],rt=0;rt<Xe.length;++rt)He[De[rt]]?(Ve.push(Xe[rt]||De[rt]),Lt[Xe[rt]]=He[Xe[rt]]||He[De[rt]]):(Ve.push(Xe[rt]),Lt[Xe[rt]]={"!ref":"A1"});return{SheetNames:Ve,Sheets:Lt}}function a(z,q){var X=q||{};if(+X.codepage>=0&&Jr(+X.codepage),X.type=="string")throw new Error("Cannot write WK1 to JS string");var W=h0();if(!z["!ref"])throw new Error("Cannot export empty sheet to WK1");var we=si(z["!ref"]),H=z["!data"]!=null,ze=[];dr(W,0,o(1030)),dr(W,6,d(we));for(var He=Math.min(we.e.r,8191),De=we.s.c;De<=we.e.c;++De)ze[De]=Dt(De);for(var Xe=we.s.r;Xe<=He;++Xe){var We=Bt(Xe);for(De=we.s.c;De<=we.e.c;++De){var tt=H?(z["!data"][Xe]||[])[De]:z[ze[De]+We];if(!(!tt||tt.t=="z"))switch(tt.t){case"n":(tt.v|0)==tt.v&&tt.v>=-32768&&tt.v<=32767?dr(W,13,E(Xe,De,tt)):dr(W,14,R(Xe,De,tt));break;case"d":var vt=xi(tt.v);(vt|0)==vt&&vt>=-32768&&vt<=32767?dr(W,13,E(Xe,De,{v:vt,z:tt.z||st[14]})):dr(W,14,R(Xe,De,{v:vt,z:tt.z||st[14]}));break;default:var ht=Rn(tt);dr(W,15,v(Xe,De,ht.slice(0,239)))}}}return dr(W,1),W.end()}function s(z,q){var X=q||{};if(+X.codepage>=0&&Jr(+X.codepage),X.type=="string")throw new Error("Cannot write WK3 to JS string");var W=h0();dr(W,0,u(z));for(var we=0,H=0;we<z.SheetNames.length;++we)(z.Sheets[z.SheetNames[we]]||{})["!ref"]&&dr(W,27,_e(z.SheetNames[we],H++));var ze=0;for(we=0;we<z.SheetNames.length;++we){var He=z.Sheets[z.SheetNames[we]];if(!(!He||!He["!ref"])){for(var De=si(He["!ref"]),Xe=He["!data"]!=null,We=[],tt=Math.min(De.e.r,8191),vt=De.s.r;vt<=tt;++vt)for(var ht=Bt(vt),Lt=De.s.c;Lt<=De.e.c;++Lt){vt===De.s.r&&(We[Lt]=Dt(Lt));var Ve=We[Lt]+ht,rt=Xe?(He["!data"][vt]||[])[Lt]:He[Ve];if(!(!rt||rt.t=="z"))if(rt.t=="n")dr(W,23,ce(vt,Lt,ze,rt.v));else{var Fe=Rn(rt);dr(W,22,j(vt,Lt,ze,Fe.slice(0,239)))}}++ze}}return dr(W,1),W.end()}function o(z){var q=pi(2);return q.write_shift(2,z),q}function u(z){var q=pi(26);q.write_shift(2,4096),q.write_shift(2,4),q.write_shift(4,0);for(var X=0,W=0,we=0,H=0;H<z.SheetNames.length;++H){var ze=z.SheetNames[H],He=z.Sheets[ze];if(!(!He||!He["!ref"])){++we;var De=xs(He["!ref"]);X<De.e.r&&(X=De.e.r),W<De.e.c&&(W=De.e.c)}}return X>8191&&(X=8191),q.write_shift(2,X),q.write_shift(1,we),q.write_shift(1,W),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(1,1),q.write_shift(1,2),q.write_shift(4,0),q.write_shift(4,0),q}function h(z,q,X){var W={s:{c:0,r:0},e:{c:0,r:0}};return q==8&&X.qpro?(W.s.c=z.read_shift(1),z.l++,W.s.r=z.read_shift(2),W.e.c=z.read_shift(1),z.l++,W.e.r=z.read_shift(2),W):(W.s.c=z.read_shift(2),W.s.r=z.read_shift(2),q==12&&X.qpro&&(z.l+=2),W.e.c=z.read_shift(2),W.e.r=z.read_shift(2),q==12&&X.qpro&&(z.l+=2),W.s.c==65535&&(W.s.c=W.e.c=W.s.r=W.e.r=0),W)}function d(z){var q=pi(8);return q.write_shift(2,z.s.c),q.write_shift(2,z.s.r),q.write_shift(2,z.e.c),q.write_shift(2,z.e.r),q}function p(z,q,X){var W=[{c:0,r:0},{t:"n",v:0},0,0];return X.qpro&&X.vers!=20768?(W[0].c=z.read_shift(1),W[3]=z.read_shift(1),W[0].r=z.read_shift(2),z.l+=2):X.works?(W[0].c=z.read_shift(2),W[0].r=z.read_shift(2),W[2]=z.read_shift(2)):(W[2]=z.read_shift(1),W[0].c=z.read_shift(2),W[0].r=z.read_shift(2)),W}function b(z){return z.z&&ta(z.z)?240|(t.indexOf(z.z)+1||2):255}function g(z,q,X){var W=z.l+q,we=p(z,q,X);if(we[1].t="s",(X.vers&65534)==20768){z.l++;var H=z.read_shift(1);return we[1].v=z.read_shift(H,"utf8"),we}return X.qpro&&z.l++,we[1].v=z.read_shift(W-z.l,"cstr"),we}function v(z,q,X){var W=pi(7+X.length);W.write_shift(1,255),W.write_shift(2,q),W.write_shift(2,z),W.write_shift(1,39);for(var we=0;we<W.length;++we){var H=X.charCodeAt(we);W.write_shift(1,H>=128?95:H)}return W.write_shift(1,0),W}function y(z,q,X){var W=z.l+q,we=p(z,q,X);if(we[1].t="s",X.vers==20768){var H=z.read_shift(1);return we[1].v=z.read_shift(H,"utf8"),we}return we[1].v=z.read_shift(W-z.l,"cstr"),we}function C(z,q,X){var W=p(z,q,X);return W[1].v=z.read_shift(2,"i"),W}function E(z,q,X){var W=pi(7);return W.write_shift(1,b(X)),W.write_shift(2,q),W.write_shift(2,z),W.write_shift(2,X.v,"i"),W}function w(z,q,X){var W=p(z,q,X);return W[1].v=z.read_shift(8,"f"),W}function R(z,q,X){var W=pi(13);return W.write_shift(1,b(X)),W.write_shift(2,q),W.write_shift(2,z),W.write_shift(8,X.v,"f"),W}function T(z,q,X){var W=z.l+q,we=p(z,q,X);if(we[1].v=z.read_shift(8,"f"),X.qpro)z.l=W;else{var H=z.read_shift(2);P(z.slice(z.l,z.l+H),we),z.l+=H}return we}function D(z,q,X){var W=q&32768;return q&=-32769,q=(W?z:0)+(q>=8192?q-16384:q),(W?"":"$")+(X?Dt(q):Bt(q))}var k={31:["NA",0],33:["ABS",1],34:["TRUNC",1],35:["SQRT",1],36:["LOG",1],37:["LN",1],38:["PI",0],39:["SIN",1],40:["COS",1],41:["TAN",1],42:["ATAN2",2],43:["ATAN",1],44:["ASIN",1],45:["ACOS",1],46:["EXP",1],47:["MOD",2],49:["ISNA",1],50:["ISERR",1],51:["FALSE",0],52:["TRUE",0],53:["RAND",0],54:["DATE",3],63:["ROUND",2],64:["TIME",3],68:["ISNUMBER",1],69:["ISTEXT",1],70:["LEN",1],71:["VALUE",1],73:["MID",3],74:["CHAR",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],102:["UPPER",1],103:["LOWER",1],107:["PROPER",1],109:["TRIM",1],111:["T",1]},V=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function P(z,q){bi(z,0);for(var X=[],W=0,we="",H="",ze="",He="";z.l<z.length;){var De=z[z.l++];switch(De){case 0:X.push(z.read_shift(8,"f"));break;case 1:H=D(q[0].c,z.read_shift(2),!0),we=D(q[0].r,z.read_shift(2),!1),X.push(H+we);break;case 2:{var Xe=D(q[0].c,z.read_shift(2),!0),We=D(q[0].r,z.read_shift(2),!1);H=D(q[0].c,z.read_shift(2),!0),we=D(q[0].r,z.read_shift(2),!1),X.push(Xe+We+":"+H+we)}break;case 3:if(z.l<z.length){console.error("WK1 premature formula end");return}break;case 4:X.push("("+X.pop()+")");break;case 5:X.push(z.read_shift(2));break;case 6:{for(var tt="";De=z[z.l++];)tt+=String.fromCharCode(De);X.push('"'+tt.replace(/"/g,'""')+'"')}break;case 8:X.push("-"+X.pop());break;case 23:X.push("+"+X.pop());break;case 22:X.push("NOT("+X.pop()+")");break;case 20:case 21:He=X.pop(),ze=X.pop(),X.push(["AND","OR"][De-20]+"("+ze+","+He+")");break;default:if(De<32&&V[De])He=X.pop(),ze=X.pop(),X.push(ze+V[De]+He);else if(k[De]){if(W=k[De][1],W==69&&(W=z[z.l++]),W>X.length){console.error("WK1 bad formula parse 0x"+De.toString(16)+":|"+X.join("|")+"|");return}var vt=X.slice(-W);X.length-=W,X.push(k[De][0]+"("+vt.join(",")+")")}else return De<=7?console.error("WK1 invalid opcode "+De.toString(16)):De<=24?console.error("WK1 unsupported op "+De.toString(16)):De<=30?console.error("WK1 invalid opcode "+De.toString(16)):De<=115?console.error("WK1 unsupported function opcode "+De.toString(16)):console.error("WK1 unrecognized opcode "+De.toString(16))}}X.length==1?q[1].f=""+X[0]:console.error("WK1 bad formula parse |"+X.join("|")+"|")}function U(z){var q=[{c:0,r:0},{t:"n",v:0},0];return q[0].r=z.read_shift(2),q[3]=z[z.l++],q[0].c=z[z.l++],q}function N(z,q){var X=U(z);return X[1].t="s",X[1].v=z.read_shift(q-4,"cstr"),X}function j(z,q,X,W){var we=pi(6+W.length);we.write_shift(2,z),we.write_shift(1,X),we.write_shift(1,q),we.write_shift(1,39);for(var H=0;H<W.length;++H){var ze=W.charCodeAt(H);we.write_shift(1,ze>=128?95:ze)}return we.write_shift(1,0),we}function Y(z,q){var X=U(z);X[1].v=z.read_shift(2);var W=X[1].v>>1;if(X[1].v&1)switch(W&7){case 0:W=(W>>3)*5e3;break;case 1:W=(W>>3)*500;break;case 2:W=(W>>3)/20;break;case 3:W=(W>>3)/200;break;case 4:W=(W>>3)/2e3;break;case 5:W=(W>>3)/2e4;break;case 6:W=(W>>3)/16;break;case 7:W=(W>>3)/64;break}return X[1].v=W,X}function Z(z,q){var X=U(z),W=z.read_shift(4),we=z.read_shift(4),H=z.read_shift(2);if(H==65535)return W===0&&we===3221225472?(X[1].t="e",X[1].v=15):W===0&&we===3489660928?(X[1].t="e",X[1].v=42):X[1].v=0,X;var ze=H&32768;return H=(H&32767)-16446,X[1].v=(1-ze*2)*(we*Math.pow(2,H+32)+W*Math.pow(2,H)),X}function ce(z,q,X,W){var we=pi(14);if(we.write_shift(2,z),we.write_shift(1,X),we.write_shift(1,q),W==0)return we.write_shift(4,0),we.write_shift(4,0),we.write_shift(2,65535),we;var H=0,ze=0,He=0,De=0;return W<0&&(H=1,W=-W),ze=Math.log2(W)|0,W/=Math.pow(2,ze-31),De=W>>>0,(De&2147483648)==0&&(W/=2,++ze,De=W>>>0),W-=De,De|=2147483648,De>>>=0,W*=Math.pow(2,32),He=W>>>0,we.write_shift(4,He),we.write_shift(4,De),ze+=16383+(H?32768:0),we.write_shift(2,ze),we}function Le(z,q){var X=Z(z);return z.l+=q-14,X}function ge(z,q){var X=U(z),W=z.read_shift(4);return X[1].v=W>>6,X}function me(z,q){var X=U(z),W=z.read_shift(8,"f");return X[1].v=W,X}function de(z,q){var X=me(z);return z.l+=q-12,X}function ve(z,q){return z[z.l+q-1]==0?z.read_shift(q,"cstr"):""}function Me(z,q){var X=z[z.l++];X>q-1&&(X=q-1);for(var W="";W.length<X;)W+=String.fromCharCode(z[z.l++]);return W}function F(z,q,X){if(!(!X.qpro||q<21)){var W=z.read_shift(1);z.l+=17,z.l+=1,z.l+=2;var we=z.read_shift(q-21,"cstr");return[W,we]}}function he(z,q){for(var X={},W=z.l+q;z.l<W;){var we=z.read_shift(2);if(we==14e3){for(X[we]=[0,""],X[we][0]=z.read_shift(2);z[z.l];)X[we][1]+=String.fromCharCode(z[z.l]),z.l++;z.l++}}return X}function _e(z,q){var X=pi(5+z.length);X.write_shift(2,14e3),X.write_shift(2,q);for(var W=0;W<z.length;++W){var we=z.charCodeAt(W);X[X.l++]=we>127?95:we}return X[X.l++]=0,X}var ye={0:{n:"BOF",f:ei},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:h},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:C},14:{n:"NUMBER",f:w},15:{n:"LABEL",f:g},16:{n:"FORMULA",f:T},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:y},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ve},222:{n:"SHEETNAMELP",f:Me},255:{n:"BOF",f:ei},21506:{n:"WKSNF",f:ei},65535:{n:""}},pe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:N},23:{n:"NUMBER17",f:Z},24:{n:"NUMBER18",f:Y},25:{n:"FORMULA19",f:Le},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:he},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:ge},38:{n:"??"},39:{n:"NUMBER27",f:me},40:{n:"FORMULA28",f:de},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ve},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:F},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}},Ne={5:"dd-mmm-yy",6:"dd-mmm",7:"mmm-yy",8:"mm/dd/yy",10:"hh:mm:ss AM/PM",11:"hh:mm AM/PM",14:"dd-mmm-yyyy",15:"mmm-yyyy",34:"0.00",50:"0.00;[Red]0.00",66:"0.00;(0.00)",82:"0.00;[Red](0.00)",162:'"$"#,##0.00;\\("$"#,##0.00\\)',288:"0%",304:"0E+00",320:"# ?/?"};function Oe(z){var q=z.read_shift(2),X=z.read_shift(1);if(X!=0)throw"unsupported QPW string type "+X.toString(16);return z.read_shift(q,"sbcs-cont")}function qe(z,q){bi(z,0);var X=q||{},W={};X.dense&&(W["!data"]=[]);var we=[],H="",ze={s:{r:-1,c:-1},e:{r:-1,c:-1}},He=0,De=0,Xe=0,We=0,tt={SheetNames:[],Sheets:{}},vt=[];e:for(;z.l<z.length;){var ht=z.read_shift(2),Lt=z.read_shift(2),Ve=z.slice(z.l,z.l+Lt);switch(bi(Ve,0),ht){case 1:if(Ve.read_shift(4)!=962023505)throw"Bad QPW9 BOF!";break;case 2:break e;case 8:break;case 10:for(var rt=Ve.read_shift(4),Fe=(Ve.length-Ve.l)/rt|0,jt=0;jt<rt;++jt){var ti=Ve.l+Fe,At={};Ve.l+=2,At.numFmtId=Ve.read_shift(2),Ne[At.numFmtId]&&(At.z=Ne[At.numFmtId]),Ve.l=ti,vt.push(At)}break;case 1025:break;case 1026:break;case 1031:for(Ve.l+=12;Ve.l<Ve.length;)He=Ve.read_shift(2),De=Ve.read_shift(1),we.push(Ve.read_shift(He,"cstr"));break;case 1032:break;case 1537:{var qi=Ve.read_shift(2);W={},X.dense&&(W["!data"]=[]),ze.s.c=Ve.read_shift(2),ze.e.c=Ve.read_shift(2),ze.s.r=Ve.read_shift(4),ze.e.r=Ve.read_shift(4),Ve.l+=4,Ve.l+2<Ve.length&&(He=Ve.read_shift(2),De=Ve.read_shift(1),H=He==0?"":Ve.read_shift(He,"cstr")),H||(H=Dt(qi))}break;case 1538:{if(ze.s.c>255||ze.s.r>999999)break;ze.e.c<ze.s.c&&(ze.e.c=ze.s.c),ze.e.r<ze.s.r&&(ze.e.r=ze.s.r),W["!ref"]=yt(ze),uu(tt,W,H)}break;case 2561:Xe=Ve.read_shift(2),ze.e.c<Xe&&(ze.e.c=Xe),ze.s.c>Xe&&(ze.s.c=Xe),We=Ve.read_shift(4),ze.s.r>We&&(ze.s.r=We),We=Ve.read_shift(4),ze.e.r<We&&(ze.e.r=We);break;case 3073:{We=Ve.read_shift(4),He=Ve.read_shift(4),ze.s.r>We&&(ze.s.r=We),ze.e.r<We+He-1&&(ze.e.r=We+He-1);for(var Xt=Dt(Xe);Ve.l<Ve.length;){var Ie={t:"z"},bt=Ve.read_shift(1),zt=-1;bt&128&&(zt=Ve.read_shift(2));var xt=bt&64?Ve.read_shift(2)-1:0;switch(bt&31){case 0:break;case 1:break;case 2:Ie={t:"n",v:Ve.read_shift(2)};break;case 3:Ie={t:"n",v:Ve.read_shift(2,"i")};break;case 4:Ie={t:"n",v:ph(Ve)};break;case 5:Ie={t:"n",v:Ve.read_shift(8,"f")};break;case 7:Ie={t:"s",v:we[De=Ve.read_shift(4)-1]};break;case 8:Ie={t:"n",v:Ve.read_shift(8,"f")},Ve.l+=2,Ve.l+=4,isNaN(Ie.v)&&(Ie={t:"e",v:15});break;default:throw"Unrecognized QPW cell type "+(bt&31)}zt!=-1&&(vt[zt-1]||{}).z&&(Ie.z=vt[zt-1].z);var er=0;if(bt&32)switch(bt&31){case 2:er=Ve.read_shift(2);break;case 3:er=Ve.read_shift(2,"i");break;case 7:er=Ve.read_shift(2);break;default:throw"Unsupported delta for QPW cell type "+(bt&31)}if(!(!X.sheetStubs&&Ie.t=="z")){var ii=mi(Ie);Ie.t=="n"&&Ie.z&&ta(Ie.z)&&X.cellDates&&(ii.v=Tn(Ie.v),ii.t=typeof ii.v=="number"?"n":"d"),W["!data"]!=null?(W["!data"][We]||(W["!data"][We]=[]),W["!data"][We][Xe]=ii):W[Xt+Bt(We)]=ii}for(++We,--He;xt-- >0&&He>=0;){if(bt&32)switch(bt&31){case 2:Ie={t:"n",v:Ie.v+er&65535};break;case 3:Ie={t:"n",v:Ie.v+er&65535},Ie.v>32767&&(Ie.v-=65536);break;case 7:Ie={t:"s",v:we[De=De+er>>>0]};break;default:throw"Cannot apply delta for QPW cell type "+(bt&31)}else switch(bt&31){case 1:Ie={t:"z"};break;case 2:Ie={t:"n",v:Ve.read_shift(2)};break;case 7:Ie={t:"s",v:we[De=Ve.read_shift(4)-1]};break;default:throw"Cannot apply repeat for QPW cell type "+(bt&31)}!X.sheetStubs&&Ie.t=="z"||(W["!data"]!=null?(W["!data"][We]||(W["!data"][We]=[]),W["!data"][We][Xe]=Ie):W[Xt+Bt(We)]=Ie),++We,--He}}}break;case 3074:{Xe=Ve.read_shift(2),We=Ve.read_shift(4);var ri=Oe(Ve);W["!data"]!=null?(W["!data"][We]||(W["!data"][We]=[]),W["!data"][We][Xe]={t:"s",v:ri}):W[Dt(Xe)+Bt(We)]={t:"s",v:ri}}break}z.l+=Lt}return tt}return{sheet_to_wk1:a,book_to_wk3:s,to_workbook:e}}();function lk(i){var e={},t=i.match(Bi),r=0,a=!1;if(t)for(;r!=t.length;++r){var s=Ge(t[r]);switch(s[0].replace(/<\w*:/g,"<")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=ep[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+s[0])}}return e}var ok=function(){function i(r){var a=_i(r,"t");if(!a)return{t:"s",v:""};var s={t:"s",v:wt(a[1])},o=_i(r,"rPr");return o&&(s.s=lk(o[1])),s}var e=/<(?:\w+:)?r>/g,t=/<\/(?:\w+:)?r>/;return function(a){return a.replace(e,"").split(t).map(i).filter(function(s){return s.v})}}(),uk=function(){var e=/(\r\n|\n)/g;function t(a,s,o){var u=[];a.u&&u.push("text-decoration: underline;"),a.uval&&u.push("text-underline-style:"+a.uval+";"),a.sz&&u.push("font-size:"+a.sz+"pt;"),a.outline&&u.push("text-effect: outline;"),a.shadow&&u.push("text-shadow: auto;"),s.push('<span style="'+u.join("")+'">'),a.b&&(s.push("<b>"),o.push("</b>")),a.i&&(s.push("<i>"),o.push("</i>")),a.strike&&(s.push("<s>"),o.push("</s>"));var h=a.valign||"";return h=="superscript"||h=="super"?h="sup":h=="subscript"&&(h="sub"),h!=""&&(s.push("<"+h+">"),o.push("</"+h+">")),o.push("</span>"),a}function r(a){var s=[[],a.v,[]];return a.v?(a.s&&t(a.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(r).join("")}}(),ck=/<(?:\w+:)?t\b[^<>]*>([^<]*)<\/(?:\w+:)?t>/g,hk=/<(?:\w+:)?r\b[^<>]*>/;function mp(i,e){var t=e?e.cellHTML:!0,r={};return i?(i.match(/^\s*<(?:\w+:)?t[^>]*>/)?(r.t=wt(Vt(i.slice(i.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||""),!0),r.r=Vt(i),t&&(r.h=ko(r.t))):i.match(hk)&&(r.r=Vt(i),r.t=wt(Vt((b_(i,"rPh").match(ck)||[]).join("").replace(Bi,"")),!0),t&&(r.h=uk(ok(r.r)))),r):{t:""}}var fk=/<(?:\w+:)?(?:si|sstItem)>/g,dk=/<\/(?:\w+:)?(?:si|sstItem)>/;function pk(i,e){var t=[],r="";if(!i)return t;var a=_i(i,"sst");if(a){r=a[1].replace(fk,"").split(dk);for(var s=0;s!=r.length;++s){var o=mp(r[s].trim(),e);o!=null&&(t[t.length]=o)}a=Ge(a[0].slice(0,a[0].indexOf(">"))),t.Count=a.count,t.Unique=a.uniqueCount}return t}function mk(i){return[i.read_shift(4),i.read_shift(4)]}function gk(i,e){var t=[],r=!1;return Ua(i,function(s,o,u){switch(u){case 159:t.Count=s[0],t.Unique=s[1];break;case 19:t.push(s);break;case 160:return!0;case 35:r=!0;break;case 36:r=!1;break;default:if(o.T,!r||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),t}function xw(i){for(var e=[],t=i.split(""),r=0;r<t.length;++r)e[r]=t[r].charCodeAt(0);return e}function Ha(i,e){var t={};return t.Major=i.read_shift(2),t.Minor=i.read_shift(2),e>=4&&(i.l+=e-4),t}function vk(i){var e={};return e.id=i.read_shift(0,"lpp4"),e.R=Ha(i,4),e.U=Ha(i,4),e.W=Ha(i,4),e}function bk(i){for(var e=i.read_shift(4),t=i.l+e-4,r={},a=i.read_shift(4),s=[];a-- >0;)s.push({t:i.read_shift(4),v:i.read_shift(0,"lpp4")});if(r.name=i.read_shift(0,"lpp4"),r.comps=s,i.l!=t)throw new Error("Bad DataSpaceMapEntry: "+i.l+" != "+t);return r}function xk(i){var e=[];i.l+=4;for(var t=i.read_shift(4);t-- >0;)e.push(bk(i));return e}function wk(i){var e=[];i.l+=4;for(var t=i.read_shift(4);t-- >0;)e.push(i.read_shift(0,"lpp4"));return e}function yk(i){var e={};return i.read_shift(4),i.l+=4,e.id=i.read_shift(0,"lpp4"),e.name=i.read_shift(0,"lpp4"),e.R=Ha(i,4),e.U=Ha(i,4),e.W=Ha(i,4),e}function Ek(i){var e=yk(i);if(e.ename=i.read_shift(0,"8lpp4"),e.blksz=i.read_shift(4),e.cmode=i.read_shift(4),i.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function ww(i,e){var t=i.l+e,r={};r.Flags=i.read_shift(4)&63,i.l+=4,r.AlgID=i.read_shift(4);var a=!1;switch(r.AlgID){case 26126:case 26127:case 26128:a=r.Flags==36;break;case 26625:a=r.Flags==4;break;case 0:a=r.Flags==16||r.Flags==4||r.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+r.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return r.AlgIDHash=i.read_shift(4),r.KeySize=i.read_shift(4),r.ProviderType=i.read_shift(4),i.l+=8,r.CSPName=i.read_shift(t-i.l>>1,"utf16le"),i.l=t,r}function yw(i,e){var t={},r=i.l+e;return i.l+=4,t.Salt=i.slice(i.l,i.l+16),i.l+=16,t.Verifier=i.slice(i.l,i.l+16),i.l+=16,i.read_shift(4),t.VerifierHash=i.slice(i.l,r),i.l=r,t}function Ck(i){var e=Ha(i);switch(e.Minor){case 2:return[e.Minor,Tk(i)];case 3:return[e.Minor,_k()];case 4:return[e.Minor,Sk(i)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function Tk(i){var e=i.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var t=i.read_shift(4),r=ww(i,t),a=yw(i,i.length-i.l);return{t:"Std",h:r,v:a}}function _k(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Sk(i){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];i.l+=4;var t=i.read_shift(i.length-i.l,"utf8"),r={};return t.replace(Bi,function(s){var o=Ge(s);switch(Vr(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(u){r[u]=o[u]});break;case"<dataIntegrity":r.encryptedHmacKey=o.encryptedHmacKey,r.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":r.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":r.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":r.encs.push(o);break;default:throw o[0]}}),r}function Rk(i,e){var t={},r=t.EncryptionVersionInfo=Ha(i,4);if(e-=4,r.Minor!=2)throw new Error("unrecognized minor version code: "+r.Minor);if(r.Major>4||r.Major<2)throw new Error("unrecognized major version code: "+r.Major);t.Flags=i.read_shift(4),e-=4;var a=i.read_shift(4);return e-=4,t.EncryptionHeader=ww(i,a),e-=a,t.EncryptionVerifier=yw(i,e),t}function kk(i){var e={},t=e.EncryptionVersionInfo=Ha(i,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return e.Salt=i.read_shift(16),e.EncryptedVerifier=i.read_shift(16),e.EncryptedVerifierHash=i.read_shift(16),e}function Ak(i){var e=0,t,r=xw(i),a=r.length+1,s,o,u,h,d;for(t=Sn(a),t[0]=r.length,s=1;s!=a;++s)t[s]=r[s-1];for(s=a-1;s>=0;--s)o=t[s],u=(e&16384)===0?0:1,h=e<<1&32767,d=u|h,e=d^o;return e^52811}var Ew=function(){var i=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],r=function(o){return(o/2|o*128)&255},a=function(o,u){return r(o^u)},s=function(o){for(var u=e[o.length-1],h=104,d=o.length-1;d>=0;--d)for(var p=o[d],b=0;b!=7;++b)p&64&&(u^=t[h]),p*=2,--h;return u};return function(o){for(var u=xw(o),h=s(u),d=u.length,p=Sn(16),b=0;b!=16;++b)p[b]=0;var g,v,y;for((d&1)===1&&(g=h>>8,p[d]=a(i[0],g),--d,g=h&255,v=u[u.length-1],p[d]=a(v,g));d>0;)--d,g=h>>8,p[d]=a(u[d],g),--d,g=h&255,p[d]=a(u[d],g);for(d=15,y=15-u.length;y>0;)g=h>>8,p[d]=a(i[y],g),--d,--y,g=h&255,p[d]=a(u[d],g),--d,--y;return p}}(),Dk=function(i,e,t,r,a){a||(a=e),r||(r=Ew(i));var s,o;for(s=0;s!=e.length;++s)o=e[s],o^=r[t],o=(o>>5|o<<3)&255,a[s]=o,++t;return[a,t,r]},Fk=function(i){var e=0,t=Ew(i);return function(r){var a=Dk("",r,e,t);return e=a[1],a[0]}};function Mk(i,e,t,r){var a={key:ei(i),verificationBytes:ei(i)};return t.password&&(a.verifier=Ak(t.password)),r.valid=a.verificationBytes===a.verifier,r.valid&&(r.insitu=Fk(t.password)),a}function Ok(i,e,t){var r=t||{};return r.Info=i.read_shift(2),i.l-=2,r.Info===1?r.Data=kk(i):r.Data=Rk(i,e),r}function Lk(i,e,t){var r={Type:t.biff>=8?i.read_shift(2):0};return r.Type?Ok(i,e-2,r):Mk(i,t.biff>=8?e:e-2,t,r),r}function Nk(i,e){switch(e.type){case"base64":return Ac(yr(i),e);case"binary":return Ac(i,e);case"buffer":return Ac(gt&&Buffer.isBuffer(i)?i.toString("binary"):Ia(i),e);case"array":return Ac(gs(i),e)}throw new Error("Unrecognized type "+e.type)}function Ac(i,e){var t=e||{},r={},a=t.dense;a&&(r["!data"]=[]);var s=lp(i,"\\trowd","\\row");if(!s)throw new Error("RTF missing table");var o={s:{c:0,r:0},e:{c:0,r:s.length-1}},u=[];return s.forEach(function(h,d){a&&(u=r["!data"][d]=[]);for(var p=/\\[\w\-]+\b/g,b=0,g,v=-1,y=[];(g=p.exec(h))!=null;){var C=h.slice(b,p.lastIndex-g[0].length);switch(C.charCodeAt(0)==32&&(C=C.slice(1)),C.length&&y.push(C),g[0]){case"\\cell":if(++v,y.length){var E={v:y.join(""),t:"s"};E.v=="TRUE"||E.v=="FALSE"?(E.v=E.v=="TRUE",E.t="b"):isNaN(br(E.v))?Oi[E.v]!=null&&(E.t="e",E.w=E.v,E.v=Oi[E.v]):(E.t="n",t.cellText!==!1&&(E.w=E.v),E.v=br(E.v)),a?u[v]=E:r[kt({r:d,c:v})]=E}y=[];break;case"\\par":y.push(`
`);break}b=p.lastIndex}v>o.e.c&&(o.e.c=v)}),r["!ref"]=yt(o),r}function Bk(i,e){var t=Fn(Nk(i,e),e);return t.bookType="rtf",t}function zk(i){var e=i.slice(i[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function Qo(i){for(var e=0,t=1;e!=3;++e)t=t*256+(i[e]>255?255:i[e]<0?0:i[e]);return t.toString(16).toUpperCase().slice(1)}function Hk(i){var e=i[0]/255,t=i[1]/255,r=i[2]/255,a=Math.max(e,t,r),s=Math.min(e,t,r),o=a-s;if(o===0)return[0,0,e];var u=0,h=0,d=a+s;switch(h=o/(d>1?2-d:d),a){case e:u=((t-r)/o+6)%6;break;case t:u=(r-e)/o+2;break;case r:u=(e-t)/o+4;break}return[u/6,h,d/2]}function Pk(i){var e=i[0],t=i[1],r=i[2],a=t*2*(r<.5?r:1-r),s=r-a/2,o=[s,s,s],u=6*e,h;if(t!==0)switch(u|0){case 0:case 6:h=a*u,o[0]+=a,o[1]+=h;break;case 1:h=a*(2-u),o[0]+=h,o[1]+=a;break;case 2:h=a*(u-2),o[1]+=a,o[2]+=h;break;case 3:h=a*(4-u),o[1]+=h,o[2]+=a;break;case 4:h=a*(u-4),o[2]+=a,o[0]+=h;break;case 5:h=a*(6-u),o[2]+=h,o[0]+=a;break}for(var d=0;d!=3;++d)o[d]=Math.round(o[d]*255);return o}function Zc(i,e){if(e===0)return i;var t=Hk(zk(i));return e<0?t[2]=t[2]*(1+e):t[2]=1-(1-t[2])*(1-e),Qo(Pk(t))}var Cw=6,Ik=15,Uk=1,Qi=Cw;function Qc(i){return Math.floor((i+Math.round(128/Qi)/256)*Qi)}function Jc(i){return Math.floor((i-5)/Qi*100+.5)/100}function p0(i){return Math.round((i*Qi+5)/Qi*256)/256}function Xd(i){return p0(Jc(Qc(i)))}function gp(i){var e=Math.abs(i-Xd(i)),t=Qi;if(e>.005)for(Qi=Uk;Qi<Ik;++Qi)Math.abs(i-Xd(i))<=e&&(e=Math.abs(i-Xd(i)),t=Qi);Qi=t}function bl(i){i.width?(i.wpx=Qc(i.width),i.wch=Jc(i.wpx),i.MDW=Qi):i.wpx?(i.wch=Jc(i.wpx),i.width=p0(i.wch),i.MDW=Qi):typeof i.wch=="number"&&(i.width=p0(i.wch),i.wpx=Qc(i.width),i.MDW=Qi),i.customWidth&&delete i.customWidth}var Vk=96,Tw=Vk;function _w(i){return i*96/Tw}function Jo(i){return i*Tw/96}var Gk={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function Wk(i,e,t,r){e.Borders=[];var a={},s=!1;(i.match(Bi)||[]).forEach(function(o){var u=Ge(o);switch(Vr(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},u.diagonalUp&&(a.diagonalUp=Nt(u.diagonalUp)),u.diagonalDown&&(a.diagonalDown=Nt(u.diagonalDown)),e.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+u[0]+" in borders")}})}function jk(i,e,t,r){e.Fills=[];var a={},s=!1;(i.match(Bi)||[]).forEach(function(o){var u=Ge(o);switch(Vr(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},e.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":u.patternType&&(a.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),u.indexed&&(a.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(a.bgColor.theme=parseInt(u.theme,10)),u.tint&&(a.bgColor.tint=parseFloat(u.tint)),u.rgb&&(a.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),u.theme&&(a.fgColor.theme=parseInt(u.theme,10)),u.tint&&(a.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(a.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+u[0]+" in fills")}})}function Xk(i,e,t,r){e.Fonts=[];var a={},s=!1;(i.match(Bi)||[]).forEach(function(o){var u=Ge(o);switch(Vr(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(a),a={};break;case"<name":u.val&&(a.name=Vt(u.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=u.val?Nt(u.val):1;break;case"<b/>":a.bold=1;break;case"</b>":case"</b":break;case"<i":a.italic=u.val?Nt(u.val):1;break;case"<i/>":a.italic=1;break;case"</i>":case"</i":break;case"<u":switch(u.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"</u>":case"</u":break;case"<strike":a.strike=u.val?Nt(u.val):1;break;case"<strike/>":a.strike=1;break;case"</strike>":case"</strike":break;case"<outline":a.outline=u.val?Nt(u.val):1;break;case"<outline/>":a.outline=1;break;case"</outline>":case"</outline":break;case"<shadow":a.shadow=u.val?Nt(u.val):1;break;case"<shadow/>":a.shadow=1;break;case"</shadow>":case"</shadow":break;case"<condense":a.condense=u.val?Nt(u.val):1;break;case"<condense/>":a.condense=1;break;case"</condense>":case"</condense":break;case"<extend":a.extend=u.val?Nt(u.val):1;break;case"<extend/>":a.extend=1;break;case"</extend>":case"</extend":break;case"<sz":u.val&&(a.sz=+u.val);break;case"<sz/>":case"</sz>":case"</sz":break;case"<vertAlign":u.val&&(a.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":case"</vertAlign":break;case"<family":u.val&&(a.family=parseInt(u.val,10));break;case"<family/>":case"</family>":case"</family":break;case"<scheme":u.val&&(a.scheme=u.val);break;case"<scheme/>":case"</scheme>":case"</scheme":break;case"<charset":if(u.val=="1")break;u.codepage=ep[parseInt(u.val,10)];break;case"<charset/>":case"</charset>":case"</charset":break;case"<color":if(a.color||(a.color={}),u.auto&&(a.color.auto=Nt(u.auto)),u.rgb)a.color.rgb=u.rgb.slice(-6);else if(u.indexed){a.color.index=parseInt(u.indexed,10);var h=cs[a.color.index];a.color.index==81&&(h=cs[1]),h||(h=cs[1]),a.color.rgb=h[0].toString(16)+h[1].toString(16)+h[2].toString(16)}else u.theme&&(a.color.theme=parseInt(u.theme,10),u.tint&&(a.color.tint=parseFloat(u.tint)),u.theme&&t.themeElements&&t.themeElements.clrScheme&&(a.color.rgb=Zc(t.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":case"</color":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":case"</AlternateContent":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+u[0]+" in fonts")}})}function Yk(i,e,t){e.NumberFmt=[];for(var r=Ir(st),a=0;a<r.length;++a)e.NumberFmt[r[a]]=st[r[a]];var s=i.match(Bi);if(s)for(a=0;a<s.length;++a){var o=Ge(s[a]);switch(Vr(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=wt(Vt(o.formatCode)),h=parseInt(o.numFmtId,10);if(e.NumberFmt[h]=u,h>0){if(h>392){for(h=392;h>60&&e.NumberFmt[h]!=null;--h);e.NumberFmt[h]=u}os(u,h)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}var Dc=["numFmtId","fillId","fontId","borderId","xfId"],Fc=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function qk(i,e,t){e.CellXf=[];var r,a=!1;(i.match(Bi)||[]).forEach(function(s){var o=Ge(s),u=0;switch(Vr(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":case"<xf>":for(r=o,delete r[0],u=0;u<Dc.length;++u)r[Dc[u]]&&(r[Dc[u]]=parseInt(r[Dc[u]],10));for(u=0;u<Fc.length;++u)r[Fc[u]]&&(r[Fc[u]]=Nt(r[Fc[u]]));if(e.NumberFmt&&r.numFmtId>392){for(u=392;u>60;--u)if(e.NumberFmt[r.numFmtId]==e.NumberFmt[u]){r.numFmtId=u;break}}e.CellXf.push(r);break;case"</xf>":break;case"<alignment":case"<alignment/>":case"<alignment>":var h={};o.vertical&&(h.vertical=o.vertical),o.horizontal&&(h.horizontal=o.horizontal),o.textRotation!=null&&(h.textRotation=o.textRotation),o.indent&&(h.indent=o.indent),o.wrapText&&(h.wrapText=Nt(o.wrapText)),r.alignment=h;break;case"</alignment>":break;case"<protection":case"<protection>":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(t&&t.WTF&&!a)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}var Kk=function(){return function(t,r,a){var s={};if(!t)return s;t=sp(ru(t,"<!--","-->"));var o;return(o=_i(t,"numFmts"))&&Yk(o[0],s,a),(o=_i(t,"fonts"))&&Xk(o[0],s,r,a),(o=_i(t,"fills"))&&jk(o[0],s,r,a),(o=_i(t,"borders"))&&Wk(o[0],s,r,a),(o=_i(t,"cellXfs"))&&qk(o[0],s,a),s}}();function $k(i,e){var t=i.read_shift(2),r=Xi(i);return[t,r]}function Zk(i,e,t){var r={};r.sz=i.read_shift(2)/20;var a=aS(i);a.fItalic&&(r.italic=1),a.fCondense&&(r.condense=1),a.fExtend&&(r.extend=1),a.fShadow&&(r.shadow=1),a.fOutline&&(r.outline=1),a.fStrikeout&&(r.strike=1);var s=i.read_shift(2);switch(s===700&&(r.bold=1),i.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var o=i.read_shift(1);o!=0&&(r.underline=o);var u=i.read_shift(1);u>0&&(r.family=u);var h=i.read_shift(1);switch(h>0&&(r.charset=h),i.l++,r.color=rS(i),i.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=Xi(i),r}var Qk=Yi;function Jk(i,e){var t=i.l+e,r=i.read_shift(2),a=i.read_shift(2);return i.l=t,{ixfe:r,numFmtId:a}}var eA=Yi;function tA(i,e,t){var r={};r.NumberFmt=[];for(var a in st)r.NumberFmt[a]=st[a];r.CellXf=[],r.Fonts=[];var s=[],o=!1;return Ua(i,function(h,d,p){switch(p){case 44:r.NumberFmt[h[0]]=h[1],os(h[1],h[0]);break;case 43:r.Fonts.push(h),h.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(h.color.rgb=Zc(e.themeElements.clrScheme[h.color.theme].rgb,h.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&r.CellXf.push(h);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(p),o=!0;break;case 38:s.pop(),o=!1;break;default:if(d.T>0)s.push(p);else if(d.T<0)s.pop();else if(!o||t.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+p.toString(16))}}),r}var iA=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function rA(i,e,t){e.themeElements.clrScheme=[];var r={};(i[0].match(Bi)||[]).forEach(function(a){var s=Ge(a);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":r.rgb=s.val;break;case"</a:srgbClr>":break;case"<a:sysClr":r.rgb=s.lastClr;break;case"</a:sysClr>":break;case"</a:dk1>":case"</a:lt1>":case"<a:dk1>":case"<a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[iA.indexOf(s[0])]=r,r={}):r.name=s[0].slice(3,s[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function aA(i,e,t){e.themeElements={};var r;if(!(r=us(i,"a:clrScheme")))throw new Error("clrScheme not found in themeElements");if(rA(r,e,t),!(r=us(i,"a:fontScheme")))throw new Error("fontScheme not found in themeElements");if(!(r=us(i,"a:fmtScheme")))throw new Error("fmtScheme not found in themeElements")}function Sw(i,e){(!i||i.length===0)&&(i=nA());var t,r={};if(!(t=us(i,"a:themeElements")))throw new Error("themeElements not found in theme");return aA(t[0],r,e),r.raw=i,r}function nA(i,e){var t=[zx];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function sA(i,e,t){var r=i.l+e,a=i.read_shift(4);if(a!==124226){if(!t.cellStyles){i.l=r;return}var s=i.slice(i.l);i.l=r;var o;try{o=Bx(s,{type:"array"})}catch{return}var u=Ji(o,"theme/theme/theme1.xml",!0);if(u)return Sw(u,t)}}function lA(i){return i.read_shift(4)}function oA(i){var e={};switch(e.xclrType=i.read_shift(2),e.nTintShade=i.read_shift(2),e.xclrType){case 0:i.l+=4;break;case 1:e.xclrValue=uA(i,4);break;case 2:e.xclrValue=fw(i);break;case 3:e.xclrValue=lA(i);break;case 4:i.l+=4;break}return i.l+=8,e}function uA(i,e){return Yi(i,e)}function cA(i,e){return Yi(i,e)}function hA(i){var e=i.read_shift(2),t=i.read_shift(2)-4,r=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:r[1]=oA(i);break;case 6:r[1]=cA(i,t);break;case 14:case 15:r[1]=i.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+t)}return r}function fA(i,e){var t=i.l+e;i.l+=2;var r=i.read_shift(2);i.l+=2;for(var a=i.read_shift(2),s=[];a-- >0;)s.push(hA(i,t-i.l));return{ixfe:r,ext:s}}function dA(i,e){e.forEach(function(t){t[0]})}function pA(i,e){return{flags:i.read_shift(4),version:i.read_shift(4),name:Xi(i)}}function mA(i){for(var e=[],t=i.read_shift(4);t-- >0;)e.push([i.read_shift(4),i.read_shift(4)]);return e}function gA(i){return i.l+=4,i.read_shift(4)!=0}function vA(i,e,t){var r={Types:[],Cell:[],Value:[]},a=t||{},s=[],o=!1,u=2;return Ua(i,function(h,d,p){switch(p){case 335:r.Types.push({name:h.name});break;case 51:h.forEach(function(b){u==1?r.Cell.push({type:r.Types[b[0]-1].name,index:b[1]}):u==0&&r.Value.push({type:r.Types[b[0]-1].name,index:b[1]})});break;case 337:u=h?1:0;break;case 338:u=2;break;case 35:s.push(p),o=!0;break;case 36:s.pop(),o=!1;break;default:if(!d.T){if(!o||a.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}}),r}function bA(i,e,t){var r={Types:[],Cell:[],Value:[]};if(!i)return r;var a=!1,s=2,o;return i.replace(Bi,function(u){var h=Ge(u);switch(Vr(h[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":r.Types.push({name:h.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<r.Types.length;++d)r.Types[d].name==h.name&&(o=r.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?r.Cell.push({type:r.Types[h.t-1].name,index:+h.v}):s==0&&r.Value.push({type:r.Types[h.t-1].name,index:+h.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+h.i);break;default:if(!a&&(t!=null&&t.WTF))throw new Error("unrecognized "+h[0]+" in metadata")}return u}),r}function xA(i){var e=[];if(!i)return e;var t=1;return(i.match(Bi)||[]).forEach(function(r){var a=Ge(r);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?t=a.i:a.i=t,e.push(a);break}}),e}function wA(i){var e={};e.i=i.read_shift(4);var t={};t.r=i.read_shift(4),t.c=i.read_shift(4),e.r=kt(t);var r=i.read_shift(1);return r&2&&(e.l="1"),r&8&&(e.a="1"),e}function yA(i,e,t){var r=[];return Ua(i,function(s,o,u){switch(u){case 63:r.push(s);break;default:if(!o.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),r}function EA(i,e,t,r){if(!i)return i;var a=r||{},s=!1;Ua(i,function(u,h,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!h.T){if(!s||a.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},a)}function CA(i,e){if(!i)return"??";var t=(i.match(/<c:chart [^<>]*r:id="([^<>"]*)"/)||["",""])[1];return e["!id"][t].Target}function TA(i,e,t){var r=0;(Ox(i,"shape")||[]).forEach(function(a){var s="",o=!0,u=-1,h=-1,d=-1;switch(a.replace(Bi,function(b,g){var v=Ge(b);switch(Vr(v[0])){case"<ClientData":v.ObjectType&&(s=v.ObjectType);break;case"<Visible":case"<Visible/>":o=!1;break;case"<Row":case"<Row>":u=g+b.length;break;case"</Row>":h=+a.slice(u,g).trim();break;case"<Column":case"<Column>":u=g+b.length;break;case"</Column>":d=+a.slice(u,g).trim();break}return""}),s){case"Note":var p=tu(e,h>=0&&d>=0?kt({r:h,c:d}):t[r].ref);p.c&&(p.c.hidden=o),++r;break}})}function hb(i,e,t,r){var a=i["!data"]!=null,s;e.forEach(function(o){var u=ji(o.ref);if(!(u.r<0||u.c<0)){if(a?(i["!data"][u.r]||(i["!data"][u.r]=[]),s=i["!data"][u.r][u.c]):s=i[o.ref],!s){s={t:"z"},a?i["!data"][u.r][u.c]=s:i[o.ref]=s;var h=si(i["!ref"]||"BDWGO1000001:A1");h.s.r>u.r&&(h.s.r=u.r),h.e.r<u.r&&(h.e.r=u.r),h.s.c>u.c&&(h.s.c=u.c),h.e.c<u.c&&(h.e.c=u.c);var d=yt(h);i["!ref"]=d}s.c||(s.c=[]);var p={a:o.author,t:o.t,r:o.r,T:t};o.h&&(p.h=o.h);for(var b=s.c.length-1;b>=0;--b){if(!t&&s.c[b].T)return;t&&!s.c[b].T&&s.c.splice(b,1)}if(t&&r){for(b=0;b<r.length;++b)if(p.a==r[b].id){p.a=r[b].name||p.a;break}}s.c.push(p)}})}function _A(i,e){if(i.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],r=[],a=_i(i,"authors");a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var u=o.match(/<(?:\w+:)?author[^<>]*>(.*)/);u&&t.push(u[1])}});var s=_i(i,"commentList");return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var u=o.match(/<(?:\w+:)?comment[^<>]*>/);if(u){var h=Ge(u[0]),d={author:h.authorId&&t[h.authorId]||"sheetjsghost",ref:h.ref,guid:h.guid},p=ji(h.ref);if(!(e.sheetRows&&e.sheetRows<=p.r)){var b=_i(o,"text"),g=!!b&&!!b[1]&&mp(b[1])||{r:"",t:"",h:""};d.r=g.r,g.r=="<t></t>"&&(g.t=g.h=""),d.t=(g.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(d.h=g.h),r.push(d)}}}}),r}function SA(i,e){var t=[],r=!1,a={},s=0;return i.replace(Bi,function(u,h){var d=Ge(u);switch(Vr(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":a.t!=null&&t.push(a);break;case"<text>":case"<text":s=h+u.length;break;case"</text>":a.t=i.slice(s,h).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":r=!0;break;case"</mentions>":r=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&e.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return u}),t}function RA(i,e){var t=[],r=!1;return i.replace(Bi,function(s){var o=Ge(s);switch(Vr(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&e.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return s}),t}function kA(i){var e={};e.iauthor=i.read_shift(4);var t=ys(i);return e.rfx=t.s,e.ref=kt(t.s),i.l+=16,e}var AA=Xi;function DA(i,e){var t=[],r=[],a={},s=!1;return Ua(i,function(u,h,d){switch(d){case 632:r.push(u);break;case 635:a=u;break;case 637:a.t=u.t,a.h=u.h,a.r=u.r;break;case 636:if(a.author=r[a.iauthor],delete a.iauthor,e.sheetRows&&a.rfx&&e.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,t.push(a);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!h.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),t}var FA="application/vnd.ms-office.vbaProject";function MA(i){var e=Tt.utils.cfb_new({root:"R"});return i.FullPaths.forEach(function(t,r){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var a=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Tt.utils.cfb_add(e,a,i.FileIndex[r].content)}}),Tt.write(e)}function OA(){return{"!type":"dialog"}}function LA(){return{"!type":"dialog"}}function NA(){return{"!type":"macro"}}function BA(){return{"!type":"macro"}}var hs=function(){var i=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function t(r,a,s,o){var u=!1,h=!1;s.length==0?h=!0:s.charAt(0)=="["&&(h=!0,s=s.slice(1,-1)),o.length==0?u=!0:o.charAt(0)=="["&&(u=!0,o=o.slice(1,-1));var d=s.length>0?parseInt(s,10)|0:0,p=o.length>0?parseInt(o,10)|0:0;return u?p+=e.c:--p,h?d+=e.r:--d,a+(u?"":"$")+Dt(p)+(h?"":"$")+Bt(d)}return function(a,s){return e=s,a.replace(i,t)}}(),vp=/(^|[^._A-Z0-9])(\$?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])(\$?)(\d{1,7})(?![_.\(A-Za-z0-9])/g;try{vp=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g}catch{}var zA=function(){return function(e,t){return e.replace(vp,function(r,a,s,o,u,h){var d=hp(o)-(s?0:t.c),p=cp(h)-(u?0:t.r),b=u=="$"?p+1:p==0?"":"["+p+"]",g=s=="$"?d+1:d==0?"":"["+d+"]";return a+"R"+b+"C"+g})}}();function Rw(i,e){return i.replace(vp,function(t,r,a,s,o,u){return r+(a=="$"?a+s:Dt(hp(s)+e.c))+(o=="$"?o+u:Bt(cp(u)+e.r))})}function fb(i,e,t){var r=xs(e),a=r.s,s=ji(t),o={r:s.r-a.r,c:s.c-a.c};return Rw(i,o)}function HA(i){return i.length!=1}function db(i){return i.replace(/_xlfn\./g,"")}function hi(i){i.l+=1}function kn(i,e){var t=i.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function kw(i,e,t){var r=2;if(t){if(t.biff>=2&&t.biff<=5)return Aw(i);t.biff==12&&(r=4)}var a=i.read_shift(r),s=i.read_shift(r),o=kn(i),u=kn(i);return{s:{r:a,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:u[0],cRel:u[1],rRel:u[2]}}}function Aw(i){var e=kn(i),t=kn(i),r=i.read_shift(1),a=i.read_shift(1);return{s:{r:e[0],c:r,cRel:e[1],rRel:e[2]},e:{r:t[0],c:a,cRel:t[1],rRel:t[2]}}}function PA(i,e,t){if(t.biff<8)return Aw(i);var r=i.read_shift(t.biff==12?4:2),a=i.read_shift(t.biff==12?4:2),s=kn(i),o=kn(i);return{s:{r,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function Dw(i,e,t){if(t&&t.biff>=2&&t.biff<=5)return IA(i);var r=i.read_shift(t&&t.biff==12?4:2),a=kn(i);return{r,c:a[0],cRel:a[1],rRel:a[2]}}function IA(i){var e=kn(i),t=i.read_shift(1);return{r:e[0],c:t,cRel:e[1],rRel:e[2]}}function UA(i){var e=i.read_shift(2),t=i.read_shift(2);return{r:e,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function VA(i,e,t){var r=t&&t.biff?t.biff:8;if(r>=2&&r<=5)return GA(i);var a=i.read_shift(r>=12?4:2),s=i.read_shift(2),o=(s&16384)>>14,u=(s&32768)>>15;if(s&=16383,u==1)for(;a>524287;)a-=1048576;if(o==1)for(;s>8191;)s=s-16384;return{r:a,c:s,cRel:o,rRel:u}}function GA(i){var e=i.read_shift(2),t=i.read_shift(1),r=(e&32768)>>15,a=(e&16384)>>14;return e&=16383,r==1&&e>=8192&&(e=e-16384),a==1&&t>=128&&(t=t-256),{r:e,c:t,cRel:a,rRel:r}}function WA(i,e,t){var r=(i[i.l++]&96)>>5,a=kw(i,t.biff>=2&&t.biff<=5?6:8,t);return[r,a]}function jA(i,e,t){var r=(i[i.l++]&96)>>5,a=i.read_shift(2,"i"),s=8;if(t)switch(t.biff){case 5:i.l+=12,s=6;break;case 12:s=12;break}var o=kw(i,s,t);return[r,a,o]}function XA(i,e,t){var r=(i[i.l++]&96)>>5;return i.l+=t&&t.biff>8?12:t.biff<8?6:8,[r]}function YA(i,e,t){var r=(i[i.l++]&96)>>5,a=i.read_shift(2),s=8;if(t)switch(t.biff){case 5:i.l+=12,s=6;break;case 12:s=12;break}return i.l+=s,[r,a]}function qA(i,e,t){var r=(i[i.l++]&96)>>5,a=PA(i,e-1,t);return[r,a]}function KA(i,e,t){var r=(i[i.l++]&96)>>5;return i.l+=t.biff==2?6:t.biff==12?14:7,[r]}function pb(i){var e=i[i.l+1]&1,t=1;return i.l+=4,[e,t]}function $A(i,e,t){i.l+=2;for(var r=i.read_shift(t&&t.biff==2?1:2),a=[],s=0;s<=r;++s)a.push(i.read_shift(t&&t.biff==2?1:2));return a}function ZA(i,e,t){var r=i[i.l+1]&255?1:0;return i.l+=2,[r,i.read_shift(t&&t.biff==2?1:2)]}function QA(i,e,t){var r=i[i.l+1]&255?1:0;return i.l+=2,[r,i.read_shift(t&&t.biff==2?1:2)]}function JA(i){var e=i[i.l+1]&255?1:0;return i.l+=2,[e,i.read_shift(2)]}function e4(i,e,t){var r=i[i.l+1]&255?1:0;return i.l+=t&&t.biff==2?3:4,[r]}function Fw(i){var e=i.read_shift(1),t=i.read_shift(1);return[e,t]}function t4(i){return i.read_shift(2),Fw(i)}function i4(i){return i.read_shift(2),Fw(i)}function r4(i,e,t){var r=(i[i.l]&96)>>5;i.l+=1;var a=Dw(i,0,t);return[r,a]}function a4(i,e,t){var r=(i[i.l]&96)>>5;i.l+=1;var a=VA(i,0,t);return[r,a]}function n4(i,e,t){var r=(i[i.l]&96)>>5;i.l+=1;var a=i.read_shift(2);t&&t.biff==5&&(i.l+=12);var s=Dw(i,0,t);return[r,a,s]}function s4(i,e,t){var r=(i[i.l]&96)>>5;i.l+=1;var a=i.read_shift(t&&t.biff<=3?1:2);return[lD[a],Lw[a],r]}function l4(i,e,t){var r=i[i.l++],a=i.read_shift(1),s=t&&t.biff<=3?[r==88?-1:0,i.read_shift(1)]:o4(i);return[a,(s[0]===0?Lw:sD)[s[1]]]}function o4(i){return[i[i.l+1]>>7,i.read_shift(2)&32767]}function u4(i,e,t){i.l+=t&&t.biff==2?3:4}function c4(i,e,t){if(i.l++,t&&t.biff==12)return[i.read_shift(4,"i"),0];var r=i.read_shift(2),a=i.read_shift(t&&t.biff==2?1:2);return[r,a]}function h4(i){return i.l++,sr[i.read_shift(1)]}function f4(i){return i.l++,i.read_shift(2)}function d4(i){return i.l++,i.read_shift(1)!==0}function p4(i){return i.l++,Wi(i)}function m4(i,e,t){return i.l++,vl(i,e-1,t)}function g4(i,e){var t=[i.read_shift(1)];if(e==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=ni(i,1)?"TRUE":"FALSE",e!=12&&(i.l+=7);break;case 37:case 16:t[1]=sr[i[i.l]],i.l+=e==12?4:8;break;case 0:i.l+=8;break;case 1:t[1]=Wi(i);break;case 2:t[1]=Es(i,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function v4(i,e,t){for(var r=i.read_shift(t.biff==12?4:2),a=[],s=0;s!=r;++s)a.push((t.biff==12?ys:mh)(i));return a}function b4(i,e,t){var r=0,a=0;t.biff==12?(r=i.read_shift(4),a=i.read_shift(4)):(a=1+i.read_shift(1),r=1+i.read_shift(2)),t.biff>=2&&t.biff<8&&(--r,--a==0&&(a=256));for(var s=0,o=[];s!=r&&(o[s]=[]);++s)for(var u=0;u!=a;++u)o[s][u]=g4(i,t.biff);return o}function x4(i,e,t){var r=i.read_shift(1)>>>5&3,a=!t||t.biff>=8?4:2,s=i.read_shift(a);switch(t.biff){case 2:i.l+=5;break;case 3:case 4:i.l+=8;break;case 5:i.l+=12;break}return[r,0,s]}function w4(i,e,t){if(t.biff==5)return y4(i);var r=i.read_shift(1)>>>5&3,a=i.read_shift(2),s=i.read_shift(4);return[r,a,s]}function y4(i){var e=i.read_shift(1)>>>5&3,t=i.read_shift(2,"i");i.l+=8;var r=i.read_shift(2);return i.l+=12,[e,t,r]}function E4(i,e,t){var r=i.read_shift(1)>>>5&3;i.l+=t&&t.biff==2?3:4;var a=i.read_shift(t&&t.biff==2?1:2);return[r,a]}function C4(i,e,t){var r=i.read_shift(1)>>>5&3,a=i.read_shift(t&&t.biff==2?1:2);return[r,a]}function T4(i,e,t){var r=i.read_shift(1)>>>5&3;return i.l+=4,t.biff<8&&i.l--,t.biff==12&&(i.l+=2),[r]}function _4(i,e,t){var r=(i[i.l++]&96)>>5,a=i.read_shift(2),s=4;if(t)switch(t.biff){case 5:s=15;break;case 12:s=6;break}return i.l+=s,[r,a]}var S4=Yi,R4=Yi,k4=Yi;function su(i,e,t){return i.l+=2,[UA(i)]}function bp(i){return i.l+=6,[]}var A4=su,D4=bp,F4=bp,M4=su;function Mw(i){return i.l+=2,[ei(i),i.read_shift(2)&1]}var O4=su,L4=Mw,N4=bp,B4=su,z4=su,H4=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function P4(i){i.l+=2;var e=i.read_shift(2),t=i.read_shift(2),r=i.read_shift(4),a=i.read_shift(2),s=i.read_shift(2),o=H4[t>>2&31];return{ixti:e,coltype:t&3,rt:o,idx:r,c:a,C:s}}function I4(i){return i.l+=2,[i.read_shift(4)]}function U4(i,e,t){return i.l+=5,i.l+=2,i.l+=t.biff==2?1:4,["PTGSHEET"]}function V4(i,e,t){return i.l+=t.biff==2?4:5,["PTGENDSHEET"]}function G4(i){var e=i.read_shift(1)>>>5&3,t=i.read_shift(2);return[e,t]}function W4(i){var e=i.read_shift(1)>>>5&3,t=i.read_shift(2);return[e,t]}function j4(i){return i.l+=4,[0,0]}var mb={1:{n:"PtgExp",f:c4},2:{n:"PtgTbl",f:k4},3:{n:"PtgAdd",f:hi},4:{n:"PtgSub",f:hi},5:{n:"PtgMul",f:hi},6:{n:"PtgDiv",f:hi},7:{n:"PtgPower",f:hi},8:{n:"PtgConcat",f:hi},9:{n:"PtgLt",f:hi},10:{n:"PtgLe",f:hi},11:{n:"PtgEq",f:hi},12:{n:"PtgGe",f:hi},13:{n:"PtgGt",f:hi},14:{n:"PtgNe",f:hi},15:{n:"PtgIsect",f:hi},16:{n:"PtgUnion",f:hi},17:{n:"PtgRange",f:hi},18:{n:"PtgUplus",f:hi},19:{n:"PtgUminus",f:hi},20:{n:"PtgPercent",f:hi},21:{n:"PtgParen",f:hi},22:{n:"PtgMissArg",f:hi},23:{n:"PtgStr",f:m4},26:{n:"PtgSheet",f:U4},27:{n:"PtgEndSheet",f:V4},28:{n:"PtgErr",f:h4},29:{n:"PtgBool",f:d4},30:{n:"PtgInt",f:f4},31:{n:"PtgNum",f:p4},32:{n:"PtgArray",f:KA},33:{n:"PtgFunc",f:s4},34:{n:"PtgFuncVar",f:l4},35:{n:"PtgName",f:x4},36:{n:"PtgRef",f:r4},37:{n:"PtgArea",f:WA},38:{n:"PtgMemArea",f:E4},39:{n:"PtgMemErr",f:S4},40:{n:"PtgMemNoMem",f:R4},41:{n:"PtgMemFunc",f:C4},42:{n:"PtgRefErr",f:T4},43:{n:"PtgAreaErr",f:XA},44:{n:"PtgRefN",f:a4},45:{n:"PtgAreaN",f:qA},46:{n:"PtgMemAreaN",f:G4},47:{n:"PtgMemNoMemN",f:W4},57:{n:"PtgNameX",f:w4},58:{n:"PtgRef3d",f:n4},59:{n:"PtgArea3d",f:jA},60:{n:"PtgRefErr3d",f:_4},61:{n:"PtgAreaErr3d",f:YA},255:{}},X4={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Y4={1:{n:"PtgElfLel",f:Mw},2:{n:"PtgElfRw",f:B4},3:{n:"PtgElfCol",f:A4},6:{n:"PtgElfRwV",f:z4},7:{n:"PtgElfColV",f:M4},10:{n:"PtgElfRadical",f:O4},11:{n:"PtgElfRadicalS",f:N4},13:{n:"PtgElfColS",f:D4},15:{n:"PtgElfColSV",f:F4},16:{n:"PtgElfRadicalLel",f:L4},25:{n:"PtgList",f:P4},29:{n:"PtgSxName",f:I4},255:{}},q4={0:{n:"PtgAttrNoop",f:j4},1:{n:"PtgAttrSemi",f:e4},2:{n:"PtgAttrIf",f:QA},4:{n:"PtgAttrChoose",f:$A},8:{n:"PtgAttrGoto",f:ZA},16:{n:"PtgAttrSum",f:u4},32:{n:"PtgAttrBaxcel",f:pb},33:{n:"PtgAttrBaxcel",f:pb},64:{n:"PtgAttrSpace",f:t4},65:{n:"PtgAttrSpaceSemi",f:i4},128:{n:"PtgAttrIfError",f:JA},255:{}};function lu(i,e,t,r){if(r.biff<8)return Yi(i,e);for(var a=i.l+e,s=[],o=0;o!==t.length;++o)switch(t[o][0]){case"PtgArray":t[o][1]=b4(i,0,r),s.push(t[o][1]);break;case"PtgMemArea":t[o][2]=v4(i,t[o][1],r),s.push(t[o][2]);break;case"PtgExp":r&&r.biff==12&&(t[o][1][1]=i.read_shift(4),s.push(t[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[o][0]}return e=a-i.l,e!==0&&s.push(Yi(i,e)),s}function ou(i,e,t){for(var r=i.l+e,a,s,o=[];r!=i.l;)e=r-i.l,s=i[i.l],a=mb[s]||mb[X4[s]],(s===24||s===25)&&(a=(s===24?Y4:q4)[i[i.l+1]]),!a||!a.f?Yi(i,e):o.push([a.n,a.f(i,e,t)]);return o}function K4(i){for(var e=[],t=0;t<i.length;++t){for(var r=i[t],a=[],s=0;s<r.length;++s){var o=r[s];if(o)switch(o[0]){case 2:a.push('"'+o[1].replace(/"/g,'""')+'"');break;default:a.push(o[1])}else a.push("")}e.push(a.join(","))}return e.join(";")}var $4={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Z4(i,e){var t=i.lastIndexOf("!"),r=e.lastIndexOf("!");return t==-1&&r==-1?i+":"+e:t>0&&r>0&&i.slice(0,t).toLowerCase()==e.slice(0,r).toLowerCase()?i+":"+e.slice(r+1):(console.error("Cannot hydrate range",i,e),i+":"+e)}function Ow(i,e,t){if(!i)return"SH33TJSERR0";if(t.biff>8&&(!i.XTI||!i.XTI[e]))return i.SheetNames[e];if(!i.XTI)return"SH33TJSERR6";var r=i.XTI[e];if(t.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":i.XTI[e-1];if(!r)return"SH33TJSERR1";var a="";if(t.biff>8)switch(i[r[0]][0]){case 357:return a=r[1]==-1?"#REF":i.SheetNames[r[1]],r[1]==r[2]?a:a+":"+i.SheetNames[r[2]];case 358:return t.SID!=null?i.SheetNames[t.SID]:"SH33TJSSAME"+i[r[0]][0];case 355:default:return"SH33TJSSRC"+i[r[0]][0]}switch(i[r[0]][0][0]){case 1025:return a=r[1]==-1?"#REF":i.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?a:a+":"+i.SheetNames[r[2]];case 14849:return i[r[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return i[r[0]][0][3]?(a=r[1]==-1?"#REF":i[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?a:a+":"+i[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function gb(i,e,t){var r=Ow(i,e,t);return r=="#REF"?r:$_(r,t)}function Vi(i,e,t,r,a){var s=a&&a.biff||8,o={s:{c:0,r:0}},u=[],h,d,p,b=0,g=0,v,y="";if(!i[0]||!i[0][0])return"";for(var C=-1,E="",w=0,R=i[0].length;w<R;++w){var T=i[0][w];switch(T[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(h=u.pop(),d=u.pop(),C>=0){switch(i[0][C][1][0]){case 0:E=Ct(" ",i[0][C][1][1]);break;case 1:E=Ct("\r",i[0][C][1][1]);break;default:if(E="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+i[0][C][1][0])}d=d+E,C=-1}u.push(d+$4[T[0]]+h);break;case"PtgIsect":h=u.pop(),d=u.pop(),u.push(d+" "+h);break;case"PtgUnion":h=u.pop(),d=u.pop(),u.push(d+","+h);break;case"PtgRange":h=u.pop(),d=u.pop(),u.push(Z4(d,h));break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":p=Do(T[1][1],o,a),u.push(Fo(p,s));break;case"PtgRefN":p=t?Do(T[1][1],t,a):T[1][1],u.push(Fo(p,s));break;case"PtgRef3d":b=T[1][1],p=Do(T[1][2],o,a),y=gb(r,b,a),u.push(y+"!"+Fo(p,s));break;case"PtgFunc":case"PtgFuncVar":var D=T[1][0],k=T[1][1];D||(D=0),D&=127;var V=D==0?[]:u.slice(-D);u.length-=D,k==="User"&&(k=V.shift()),u.push(k+"("+V.join(",")+")");break;case"PtgBool":u.push(T[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(T[1]);break;case"PtgNum":u.push(String(T[1]));break;case"PtgStr":u.push('"'+T[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(T[1]);break;case"PtgAreaN":v=q1(T[1][1],t?{s:t}:o,a),u.push(Wd(v,a));break;case"PtgArea":v=q1(T[1][1],o,a),u.push(Wd(v,a));break;case"PtgArea3d":b=T[1][1],v=T[1][2],y=gb(r,b,a),u.push(y+"!"+Wd(v,a));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":g=T[1][2];var P=(r.names||[])[g-1]||(r[0]||[])[g],U=P?P.Name:"SH33TJSNAME"+String(g);U&&U.slice(0,6)=="_xlfn."&&!a.xlfn&&(U=U.slice(6)),u.push(U);break;case"PtgNameX":var N=T[1][1];g=T[1][2];var j;if(a.biff<=5)N<0&&(N=-N),r[N]&&(j=r[N][g]);else{var Y="";if(((r[N]||[])[0]||[])[0]==14849||(((r[N]||[])[0]||[])[0]==1025?r[N][g]&&r[N][g].itab>0&&(Y=r.SheetNames[r[N][g].itab-1]+"!"):Y=r.SheetNames[g-1]+"!"),r[N]&&r[N][g])Y+=r[N][g].Name;else if(r[0]&&r[0][g])Y+=r[0][g].Name;else{var Z=(Ow(r,N,a)||"").split(";;");Z[g-1]?Y=Z[g-1]:Y+="SH33TJSERRX"}u.push(Y);break}j||(j={Name:"SH33TJSERRY"}),u.push(j.Name);break;case"PtgParen":var ce="(",Le=")";if(C>=0){switch(E="",i[0][C][1][0]){case 2:ce=Ct(" ",i[0][C][1][1])+ce;break;case 3:ce=Ct("\r",i[0][C][1][1])+ce;break;case 4:Le=Ct(" ",i[0][C][1][1])+Le;break;case 5:Le=Ct("\r",i[0][C][1][1])+Le;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+i[0][C][1][0])}C=-1}u.push(ce+u.pop()+Le);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":p={c:T[1][1],r:T[1][0]};var ge={c:t.c,r:t.r};if(r.sharedf[kt(p)]){var me=r.sharedf[kt(p)];u.push(Vi(me,o,ge,r,a))}else{var de=!1;for(h=0;h!=r.arrayf.length;++h)if(d=r.arrayf[h],!(p.c<d[0].s.c||p.c>d[0].e.c)&&!(p.r<d[0].s.r||p.r>d[0].e.r)){u.push(Vi(d[1],o,ge,r,a)),de=!0;break}de||u.push(T[1])}break;case"PtgArray":u.push("{"+K4(T[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":C=w;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+T[1].idx+"[#"+T[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(T));default:throw new Error("Unrecognized Formula Token: "+String(T))}var ve=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&C>=0&&ve.indexOf(i[0][w][0])==-1){T=i[0][C];var Me=!0;switch(T[1][0]){case 4:Me=!1;case 0:E=Ct(" ",T[1][1]);break;case 5:Me=!1;case 1:E=Ct("\r",T[1][1]);break;default:if(E="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+T[1][0])}u.push((Me?E:"")+u.pop()+(Me?"":E)),C=-1}}if(u.length>1&&a.WTF)throw new Error("bad formula stack");return u[0]=="TRUE"?!0:u[0]=="FALSE"?!1:u[0]}function Q4(i,e,t){var r=i.l+e,a=t.biff==2?1:2,s,o=i.read_shift(a);if(o==65535)return[[],Yi(i,e-2)];var u=ou(i,o,t);return e!==o+a&&(s=lu(i,e-o-a,u,t)),i.l=r,[u,s]}function J4(i,e,t){var r=i.l+e,a=t.biff==2?1:2,s,o=i.read_shift(a);if(o==65535)return[[],Yi(i,e-2)];var u=ou(i,o,t);return e!==o+a&&(s=lu(i,e-o-a,u,t)),i.l=r,[u,s]}function eD(i,e,t,r){var a=i.l+e,s=ou(i,r,t),o;return a!==i.l&&(o=lu(i,a-i.l,s,t)),[s,o]}function tD(i,e,t){var r=i.l+e,a,s=i.read_shift(2),o=ou(i,s,t);return s==65535?[[],Yi(i,e-2)]:(e!==s+2&&(a=lu(i,r-s-2,o,t)),[o,a])}function iD(i){var e;if(Na(i,i.l+6)!==65535)return[Wi(i),"n"];switch(i[i.l]){case 0:return i.l+=8,["String","s"];case 1:return e=i[i.l+2]===1,i.l+=8,[e,"b"];case 2:return e=i[i.l+2],i.l+=8,[e,"e"];case 3:return i.l+=8,["","s"]}return[]}function Yd(i,e,t){var r=i.l+e,a=ia(i,6,t),s=iD(i),o=i.read_shift(1);t.biff!=2&&(i.read_shift(1),t.biff>=5&&i.read_shift(4));var u=J4(i,r-i.l,t);return{cell:a,val:s[0],formula:u,shared:o>>3&1,tt:s[1]}}function gh(i,e,t){var r=i.read_shift(4),a=ou(i,r,t),s=i.read_shift(4),o=s>0?lu(i,s,a,t):null;return[a,o]}var rD=gh,vh=gh,aD=gh,nD=gh,sD={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Lw={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},lD={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function vb(i){return i.slice(0,3)=="of:"&&(i=i.slice(3)),i.charCodeAt(0)==61&&(i=i.slice(1),i.charCodeAt(0)==61&&(i=i.slice(1))),i=i.replace(/COM\.MICROSOFT\./g,""),i=i.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,t){return t.replace(/\./g,"")}),i=i.replace(/\$'([^']|'')+'/g,function(e){return e.slice(1)}),i=i.replace(/\$([^\]\. #$]+)/g,function(e,t){return t.match(/^([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])?(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})?$/)?e:t}),i=i.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),i.replace(/[;~]/g,",").replace(/\|/g,";")}function qd(i){i=i.replace(/\$'([^']|'')+'/g,function(r){return r.slice(1)}),i=i.replace(/\$([^\]\. #$]+)/g,function(r,a){return a.match(/^([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])?(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})?$/)?r:a});var e=i.split(":"),t=e[0].split(".")[0];return[t,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}var No={},dl={};function Bo(i,e){if(i){var t=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(t=[1,1,1,1,.5,.5]),i.left==null&&(i.left=t[0]),i.right==null&&(i.right=t[1]),i.top==null&&(i.top=t[2]),i.bottom==null&&(i.bottom=t[3]),i.header==null&&(i.header=t[4]),i.footer==null&&(i.footer=t[5])}}function Nw(i,e,t,r,a,s,o){try{r.cellNF&&(i.z=st[e])}catch(h){if(r.WTF)throw h}if(!(i.t==="z"&&!r.cellStyles)){if(i.t==="d"&&typeof i.v=="string"&&(i.v=Ni(i.v)),(!r||r.cellText!==!1)&&i.t!=="z")try{if(st[e]==null&&os(QT[e]||"General",e),i.t==="e")i.w=i.w||sr[i.v];else if(e===0)if(i.t==="n")(i.v|0)===i.v?i.w=i.v.toString(10):i.w=Ko(i.v);else if(i.t==="d"){var u=xi(i.v,!!o);(u|0)===u?i.w=u.toString(10):i.w=Ko(u)}else{if(i.v===void 0)return"";i.w=ms(i.v,dl)}else i.t==="d"?i.w=Er(e,xi(i.v,!!o),dl):i.w=Er(e,i.v,dl)}catch(h){if(r.WTF)throw h}if(r.cellStyles&&t!=null)try{i.s=s.Fills[t],i.s.fgColor&&i.s.fgColor.theme&&!i.s.fgColor.rgb&&(i.s.fgColor.rgb=Zc(a.themeElements.clrScheme[i.s.fgColor.theme].rgb,i.s.fgColor.tint||0),r.WTF&&(i.s.fgColor.raw_rgb=a.themeElements.clrScheme[i.s.fgColor.theme].rgb)),i.s.bgColor&&i.s.bgColor.theme&&(i.s.bgColor.rgb=Zc(a.themeElements.clrScheme[i.s.bgColor.theme].rgb,i.s.bgColor.tint||0),r.WTF&&(i.s.bgColor.raw_rgb=a.themeElements.clrScheme[i.s.bgColor.theme].rgb))}catch(h){if(r.WTF&&s.Fills)throw h}}}function oD(i,e){var t=si(e);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(i["!ref"]=yt(t))}var uD=/<(?:\w+:)?mergeCell ref=["'][A-Z0-9:]+['"]\s*[\/]?>/g,cD=/<(?:\w+:)?hyperlink [^<>]*>/mg,hD=/"(\w*:\w*)"/,fD=/<(?:\w+:)?col\b[^<>]*[\/]?>/g,dD=/<(?:\w+:)?autoFilter[^>]*/g,pD=/<(?:\w+:)?pageMargins[^<>]*\/>/g,Bw=/<(?:\w+:)?sheetPr\b[^<>]*?\/>/;function mD(i,e,t,r,a,s,o){if(!i)return i;r||(r={"!id":{}});var u={};e.dense&&(u["!data"]=[]);var h={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",p="",b=_i(i,"sheetData");b?(d=i.slice(0,b.index),p=i.slice(b.index+b[0].length)):d=p=i;var g=d.match(Bw);g?xp(g[0],u,a,t):(g=_i(d,"sheetPr"))&&gD(g[0],g[1]||"",u,a,t);var v=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(v>0){var y=d.slice(v,v+50).match(hD);y&&!(e&&e.nodim)&&oD(u,y[1])}var C=_i(d,"sheetViews");C&&C[1]&&ED(C[1],a);var E=[];if(e.cellStyles){var w=d.match(fD);w&&xD(E,w)}b&&CD(b[1],u,e,h,s,o,a);var R=p.match(dD);R&&(u["!autofilter"]=wD(R[0]));var T=[],D=p.match(uD);if(D)for(v=0;v!=D.length;++v)T[v]=si(D[v].slice(D[v].indexOf("=")+2));var k=p.match(cD);k&&vD(u,k,r);var V=p.match(pD);V&&(u["!margins"]=bD(Ge(V[0])));var P;if((P=p.match(/legacyDrawing r:id="(.*?)"/))&&(u["!legrel"]=P[1]),e&&e.nodim&&(h.s.c=h.s.r=0),!u["!ref"]&&h.e.c>=h.s.c&&h.e.r>=h.s.r&&(u["!ref"]=yt(h)),e.sheetRows>0&&u["!ref"]){var U=si(u["!ref"]);e.sheetRows<=+U.e.r&&(U.e.r=e.sheetRows-1,U.e.r>h.e.r&&(U.e.r=h.e.r),U.e.r<U.s.r&&(U.s.r=U.e.r),U.e.c>h.e.c&&(U.e.c=h.e.c),U.e.c<U.s.c&&(U.s.c=U.e.c),u["!fullref"]=u["!ref"],u["!ref"]=yt(U))}return E.length>0&&(u["!cols"]=E),T.length>0&&(u["!merges"]=T),r["!id"][u["!legrel"]]&&(u["!legdrawel"]=r["!id"][u["!legrel"]]),u}function xp(i,e,t,r){var a=Ge(i);t.Sheets[r]||(t.Sheets[r]={}),a.codeName&&(t.Sheets[r].CodeName=wt(Vt(a.codeName)))}function gD(i,e,t,r,a){xp(i.slice(0,i.indexOf(">")),t,r,a)}function vD(i,e,t){for(var r=i["!data"]!=null,a=0;a!=e.length;++a){var s=Ge(Vt(e[a]),!0);if(!s.ref)return;var o=((t||{})["!id"]||[])[s.id];o?(s.Target=o.Target,s.location&&(s.Target+="#"+wt(s.location))):(s.Target="#"+wt(s.location),o={Target:s.Target,TargetMode:"Internal"}),s.Rel=o,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var u=si(s.ref),h=u.s.r;h<=u.e.r;++h)for(var d=u.s.c;d<=u.e.c;++d){var p=Dt(d)+Bt(h);r?(i["!data"][h]||(i["!data"][h]=[]),i["!data"][h][d]||(i["!data"][h][d]={t:"z",v:void 0}),i["!data"][h][d].l=s):(i[p]||(i[p]={t:"z",v:void 0}),i[p].l=s)}}}function bD(i){var e={};return["left","right","top","bottom","header","footer"].forEach(function(t){i[t]&&(e[t]=parseFloat(i[t]))}),e}function xD(i,e){for(var t=!1,r=0;r!=e.length;++r){var a=Ge(e[r],!0);a.hidden&&(a.hidden=Nt(a.hidden));var s=parseInt(a.min,10)-1,o=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!t&&a.width&&(t=!0,gp(a.width)),bl(a);s<=o;)i[s++]=mi(a)}}function wD(i){var e={ref:(i.match(/ref="([^"]*)"/)||[])[1]};return e}var yD=/<(?:\w:)?sheetView(?:[^<>a-z][^<>]*)?\/?>/g;function ED(i,e){e.Views||(e.Views=[{}]),(i.match(yD)||[]).forEach(function(t,r){var a=Ge(t);e.Views[r]||(e.Views[r]={}),+a.zoomScale&&(e.Views[r].zoom=+a.zoomScale),a.rightToLeft&&Nt(a.rightToLeft)&&(e.Views[r].RTL=!0)})}var CD=function(){var i=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,r=/ref=["']([^"']*)["']/;return function(s,o,u,h,d,p,b){for(var g=0,v="",y=[],C=[],E=0,w=0,R=0,T="",D,k,V=0,P=0,U,N,j=0,Y=0,Z=Array.isArray(p.CellXf),ce,Le=[],ge=[],me=o["!data"]!=null,de=[],ve={},Me=!1,F=!!u.sheetStubs,he=!!((b||{}).WBProps||{}).date1904,_e=s.split(e),ye=0,pe=_e.length;ye!=pe;++ye){v=_e[ye].trim();var Ne=v.length;if(Ne!==0){var Oe=0;e:for(g=0;g<Ne;++g)switch(v[g]){case">":if(v[g-1]!="/"){++g;break e}if(u&&u.cellStyles){if(k=Ge(v.slice(Oe,g),!0),V=k.r!=null?parseInt(k.r,10):V+1,P=-1,u.sheetRows&&u.sheetRows<V)continue;ve={},Me=!1,k.ht&&(Me=!0,ve.hpt=parseFloat(k.ht),ve.hpx=Jo(ve.hpt)),k.hidden&&Nt(k.hidden)&&(Me=!0,ve.hidden=!0),k.outlineLevel!=null&&(Me=!0,ve.level=+k.outlineLevel),Me&&(de[V-1]=ve)}break;case"<":Oe=g;break}if(Oe>=g)break;if(k=Ge(v.slice(Oe,g),!0),V=k.r!=null?parseInt(k.r,10):V+1,P=-1,!(u.sheetRows&&u.sheetRows<V)){u.nodim||(h.s.r>V-1&&(h.s.r=V-1),h.e.r<V-1&&(h.e.r=V-1)),u&&u.cellStyles&&(ve={},Me=!1,k.ht&&(Me=!0,ve.hpt=parseFloat(k.ht),ve.hpx=Jo(ve.hpt)),k.hidden&&Nt(k.hidden)&&(Me=!0,ve.hidden=!0),k.outlineLevel!=null&&(Me=!0,ve.level=+k.outlineLevel),Me&&(de[V-1]=ve)),y=v.slice(g).split(i);for(var qe=0;qe!=y.length&&y[qe].trim().charAt(0)=="<";++qe);for(y=y.slice(qe),g=0;g!=y.length;++g)if(v=y[g].trim(),v.length!==0){if(C=v.match(t),E=g,w=0,R=0,v="<c "+(v.slice(0,1)=="<"?">":"")+v,C!=null&&C.length===2){for(E=0,T=C[1],w=0;w!=T.length&&!((R=T.charCodeAt(w)-64)<1||R>26);++w)E=26*E+R;--E,P=E}else++P;for(w=0;w!=v.length&&v.charCodeAt(w)!==62;++w);if(++w,k=Ge(v.slice(0,w),!0),k.r||(k.r=kt({r:V-1,c:P})),T=v.slice(w),D={t:""},(C=_i(T,"v"))!=null&&C[1]!==""&&(D.v=wt(C[1])),u.cellFormula){if((C=_i(T,"f"))!=null){if(C[1]=="")C[0].indexOf('t="shared"')>-1&&(N=Ge(C[0]),ge[N.si]&&(D.f=fb(ge[N.si][1],ge[N.si][2],k.r)));else if(D.f=wt(Vt(C[1]),!0),u.xlfn||(D.f=db(D.f)),C[0].indexOf('t="array"')>-1)D.F=(T.match(r)||[])[1],D.F.indexOf(":")>-1&&Le.push([si(D.F),D.F]);else if(C[0].indexOf('t="shared"')>-1){N=Ge(C[0]);var z=wt(Vt(C[1]));u.xlfn||(z=db(z)),ge[parseInt(N.si,10)]=[N,z,k.r]}}else(C=T.match(/<f[^<>]*\/>/))&&(N=Ge(C[0]),ge[N.si]&&(D.f=fb(ge[N.si][1],ge[N.si][2],k.r)));var q=ji(k.r);for(w=0;w<Le.length;++w)q.r>=Le[w][0].s.r&&q.r<=Le[w][0].e.r&&q.c>=Le[w][0].s.c&&q.c<=Le[w][0].e.c&&(D.F=Le[w][1])}if(k.t==null&&D.v===void 0)if(D.f||D.F)D.v=0,D.t="n";else if(F)D.t="z";else continue;else D.t=k.t||"n";switch(h.s.c>P&&(h.s.c=P),h.e.c<P&&(h.e.c=P),D.t){case"n":if(D.v==""||D.v==null){if(!F)continue;D.t="z"}else D.v=parseFloat(D.v);break;case"s":if(typeof D.v>"u"){if(!F)continue;D.t="z"}else U=No[parseInt(D.v,10)],D.v=U.t,D.r=U.r,u.cellHTML&&(D.h=U.h);break;case"str":D.t="s",D.v=D.v!=null?wt(Vt(D.v),!0):"",u.cellHTML&&(D.h=ko(D.v));break;case"inlineStr":C=_i(T,"is"),D.t="s",C!=null&&(U=mp(C[1]))?(D.v=U.t,u.cellHTML&&(D.h=U.h)):D.v="";break;case"b":D.v=Nt(D.v);break;case"d":u.cellDates?D.v=Ni(D.v,he):(D.v=xi(Ni(D.v,he),he),D.t="n");break;case"e":(!u||u.cellText!==!1)&&(D.w=D.v),D.v=Oi[D.v];break}if(j=Y=0,ce=null,Z&&k.s!==void 0&&(ce=p.CellXf[k.s],ce!=null&&(ce.numFmtId!=null&&(j=ce.numFmtId),u.cellStyles&&ce.fillId!=null&&(Y=ce.fillId))),Nw(D,j,Y,u,d,p,he),u.cellDates&&Z&&D.t=="n"&&ta(st[j])&&(D.v=Tn(D.v+(he?1462:0)),D.t=typeof D.v=="number"?"n":"d"),k.cm&&u.xlmeta){var X=(u.xlmeta.Cell||[])[+k.cm-1];X&&X.type=="XLDAPR"&&(D.D=!0)}var W;u.nodim&&(W=ji(k.r),h.s.r>W.r&&(h.s.r=W.r),h.e.r<W.r&&(h.e.r=W.r)),me?(W=ji(k.r),o["!data"][W.r]||(o["!data"][W.r]=[]),o["!data"][W.r][W.c]=D):o[k.r]=D}}}}de.length>0&&(o["!rows"]=de)}}();function TD(i,e){var t={},r=i.l+e;t.r=i.read_shift(4),i.l+=4;var a=i.read_shift(2);i.l+=1;var s=i.read_shift(1);return i.l=r,s&7&&(t.level=s&7),s&16&&(t.hidden=!0),s&32&&(t.hpt=a/20),t}var _D=ys;function SD(){}function RD(i,e){var t={},r=i[i.l];return++i.l,t.above=!(r&64),t.left=!(r&128),i.l+=18,t.name=tS(i),t}function kD(i){var e=Gr(i);return[e]}function AD(i){var e=ws(i);return[e]}function DD(i){var e=Gr(i),t=i.read_shift(1);return[e,t,"b"]}function FD(i){var e=ws(i),t=i.read_shift(1);return[e,t,"b"]}function MD(i){var e=Gr(i),t=i.read_shift(1);return[e,t,"e"]}function OD(i){var e=ws(i),t=i.read_shift(1);return[e,t,"e"]}function LD(i){var e=Gr(i),t=i.read_shift(4);return[e,t,"s"]}function ND(i){var e=ws(i),t=i.read_shift(4);return[e,t,"s"]}function BD(i){var e=Gr(i),t=Wi(i);return[e,t,"n"]}function zw(i){var e=ws(i),t=Wi(i);return[e,t,"n"]}function zD(i){var e=Gr(i),t=ph(i);return[e,t,"n"]}function HD(i){var e=ws(i),t=ph(i);return[e,t,"n"]}function PD(i){var e=Gr(i),t=fp(i);return[e,t,"is"]}function ID(i){var e=Gr(i),t=Xi(i);return[e,t,"str"]}function UD(i){var e=ws(i),t=Xi(i);return[e,t,"str"]}function VD(i,e,t){var r=i.l+e,a=Gr(i);a.r=t["!row"];var s=i.read_shift(1),o=[a,s,"b"];if(t.cellFormula){i.l+=2;var u=vh(i,r-i.l,t);o[3]=Vi(u,null,a,t.supbooks,t)}else i.l=r;return o}function GD(i,e,t){var r=i.l+e,a=Gr(i);a.r=t["!row"];var s=i.read_shift(1),o=[a,s,"e"];if(t.cellFormula){i.l+=2;var u=vh(i,r-i.l,t);o[3]=Vi(u,null,a,t.supbooks,t)}else i.l=r;return o}function WD(i,e,t){var r=i.l+e,a=Gr(i);a.r=t["!row"];var s=Wi(i),o=[a,s,"n"];if(t.cellFormula){i.l+=2;var u=vh(i,r-i.l,t);o[3]=Vi(u,null,a,t.supbooks,t)}else i.l=r;return o}function jD(i,e,t){var r=i.l+e,a=Gr(i);a.r=t["!row"];var s=Xi(i),o=[a,s,"str"];if(t.cellFormula){i.l+=2;var u=vh(i,r-i.l,t);o[3]=Vi(u,null,a,t.supbooks,t)}else i.l=r;return o}var XD=ys;function YD(i,e){var t=i.l+e,r=ys(i),a=dh(i),s=Xi(i),o=Xi(i),u=Xi(i);i.l=t;var h={rfx:r,relId:a,loc:s,display:u};return o&&(h.Tooltip=o),h}function qD(){}function KD(i,e,t){var r=i.l+e,a=iw(i),s=i.read_shift(1),o=[a];if(o[2]=s,t.cellFormula){var u=rD(i,r-i.l,t);o[1]=u}else i.l=r;return o}function $D(i,e,t){var r=i.l+e,a=ys(i),s=[a];if(t.cellFormula){var o=nD(i,r-i.l,t);s[1]=o,i.l=r}else i.l=r;return s}var ZD=["left","right","top","bottom","header","footer"];function QD(i){var e={};return ZD.forEach(function(t){e[t]=Wi(i)}),e}function JD(i){var e=i.read_shift(2);return i.l+=28,{RTL:e&32}}function e3(){}function t3(){}function i3(i,e,t,r,a,s,o){if(!i)return i;var u=e||{};r||(r={"!id":{}});var h={};u.dense&&(h["!data"]=[]);var d,p={s:{r:2e6,c:2e6},e:{r:0,c:0}},b=!1,g=!1,v,y,C,E,w,R,T,D,k,V=[];u.biff=12,u["!row"]=0;var P=0,U=!1,N=[],j={},Y=u.supbooks||a.supbooks||[[]];if(Y.sharedf=j,Y.arrayf=N,Y.SheetNames=a.SheetNames||a.Sheets.map(function(Me){return Me.name}),!u.supbooks&&(u.supbooks=Y,a.Names))for(var Z=0;Z<a.Names.length;++Z)Y[0][Z+1]=a.Names[Z];var ce=[],Le=[],ge=!1;eh[16]={n:"BrtShortReal",f:zw};var me,de=1462*+!!((a||{}).WBProps||{}).date1904;if(Ua(i,function(F,he,_e){if(!g)switch(_e){case 148:d=F;break;case 0:v=F,u.sheetRows&&u.sheetRows<=v.r&&(g=!0),D=Bt(E=v.r),u["!row"]=v.r,(F.hidden||F.hpt||F.level!=null)&&(F.hpt&&(F.hpx=Jo(F.hpt)),Le[F.r]=F);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(y={t:F[2]},F[2]){case"n":y.v=F[1];break;case"s":T=No[F[1]],y.v=T.t,y.r=T.r;break;case"b":y.v=!!F[1];break;case"e":y.v=F[1],u.cellText!==!1&&(y.w=sr[y.v]);break;case"str":y.t="s",y.v=F[1];break;case"is":y.t="s",y.v=F[1].t;break}if((C=o.CellXf[F[0].iStyleRef])&&Nw(y,C.numFmtId,null,u,s,o,de>0),w=F[0].c==-1?w+1:F[0].c,u.dense?(h["!data"][E]||(h["!data"][E]=[]),h["!data"][E][w]=y):h[Dt(w)+D]=y,u.cellFormula){for(U=!1,P=0;P<N.length;++P){var ye=N[P];v.r>=ye[0].s.r&&v.r<=ye[0].e.r&&w>=ye[0].s.c&&w<=ye[0].e.c&&(y.F=yt(ye[0]),U=!0)}!U&&F.length>3&&(y.f=F[3])}if(p.s.r>v.r&&(p.s.r=v.r),p.s.c>w&&(p.s.c=w),p.e.r<v.r&&(p.e.r=v.r),p.e.c<w&&(p.e.c=w),u.cellDates&&C&&y.t=="n"&&ta(st[C.numFmtId])){var pe=Oa(y.v+de);pe&&(y.t="d",y.v=new Date(Date.UTC(pe.y,pe.m-1,pe.d,pe.H,pe.M,pe.S,pe.u)))}me&&(me.type=="XLDAPR"&&(y.D=!0),me=void 0);break;case 1:case 12:if(!u.sheetStubs||b)break;y={t:"z",v:void 0},w=F[0].c==-1?w+1:F[0].c,u.dense?(h["!data"][E]||(h["!data"][E]=[]),h["!data"][E][w]=y):h[Dt(w)+D]=y,p.s.r>v.r&&(p.s.r=v.r),p.s.c>w&&(p.s.c=w),p.e.r<v.r&&(p.e.r=v.r),p.e.c<w&&(p.e.c=w),me&&(me.type=="XLDAPR"&&(y.D=!0),me=void 0);break;case 176:V.push(F);break;case 49:me=((u.xlmeta||{}).Cell||[])[F-1];break;case 494:var Ne=r["!id"][F.relId];for(Ne?(F.Target=Ne.Target,F.loc&&(F.Target+="#"+F.loc),F.Rel=Ne):F.relId==""&&(F.Target="#"+F.loc),E=F.rfx.s.r;E<=F.rfx.e.r;++E)for(w=F.rfx.s.c;w<=F.rfx.e.c;++w)u.dense?(h["!data"][E]||(h["!data"][E]=[]),h["!data"][E][w]||(h["!data"][E][w]={t:"z",v:void 0}),h["!data"][E][w].l=F):(R=Dt(w)+Bt(E),h[R]||(h[R]={t:"z",v:void 0}),h[R].l=F);break;case 426:if(!u.cellFormula)break;N.push(F),k=u.dense?h["!data"][E][w]:h[Dt(w)+D],k.f=Vi(F[1],p,{r:v.r,c:w},Y,u),k.F=yt(F[0]);break;case 427:if(!u.cellFormula)break;j[kt(F[0].s)]=F[1],k=u.dense?h["!data"][E][w]:h[Dt(w)+D],k.f=Vi(F[1],p,{r:v.r,c:w},Y,u);break;case 60:if(!u.cellStyles)break;for(;F.e>=F.s;)ce[F.e--]={width:F.w/256,hidden:!!(F.flags&1),level:F.level},ge||(ge=!0,gp(F.w/256)),bl(ce[F.e+1]);break;case 551:F&&(h["!legrel"]=F);break;case 161:h["!autofilter"]={ref:yt(F)};break;case 476:h["!margins"]=F;break;case 147:a.Sheets[t]||(a.Sheets[t]={}),F.name&&(a.Sheets[t].CodeName=F.name),(F.above||F.left)&&(h["!outline"]={above:F.above,left:F.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),F.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:b=!0;break;case 36:b=!1;break;case 37:b=!0;break;case 38:b=!1;break;default:if(!he.T){if(!b||u.WTF)throw new Error("Unexpected record 0x"+_e.toString(16))}}},u),delete u.supbooks,delete u["!row"],!h["!ref"]&&(p.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(h["!ref"]=yt(d||p)),u.sheetRows&&h["!ref"]){var ve=si(h["!ref"]);u.sheetRows<=+ve.e.r&&(ve.e.r=u.sheetRows-1,ve.e.r>p.e.r&&(ve.e.r=p.e.r),ve.e.r<ve.s.r&&(ve.s.r=ve.e.r),ve.e.c>p.e.c&&(ve.e.c=p.e.c),ve.e.c<ve.s.c&&(ve.s.c=ve.e.c),h["!fullref"]=h["!ref"],h["!ref"]=yt(ve))}return V.length>0&&(h["!merges"]=V),ce.length>0&&(h["!cols"]=ce),Le.length>0&&(h["!rows"]=Le),r["!id"][h["!legrel"]]&&(h["!legdrawel"]=r["!id"][h["!legrel"]]),h}function r3(i){var e=[],t=i.match(/^<c:numCache>/),r;(i.match(/<c:pt idx="(\d*)"[^<>\/]*><c:v>([^<])<\/c:v><\/c:pt>/mg)||[]).forEach(function(s){var o=s.match(/<c:pt idx="(\d*)"[^<>\/]*><c:v>([^<]*)<\/c:v><\/c:pt>/);o&&(e[+o[1]]=t?+o[2]:o[2])});var a=wt((us(i,"c:formatCode")||["","General"])[1]);return(lp(i,"<c:f>","</c:f>")||[]).forEach(function(s){r=s.replace(/<[^<>]*>/g,"")}),[e,a,r]}function a3(i,e,t,r,a,s){var o=s||{"!type":"chart"};if(!i)return s;var u=0,h=0,d="A",p={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(lp(i,"<c:numCache>","</c:numCache>")||[]).forEach(function(b){var g=r3(b);p.s.r=p.s.c=0,p.e.c=u,d=Dt(u),g[0].forEach(function(v,y){o["!data"]?(o["!data"][y]||(o["!data"][y]=[]),o["!data"][y][u]={t:"n",v,z:g[1]}):o[d+Bt(y)]={t:"n",v,z:g[1]},h=y}),p.e.r<h&&(p.e.r=h),++u}),u>0&&(o["!ref"]=yt(p)),o}function n3(i,e,t,r,a){if(!i)return i;r||(r={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o,u=i.match(Bw);return u&&xp(u[0],s,a,t),(o=i.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=o[1]),r["!id"][s["!rel"]]&&(s["!drawel"]=r["!id"][s["!rel"]]),s}function s3(i,e){i.l+=10;var t=Xi(i);return{name:t}}function l3(i,e,t,r,a){if(!i)return i;r||(r={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o=!1;return Ua(i,function(h,d,p){switch(p){case 550:s["!rel"]=h;break;case 651:a.Sheets[t]||(a.Sheets[t]={}),h.name&&(a.Sheets[t].CodeName=h.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!o||e.WTF)throw new Error("Unexpected record 0x"+p.toString(16))}}}},e),r["!id"][s["!rel"]]&&(s["!drawel"]=r["!id"][s["!rel"]]),s}var Hw=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],o3=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],u3=[],c3=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function bb(i,e){for(var t=0;t!=i.length;++t)for(var r=i[t],a=0;a!=e.length;++a){var s=e[a];if(r[s[0]]==null)r[s[0]]=s[1];else switch(s[2]){case"bool":typeof r[s[0]]=="string"&&(r[s[0]]=Nt(r[s[0]]));break;case"int":typeof r[s[0]]=="string"&&(r[s[0]]=parseInt(r[s[0]],10));break}}}function xb(i,e){for(var t=0;t!=e.length;++t){var r=e[t];if(i[r[0]]==null)i[r[0]]=r[1];else switch(r[2]){case"bool":typeof i[r[0]]=="string"&&(i[r[0]]=Nt(i[r[0]]));break;case"int":typeof i[r[0]]=="string"&&(i[r[0]]=parseInt(i[r[0]],10));break}}}function Pw(i){xb(i.WBProps,Hw),xb(i.CalcPr,c3),bb(i.WBView,o3),bb(i.Sheets,u3),dl.date1904=Nt(i.WBProps.date1904)}var h3=":][*?/\\".split("");function f3(i,e){try{if(i=="")throw new Error("Sheet name cannot be blank");if(i.length>31)throw new Error("Sheet name cannot exceed 31 chars");if(i.charCodeAt(0)==39||i.charCodeAt(i.length-1)==39)throw new Error("Sheet name cannot start or end with apostrophe (')");if(i.toLowerCase()=="history")throw new Error("Sheet name cannot be 'History'");h3.forEach(function(t){if(i.indexOf(t)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")})}catch(t){throw t}return!0}var d3=/<\w+:workbook/;function p3(i,e){if(!i)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},r=!1,a="xmlns",s={},o=0;if(i.replace(Bi,function(h,d){var p=Ge(h);switch(Vr(p[0])){case"<?xml":break;case"<workbook":h.match(d3)&&(a="xmlns"+h.match(/<(\w+):/)[1]),t.xmlns=p[a];break;case"</workbook>":break;case"<fileVersion":delete p[0],t.AppVersion=p;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Hw.forEach(function(b){if(p[b[0]]!=null)switch(b[2]){case"bool":t.WBProps[b[0]]=Nt(p[b[0]]);break;case"int":t.WBProps[b[0]]=parseInt(p[b[0]],10);break;default:t.WBProps[b[0]]=p[b[0]]}}),p.codeName&&(t.WBProps.CodeName=Vt(p.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete p[0],t.WBView.push(p);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(p.state){case"hidden":p.Hidden=1;break;case"veryHidden":p.Hidden=2;break;default:p.Hidden=0}delete p.state,p.name=wt(Vt(p.name)),delete p[0],t.Sheets.push(p);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":r=!0;break;case"</definedNames>":r=!1;break;case"<definedName":s={},s.Name=Vt(p.name),p.comment&&(s.Comment=p.comment),p.localSheetId&&(s.Sheet=+p.localSheetId),Nt(p.hidden||"0")&&(s.Hidden=!0),o=d+h.length;break;case"</definedName>":s.Ref=wt(Vt(i.slice(o,d))),t.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete p[0],t.CalcPr=p;break;case"<calcPr/>":delete p[0],t.CalcPr=p;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":r=!0;break;case"</AlternateContent>":r=!1;break;case"<revisionPtr":break;default:if(!r&&e.WTF)throw new Error("unrecognized "+p[0]+" in workbook")}return h}),B_.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return Pw(t),t}function m3(i,e){var t={};return t.Hidden=i.read_shift(4),t.iTabID=i.read_shift(4),t.strRelID=f0(i),t.name=Xi(i),t}function g3(i,e){var t={},r=i.read_shift(4);t.defaultThemeVersion=i.read_shift(4);var a=e>8?Xi(i):"";return a.length>0&&(t.CodeName=a),t.autoCompressPictures=!!(r&65536),t.backupFile=!!(r&64),t.checkCompatibility=!!(r&4096),t.date1904=!!(r&1),t.filterPrivacy=!!(r&8),t.hidePivotFieldList=!!(r&1024),t.promptedSolutions=!!(r&16),t.publishItems=!!(r&2048),t.refreshAllConnections=!!(r&262144),t.saveExternalLinkValues=!!(r&128),t.showBorderUnselectedTables=!!(r&4),t.showInkAnnotation=!!(r&32),t.showObjects=["all","placeholders","none"][r>>13&3],t.showPivotChartFilter=!!(r&32768),t.updateLinks=["userSet","never","always"][r>>8&3],t}function v3(i,e){var t={};return i.read_shift(4),t.ArchID=i.read_shift(4),i.l+=e-8,t}function b3(i,e,t){var r=i.l+e,a=i.read_shift(4);i.l+=1;var s=i.read_shift(4),o=iS(i),u,h="";try{u=aD(i,0,t);try{h=dh(i)}catch{}}catch{console.error("Could not parse defined name "+o)}a&32&&(o="_xlnm."+o),i.l=r;var d={Name:o,Ptg:u,Flags:a};return s<268435455&&(d.Sheet=s),h&&(d.Comment=h),d}function x3(i,e){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},r=[],a=!1;e||(e={}),e.biff=12;var s=[],o=[[]];return o.SheetNames=[],o.XTI=[],eh[16]={n:"BrtFRTArchID$",f:v3},Ua(i,function(h,d,p){switch(p){case 156:o.SheetNames.push(h.name),t.Sheets.push(h);break;case 153:t.WBProps=h;break;case 39:h.Sheet!=null&&(e.SID=h.Sheet),h.Ref=h.Ptg?Vi(h.Ptg,null,null,o,e):"#REF!",delete e.SID,delete h.Ptg,s.push(h);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([p,h]):o[0]=[p,h],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(h),o.XTI=o.XTI.concat(h);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:r.push(p),a=!0;break;case 36:r.pop(),a=!1;break;case 37:r.push(p),a=!0;break;case 38:r.pop(),a=!1;break;case 16:break;default:if(!d.T){if(!a||e.WTF&&r[r.length-1]!=37&&r[r.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}},e),Pw(t),t.Names=s,t.supbooks=o,t}function w3(i,e,t){return e.slice(-4)===".bin"?x3(i,t):p3(i,t)}function y3(i,e,t,r,a,s,o,u){return e.slice(-4)===".bin"?i3(i,r,t,a,s,o,u):mD(i,r,t,a,s,o,u)}function E3(i,e,t,r,a,s,o,u){return e.slice(-4)===".bin"?l3(i,r,t,a,s):n3(i,r,t,a,s)}function C3(i,e,t,r,a,s,o,u){return e.slice(-4)===".bin"?NA():BA()}function T3(i,e,t,r,a,s,o,u){return e.slice(-4)===".bin"?OA():LA()}function _3(i,e,t,r){return e.slice(-4)===".bin"?tA(i,t,r):Kk(i,t,r)}function S3(i,e,t){return e.slice(-4)===".bin"?gk(i,t):pk(i,t)}function R3(i,e,t){return e.slice(-4)===".bin"?DA(i,t):_A(i,t)}function k3(i,e,t){return e.slice(-4)===".bin"?yA(i):xA(i)}function A3(i,e,t,r){return t.slice(-4)===".bin"?EA(i,e,t,r):void 0}function D3(i,e,t){return e.slice(-4)===".bin"?vA(i,e,t):bA(i,e,t)}var Iw=/\b((?:\w+:)?[\w]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Uw=/\b((?:\w+:)?[\w]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Kr(i,e){var t=i.split(/\s+/),r=[];if(r[0]=t[0],t.length===1)return r;var a=i.match(Iw),s,o,u,h;if(a)for(h=0;h!=a.length;++h)s=a[h].match(Uw),(o=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?u="xmlns"+s[1].slice(6):u=s[1].slice(o+1),r[u]=s[2].slice(1,s[2].length-1));return r}function F3(i){var e=i.split(/\s+/),t={};if(e.length===1)return t;var r=i.match(Iw),a,s,o,u;if(r)for(u=0;u!=r.length;++u)a=r[u].match(Uw),(s=a[1].indexOf(":"))===-1?t[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(s+1),t[o]=a[2].slice(1,a[2].length-1));return t}var zo;function M3(i,e,t){var r=zo[i]||wt(i);return r==="General"?ms(e):Er(r,e,{date1904:!!t})}function O3(i,e,t,r){var a=r;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Nt(r);break;case"i2":case"int":a=parseInt(r,10);break;case"r4":case"float":a=parseFloat(r);break;case"date":case"dateTime.tz":a=Ni(r);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}i[wt(e)]=a}function L3(i,e,t,r){if(i.t!=="z"){if(!t||t.cellText!==!1)try{i.t==="e"?i.w=i.w||sr[i.v]:e==="General"?i.t==="n"?(i.v|0)===i.v?i.w=i.v.toString(10):i.w=Ko(i.v):i.w=ms(i.v):i.w=M3(e||"General",i.v,r)}catch(o){if(t.WTF)throw o}try{var a=zo[e]||e||"General";if(t.cellNF&&(i.z=a),t.cellDates&&i.t=="n"&&ta(a)){var s=Oa(i.v+(r?1462:0));s&&(i.t="d",i.v=new Date(Date.UTC(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u)))}}catch(o){if(t.WTF)throw o}}}function N3(i,e,t){if(t.cellStyles&&e.Interior){var r=e.Interior;r.Pattern&&(r.patternType=Gk[r.Pattern]||r.Pattern)}i[e.ID]=e}function B3(i,e,t,r,a,s,o,u,h,d,p){var b="General",g=r.StyleID,v={};d=d||{};var y=[],C=0;for(g===void 0&&u&&(g=u.StyleID),g===void 0&&o&&(g=o.StyleID);s[g]!==void 0;){var E=s[g];if(E.nf&&(b=E.nf),E.Interior&&y.push(E.Interior),!E.Parent)break;g=E.Parent}switch(t.Type){case"Boolean":r.t="b",r.v=Nt(i);break;case"String":r.t="s",r.r=P1(wt(i)),r.v=i.indexOf("<")>-1?wt(e||i).replace(/<[^<>]*>/g,""):r.r;break;case"DateTime":i.slice(-1)!="Z"&&(i+="Z"),r.v=xi(Ni(i,p),p),r.v!==r.v&&(r.v=wt(i)),(!b||b=="General")&&(b="yyyy-mm-dd");case"Number":r.v===void 0&&(r.v=+i),r.t||(r.t="n");break;case"Error":r.t="e",r.v=Oi[i],d.cellText!==!1&&(r.w=i);break;default:i==""&&e==""?r.t="z":(r.t="s",r.v=P1(e||i));break}if(L3(r,b,d,p),d.cellFormula!==!1)if(r.Formula){var w=wt(r.Formula);w.charCodeAt(0)==61&&(w=w.slice(1)),r.f=hs(w,a),delete r.Formula,r.ArrayRange=="RC"?r.F=hs("RC:RC",a):r.ArrayRange&&(r.F=hs(r.ArrayRange,a),h.push([si(r.F),r.F]))}else for(C=0;C<h.length;++C)a.r>=h[C][0].s.r&&a.r<=h[C][0].e.r&&a.c>=h[C][0].s.c&&a.c<=h[C][0].e.c&&(r.F=h[C][1]);d.cellStyles&&(y.forEach(function(R){!v.patternType&&R.patternType&&(v.patternType=R.patternType)}),r.s=v),r.StyleID!==void 0&&(r.ixfe=r.StyleID)}function z3(i){return nw.indexOf("_xlnm."+i)>-1?"_xlnm."+i:i}function H3(i){i.t=i.v||"",i.t=i.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),i.v=i.w=i.ixfe=void 0}function Kd(i,e){var t=e||{};Dx();var r=Eo(fh(i));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(r=Vt(r));var a=r.slice(0,1024).toLowerCase(),s=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var o=mi(t);return o.type="string",Zo.to_workbook(r,o)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(We){a.indexOf("<"+We)>=0&&(s=!0)}),s)return Y3(r,t);zo={"General Number":"General","General Date":st[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":st[15],"Short Date":st[14],"Long Time":st[19],"Medium Time":st[18],"Short Time":st[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:st[2],Standard:st[4],Percent:st[10],Scientific:st[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,h=[],d,p={},b=[],g={},v="";t.dense&&(g["!data"]=[]);var y={},C={},E=Kr('<Data ss:Type="String">'),w=0,R=0,T=0,D={s:{r:2e6,c:2e6},e:{r:0,c:0}},k={},V={},P="",U=0,N=[],j={},Y={},Z=0,ce=[],Le=[],ge={},me=[],de,ve=!1,Me=[],F=[],he={},_e=0,ye=0,pe={Sheets:[],WBProps:{date1904:!1}},Ne={};di.lastIndex=0,r=ru(r,"<!--","-->");for(var Oe="";u=di.exec(r);)switch(u[3]=(Oe=u[3]).toLowerCase()){case"data":if(Oe=="data"){if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break}if(h[h.length-1][1])break;u[1]==="/"?B3(r.slice(w,u.index),P,E,h[h.length-1][0]=="comment"?ge:y,{c:R,r:T},k,me[R],C,Me,t,pe.WBProps.date1904):(P="",E=Kr(u[0]),w=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(Le.length>0&&(y.c=Le),(!t.sheetRows||t.sheetRows>T)&&y.v!==void 0&&(t.dense?(g["!data"][T]||(g["!data"][T]=[]),g["!data"][T][R]=y):g[Dt(R)+Bt(T)]=y),y.HRef&&(y.l={Target:wt(y.HRef)},y.HRefScreenTip&&(y.l.Tooltip=y.HRefScreenTip),delete y.HRef,delete y.HRefScreenTip),(y.MergeAcross||y.MergeDown)&&(_e=R+(parseInt(y.MergeAcross,10)|0),ye=T+(parseInt(y.MergeDown,10)|0),(_e>R||ye>T)&&N.push({s:{c:R,r:T},e:{c:_e,r:ye}})),!t.sheetStubs)y.MergeAcross?R=_e+1:++R;else if(y.MergeAcross||y.MergeDown){for(var qe=R;qe<=_e;++qe)for(var z=T;z<=ye;++z)(qe>R||z>T)&&(t.dense?(g["!data"][z]||(g["!data"][z]=[]),g["!data"][z][qe]={t:"z"}):g[Dt(qe)+Bt(z)]={t:"z"});R=_e+1}else++R;else y=F3(u[0]),y.Index&&(R=+y.Index-1),R<D.s.c&&(D.s.c=R),R>D.e.c&&(D.e.c=R),u[0].slice(-2)==="/>"&&++R,Le=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(T<D.s.r&&(D.s.r=T),T>D.e.r&&(D.e.r=T),u[0].slice(-2)==="/>"&&(C=Kr(u[0]),C.Index&&(T=+C.Index-1)),R=0,++T):(C=Kr(u[0]),C.Index&&(T=+C.Index-1),he={},(C.AutoFitHeight=="0"||C.Height)&&(he.hpx=parseInt(C.Height,10),he.hpt=_w(he.hpx),F[T]=he),C.Hidden=="1"&&(he.hidden=!0,F[T]=he));break;case"worksheet":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"));b.push(v),D.s.r<=D.e.r&&D.s.c<=D.e.c&&(g["!ref"]=yt(D),t.sheetRows&&t.sheetRows<=D.e.r&&(g["!fullref"]=g["!ref"],D.e.r=t.sheetRows-1,g["!ref"]=yt(D))),N.length&&(g["!merges"]=N),me.length>0&&(g["!cols"]=me),F.length>0&&(g["!rows"]=F),p[v]=g}else D={s:{r:2e6,c:2e6},e:{r:0,c:0}},T=R=0,h.push([u[3],!1]),d=Kr(u[0]),v=wt(d.Name),g={},t.dense&&(g["!data"]=[]),N=[],Me=[],F=[],Ne={name:v,Hidden:0},pe.Sheets.push(Ne);break;case"table":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else{if(u[0].slice(-2)=="/>")break;h.push([u[3],!1]),me=[],ve=!1}break;case"style":u[1]==="/"?N3(k,V,t):V=Kr(u[0]);break;case"numberformat":V.nf=wt(Kr(u[0]).Format||"General"),zo[V.nf]&&(V.nf=zo[V.nf]);for(var q=0;q!=392&&st[q]!=V.nf;++q);if(q==392){for(q=57;q!=392;++q)if(st[q]==null){os(V.nf,q);break}}break;case"column":if(h[h.length-1][0]!=="table"||u[1]==="/")break;if(de=Kr(u[0]),de.Hidden&&(de.hidden=!0,delete de.Hidden),de.Width&&(de.wpx=parseInt(de.Width,10)),!ve&&de.wpx>10){ve=!0,Qi=Cw;for(var X=0;X<me.length;++X)me[X]&&bl(me[X])}ve&&bl(de),me[de.Index-1||me.length]=de;for(var W=0;W<+de.Span;++W)me[me.length]=mi(de);break;case"namedrange":if(u[1]==="/")break;pe.Names||(pe.Names=[]);var we=Ge(u[0]),H={Name:z3(we.Name),Ref:hs(we.RefersTo.slice(1),{r:0,c:0})};pe.Sheets.length>0&&(H.Sheet=pe.Sheets.length-1),pe.Names.push(H);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?P+=r.slice(U,u.index):U=u.index+u[0].length;break;case"interior":if(!t.cellStyles)break;V.Interior=Kr(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?SS(j,Oe,r.slice(Z,u.index)):Z=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else h.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"));H3(ge),Le.push(ge)}else h.push([u[3],!1]),d=Kr(u[0]),Nt(d.ShowAlways||"0")||(Le.hidden=!0),ge={a:d.Author};break;case"autofilter":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var ze=Kr(u[0]);g["!autofilter"]={ref:hs(ze.Range).replace(/\$/g,"")},h.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break;case"null":break;default:if(h.length==0&&u[3]=="document"||h.length==0&&u[3]=="uof")return Tb(r,t);var He=!0;switch(h[h.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:He=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:He=!1}break;case"excelworkbook":switch(u[3]){case"date1904":pe.WBProps.date1904=!0;break;case"hidehorizontalscrollbar":break;case"hideverticalscrollbar":break;case"hideworkbooktabs":break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:He=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:He=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(r.slice(Z,u.index)){case"SheetHidden":Ne.Hidden=1;break;case"SheetVeryHidden":Ne.Hidden=2;break}else Z=u.index+u[0].length;break;case"header":g["!margins"]||Bo(g["!margins"]={},"xlml"),isNaN(+Ge(u[0]).Margin)||(g["!margins"].header=+Ge(u[0]).Margin);break;case"footer":g["!margins"]||Bo(g["!margins"]={},"xlml"),isNaN(+Ge(u[0]).Margin)||(g["!margins"].footer=+Ge(u[0]).Margin);break;case"pagemargins":var De=Ge(u[0]);g["!margins"]||Bo(g["!margins"]={},"xlml"),isNaN(+De.Top)||(g["!margins"].top=+De.Top),isNaN(+De.Left)||(g["!margins"].left=+De.Left),isNaN(+De.Right)||(g["!margins"].right=+De.Right),isNaN(+De.Bottom)||(g["!margins"].bottom=+De.Bottom);break;case"displayrighttoleft":pe.Views||(pe.Views=[]),pe.Views[0]||(pe.Views[0]={}),pe.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:He=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:He=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:He=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:He=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:He=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:He=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:He=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:He=!1}break;case"smarttags":break;default:He=!1;break}if(He||u[3].match(/!\[CDATA/))break;if(!h[h.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+h.join("|");if(h[h.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?O3(Y,Oe,ce,r.slice(Z,u.index)):(ce=u,Z=u.index+u[0].length);break}if(t.WTF)throw"Unrecognized tag: "+u[3]+"|"+h.join("|")}var Xe={};return!t.bookSheets&&!t.bookProps&&(Xe.Sheets=p),Xe.SheetNames=b,Xe.Workbook=pe,Xe.SSF=mi(st),Xe.Props=j,Xe.Custprops=Y,Xe.bookType="xlml",Xe}function m0(i,e){switch(wp(e=e||{}),e.type||"base64"){case"base64":return Kd(yr(i),e);case"binary":case"buffer":case"file":return Kd(i,e);case"array":return Kd(Ia(i),e)}}function P3(i){var e={},t=i.content;if(t.l=28,e.AnsiUserType=t.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=nS(t),t.length-t.l<=4)return e;var r=t.read_shift(4);if(r==0||r>40||(t.l-=4,e.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(r=t.read_shift(4),r!==1907505652)||(e.UnicodeClipboardFormat=sS(t),r=t.read_shift(4),r==0||r>40))return e;t.l-=4,e.Reserved2=t.read_shift(0,"lpwstr")}var I3=[60,1084,2066,2165,2175];function U3(i,e,t,r,a){var s=r,o=[],u=t.slice(t.l,t.l+s);if(a&&a.enc&&a.enc.insitu&&u.length>0)switch(i){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(u)}o.push(u),t.l+=s;for(var h=Na(t,t.l),d=g0[h],p=0;d!=null&&I3.indexOf(h)>-1;)s=Na(t,t.l+2),p=t.l+4,h==2066?p+=4:(h==2165||h==2175)&&(p+=12),u=t.slice(p,t.l+4+s),o.push(u),t.l+=4+s,d=g0[h=Na(t,t.l)];var b=yn(o);bi(b,0);var g=0;b.lens=[];for(var v=0;v<o.length;++v)b.lens.push(g),g+=o[v].length;if(b.length<r)throw"XLS Record 0x"+i.toString(16)+" Truncated: "+b.length+" < "+r;return e.f(b,b.length,a)}function oa(i,e,t){if(i.t!=="z"&&i.XF){var r=0;try{r=i.z||i.XF.numFmtId||0,e.cellNF&&i.z==null&&(i.z=st[r])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{i.t==="e"?i.w=i.w||sr[i.v]:r===0||r=="General"?i.t==="n"?(i.v|0)===i.v?i.w=i.v.toString(10):i.w=Ko(i.v):i.w=ms(i.v):i.w=Er(r,i.v,{date1904:!!t,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&r&&i.t=="n"&&ta(st[r]||String(r))){var a=Oa(i.v+(t?1462:0));a&&(i.t="d",i.v=new Date(Date.UTC(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u)))}}}function Mc(i,e,t){return{v:i,ixfe:e,t}}function V3(i,e){var t={opts:{}},r={},a={};e.dense&&(a["!data"]=[]);var s={},o={},u=null,h=[],d="",p={},b,g="",v,y,C,E,w={},R=[],T,D,k=[],V=[],P={Sheets:[],WBProps:{date1904:!1},Views:[{}]},U={},N=!1,j=function(Ie){return Ie<8?cs[Ie]:Ie<64&&V[Ie-8]||cs[Ie]},Y=function(Ie,bt){var zt=Ie.XF.data;if(!(!zt||!zt.patternType||!bt||!bt.cellStyles)){Ie.s={},Ie.s.patternType=zt.patternType;var xt;(xt=Qo(j(zt.icvFore)))&&(Ie.s.fgColor={rgb:xt}),(xt=Qo(j(zt.icvBack)))&&(Ie.s.bgColor={rgb:xt})}},Z=function(Ie,bt,zt){if(!(!N&&_e>1)&&!(zt.sheetRows&&Ie.r>=zt.sheetRows)){if(zt.cellStyles&&bt.XF&&bt.XF.data&&Y(bt,zt),delete bt.ixfe,delete bt.XF,b=Ie,g=kt(Ie),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),Ie.r<o.s.r&&(o.s.r=Ie.r),Ie.c<o.s.c&&(o.s.c=Ie.c),Ie.r+1>o.e.r&&(o.e.r=Ie.r+1),Ie.c+1>o.e.c&&(o.e.c=Ie.c+1),zt.cellFormula&&bt.f){for(var xt=0;xt<R.length;++xt)if(!(R[xt][0].s.c>Ie.c||R[xt][0].s.r>Ie.r)&&!(R[xt][0].e.c<Ie.c||R[xt][0].e.r<Ie.r)){bt.F=yt(R[xt][0]),(R[xt][0].s.c!=Ie.c||R[xt][0].s.r!=Ie.r)&&delete bt.f,bt.f&&(bt.f=""+Vi(R[xt][1],o,Ie,F,ce));break}}zt.dense?(a["!data"][Ie.r]||(a["!data"][Ie.r]=[]),a["!data"][Ie.r][Ie.c]=bt):a[g]=bt}},ce={enc:!1,sbcch:0,snames:[],sharedf:w,arrayf:R,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(ce.password=e.password);var Le,ge=[],me=[],de=[],ve=[],Me=!1,F=[];F.SheetNames=ce.snames,F.sharedf=ce.sharedf,F.arrayf=ce.arrayf,F.names=[],F.XTI=[];var he=0,_e=0,ye=0,pe=[],Ne=[],Oe;ce.codepage=1200,Jr(1200);for(var qe=!1;i.l<i.length-1;){var z=i.l,q=i.read_shift(2);if(q===0&&he===10)break;var X=i.l===i.length?0:i.read_shift(2),W=g0[q];if(_e==0&&[9,521,1033,2057].indexOf(q)==-1)break;if(W&&W.f){if(e.bookSheets&&he===133&&q!==133)break;if(he=q,W.r===2||W.r==12){var we=i.read_shift(2);if(X-=2,!ce.enc&&we!==q&&((we&255)<<8|we>>8)!==q)throw new Error("rt mismatch: "+we+"!="+q);W.r==12&&(i.l+=10,X-=10)}var H={};if(q===10?H=W.f(i,X,ce):H=U3(q,W,i,X,ce),_e==0&&[9,521,1033,2057].indexOf(he)===-1)continue;switch(q){case 34:t.opts.Date1904=P.WBProps.date1904=H;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(ce.enc||(i.l=0),ce.enc=H,!e.password)throw new Error("File is password-protected");if(H.valid==null)throw new Error("Encryption scheme unsupported");if(!H.valid)throw new Error("Password is incorrect");break;case 92:ce.lastuser=H;break;case 66:var ze=Number(H);switch(ze){case 21010:ze=1200;break;case 32768:ze=1e4;break;case 32769:ze=1252;break}Jr(ce.codepage=ze),qe=!0;break;case 317:ce.rrtabid=H;break;case 25:ce.winlocked=H;break;case 439:t.opts.RefreshAll=H;break;case 12:t.opts.CalcCount=H;break;case 16:t.opts.CalcDelta=H;break;case 17:t.opts.CalcIter=H;break;case 13:t.opts.CalcMode=H;break;case 14:t.opts.CalcPrecision=H;break;case 95:t.opts.CalcSaveRecalc=H;break;case 15:ce.CalcRefMode=H;break;case 2211:t.opts.FullCalc=H;break;case 129:H.fDialog&&(a["!type"]="dialog"),H.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),H.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 67:case 579:case 1091:case 224:k.push(H);break;case 430:F.push([H]),F[F.length-1].XTI=[];break;case 35:case 547:F[F.length-1].push(H);break;case 24:case 536:Oe={Name:H.Name,Ref:Vi(H.rgce,o,null,F,ce)},H.itab>0&&(Oe.Sheet=H.itab-1),F.names.push(Oe),F[0]||(F[0]=[],F[0].XTI=[]),F[F.length-1].push(H),H.Name=="_xlnm._FilterDatabase"&&H.itab>0&&H.rgce&&H.rgce[0]&&H.rgce[0][0]&&H.rgce[0][0][0]=="PtgArea3d"&&(Ne[H.itab-1]={ref:yt(H.rgce[0][0][1][2])});break;case 22:ce.ExternCount=H;break;case 23:F.length==0&&(F[0]=[],F[0].XTI=[]),F[F.length-1].XTI=F[F.length-1].XTI.concat(H),F.XTI=F.XTI.concat(H);break;case 2196:if(ce.biff<8)break;Oe!=null&&(Oe.Comment=H[1]);break;case 18:a["!protect"]=H;break;case 19:H!==0&&ce.WTF&&console.error("Password verifier: "+H);break;case 133:s[ce.biff==4?ce.snames.length:H.pos]=H,ce.snames.push(H.name);break;case 10:{if(--_e?!N:N)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,a["!ref"]=yt(o),e.sheetRows&&e.sheetRows<=o.e.r){var He=o.e.r;o.e.r=e.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=yt(o),o.e.r=He}o.e.r++,o.e.c++}ge.length>0&&(a["!merges"]=ge),me.length>0&&(a["!objects"]=me),de.length>0&&(a["!cols"]=de),ve.length>0&&(a["!rows"]=ve),P.Sheets.push(U)}d===""?p=a:r[d]=a,a={},e.dense&&(a["!data"]=[])}break;case 9:case 521:case 1033:case 2057:{if(ce.biff===8&&(ce.biff={9:2,521:3,1033:4}[q]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[H.BIFFVer]||8),ce.biffguess=H.BIFFVer==0,H.BIFFVer==0&&H.dt==4096&&(ce.biff=5,qe=!0,Jr(ce.codepage=28591)),ce.biff==4&&H.dt&256&&(N=!0),ce.biff==8&&H.BIFFVer==0&&H.dt==16&&(ce.biff=2),_e++&&!N)break;if(a={},e.dense&&(a["!data"]=[]),ce.biff<8&&!qe&&(qe=!0,Jr(ce.codepage=e.codepage||1252)),ce.biff==4&&N)d=(s[ce.snames.indexOf(d)+1]||{name:""}).name;else if(ce.biff<5||H.BIFFVer==0&&H.dt==4096){d===""&&(d="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var De={pos:i.l-X,name:d};s[De.pos]=De,ce.snames.push(d)}else d=(s[z]||{name:""}).name;H.dt==32&&(a["!type"]="chart"),H.dt==64&&(a["!type"]="macro"),ge=[],me=[],ce.arrayf=R=[],de=[],ve=[],Me=!1,U={Hidden:(s[z]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(e.dense?(a["!data"][H.r]||[])[H.c]:a[Dt(H.c)+Bt(H.r)])&&++H.c,T={ixfe:H.ixfe,XF:k[H.ixfe]||{},v:H.val,t:"n"},ye>0&&(T.z=T.XF&&T.XF.numFmtId&&pe[T.XF.numFmtId]||pe[T.ixfe>>8&63]),oa(T,e,t.opts.Date1904),Z({c:H.c,r:H.r},T,e);break;case 5:case 517:T={ixfe:H.ixfe,XF:k[H.ixfe],v:H.val,t:H.t},ye>0&&(T.z=T.XF&&T.XF.numFmtId&&pe[T.XF.numFmtId]||pe[T.ixfe>>8&63]),oa(T,e,t.opts.Date1904),Z({c:H.c,r:H.r},T,e);break;case 638:T={ixfe:H.ixfe,XF:k[H.ixfe],v:H.rknum,t:"n"},ye>0&&(T.z=T.XF&&T.XF.numFmtId&&pe[T.XF.numFmtId]||pe[T.ixfe>>8&63]),oa(T,e,t.opts.Date1904),Z({c:H.c,r:H.r},T,e);break;case 189:for(var Xe=H.c;Xe<=H.C;++Xe){var We=H.rkrec[Xe-H.c][0];T={ixfe:We,XF:k[We],v:H.rkrec[Xe-H.c][1],t:"n"},ye>0&&(T.z=T.XF&&T.XF.numFmtId&&pe[T.XF.numFmtId]||pe[T.ixfe>>8&63]),oa(T,e,t.opts.Date1904),Z({c:Xe,r:H.r},T,e)}break;case 6:case 518:case 1030:{if(H.val=="String"){u=H;break}if(T=Mc(H.val,H.cell.ixfe,H.tt),T.XF=k[T.ixfe],e.cellFormula){var tt=H.formula;if(tt&&tt[0]&&tt[0][0]&&tt[0][0][0]=="PtgExp"){var vt=tt[0][0][1][0],ht=tt[0][0][1][1],Lt=kt({r:vt,c:ht});w[Lt]?T.f=""+Vi(H.formula,o,H.cell,F,ce):T.F=((e.dense?(a["!data"][vt]||[])[ht]:a[Lt])||{}).F}else T.f=""+Vi(H.formula,o,H.cell,F,ce)}ye>0&&(T.z=T.XF&&T.XF.numFmtId&&pe[T.XF.numFmtId]||pe[T.ixfe>>8&63]),oa(T,e,t.opts.Date1904),Z(H.cell,T,e),u=H}break;case 7:case 519:if(u)u.val=H,T=Mc(H,u.cell.ixfe,"s"),T.XF=k[T.ixfe],e.cellFormula&&(T.f=""+Vi(u.formula,o,u.cell,F,ce)),ye>0&&(T.z=T.XF&&T.XF.numFmtId&&pe[T.XF.numFmtId]||pe[T.ixfe>>8&63]),oa(T,e,t.opts.Date1904),Z(u.cell,T,e),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{R.push(H);var Ve=kt(H[0].s);if(v=e.dense?(a["!data"][H[0].s.r]||[])[H[0].s.c]:a[Ve],e.cellFormula&&v){if(!u||!Ve||!v)break;v.f=""+Vi(H[1],o,H[0],F,ce),v.F=yt(H[0])}}break;case 1212:{if(!e.cellFormula)break;if(g){if(!u)break;w[kt(u.cell)]=H[0],v=e.dense?(a["!data"][u.cell.r]||[])[u.cell.c]:a[kt(u.cell)],(v||{}).f=""+Vi(H[0],o,b,F,ce)}}break;case 253:T=Mc(h[H.isst].t,H.ixfe,"s"),h[H.isst].h&&(T.h=h[H.isst].h),T.XF=k[T.ixfe],ye>0&&(T.z=T.XF&&T.XF.numFmtId&&pe[T.XF.numFmtId]||pe[T.ixfe>>8&63]),oa(T,e,t.opts.Date1904),Z({c:H.c,r:H.r},T,e);break;case 513:e.sheetStubs&&(T={ixfe:H.ixfe,XF:k[H.ixfe],t:"z"},ye>0&&(T.z=T.XF&&T.XF.numFmtId&&pe[T.XF.numFmtId]||pe[T.ixfe>>8&63]),oa(T,e,t.opts.Date1904),Z({c:H.c,r:H.r},T,e));break;case 190:if(e.sheetStubs)for(var rt=H.c;rt<=H.C;++rt){var Fe=H.ixfe[rt-H.c];T={ixfe:Fe,XF:k[Fe],t:"z"},ye>0&&(T.z=T.XF&&T.XF.numFmtId&&pe[T.XF.numFmtId]||pe[T.ixfe>>8&63]),oa(T,e,t.opts.Date1904),Z({c:rt,r:H.r},T,e)}break;case 214:case 516:case 4:T=Mc(H.val,H.ixfe,"s"),T.XF=k[T.ixfe],ye>0&&(T.z=T.XF&&T.XF.numFmtId&&pe[T.XF.numFmtId]||pe[T.ixfe>>8&63]),oa(T,e,t.opts.Date1904),Z({c:H.c,r:H.r},T,e);break;case 0:case 512:_e===1&&(o=H);break;case 252:h=H;break;case 1054:if(ce.biff>=3&&ce.biff<=4){pe[ye++]=H[1];for(var jt=0;jt<ye+163&&st[jt]!=H[1];++jt);jt>=163&&os(H[1],ye+163)}else os(H[1],H[0]);break;case 30:{pe[ye++]=H;for(var ti=0;ti<ye+163&&st[ti]!=H;++ti);ti>=163&&os(H,ye+163)}break;case 229:ge=ge.concat(H);break;case 93:me[H.cmo[0]]=ce.lastobj=H;break;case 438:ce.lastobj.TxO=H;break;case 127:ce.lastobj.ImData=H;break;case 440:for(E=H[0].s.r;E<=H[0].e.r;++E)for(C=H[0].s.c;C<=H[0].e.c;++C)v=e.dense?(a["!data"][E]||[])[C]:a[kt({c:C,r:E})],v&&(v.l=H[1]);break;case 2048:for(E=H[0].s.r;E<=H[0].e.r;++E)for(C=H[0].s.c;C<=H[0].e.c;++C)v=e.dense?(a["!data"][E]||[])[C]:a[kt({c:C,r:E})],v&&v.l&&(v.l.Tooltip=H[1]);break;case 28:{if(v=e.dense?(a["!data"][H[0].r]||[])[H[0].c]:a[kt(H[0])],v||(e.dense?(a["!data"][H[0].r]||(a["!data"][H[0].r]=[]),v=a["!data"][H[0].r][H[0].c]={t:"z"}):v=a[kt(H[0])]={t:"z"},o.e.r=Math.max(o.e.r,H[0].r),o.s.r=Math.min(o.s.r,H[0].r),o.e.c=Math.max(o.e.c,H[0].c),o.s.c=Math.min(o.s.c,H[0].c)),v.c||(v.c=[]),ce.biff<=5&&ce.biff>=2)y={a:"SheetJ5",t:H[1]};else{var At=me[H[2]];y={a:H[1],t:At.TxO.t},H[3]!=null&&!(H[3]&2)&&(v.c.hidden=!0)}v.c.push(y)}break;case 2173:dA(k[H.ixfe],H.ext);break;case 125:{if(!ce.cellStyles)break;for(;H.e>=H.s;)de[H.e--]={width:H.w/256,level:H.level||0,hidden:!!(H.flags&1)},Me||(Me=!0,gp(H.w/256)),bl(de[H.e+1])}break;case 520:{var qi={};H.level!=null&&(ve[H.r]=qi,qi.level=H.level),H.hidden&&(ve[H.r]=qi,qi.hidden=!0),H.hpt&&(ve[H.r]=qi,qi.hpt=H.hpt,qi.hpx=Jo(H.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||Bo(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[q]]=H;break;case 161:a["!margins"]||Bo(a["!margins"]={}),a["!margins"].header=H.header,a["!margins"].footer=H.footer;break;case 574:H.RTL&&(P.Views[0].RTL=!0);break;case 146:V=H;break;case 2198:Le=H;break;case 140:D=H;break;case 442:d?U.CodeName=H||U.name:P.WBProps.CodeName=H||"ThisWorkbook";break}}else W||console.error("Missing Info for XLS Record 0x"+q.toString(16)),i.l+=X}return t.SheetNames=Ir(s).sort(function(Xt,Ie){return Number(Xt)-Number(Ie)}).map(function(Xt){return s[Xt].name}),e.bookSheets||(t.Sheets=r),!t.SheetNames.length&&p["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=p)):t.Preamble=p,t.Sheets&&Ne.forEach(function(Xt,Ie){t.Sheets[t.SheetNames[Ie]]["!autofilter"]=Xt}),t.Strings=h,t.SSF=mi(st),ce.enc&&(t.Encryption=ce.enc),Le&&(t.Themes=Le),t.Metadata={},D!==void 0&&(t.Metadata.Country=D),F.names.length>0&&(P.Names=F.names),t.Workbook=P,t}var wb={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function G3(i,e,t){var r=Tt.find(i,"/!DocumentSummaryInformation");if(r&&r.size>0)try{var a=ib(r,fS,wb.DSI);for(var s in a)e[s]=a[s]}catch(d){if(t.WTF)throw d}var o=Tt.find(i,"/!SummaryInformation");if(o&&o.size>0)try{var u=ib(o,dS,wb.SI);for(var h in u)e[h]==null&&(e[h]=u[h])}catch(d){if(t.WTF)throw d}e.HeadingPairs&&e.TitlesOfParts&&(lw(e.HeadingPairs,e.TitlesOfParts,e,t),delete e.HeadingPairs,delete e.TitlesOfParts)}function Vw(i,e){e||(e={}),wp(e),xx(),e.codepage&&tp(e.codepage);var t,r;if(i.FullPaths){if(Tt.find(i,"/encryption"))throw new Error("File is password-protected");t=Tt.find(i,"!CompObj"),r=Tt.find(i,"/Workbook")||Tt.find(i,"/Book")}else{switch(e.type){case"base64":i=gr(yr(i));break;case"binary":i=gr(i);break;case"buffer":break;case"array":Array.isArray(i)||(i=Array.prototype.slice.call(i));break}bi(i,0),r={content:i}}var a,s;if(t&&P3(t),e.bookProps&&!e.bookSheets)a={};else{var o=gt?"buffer":"array";if(r&&r.content)a=V3(r.content,e);else if((s=Tt.find(i,"PerfectOffice_MAIN"))&&s.content)a=Lo.to_workbook(s.content,(e.type=o,e));else if((s=Tt.find(i,"NativeContent_MAIN"))&&s.content)a=Lo.to_workbook(s.content,(e.type=o,e));else throw(s=Tt.find(i,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&i.FullPaths&&Tt.find(i,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=MA(i))}var u={};return i.FullPaths&&G3(i,u,e),a.Props=a.Custprops=u,e.bookFiles&&(a.cfb=i),a}var eh={0:{f:TD},1:{f:kD},2:{f:zD},3:{f:MD},4:{f:DD},5:{f:BD},6:{f:ID},7:{f:LD},8:{f:jD},9:{f:WD},10:{f:VD},11:{f:GD},12:{f:AD},13:{f:HD},14:{f:OD},15:{f:FD},16:{f:zw},17:{f:UD},18:{f:ND},19:{f:fp},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:b3},40:{},42:{},43:{f:Zk},44:{f:$k},45:{f:Qk},46:{f:eA},47:{f:Jk},48:{},49:{f:Q_},50:{},51:{f:mA},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:bw},62:{f:PD},63:{f:wA},64:{f:e3},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Yi,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:JD},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:RD},148:{f:_D,p:16},151:{f:qD},152:{},153:{f:g3},154:{},155:{},156:{f:m3},157:{},158:{},159:{T:1,f:mk},160:{T:-1},161:{T:1,f:ys},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:XD},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:pA},336:{T:-1},337:{f:gA,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:f0},357:{},358:{},359:{},360:{T:1},361:{},362:{f:vw},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:KD},427:{f:$D},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:QD},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:SD},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:YD},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:f0},551:{f:dh},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:AA},633:{T:1},634:{T:-1},635:{T:1,f:kA},636:{T:-1},637:{f:eS},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:s3},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:t3},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},g0={6:{f:Yd},10:{f:dn},12:{f:ei},13:{f:ei},14:{f:ni},15:{f:ni},16:{f:Wi},17:{f:ni},18:{f:ni},19:{f:ei},20:{f:nb},21:{f:nb},23:{f:vw},24:{f:lb},25:{f:ni},26:{},27:{},28:{f:DR},29:{},34:{f:ni},35:{f:sb},38:{f:Wi},39:{f:Wi},40:{f:Wi},41:{f:Wi},42:{f:ni},43:{f:ni},47:{f:Lk},49:{f:uR},51:{f:ei},60:{},61:{f:sR},64:{f:ni},65:{f:oR},66:{f:ei},77:{},80:{},81:{},82:{},85:{f:ei},89:{},90:{},91:{},92:{f:QS},93:{f:MR},94:{},95:{f:ni},96:{},97:{},99:{f:ni},125:{f:bw},128:{f:ER},129:{f:JS},130:{f:ei},131:{f:ni},132:{f:ni},133:{f:eR},134:{},140:{f:HR},141:{f:ei},144:{},146:{f:IR},151:{},152:{},153:{},154:{},155:{},156:{f:ei},157:{},158:{},160:{f:jR},161:{f:VR},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:mR},190:{f:gR},193:{f:dn},197:{},198:{},199:{},200:{},201:{},202:{f:ni},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:ei},220:{},221:{f:ni},222:{},224:{f:bR},225:{f:ZS},226:{f:dn},227:{},229:{f:FR},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:tR},253:{f:cR},255:{f:iR},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:cw},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:ni},353:{f:dn},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:_R},431:{f:ni},432:{},433:{},434:{},437:{},438:{f:NR},439:{f:ni},440:{f:BR},441:{},442:{f:nu},443:{},444:{f:ei},445:{},446:{},448:{f:dn},449:{f:nR,r:2},450:{f:dn},512:{f:ab},513:{f:WR},515:{f:TR},516:{f:hR},517:{f:CR},519:{f:XR},520:{f:rR},523:{},545:{f:ub},549:{f:rb},566:{},574:{f:lR},638:{f:pR},659:{},1048:{},1054:{f:fR},1084:{},1212:{f:RR},2048:{f:zR},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:kc},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:dn},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:UR,r:12},2173:{f:fA,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:ni,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:SR,r:12},2197:{},2198:{f:sA,r:12},2199:{},2200:{},2201:{},2202:{f:kR,r:12},2203:{f:dn},2204:{},2205:{},2206:{},2207:{},2211:{f:aR},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:ei},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:GR},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:PR},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:ab},1:{},2:{f:$R},3:{f:KR},4:{f:qR},5:{f:QR},7:{f:ZR},8:{},9:{f:kc},11:{},22:{f:ei},30:{f:dR},31:{},32:{},33:{f:ub},36:{},37:{f:rb},50:{f:JR},62:{},52:{},67:{f:xR},68:{f:ei},69:{},86:{},126:{},127:{f:YR},135:{},136:{},137:{},143:{f:tk},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:ek},223:{},234:{},354:{},421:{},518:{f:Yd},521:{f:kc},536:{f:lb},547:{f:sb},561:{},579:{f:wR},1030:{f:Yd},1033:{f:kc},1091:{f:yR},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},101:{},102:{},105:{},106:{},107:{},109:{},112:{},114:{},29282:{}};function dr(i,e,t,r){var a=e;if(!isNaN(a)){var s=(t||[]).length||0,o=i.next(4);o.write_shift(2,a),o.write_shift(2,s),s>0&&Jx(t)&&i.push(t)}}function yb(i,e){var t=e||{},r=t.dense!=null?t.dense:kT,a={};r&&(a["!data"]=[]),i=ru(i,"<!--","-->");var s=i.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var o=i.match(/<\/table/i),u=s.index,h=o&&o.index||i.length,d=g_(i.slice(u,h),/(:?<tr[^<>]*>)/i,"<tr>"),p=-1,b=0,g=0,v=0,y={s:{r:1e7,c:1e7},e:{r:0,c:0}},C=[];for(u=0;u<d.length;++u){var E=d[u].trim(),w=E.slice(0,3).toLowerCase();if(w=="<tr"){if(++p,t.sheetRows&&t.sheetRows<=p){--p;break}b=0;continue}if(!(w!="<td"&&w!="<th")){var R=E.split(/<\/t[dh]>/i);for(h=0;h<R.length;++h){var T=R[h].trim();if(T.match(/<t[dh]/i)){for(var D=T,k=0;D.charAt(0)=="<"&&(k=D.indexOf(">"))>-1;)D=D.slice(k+1);for(var V=0;V<C.length;++V){var P=C[V];P.s.c==b&&P.s.r<p&&p<=P.e.r&&(b=P.e.c+1,V=-1)}var U=Ge(T.slice(0,T.indexOf(">")));v=U.colspan?+U.colspan:1,((g=+U.rowspan)>1||v>1)&&C.push({s:{r:p,c:b},e:{r:p+(g||1)-1,c:b+v-1}});var N=U.t||U["data-t"]||"";if(!D.length){b+=v;continue}if(D=Ix(D),y.s.r>p&&(y.s.r=p),y.e.r<p&&(y.e.r=p),y.s.c>b&&(y.s.c=b),y.e.c<b&&(y.e.c=b),!D.length){b+=v;continue}var j={t:"s",v:D};t.raw||!D.trim().length||N=="s"||(D==="TRUE"?j={t:"b",v:!0}:D==="FALSE"?j={t:"b",v:!1}:isNaN(br(D))?isNaN($o(D).getDate())?D.charCodeAt(0)==35&&Oi[D]!=null&&(j.t="e",j.w=D,j.v=Oi[D]):(j={t:"d",v:Ni(D)},t.UTC===!1&&(j.v=vs(j.v)),t.cellDates||(j={t:"n",v:xi(j.v)}),j.z=t.dateNF||st[14]):j={t:"n",v:br(D)}),j.cellText!==!1&&(j.w=D),r?(a["!data"][p]||(a["!data"][p]=[]),a["!data"][p][b]=j):a[kt({r:p,c:b})]=j,b+=v}}}}return a["!ref"]=yt(y),C.length&&(a["!merges"]=C),a}function W3(i,e,t,r){for(var a=i["!merges"]||[],s=[],o={},u=i["!data"]!=null,h=e.s.c;h<=e.e.c;++h){for(var d=0,p=0,b=0;b<a.length;++b)if(!(a[b].s.r>t||a[b].s.c>h)&&!(a[b].e.r<t||a[b].e.c<h)){if(a[b].s.r<t||a[b].s.c<h){d=-1;break}d=a[b].e.r-a[b].s.r+1,p=a[b].e.c-a[b].s.c+1;break}if(!(d<0)){var g=Dt(h)+Bt(t),v=u?(i["!data"][t]||[])[h]:i[g];v&&v.t=="n"&&v.v!=null&&!isFinite(v.v)&&(isNaN(v.v)?v={t:"e",v:36,w:sr[36]}:v={t:"e",v:7,w:sr[7]});var y=v&&v.v!=null&&(v.h||ko(v.w||(Rn(v),v.w)||""))||"";o={},d>1&&(o.rowspan=d),p>1&&(o.colspan=p),r.editable?y='<span contenteditable="true">'+y+"</span>":v&&(o["data-t"]=v&&v.t||"z",v.v!=null&&(o["data-v"]=ko(v.v instanceof Date?v.v.toISOString():v.v)),v.z!=null&&(o["data-z"]=v.z),v.l&&(v.l.Target||"#").charAt(0)!="#"&&(y='<a href="'+ko(v.l.Target)+'">'+y+"</a>")),o.id=(r.id||"sjs")+"-"+g,s.push(L_("td",y,o))}}var C="<tr>";return C+s.join("")+"</tr>"}var j3='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',X3="</body></html>";function Y3(i,e){var t=x_(i,"table");if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1){var r=Fn(yb(t[0],e),e);return r.bookType="html",r}var a=Ep();return t.forEach(function(s,o){uu(a,yb(s,e),"Sheet"+(o+1))}),a.bookType="html",a}function q3(i,e,t){var r=[];return r.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function K3(i,e){var t=e||{},r=t.header!=null?t.header:j3,a=t.footer!=null?t.footer:X3,s=[r],o=xs(i["!ref"]||"A1");if(s.push(q3(i,o,t)),i["!ref"])for(var u=o.s.r;u<=o.e.r;++u)s.push(W3(i,o,u,t));return s.push("</table>"+a),s.join("")}function Gw(i,e,t){var r=e.rows;if(!r)throw"Unsupported origin when "+e.tagName+" is not a TABLE";var a=t||{},s=i["!data"]!=null,o=0,u=0;if(a.origin!=null)if(typeof a.origin=="number")o=a.origin;else{var h=typeof a.origin=="string"?ji(a.origin):a.origin;o=h.r,u=h.c}var d=Math.min(a.sheetRows||1e7,r.length),p={s:{r:0,c:0},e:{r:o,c:u}};if(i["!ref"]){var b=xs(i["!ref"]);p.s.r=Math.min(p.s.r,b.s.r),p.s.c=Math.min(p.s.c,b.s.c),p.e.r=Math.max(p.e.r,b.e.r),p.e.c=Math.max(p.e.c,b.e.c),o==-1&&(p.e.r=o=b.e.r+1)}var g=[],v=0,y=i["!rows"]||(i["!rows"]=[]),C=0,E=0,w=0,R=0,T=0,D=0;for(i["!cols"]||(i["!cols"]=[]);C<r.length&&E<d;++C){var k=r[C];if(Eb(k)){if(a.display)continue;y[E]={hidden:!0}}var V=k.cells;for(w=R=0;w<V.length;++w){var P=V[w];if(!(a.display&&Eb(P))){var U=P.hasAttribute("data-v")?P.getAttribute("data-v"):P.hasAttribute("v")?P.getAttribute("v"):Ix(P.innerHTML),N=P.getAttribute("data-z")||P.getAttribute("z");for(v=0;v<g.length;++v){var j=g[v];j.s.c==R+u&&j.s.r<E+o&&E+o<=j.e.r&&(R=j.e.c+1-u,v=-1)}D=+P.getAttribute("colspan")||1,((T=+P.getAttribute("rowspan")||1)>1||D>1)&&g.push({s:{r:E+o,c:R+u},e:{r:E+o+(T||1)-1,c:R+u+(D||1)-1}});var Y={t:"s",v:U},Z=P.getAttribute("data-t")||P.getAttribute("t")||"";U!=null&&(U.length==0?Y.t=Z||"z":a.raw||U.trim().length==0||Z=="s"||(Z=="e"&&sr[+U]?Y={t:"e",v:+U,w:sr[+U]}:U==="TRUE"?Y={t:"b",v:!0}:U==="FALSE"?Y={t:"b",v:!1}:isNaN(br(U))?isNaN($o(U).getDate())?U.charCodeAt(0)==35&&Oi[U]!=null&&(Y={t:"e",v:Oi[U],w:U}):(Y={t:"d",v:Ni(U)},a.UTC&&(Y.v=hh(Y.v)),a.cellDates||(Y={t:"n",v:xi(Y.v)}),Y.z=a.dateNF||st[14]):Y={t:"n",v:br(U)})),Y.z===void 0&&N!=null&&(Y.z=N);var ce="",Le=P.getElementsByTagName("A");if(Le&&Le.length)for(var ge=0;ge<Le.length&&!(Le[ge].hasAttribute("href")&&(ce=Le[ge].getAttribute("href"),ce.charAt(0)!="#"));++ge);ce&&ce.charAt(0)!="#"&&ce.slice(0,11).toLowerCase()!="javascript:"&&(Y.l={Target:ce}),s?(i["!data"][E+o]||(i["!data"][E+o]=[]),i["!data"][E+o][R+u]=Y):i[kt({c:R+u,r:E+o})]=Y,p.e.c<R+u&&(p.e.c=R+u),R+=D}}++E}return g.length&&(i["!merges"]=(i["!merges"]||[]).concat(g)),p.e.r=Math.max(p.e.r,E-1+o),i["!ref"]=yt(p),E>=d&&(i["!fullref"]=yt((p.e.r=r.length-C+E-1+o,p))),i}function Ww(i,e){var t=e||{},r={};return t.dense&&(r["!data"]=[]),Gw(r,i,e)}function $3(i,e){var t=Fn(Ww(i,e),e);return t}function Eb(i){var e="",t=Z3(i);return t&&(e=t(i).getPropertyValue("display")),e||(e=i.style&&i.style.display),e==="none"}function Z3(i){return i.ownerDocument.defaultView&&typeof i.ownerDocument.defaultView.getComputedStyle=="function"?i.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Q3(i){var e=i.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(r,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^<>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=wt(e.replace(/<[^<>]*>/g,""));return[t]}function jw(i,e,t){var r=t||{},a=fh(i);di.lastIndex=0,a=sp(ru(a,"<!--","-->"));for(var s,o,u="",h="",d,p=0,b=-1,g="";s=di.exec(a);)switch(s[3]=s[3].replace(/_[\s\S]*$/,"")){case"number-style":case"currency-style":case"percentage-style":case"date-style":case"time-style":case"text-style":s[1]==="/"?(o["truncate-on-overflow"]=="false"&&(u.match(/h/)?u=u.replace(/h+/,"[$&]"):u.match(/m/)?u=u.replace(/m+/,"[$&]"):u.match(/s/)&&(u=u.replace(/s+/,"[$&]"))),r[o.name]=u,u=""):s[0].charAt(s[0].length-2)!=="/"&&(u="",o=Ge(s[0],!1));break;case"boolean-style":s[1]==="/"?(r[o.name]="General",u=""):s[0].charAt(s[0].length-2)!=="/"&&(u="",o=Ge(s[0],!1));break;case"boolean":u+="General";break;case"text":s[1]==="/"?(g=a.slice(b,di.lastIndex-s[0].length),g=="%"&&o[0]=="<number:percentage-style"?u+="%":u+='"'+g.replace(/"/g,'""')+'"'):s[0].charAt(s[0].length-2)!=="/"&&(b=di.lastIndex);break;case"day":switch(d=Ge(s[0],!1),d.style){case"short":u+="d";break;case"long":u+="dd";break;default:u+="dd";break}break;case"day-of-week":switch(d=Ge(s[0],!1),d.style){case"short":u+="ddd";break;case"long":u+="dddd";break;default:u+="ddd";break}break;case"era":switch(d=Ge(s[0],!1),d.style){case"short":u+="ee";break;case"long":u+="eeee";break;default:u+="eeee";break}break;case"hours":switch(d=Ge(s[0],!1),d.style){case"short":u+="h";break;case"long":u+="hh";break;default:u+="hh";break}break;case"minutes":switch(d=Ge(s[0],!1),d.style){case"short":u+="m";break;case"long":u+="mm";break;default:u+="mm";break}break;case"month":switch(d=Ge(s[0],!1),d.textual&&(u+="mm"),d.style){case"short":u+="m";break;case"long":u+="mm";break;default:u+="m";break}break;case"seconds":{switch(d=Ge(s[0],!1),d.style){case"short":u+="s";break;case"long":u+="ss";break;default:u+="ss";break}d["decimal-places"]&&(u+="."+Ct("0",+d["decimal-places"]))}break;case"year":switch(d=Ge(s[0],!1),d.style){case"short":u+="yy";break;case"long":u+="yyyy";break;default:u+="yy";break}break;case"am-pm":u+="AM/PM";break;case"week-of-year":case"quarter":console.error("Excel does not support ODS format token "+s[3]);break;case"fill-character":s[1]==="/"?(g=a.slice(b,di.lastIndex-s[0].length),u+='"'+g.replace(/"/g,'""')+'"*'):s[0].charAt(s[0].length-2)!=="/"&&(b=di.lastIndex);break;case"scientific-number":d=Ge(s[0],!1),u+="0."+Ct("0",+d["min-decimal-places"]||+d["decimal-places"]||2)+Ct("?",+d["decimal-places"]-+d["min-decimal-places"]||0)+"E"+(Nt(d["forced-exponent-sign"])?"+":"")+Ct("0",+d["min-exponent-digits"]||2);break;case"fraction":d=Ge(s[0],!1),+d["min-integer-digits"]?u+=Ct("0",+d["min-integer-digits"]):u+="#",u+=" ",u+=Ct("?",+d["min-numerator-digits"]||1),u+="/",+d["denominator-value"]?u+=d["denominator-value"]:u+=Ct("?",+d["min-denominator-digits"]||1);break;case"currency-symbol":s[1]==="/"?u+='"'+a.slice(b,di.lastIndex-s[0].length).replace(/"/g,'""')+'"':s[0].charAt(s[0].length-2)!=="/"?b=di.lastIndex:u+="$";break;case"text-properties":switch(d=Ge(s[0],!1),(d.color||"").toLowerCase().replace("#","")){case"ff0000":case"red":u="[Red]"+u;break}break;case"text-content":u+="@";break;case"map":d=Ge(s[0],!1),wt(d.condition)=="value()>=0"?u=r[d["apply-style-name"]]+";"+u:console.error("ODS number format may be incorrect: "+d.condition);break;case"number":if(s[1]==="/")break;d=Ge(s[0],!1),h="",h+=Ct("0",+d["min-integer-digits"]||1),Nt(d.grouping)&&(h=La(Ct("#",Math.max(0,4-h.length))+h)),(+d["min-decimal-places"]||+d["decimal-places"])&&(h+="."),+d["min-decimal-places"]&&(h+=Ct("0",+d["min-decimal-places"]||1)),+d["decimal-places"]-(+d["min-decimal-places"]||0)&&(h+=Ct("0",+d["decimal-places"]-(+d["min-decimal-places"]||0))),u+=h;break;case"embedded-text":s[1]==="/"?p==0?u+='"'+a.slice(b,di.lastIndex-s[0].length).replace(/"/g,'""')+'"':u=u.slice(0,p)+'"'+a.slice(b,di.lastIndex-s[0].length).replace(/"/g,'""')+'"'+u.slice(p):s[0].charAt(s[0].length-2)!=="/"&&(b=di.lastIndex,p=-+Ge(s[0],!1).position||0);break}return r}function Xw(i,e,t){var r=e||{},a=fh(i),s=[],o,u,h,d="",p=0,b,g,v={},y=[],C={};r.dense&&(C["!data"]=[]);var E,w,R={value:""},T={},D="",k=0,V="",P=0,U=[],N=[],j=-1,Y=-1,Z={s:{r:1e6,c:1e7},e:{r:0,c:0}},ce=0,Le=t||{},ge={},me=[],de={},ve=0,Me=0,F=[],he=1,_e=1,ye=[],pe={Names:[],WBProps:{}},Ne={},Oe=["",""],qe=[],z={},q="",X=0,W=!1,we=!1,H=0;for(di.lastIndex=0,a=sp(ru(a,"<!--","-->"));E=di.exec(a);)switch(E[3]=E[3].replace(/_[\s\S]*$/,"")){case"table":case"":E[1]==="/"?(Z.e.c>=Z.s.c&&Z.e.r>=Z.s.r?C["!ref"]=yt(Z):C["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=Z.e.r&&(C["!fullref"]=C["!ref"],Z.e.r=r.sheetRows-1,C["!ref"]=yt(Z)),me.length&&(C["!merges"]=me),F.length&&(C["!rows"]=F),b.name=b.||b.name,typeof JSON<"u"&&JSON.stringify(b),y.push(b.name),v[b.name]=C,we=!1):E[0].charAt(E[0].length-2)!=="/"&&(b=Ge(E[0],!1),j=Y=-1,Z.s.r=Z.s.c=1e7,Z.e.r=Z.e.c=0,C={},r.dense&&(C["!data"]=[]),me=[],F=[],we=!0);break;case"table-row-group":E[1]==="/"?--ce:++ce;break;case"table-row":case"":if(E[1]==="/"){j+=he,he=1;break}if(g=Ge(E[0],!1),g.?j=g.-1:j==-1&&(j=0),he=+g["number-rows-repeated"]||1,he<10)for(H=0;H<he;++H)ce>0&&(F[j+H]={level:ce});Y=-1;break;case"covered-table-cell":if(E[1]!=="/")if(++Y,R=Ge(E[0],!1),_e=parseInt(R["number-columns-repeated"]||"1",10)||1,r.sheetStubs){for(;_e-- >0;)r.dense?(C["!data"][j]||(C["!data"][j]=[]),C["!data"][j][Y]={t:"z"}):C[kt({r:j,c:Y})]={t:"z"},++Y;--Y}else Y+=_e-1;D="",U=[];break;case"table-cell":case"":if(E[0].charAt(E[0].length-2)==="/")++Y,R=Ge(E[0],!1),_e=parseInt(R["number-columns-repeated"]||"1",10)||1,w={t:"z",v:null},R.formula&&r.cellFormula!=!1&&(w.f=vb(wt(R.formula))),R["style-name"]&&ge[R["style-name"]]&&(w.z=ge[R["style-name"]]),(R.||R["value-type"])=="string"&&(w.t="s",w.v=wt(R["string-value"]||""),r.dense?(C["!data"][j]||(C["!data"][j]=[]),C["!data"][j][Y]=w):C[Dt(Y)+Bt(j)]=w),Y+=_e-1;else if(E[1]!=="/"){++Y,D=V="",k=P=0,U=[],N=[],_e=1;var ze=he?j+he-1:j;if(Y>Z.e.c&&(Z.e.c=Y),Y<Z.s.c&&(Z.s.c=Y),j<Z.s.r&&(Z.s.r=j),ze>Z.e.r&&(Z.e.r=ze),R=Ge(E[0],!1),T=S_(E[0]),qe=[],z={},w={t:R.||R["value-type"],v:null},R["style-name"]&&ge[R["style-name"]]&&(w.z=ge[R["style-name"]]),r.cellFormula)if(R.formula&&(R.formula=wt(R.formula)),R["number-matrix-columns-spanned"]&&R["number-matrix-rows-spanned"]&&(ve=parseInt(R["number-matrix-rows-spanned"],10)||0,Me=parseInt(R["number-matrix-columns-spanned"],10)||0,de={s:{r:j,c:Y},e:{r:j+ve-1,c:Y+Me-1}},w.F=yt(de),ye.push([de,w.F])),R.formula)w.f=vb(R.formula);else for(H=0;H<ye.length;++H)j>=ye[H][0].s.r&&j<=ye[H][0].e.r&&Y>=ye[H][0].s.c&&Y<=ye[H][0].e.c&&(w.F=ye[H][1]);switch((R["number-columns-spanned"]||R["number-rows-spanned"])&&(ve=parseInt(R["number-rows-spanned"]||"1",10)||1,Me=parseInt(R["number-columns-spanned"]||"1",10)||1,ve*Me>1&&(de={s:{r:j,c:Y},e:{r:j+ve-1,c:Y+Me-1}},me.push(de))),R["number-columns-repeated"]&&(_e=parseInt(R["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=Nt(R["boolean-value"])||+R["boolean-value"]>=1;break;case"float":w.t="n",w.v=parseFloat(R.value),r.cellDates&&w.z&&ta(w.z)&&(w.v=Tn(w.v+(pe.WBProps.date1904?1462:0)),w.t=typeof w.v=="number"?"n":"d");break;case"percentage":w.t="n",w.v=parseFloat(R.value);break;case"currency":w.t="n",w.v=parseFloat(R.value);break;case"date":w.t="d",w.v=Ni(R["date-value"],pe.WBProps.date1904),r.cellDates||(w.t="n",w.v=xi(w.v,pe.WBProps.date1904)),w.z||(w.z="m/d/yy");break;case"time":w.t="n",w.v=s_(R["time-value"])/86400,r.cellDates&&(w.v=Tn(w.v),w.t=typeof w.v=="number"?"n":"d"),w.z||(w.z="HH:MM:SS");break;case"number":w.t="n",w.v=parseFloat(R.);break;default:if(w.t==="string"||w.t==="text"||!w.t)w.t="s",R["string-value"]!=null&&(D=wt(R["string-value"]),U=[]);else throw new Error("Unsupported value type "+w.t)}}else{if(W=!1,T["calcext:value-type"]=="error"&&Oi[D]!=null&&(w.t="e",w.w=D,w.v=Oi[D]),w.t==="s"&&(w.v=D||"",U.length&&(w.R=U),W=k==0),Ne.Target&&(w.l=Ne),qe.length>0&&(w.c=qe,qe=[]),D&&r.cellText!==!1&&(w.w=D),W&&(w.t="z",delete w.v),(!W||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=j))for(var He=0;He<he;++He){if(_e=parseInt(R["number-columns-repeated"]||"1",10),r.dense)for(C["!data"][j+He]||(C["!data"][j+He]=[]),C["!data"][j+He][Y]=He==0?w:mi(w);--_e>0;)C["!data"][j+He][Y+_e]=mi(w);else for(C[kt({r:j+He,c:Y})]=w;--_e>0;)C[kt({r:j+He,c:Y+_e})]=mi(w);Z.e.c<=Y&&(Z.e.c=Y)}_e=parseInt(R["number-columns-repeated"]||"1",10),Y+=_e-1,_e=0,w={},D="",U=[]}Ne={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(E[1]==="/"){if((o=s.pop())[0]!==E[3])throw"Bad state: "+o}else E[0].charAt(E[0].length-2)!=="/"&&s.push([E[3],!0]);break;case"annotation":if(E[1]==="/"){if((o=s.pop())[0]!==E[3])throw"Bad state: "+o;z.t=D,U.length&&(z.R=U),z.a=q,qe.push(z),D=V,k=P,U=N}else if(E[0].charAt(E[0].length-2)!=="/"){s.push([E[3],!1]);var De=Ge(E[0],!0);De.display&&Nt(De.display)||(qe.hidden=!0),V=D,P=k,N=U,D="",k=0,U=[]}q="",X=0;break;case"creator":E[1]==="/"?q=a.slice(X,E.index):X=E.index+E[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(E[1]==="/"){if((o=s.pop())[0]!==E[3])throw"Bad state: "+o}else E[0].charAt(E[0].length-2)!=="/"&&s.push([E[3],!1]);D="",k=0,U=[];break;case"scientific-number":case"currency-symbol":case"fill-character":break;case"text-style":case"boolean-style":case"number-style":case"currency-style":case"percentage-style":case"date-style":case"time-style":if(E[1]==="/"){var Xe=di.lastIndex;jw(a.slice(h,di.lastIndex),e,Le),di.lastIndex=Xe}else E[0].charAt(E[0].length-2)!=="/"&&(h=di.lastIndex-E[0].length);break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":{var We=Ge(E[0],!1);We.family=="table-cell"&&Le[We["data-style-name"]]&&(ge[We.name]=Le[We["data-style-name"]])}break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":break;case"boolean":break;case"text":if(E[0].slice(-2)==="/>")break;if(E[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":d+=a.slice(p,E.index);break}else p=E.index+E[0].length;break;case"named-range":u=Ge(E[0],!1),Oe=qd(u["cell-range-address"]);var tt={Name:u.name,Ref:Oe[0]+"!"+Oe[1]};we&&(tt.Sheet=y.length),pe.Names.push(tt);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":switch(u=Ge(E[0],!1),u["date-value"]){case"1904-01-01":pe.WBProps.date1904=!0;break}break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(E[1]==="/"&&(!R||!R["string-value"])){var vt=Q3(a.slice(k,E.index));D=(D.length>0?D+`
`:"")+vt[0]}else E[0].slice(-2)=="/>"?D+=`
`:(Ge(E[0],!1),k=E.index+E[0].length);break;case"s":break;case"database-range":if(E[1]==="/")break;try{Oe=qd(Ge(E[0])["target-range-address"]),v[Oe[0]]["!autofilter"]={ref:Oe[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"filter-set-item":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(E[1]!=="/"){if(Ne=Ge(E[0],!1),!Ne.href)break;Ne.Target=wt(Ne.href),delete Ne.href,Ne.Target.charAt(0)=="#"&&Ne.Target.indexOf(".")>-1?(Oe=qd(Ne.Target.slice(1)),Ne.Target="#"+Oe[0]+"!"+Oe[1]):Ne.Target.match(/^\.\.[\\\/]/)&&(Ne.Target=Ne.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(E[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(E)}}var ht={Sheets:v,SheetNames:y,Workbook:pe};return r.bookSheets&&delete ht.Sheets,ht}function Cb(i,e){e=e||{},zr(i,"META-INF/manifest.xml")&&wS(fi(i,"META-INF/manifest.xml"),e);var t=Ji(i,"styles.xml"),r=t&&jw(Vt(t)),a=Ji(i,"content.xml");if(!a)throw new Error("Missing content.xml in ODS / UOF file");var s=Xw(Vt(a),e,r);return zr(i,"meta.xml")&&(s.Props=sw(fi(i,"meta.xml"))),s.bookType="ods",s}function Tb(i,e){var t=Xw(i,e);return t.bookType="fods",t}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */var Li=function(){try{return typeof Uint8Array>"u"||typeof Uint8Array.prototype.subarray>"u"?"slice":typeof Buffer<"u"?typeof Buffer.prototype.subarray>"u"?"slice":(typeof Buffer.from=="function"?Buffer.from([72,62]):new Buffer([72,62]))instanceof Uint8Array?"subarray":"slice":"subarray"}catch{return"slice"}}();function eu(i){return new DataView(i.buffer,i.byteOffset,i.byteLength)}function pl(i){return typeof TextDecoder<"u"?new TextDecoder().decode(i):Vt(Ia(i))}function Yw(i){for(var e=0,t=0;t<i.length;++t)e+=i[t].length;var r=new Uint8Array(e),a=0;for(t=0;t<i.length;++t){var s=i[t],o=s.length;if(o<250)for(var u=0;u<o;++u)r[a++]=s[u];else r.set(s,a),a+=o}return r}function Ho(i){return i-=i>>1&1431655765,i=(i&858993459)+(i>>2&858993459),(i+(i>>4)&252645135)*16843009>>>24}function J3(i,e){for(var t=(i[e+15]&127)<<7|i[e+14]>>1,r=i[e+14]&1,a=e+13;a>=e;--a)r=r*256+i[a];return(i[e+15]&128?-r:r)*Math.pow(10,t-6176)}function th(i,e){var t=e.l,r=i[t]&127;e:if(i[t++]>=128&&(r|=(i[t]&127)<<7,i[t++]<128||(r|=(i[t]&127)<<14,i[t++]<128)||(r|=(i[t]&127)<<21,i[t++]<128)||(r+=(i[t]&127)*Math.pow(2,28),++t,i[t++]<128)||(r+=(i[t]&127)*Math.pow(2,35),++t,i[t++]<128)||(r+=(i[t]&127)*Math.pow(2,42),++t,i[t++]<128)))break e;return e.l=t,r}function Rt(i){var e=0,t=i[e]&127;return i[e++]<128||(t|=(i[e]&127)<<7,i[e++]<128)||(t|=(i[e]&127)<<14,i[e++]<128)||(t|=(i[e]&127)<<21,i[e++]<128)||(t|=(i[e]&15)<<28),t}function pt(i){for(var e=[],t={l:0};t.l<i.length;){var r=t.l,a=th(i,t),s=a&7;a=a/8|0;var o,u=t.l;switch(s){case 0:{for(;i[u++]>=128;);o=i[Li](t.l,u),t.l=u}break;case 1:o=i[Li](u,u+8),t.l=u+8;break;case 2:{var h=th(i,t);o=i[Li](t.l,t.l+h),t.l+=h}break;case 5:o=i[Li](u,u+4),t.l=u+4;break;default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(r))}var d={data:o,type:s};e[a]==null&&(e[a]=[]),e[a].push(d)}return e}function bh(i,e){return(i==null?void 0:i.map(function(t){return e(t.data)}))||[]}function eF(i){for(var e,t=[],r={l:0};r.l<i.length;){var a=th(i,r),s=pt(i[Li](r.l,r.l+a));r.l+=a;var o={id:Rt(s[1][0].data),messages:[]};s[2].forEach(function(u){var h=pt(u.data),d=Rt(h[3][0].data);o.messages.push({meta:h,data:i[Li](r.l,r.l+d)}),r.l+=d}),(e=s[3])!=null&&e[0]&&(o.merge=Rt(s[3][0].data)>>>0>0),t.push(o)}return t}function tF(i,e){if(i!=0)throw new Error("Unexpected Snappy chunk type ".concat(i));for(var t={l:0},r=th(e,t),a=[],s=t.l;s<e.length;){var o=e[s]&3;if(o==0){var u=e[s++]>>2;if(u<60)++u;else{var h=u-59;u=e[s],h>1&&(u|=e[s+1]<<8),h>2&&(u|=e[s+2]<<16),h>3&&(u|=e[s+3]<<24),u>>>=0,u++,s+=h}a.push(e[Li](s,s+u)),s+=u;continue}else{var d=0,p=0;if(o==1?(p=(e[s]>>2&7)+4,d=(e[s++]&224)<<3,d|=e[s++]):(p=(e[s++]>>2)+1,o==2?(d=e[s]|e[s+1]<<8,s+=2):(d=(e[s]|e[s+1]<<8|e[s+2]<<16|e[s+3]<<24)>>>0,s+=4)),d==0)throw new Error("Invalid offset 0");for(var b=a.length-1,g=d;b>=0&&g>=a[b].length;)g-=a[b].length,--b;if(b<0)if(g==0)g=a[b=0].length;else throw new Error("Invalid offset beyond length");if(p<g)a.push(a[b][Li](a[b].length-g,a[b].length-g+p));else{for(g>0&&(a.push(a[b][Li](a[b].length-g)),p-=g),++b;p>=a[b].length;)a.push(a[b]),p-=a[b].length,++b;p&&a.push(a[b][Li](0,p))}a.length>25&&(a=[Yw(a)])}}for(var v=0,y=0;y<a.length;++y)v+=a[y].length;if(v!=r)throw new Error("Unexpected length: ".concat(v," != ").concat(r));return a}function iF(i){Array.isArray(i)&&(i=new Uint8Array(i));for(var e=[],t=0;t<i.length;){var r=i[t++],a=i[t]|i[t+1]<<8|i[t+2]<<16;t+=3,e.push.apply(e,tF(r,i[Li](t,t+a))),t+=a}if(t!==i.length)throw new Error("data is not a valid framed stream!");return e.length==1?e[0]:Yw(e)}var rF=function(){return{sst:[],rsst:[],ofmt:[],nfmt:[],fmla:[],ferr:[],cmnt:[]}};function qw(i,e,t,r,a){var s,o,u,h,d=e&255,p=e>>8,b=p>=5?a:r;e:if(t&(p>4?8:4)&&i.t=="n"&&d==7){var g=(s=b[7])!=null&&s[0]?Rt(b[7][0].data):-1;if(g==-1)break e;var v=(o=b[15])!=null&&o[0]?Rt(b[15][0].data):-1,y=(u=b[16])!=null&&u[0]?Rt(b[16][0].data):-1,C=(h=b[40])!=null&&h[0]?Rt(b[40][0].data):-1,E=i.v,w=E;t:if(C){if(E==0){v=y=2;break t}E>=604800?v=1:E>=86400?v=2:E>=3600?v=4:E>=60?v=8:E>=1?v=16:v=32,Math.floor(E)!=E?y=32:E%60?y=16:E%3600?y=8:E%86400?y=4:E%604800&&(y=2),y<v&&(y=v)}if(v==-1||y==-1)break e;var R=[],T=[];v==1&&(w=E/604800,y==1?T.push('d"d"'):(w|=0,E-=604800*w),R.push(w+(g==2?" week"+(w==1?"":"s"):g==1?"w":""))),v<=2&&y>=2&&(w=E/86400,y>2&&(w|=0,E-=86400*w),T.push('d"d"'),R.push(w+(g==2?" day"+(w==1?"":"s"):g==1?"d":""))),v<=4&&y>=4&&(w=E/3600,y>4&&(w|=0,E-=3600*w),T.push((v>=4?"[h]":"h")+'"h"'),R.push(w+(g==2?" hour"+(w==1?"":"s"):g==1?"h":""))),v<=8&&y>=8&&(w=E/60,y>8&&(w|=0,E-=60*w),T.push((v>=8?"[m]":"m")+'"m"'),g==0?R.push((v==8&&y==8||w>=10?"":"0")+w):R.push(w+(g==2?" minute"+(w==1?"":"s"):g==1?"m":""))),v<=16&&y>=16&&(w=E,y>16&&(w|=0,E-=w),T.push((v>=16?"[s]":"s")+'"s"'),g==0?R.push((y==16&&v==16||w>=10?"":"0")+w):R.push(w+(g==2?" second"+(w==1?"":"s"):g==1?"s":""))),y>=32&&(w=Math.round(1e3*E),v<32&&T.push('.000"ms"'),g==0?R.push((w>=100?"":w>=10?"0":"00")+w):R.push(w+(g==2?" millisecond"+(w==1?"":"s"):g==1?"ms":""))),i.w=R.join(g==0?":":" "),i.z=T.join(g==0?'":"':" "),g==0&&(i.w=i.w.replace(/:(\d\d\d)$/,".$1"))}}function aF(i,e,t,r){var a=eu(i),s=a.getUint32(4,!0),o=-1,u=-1,h=-1,d=NaN,p=0,b=new Date(Date.UTC(2001,0,1)),g=t>1?12:8;s&2&&(h=a.getUint32(g,!0),g+=4),g+=Ho(s&(t>1?3468:396))*4,s&512&&(o=a.getUint32(g,!0),g+=4),g+=Ho(s&(t>1?12288:4096))*4,s&16&&(u=a.getUint32(g,!0),g+=4),s&32&&(d=a.getFloat64(g,!0),g+=8),s&64&&(b.setTime(b.getTime()+(p=a.getFloat64(g,!0))*1e3),g+=8),t>1&&(s=a.getUint32(8,!0)>>>16,s&255&&(h==-1&&(h=a.getUint32(g,!0)),g+=4));var v,y=i[t>=4?1:2];switch(y){case 0:return;case 2:v={t:"n",v:d};break;case 3:v={t:"s",v:e.sst[u]};break;case 5:r!=null&&r.cellDates?v={t:"d",v:b}:v={t:"n",v:p/86400+35430,z:st[14]};break;case 6:v={t:"b",v:d>0};break;case 7:v={t:"n",v:d};break;case 8:v={t:"e",v:0};break;case 9:if(o>-1){var C=e.rsst[o];v={t:"s",v:C.v},C.l&&(v.l={Target:C.l})}else throw new Error("Unsupported cell type ".concat(i[Li](0,4)));break;default:throw new Error("Unsupported cell type ".concat(i[Li](0,4)))}return h>-1&&qw(v,y|t<<8,s,e.ofmt[h],e.nfmt[h]),y==7&&(v.v/=86400),v}function nF(i,e,t){var r=eu(i);r.getUint32(4,!0);var a=r.getUint32(8,!0),s=12,o=-1,u=-1,h=-1,d=NaN,p=NaN,b=0,g=new Date(Date.UTC(2001,0,1));a&1&&(d=J3(i,s),s+=16),a&2&&(p=r.getFloat64(s,!0),s+=8),a&4&&(g.setTime(g.getTime()+(b=r.getFloat64(s,!0))*1e3),s+=8),a&8&&(u=r.getUint32(s,!0),s+=4),a&16&&(o=r.getUint32(s,!0),s+=4),s+=Ho(a&480)*4,a&512&&(r.getUint32(s,!0),s+=4),s+=Ho(a&1024)*4,a&2048&&(r.getUint32(s,!0),s+=4);var v,y=i[1];switch(y){case 0:v={t:"z"};break;case 2:v={t:"n",v:d};break;case 3:v={t:"s",v:e.sst[u]};break;case 5:t!=null&&t.cellDates?v={t:"d",v:g}:v={t:"n",v:b/86400+35430,z:st[14]};break;case 6:v={t:"b",v:p>0};break;case 7:v={t:"n",v:p};break;case 8:v={t:"e",v:0};break;case 9:if(o>-1){var C=e.rsst[o];v={t:"s",v:C.v},C.l&&(v.l={Target:C.l})}else throw new Error("Unsupported cell type ".concat(i[1]," : ").concat(a&31," : ").concat(i[Li](0,4)));break;case 10:v={t:"n",v:d};break;default:throw new Error("Unsupported cell type ".concat(i[1]," : ").concat(a&31," : ").concat(i[Li](0,4)))}if(s+=Ho(a&4096)*4,a&516096&&(h==-1&&(h=r.getUint32(s,!0)),s+=4),a&524288){var E=r.getUint32(s,!0);s+=4,e.cmnt[E]&&(v.c=uF(e.cmnt[E]))}return h>-1&&qw(v,y|1280,a>>13,e.ofmt[h],e.nfmt[h]),y==7&&(v.v/=86400),v}function sF(i,e,t){switch(i[0]){case 0:case 1:case 2:case 3:case 4:return aF(i,e,i[0],t);case 5:return nF(i,e,t);default:throw new Error("Unsupported payload version ".concat(i[0]))}}function Ti(i){var e=pt(i);return Rt(e[1][0].data)}function es(i,e){var t=pt(e.data),r=Rt(t[1][0].data),a=t[3],s=[];return(a||[]).forEach(function(o){var u,h,d=pt(o.data);if(d[1]){var p=Rt(d[1][0].data)>>>0;switch(r){case 1:s[p]=pl(d[3][0].data);break;case 8:{var b=i[Ti(d[9][0].data)][0],g=pt(b.data),v=i[Ti(g[1][0].data)][0],y=Rt(v.meta[1][0].data);if(y!=2001)throw new Error("2000 unexpected reference to ".concat(y));var C=pt(v.data),E={v:C[3].map(function(T){return pl(T.data)}).join("")};s[p]=E;e:if((u=C==null?void 0:C[11])!=null&&u[0]){var w=(h=pt(C[11][0].data))==null?void 0:h[1];if(!w)break e;w.forEach(function(T){var D,k,V,P=pt(T.data);if((D=P[2])!=null&&D[0]){var U=i[Ti((k=P[2])==null?void 0:k[0].data)][0],N=Rt(U.meta[1][0].data);switch(N){case 2032:var j=pt(U.data);(V=j==null?void 0:j[2])!=null&&V[0]&&!E.l&&(E.l=pl(j[2][0].data));break;case 2039:break;default:console.log("unrecognized ObjectAttribute type ".concat(N))}}})}}break;case 2:s[p]=pt(d[6][0].data);break;case 3:s[p]=pt(d[5][0].data);break;case 10:{var R=i[Ti(d[10][0].data)][0];s[p]=Kw(i,R.data)}break;default:throw r}}}),s}function lF(i,e){var t,r,a,s,o,u,h,d,p,b,g,v,y,C,E=pt(i),w=Rt(E[1][0].data)>>>0,R=Rt(E[2][0].data)>>>0,T=((r=(t=E[8])==null?void 0:t[0])==null?void 0:r.data)&&Rt(E[8][0].data)>0||!1,D,k;if((s=(a=E[7])==null?void 0:a[0])!=null&&s.data&&e!=0)D=(u=(o=E[7])==null?void 0:o[0])==null?void 0:u.data,k=(d=(h=E[6])==null?void 0:h[0])==null?void 0:d.data;else if((b=(p=E[4])==null?void 0:p[0])!=null&&b.data&&e!=1)D=(v=(g=E[4])==null?void 0:g[0])==null?void 0:v.data,k=(C=(y=E[3])==null?void 0:y[0])==null?void 0:C.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var V=T?4:1,P=eu(D),U=[],N=0;N<D.length/2;++N){var j=P.getUint16(N*2,!0);j<65535&&U.push([N,j])}if(U.length!=R)throw"Expected ".concat(R," cells, found ").concat(U.length);var Y=[];for(N=0;N<U.length-1;++N)Y[U[N][0]]=k[Li](U[N][1]*V,U[N+1][1]*V);return U.length>=1&&(Y[U[U.length-1][0]]=k[Li](U[U.length-1][1]*V)),{R:w,cells:Y}}function oF(i,e){var t,r=pt(e.data),a=-1;(t=r==null?void 0:r[7])!=null&&t[0]&&(Rt(r[7][0].data)>>>0?a=1:a=0);var s=bh(r[5],function(o){return lF(o,a)});return{nrows:Rt(r[4][0].data)>>>0,data:s.reduce(function(o,u){return o[u.R]||(o[u.R]=[]),u.cells.forEach(function(h,d){if(o[u.R][d])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(d));o[u.R][d]=h}),o},[])}}function Kw(i,e){var t,r,a,s,o,u,h,d,p,b,g={t:"",a:""},v=pt(e);if((r=(t=v==null?void 0:v[1])==null?void 0:t[0])!=null&&r.data&&(g.t=pl((s=(a=v==null?void 0:v[1])==null?void 0:a[0])==null?void 0:s.data)||""),(u=(o=v==null?void 0:v[3])==null?void 0:o[0])!=null&&u.data){var y=i[Ti((d=(h=v==null?void 0:v[3])==null?void 0:h[0])==null?void 0:d.data)][0],C=pt(y.data);(b=(p=C[1])==null?void 0:p[0])!=null&&b.data&&(g.a=pl(C[1][0].data))}return v!=null&&v[4]&&(g.replies=[],v[4].forEach(function(E){var w=i[Ti(E.data)][0];g.replies.push(Kw(i,w.data))})),g}function uF(i){var e=[];return e.push({t:i.t||"",a:i.a,T:i.replies&&i.replies.length>0}),i.replies&&i.replies.forEach(function(t){e.push({t:t.t||"",a:t.a,T:!0})}),e}function cF(i,e,t,r){var a,s,o,u,h,d,p,b,g,v,y,C,E,w,R=pt(e.data),T={s:{r:0,c:0},e:{r:0,c:0}};if(T.e.r=(Rt(R[6][0].data)>>>0)-1,T.e.r<0)throw new Error("Invalid row varint ".concat(R[6][0].data));if(T.e.c=(Rt(R[7][0].data)>>>0)-1,T.e.c<0)throw new Error("Invalid col varint ".concat(R[7][0].data));t["!ref"]=yt(T);var D=t["!data"]!=null,k=t,V=pt(R[4][0].data),P=rF();(a=V[4])!=null&&a[0]&&(P.sst=es(i,i[Ti(V[4][0].data)][0])),(s=V[6])!=null&&s[0]&&(P.fmla=es(i,i[Ti(V[6][0].data)][0])),(o=V[11])!=null&&o[0]&&(P.ofmt=es(i,i[Ti(V[11][0].data)][0])),(u=V[12])!=null&&u[0]&&(P.ferr=es(i,i[Ti(V[12][0].data)][0])),(h=V[17])!=null&&h[0]&&(P.rsst=es(i,i[Ti(V[17][0].data)][0])),(d=V[19])!=null&&d[0]&&(P.cmnt=es(i,i[Ti(V[19][0].data)][0])),(p=V[22])!=null&&p[0]&&(P.nfmt=es(i,i[Ti(V[22][0].data)][0]));var U=pt(V[3][0].data),N=0;if(!((b=V[9])!=null&&b[0]))throw"NUMBERS file missing row tree";var j=pt(V[9][0].data)[1].map(function(ge){return pt(ge.data)});if(j.forEach(function(ge){N=Rt(ge[1][0].data);var me=Rt(ge[2][0].data),de=U[1][me];if(!de)throw"NUMBERS missing tile "+me;var ve=pt(de.data),Me=i[Ti(ve[2][0].data)][0],F=Rt(Me.meta[1][0].data);if(F!=6002)throw new Error("6001 unexpected reference to ".concat(F));var he=oF(i,Me);he.data.forEach(function(_e,ye){_e.forEach(function(pe,Ne){var Oe=sF(pe,P,r);Oe&&(D?(k["!data"][N+ye]||(k["!data"][N+ye]=[]),k["!data"][N+ye][Ne]=Oe):t[Dt(Ne)+Bt(N+ye)]=Oe)})}),N+=he.nrows}),(g=V[13])!=null&&g[0]){var Y=i[Ti(V[13][0].data)][0],Z=Rt(Y.meta[1][0].data);if(Z!=6144)throw new Error("Expected merge type 6144, found ".concat(Z));t["!merges"]=(v=pt(Y.data))==null?void 0:v[1].map(function(ge){var me=pt(ge.data),de=eu(pt(me[1][0].data)[1][0].data),ve=eu(pt(me[2][0].data)[1][0].data);return{s:{r:de.getUint16(0,!0),c:de.getUint16(2,!0)},e:{r:de.getUint16(0,!0)+ve.getUint16(0,!0)-1,c:de.getUint16(2,!0)+ve.getUint16(2,!0)-1}}})}if(!((y=t["!merges"])!=null&&y.length)&&((C=R[47])!=null&&C[0])){var ce=pt(R[47][0].data);if((E=ce[2])!=null&&E[0]){var Le=pt(ce[2][0].data);(w=Le[3])!=null&&w[0]&&(t["!merges"]=bh(Le[3],function(ge){var me,de,ve,Me,F,he=pt(ge),_e=pt(he[2][0].data),ye=pt(_e[1][0].data);if((me=ye[1])!=null&&me[0]){var pe=pt(ye[1][0].data),Ne=Rt(pe[1][0].data);if(Ne==67){var Oe=pt(pe[40][0].data);if(!(!((de=Oe[3])!=null&&de[0])||!((ve=Oe[4])!=null&&ve[0]))){var qe=pt(Oe[3][0].data),z=pt(Oe[4][0].data),q=Rt(qe[1][0].data),X=(Me=qe[2])!=null&&Me[0]?Rt(qe[2][0].data):q,W=Rt(z[1][0].data),we=(F=z[2])!=null&&F[0]?Rt(z[2][0].data):W;return{s:{r:W,c:q},e:{r:we,c:X}}}}}}).filter(function(ge){return ge!=null}))}}}function hF(i,e,t){var r=pt(e.data),a={"!ref":"A1"};t!=null&&t.dense&&(a["!data"]=[]);var s=i[Ti(r[2][0].data)],o=Rt(s[0].meta[1][0].data);if(o!=6001)throw new Error("6000 unexpected reference to ".concat(o));return cF(i,s[0],a,t),a}function fF(i,e,t){var r,a=pt(e.data),s={name:(r=a[1])!=null&&r[0]?pl(a[1][0].data):"",sheets:[]},o=bh(a[2],Ti);return o.forEach(function(u){i[u].forEach(function(h){var d=Rt(h.meta[1][0].data);d==6e3&&s.sheets.push(hF(i,h,t))})}),s}function dF(i,e,t){var r,a=Ep();a.Workbook={WBProps:{date1904:!0}};var s=pt(e.data);if((r=s[2])!=null&&r[0])throw new Error("Keynote presentations are not supported");var o=bh(s[1],Ti);if(o.forEach(function(u){i[u].forEach(function(h){var d=Rt(h.meta[1][0].data);if(d==2){var p=fF(i,h,t);p.sheets.forEach(function(b,g){uu(a,b,g==0?p.name:p.name+"_"+g,!0)})}})}),a.SheetNames.length==0)throw new Error("Empty NUMBERS file");return a.bookType="numbers",a}function $d(i,e){var t,r,a,s,o,u,h,d={},p=[];if(i.FullPaths.forEach(function(g){if(g.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),i.FileIndex.forEach(function(g){if(g.name.match(/\.iwa$/)&&g.content[0]==0){var v;try{v=iF(g.content)}catch(C){return console.log("?? "+g.content.length+" "+(C.message||C))}var y;try{y=eF(v)}catch(C){return console.log("## "+(C.message||C))}y.forEach(function(C){d[C.id]=C.messages,p.push(C.id)})}}),!p.length)throw new Error("File has no messages");if((a=(r=(t=d==null?void 0:d[1])==null?void 0:t[0].meta)==null?void 0:r[1])!=null&&a[0].data&&Rt(d[1][0].meta[1][0].data)==1e4)throw new Error("Pages documents are not supported");var b=((h=(u=(o=(s=d==null?void 0:d[1])==null?void 0:s[0])==null?void 0:o.meta)==null?void 0:u[1])==null?void 0:h[0].data)&&Rt(d[1][0].meta[1][0].data)==1&&d[1][0];if(b||p.forEach(function(g){d[g].forEach(function(v){var y=Rt(v.meta[1][0].data)>>>0;if(y==1)if(!b)b=v;else throw new Error("Document has multiple roots")})}),!b)throw new Error("Cannot find Document root");return dF(d,b,e)}function pF(i){return function(t){for(var r=0;r!=i.length;++r){var a=i[r];t[a[0]]===void 0&&(t[a[0]]=a[1]),a[2]==="n"&&(t[a[0]]=Number(t[a[0]]))}}}function wp(i){pF([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(i)}function mF(i){return sl.WS.indexOf(i)>-1?"sheet":i==sl.CS?"chart":i==sl.DS?"dialog":i==sl.MS?"macro":i&&i.length?i:"sheet"}function gF(i,e){if(!i)return 0;try{i=e.map(function(r){return r.id||(r.id=r.strRelID),[r.name,i["!id"][r.id].Target,mF(i["!id"][r.id].Type)]})}catch{return null}return!i||i.length===0?null:i}function vF(i,e,t,r,a,s,o,u){if(!(!i||!i["!legdrawel"])){var h=nl(i["!legdrawel"].Target,r),d=Ji(t,h,!0);d&&TA(Vt(d),i,u||[])}}function bF(i,e,t,r,a,s,o,u,h,d,p,b){try{s[r]=Mo(Ji(i,t,!0),e);var g=fi(i,e),v;switch(u){case"sheet":v=y3(g,e,a,h,s[r],d,p,b);break;case"chart":if(v=E3(g,e,a,h,s[r],d,p,b),!v||!v["!drawel"])break;var y=nl(v["!drawel"].Target,e),C=d0(y),E=CA(Ji(i,y,!0),Mo(Ji(i,C,!0),y)),w=nl(E,y),R=d0(w);v=a3(Ji(i,w,!0),w,h,Mo(Ji(i,R,!0),w),d,v);break;case"macro":v=C3(g,e,a,h,s[r],d,p,b);break;case"dialog":v=T3(g,e,a,h,s[r],d,p,b);break;default:throw new Error("Unrecognized sheet type "+u)}o[r]=v;var T=[],D=[];s&&s[r]&&Ir(s[r]).forEach(function(k){var V="";if(s[r][k].Type==sl.CMNT){if(V=nl(s[r][k].Target,e),T=R3(fi(i,V,!0),V,h),!T||!T.length)return;hb(v,T,!1)}s[r][k].Type==sl.TCMNT&&(V=nl(s[r][k].Target,e),D=D.concat(SA(fi(i,V,!0),h)))}),D&&D.length&&hb(v,D,!0,h.people||[]),vF(v,u,i,e,a,h,d,T)}catch(k){if(h.WTF)throw k}}function Nr(i){return i.charAt(0)=="/"?i.slice(1):i}function xF(i,e){if(Dx(),e=e||{},wp(e),zr(i,"META-INF/manifest.xml")||zr(i,"objectdata.xml"))return Cb(i,e);if(zr(i,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof $d<"u"){if(i.FileIndex)return $d(i,e);var t=Tt.utils.cfb_new();return z1(i).forEach(function(ge){E_(t,ge,y_(i,ge))}),$d(t,e)}throw new Error("Unsupported NUMBERS file")}if(!zr(i,"[Content_Types].xml")){if(zr(i,"index.xml.gz"))throw new Error("Unsupported NUMBERS 08 file");if(zr(i,"index.xml"))throw new Error("Unsupported NUMBERS 09 file");var r=Tt.find(i,"Index.zip");if(r)return e=mi(e),delete e.type,typeof r.content=="string"&&(e.type="binary"),typeof Bun<"u"&&Buffer.isBuffer(r.content)?ml(new Uint8Array(r.content),e):ml(r.content,e);throw new Error("Unsupported ZIP file")}var a=z1(i),s=bS(Ji(i,"[Content_Types].xml")),o=!1,u,h;if(s.workbooks.length===0&&(h="xl/workbook.xml",fi(i,h,!0)&&s.workbooks.push(h)),s.workbooks.length===0){if(h="xl/workbook.bin",!fi(i,h,!0))throw new Error("Could not find workbook");s.workbooks.push(h),o=!0}s.workbooks[0].slice(-3)=="bin"&&(o=!0);var d={},p={};if(!e.bookSheets&&!e.bookProps){if(No=[],s.sst)try{No=S3(fi(i,Nr(s.sst)),s.sst,e)}catch(ge){if(e.WTF)throw ge}e.cellStyles&&s.themes.length&&(d=Sw(Ji(i,s.themes[0].replace(/^\//,""),!0)||"",e)),s.style&&(p=_3(fi(i,Nr(s.style)),s.style,d,e))}s.links.map(function(ge){try{var me=Mo(Ji(i,d0(Nr(ge))),ge);return A3(fi(i,Nr(ge)),me,ge,e)}catch{}});var b=w3(fi(i,Nr(s.workbooks[0])),s.workbooks[0],e),g={},v="";s.coreprops.length&&(v=fi(i,Nr(s.coreprops[0]),!0),v&&(g=sw(v)),s.extprops.length!==0&&(v=fi(i,Nr(s.extprops[0]),!0),v&&ES(v,g,e)));var y={};(!e.bookSheets||e.bookProps)&&s.custprops.length!==0&&(v=Ji(i,Nr(s.custprops[0]),!0),v&&(y=TS(v,e)));var C={};if((e.bookSheets||e.bookProps)&&(b.Sheets?u=b.Sheets.map(function(me){return me.name}):g.Worksheets&&g.SheetNames.length>0&&(u=g.SheetNames),e.bookProps&&(C.Props=g,C.Custprops=y),e.bookSheets&&typeof u<"u"&&(C.SheetNames=u),e.bookSheets?C.SheetNames:e.bookProps))return C;u={};var E={};e.bookDeps&&s.calcchain&&(E=k3(fi(i,Nr(s.calcchain)),s.calcchain));var w=0,R={},T,D;{var k=b.Sheets;g.Worksheets=k.length,g.SheetNames=[];for(var V=0;V!=k.length;++V)g.SheetNames[V]=k[V].name}var P=o?"bin":"xml",U=s.workbooks[0].lastIndexOf("/"),N=(s.workbooks[0].slice(0,U+1)+"_rels/"+s.workbooks[0].slice(U+1)+".rels").replace(/^\//,"");zr(i,N)||(N="xl/_rels/workbook."+P+".rels");var j=Mo(Ji(i,N,!0),N.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(e.xlmeta=D3(fi(i,Nr(s.metadata[0])),s.metadata[0],e)),(s.people||[]).length>=1&&(e.people=RA(fi(i,Nr(s.people[0])),e)),j&&(j=gF(j,b.Sheets));var Y=fi(i,"xl/worksheets/sheet.xml",!0)?1:0;e:for(w=0;w!=g.Worksheets;++w){var Z="sheet";if(j&&j[w]?(T="xl/"+j[w][1].replace(/[\/]?xl\//,""),zr(i,T)||(T=j[w][1]),zr(i,T)||(T=N.replace(/_rels\/[\S\s]*$/,"")+j[w][1]),Z=j[w][2]):(T="xl/worksheets/sheet"+(w+1-Y)+"."+P,T=T.replace(/sheet0\./,"sheet.")),D=T.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(w!=e.sheets)continue e;break;case"string":if(g.SheetNames[w].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var ce=!1,Le=0;Le!=e.sheets.length;++Le)typeof e.sheets[Le]=="number"&&e.sheets[Le]==w&&(ce=1),typeof e.sheets[Le]=="string"&&e.sheets[Le].toLowerCase()==g.SheetNames[w].toLowerCase()&&(ce=1);if(!ce)continue e}}bF(i,T,D,g.SheetNames[w],w,R,u,Z,e,b,d,p)}return C={Directory:s,Workbook:b,Props:g,Custprops:y,Deps:E,Sheets:u,SheetNames:g.SheetNames,Strings:No,Styles:p,Themes:d,SSF:mi(st)},e&&e.bookFiles&&(i.files?(C.keys=a,C.files=i.files):(C.keys=[],C.files={},i.FullPaths.forEach(function(ge,me){ge=ge.replace(/^Root Entry[\/]/,""),C.keys.push(ge),C.files[ge]=i.FileIndex[me]}))),e&&e.bookVBA&&(s.vba.length>0?C.vbaraw=fi(i,Nr(s.vba[0]),!0):s.defaults&&s.defaults.bin===FA&&(C.vbaraw=fi(i,"xl/vbaProject.bin",!0))),C.bookType=o?"xlsb":"xlsx",C}function wF(i,e){var t=e||{},r="Workbook",a=Tt.find(i,r);try{if(r="/!DataSpaces/Version",a=Tt.find(i,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(vk(a.content),r="/!DataSpaces/DataSpaceMap",a=Tt.find(i,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var s=xk(a.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=Tt.find(i,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var o=wk(a.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=Tt.find(i,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);Ek(a.content)}catch{}if(r="/EncryptionInfo",a=Tt.find(i,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var u=Ck(a.content);if(r="/EncryptedPackage",a=Tt.find(i,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],a.content,t.password||"",t);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],a.content,t.password||"",t);throw new Error("File is password-protected")}function yp(i,e){var t="";switch((e||{}).type||"base64"){case"buffer":return[i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7]];case"base64":t=yr(i.slice(0,12));break;case"binary":t=i;break;case"array":return[i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function yF(i,e){return Tt.find(i,"EncryptedPackage")?wF(i,e):Vw(i,e)}function EF(i,e){var t,r=i,a=e||{};return a.type||(a.type=gt&&Buffer.isBuffer(i)?"buffer":"base64"),t=Bx(r,a),xF(t,a)}function $w(i,e){var t=0;e:for(;t<i.length;)switch(i.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return m0(i.slice(t),e);default:break e}return Zo.to_workbook(i,e)}function CF(i,e){var t="",r=yp(i,e);switch(e.type){case"base64":t=yr(i);break;case"binary":t=i;break;case"buffer":t=i.toString("binary");break;case"array":t=gs(i);break;default:throw new Error("Unrecognized type "+e.type)}return r[0]==239&&r[1]==187&&r[2]==191&&(t=Vt(t)),e.type="binary",$w(t,e)}function TF(i,e){var t=i;return e.type=="base64"&&(t=yr(t)),typeof ArrayBuffer<"u"&&i instanceof ArrayBuffer&&(t=new Uint8Array(i)),t=gt&&Buffer.isBuffer(i)?i.slice(2).toString("utf16le"):typeof Uint8Array<"u"&&t instanceof Uint8Array?typeof TextDecoder<"u"?new TextDecoder("utf-16le").decode(t.slice(2)):RT(t.slice(2)):wx(t.slice(2)),e.type="binary",$w(t,e)}function _F(i){return i.match(/[^\x00-\x7F]/)?To(i):i}function Zd(i,e,t,r){return r?(t.type="string",Zo.to_workbook(i,t)):Zo.to_workbook(e,t)}function ml(i,e){xx();var t=e||{};if(t.codepage&&console.error("Codepage tables are not loaded.  Non-ASCII characters may not give expected results"),typeof ArrayBuffer<"u"&&i instanceof ArrayBuffer)return ml(new Uint8Array(i),(t=mi(t),t.type="array",t));if(typeof Int8Array<"u"&&i instanceof Int8Array)return ml(new Uint8Array(i.buffer,i.byteOffset,i.length),t);typeof Uint8Array<"u"&&i instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var r=i,a=[0,0,0,0],s=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),dl={},t.dateNF&&(dl.dateNF=t.dateNF),t.type||(t.type=gt&&Buffer.isBuffer(i)?"buffer":"base64"),t.type=="file"&&(t.type=gt?"buffer":"binary",r=r_(i),typeof Uint8Array<"u"&&!gt&&(t.type="array")),t.type=="string"&&(s=!0,t.type="binary",t.codepage=65001,r=_F(i)),t.type=="array"&&typeof Uint8Array<"u"&&i instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),u=new Uint8Array(o);if(u.foo="bar",!u.foo)return t=mi(t),t.type="array",ml(ip(r),t)}switch((a=yp(r,t))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return yF(Tt.read(r,t),t);break;case 9:if(a[1]<=8)return Vw(r,t);break;case 60:return m0(r,t);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return sk(r,t);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return ak.to_workbook(r,t);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?EF(r,t):Zd(i,r,t,s);case 239:return a[3]===60?m0(r,t):Zd(i,r,t,s);case 255:if(a[1]===254)return TF(r,t);if(a[1]===0&&a[2]===2&&a[3]===0)return Lo.to_workbook(r,t);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return Lo.to_workbook(r,t);break;case 3:case 131:case 139:case 140:return cb.to_workbook(r,t);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return Bk(r,t);break;case 10:case 13:case 32:return CF(r,t);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break;case 8:if(a[1]===231)throw new Error("Unsupported Multiplan 1.x file!");break;case 12:if(a[1]===236)throw new Error("Unsupported Multiplan 2.x file!");if(a[1]===237)throw new Error("Unsupported Multiplan 3.x file!");break}return ik.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?cb.to_workbook(r,t):Zd(i,r,t,s)}function SF(i,e,t,r,a,s,o){var u=Bt(t),h=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),p=!0,b=i["!data"]!=null,g=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(g,"__rowNum__",{value:t,enumerable:!1})}catch{g.__rowNum__=t}else g.__rowNum__=t;if(!b||i["!data"][t])for(var v=e.s.c;v<=e.e.c;++v){var y=b?(i["!data"][t]||[])[v]:i[r[v]+u];if(y==null||y.t===void 0){if(h===void 0)continue;s[v]!=null&&(g[s[v]]=h);continue}var C=y.v;switch(y.t){case"z":if(C==null)break;continue;case"e":C=C==0?null:void 0;break;case"s":case"b":case"n":if(!y.z||!ta(y.z)||(C=Tn(C),typeof C=="number"))break;case"d":o&&(o.UTC||o.raw===!1)||(C=vs(new Date(C)));break;default:throw new Error("unrecognized type "+y.t)}if(s[v]!=null){if(C==null)if(y.t=="e"&&C===null)g[s[v]]=null;else if(h!==void 0)g[s[v]]=h;else if(d&&C===null)g[s[v]]=null;else continue;else g[s[v]]=(y.t==="n"&&typeof o.rawNumbers=="boolean"?o.rawNumbers:d)?C:Rn(y,C,o);C!=null&&(p=!1)}}return{row:g,isempty:p}}function v0(i,e){if(i==null||i["!ref"]==null)return[];var t={t:"n",v:0},r=0,a=1,s=[],o=0,u="",h={s:{r:0,c:0},e:{r:0,c:0}},d=e||{},p=d.range!=null?d.range:i["!ref"];switch(d.header===1?r=1:d.header==="A"?r=2:Array.isArray(d.header)?r=3:d.header==null&&(r=0),typeof p){case"string":h=si(p);break;case"number":h=si(i["!ref"]),h.s.r=p;break;default:h=p}r>0&&(a=0);var b=Bt(h.s.r),g=[],v=[],y=0,C=0,E=i["!data"]!=null,w=h.s.r,R=0,T={};E&&!i["!data"][w]&&(i["!data"][w]=[]);var D=d.skipHidden&&i["!cols"]||[],k=d.skipHidden&&i["!rows"]||[];for(R=h.s.c;R<=h.e.c;++R)if(!(D[R]||{}).hidden)switch(g[R]=Dt(R),t=E?i["!data"][w][R]:i[g[R]+b],r){case 1:s[R]=R-h.s.c;break;case 2:s[R]=g[R];break;case 3:s[R]=d.header[R-h.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),u=o=Rn(t,null,d),C=T[o]||0,!C)T[o]=1;else{do u=o+"_"+C++;while(T[u]);T[o]=C,T[u]=1}s[R]=u}for(w=h.s.r+a;w<=h.e.r;++w)if(!(k[w]||{}).hidden){var V=SF(i,h,w,g,r,s,d);(V.isempty===!1||(r===1?d.blankrows!==!1:d.blankrows))&&(v[y++]=V.row)}return v.length=y,v}var _b=/"/g;function RF(i,e,t,r,a,s,o,u,h){for(var d=!0,p=[],b="",g=Bt(t),v=i["!data"]!=null,y=v&&i["!data"][t]||[],C=e.s.c;C<=e.e.c;++C)if(r[C]){var E=v?y[C]:i[r[C]+g];if(E==null)b="";else if(E.v!=null){d=!1,b=""+(h.rawNumbers&&E.t=="n"?E.v:Rn(E,null,h));for(var w=0,R=0;w!==b.length;++w)if((R=b.charCodeAt(w))===a||R===s||R===34||h.forceQuotes){b='"'+b.replace(_b,'""')+'"';break}b=="ID"&&u==0&&p.length==0&&(b='"ID"')}else E.f!=null&&!E.F?(d=!1,b="="+E.f,b.indexOf(",")>=0&&(b='"'+b.replace(_b,'""')+'"')):b="";p.push(b)}if(h.strip)for(;p[p.length-1]==="";)--p.length;return h.blankrows===!1&&d?null:p.join(o)}function Zw(i,e){var t=[],r=e??{};if(i==null||i["!ref"]==null)return"";for(var a=si(i["!ref"]),s=r.FS!==void 0?r.FS:",",o=s.charCodeAt(0),u=r.RS!==void 0?r.RS:`
`,h=u.charCodeAt(0),d="",p=[],b=r.skipHidden&&i["!cols"]||[],g=r.skipHidden&&i["!rows"]||[],v=a.s.c;v<=a.e.c;++v)(b[v]||{}).hidden||(p[v]=Dt(v));for(var y=0,C=a.s.r;C<=a.e.r;++C)(g[C]||{}).hidden||(d=RF(i,a,C,p,o,h,s,y,r),d!=null&&(d||r.blankrows!==!1)&&t.push((y++?u:"")+d));return t.join("")}function kF(i,e){e||(e={}),e.FS="	",e.RS=`
`;var t=Zw(i,e);return t}function AF(i,e){var t="",r,a="";if(i==null||i["!ref"]==null)return[];var s=si(i["!ref"]),o="",u=[],h,d=[],p=i["!data"]!=null;for(h=s.s.c;h<=s.e.c;++h)u[h]=Dt(h);for(var b=s.s.r;b<=s.e.r;++b)for(o=Bt(b),h=s.s.c;h<=s.e.c;++h)if(t=u[h]+o,r=p?(i["!data"][b]||[])[h]:i[t],a="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;a=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)a=r.f;else{if(e&&e.values===!1)continue;if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)a=""+r.v;else if(r.t=="b")a=r.v?"TRUE":"FALSE";else if(r.w!==void 0)a="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?a="'"+r.v:a=""+r.v}}d[d.length]=t+"="+a}return d}function Qw(i,e,t){var r=t||{},a=i?i["!data"]!=null:r.dense,s=+!r.skipHeader,o=i||{};!i&&a&&(o["!data"]=[]);var u=0,h=0;if(o&&r.origin!=null)if(typeof r.origin=="number")u=r.origin;else{var d=typeof r.origin=="string"?ji(r.origin):r.origin;u=d.r,h=d.c}var p={s:{c:0,r:0},e:{c:h,r:u+e.length-1+s}};if(o["!ref"]){var b=si(o["!ref"]);p.e.c=Math.max(p.e.c,b.e.c),p.e.r=Math.max(p.e.r,b.e.r),u==-1&&(u=b.e.r+1,p.e.r=u+e.length-1+s)}else u==-1&&(u=0,p.e.r=e.length-1+s);var g=r.header||[],v=0,y=[];e.forEach(function(E,w){a&&!o["!data"][u+w+s]&&(o["!data"][u+w+s]=[]),a&&(y=o["!data"][u+w+s]),Ir(E).forEach(function(R){(v=g.indexOf(R))==-1&&(g[v=g.length]=R);var T=E[R],D="z",k="",V=a?"":Dt(h+v)+Bt(u+w+s),P=a?y[h+v]:o[V];T&&typeof T=="object"&&!(T instanceof Date)?a?y[h+v]=T:o[V]=T:(typeof T=="number"?D="n":typeof T=="boolean"?D="b":typeof T=="string"?D="s":T instanceof Date?(D="d",r.UTC||(T=hh(T)),r.cellDates||(D="n",T=xi(T)),k=P!=null&&P.z&&ta(P.z)?P.z:r.dateNF||st[14]):T===null&&r.nullError&&(D="e",T=0),P?(P.t=D,P.v=T,delete P.w,delete P.R,k&&(P.z=k)):a?y[h+v]=P={t:D,v:T}:o[V]=P={t:D,v:T},k&&(P.z=k))})}),p.e.c=Math.max(p.e.c,h+g.length-1);var C=Bt(u);if(a&&!o["!data"][u]&&(o["!data"][u]=[]),s)for(v=0;v<g.length;++v)a?o["!data"][u][v+h]={t:"s",v:g[v]}:o[Dt(v+h)+C]={t:"s",v:g[v]};return o["!ref"]=yt(p),o}function DF(i,e){return Qw(null,i,e)}function tu(i,e,t){if(typeof e=="string"){if(i["!data"]!=null){var r=ji(e);return i["!data"][r.r]||(i["!data"][r.r]=[]),i["!data"][r.r][r.c]||(i["!data"][r.r][r.c]={t:"z"})}return i[e]||(i[e]={t:"z"})}return typeof e!="number"?tu(i,kt(e)):tu(i,Dt(t||0)+Bt(e))}function FF(i,e){if(typeof e=="number"){if(e>=0&&i.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var t=i.SheetNames.indexOf(e);if(t>-1)return t;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function Ep(i,e){var t={SheetNames:[],Sheets:{}};return i&&uu(t,i,e||"Sheet1"),t}function uu(i,e,t,r){var a=1;if(!t)for(;a<=65535&&i.SheetNames.indexOf(t="Sheet"+a)!=-1;++a,t=void 0);if(!t||i.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&i.SheetNames.indexOf(t)>=0&&t.length<32){var s=t.match(/\d+$/);a=s&&+s[0]||0;var o=s&&t.slice(0,s.index)||t;for(++a;a<=65535&&i.SheetNames.indexOf(t=o+a)!=-1;++a);}if(f3(t),i.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return i.SheetNames.push(t),i.Sheets[t]=e,t}function MF(i,e,t){i.Workbook||(i.Workbook={}),i.Workbook.Sheets||(i.Workbook.Sheets=[]);var r=FF(i,e);switch(i.Workbook.Sheets[r]||(i.Workbook.Sheets[r]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}i.Workbook.Sheets[r].Hidden=t}function OF(i,e){return i.z=e,i}function Jw(i,e,t){return e?(i.l={Target:e},t&&(i.l.Tooltip=t)):delete i.l,i}function LF(i,e,t){return Jw(i,"#"+e,t)}function NF(i,e,t){i.c||(i.c=[]),i.c.push({t:e,a:t||"SheetJS"})}function BF(i,e,t,r){for(var a=typeof e!="string"?e:si(e),s=typeof e=="string"?e:yt(e),o=a.s.r;o<=a.e.r;++o)for(var u=a.s.c;u<=a.e.c;++u){var h=tu(i,o,u);h.t="n",h.F=s,delete h.v,o==a.s.r&&u==a.s.c&&(h.f=t,r&&(h.D=!0))}var d=xs(i["!ref"]);return d.s.r>a.s.r&&(d.s.r=a.s.r),d.s.c>a.s.c&&(d.s.c=a.s.c),d.e.r<a.e.r&&(d.e.r=a.e.r),d.e.c<a.e.c&&(d.e.c=a.e.c),i["!ref"]=yt(d),i}var zF={encode_col:Dt,encode_row:Bt,encode_cell:kt,encode_range:yt,decode_col:hp,decode_row:cp,split_cell:K_,decode_cell:ji,decode_range:xs,format_cell:Rn,sheet_new:Z_,sheet_add_aoa:tw,sheet_add_json:Qw,sheet_add_dom:Gw,aoa_to_sheet:wl,json_to_sheet:DF,table_to_sheet:Ww,table_to_book:$3,sheet_to_csv:Zw,sheet_to_txt:kF,sheet_to_json:v0,sheet_to_html:K3,sheet_to_formulae:AF,sheet_to_row_object_array:v0,sheet_get_cell:tu,book_new:Ep,book_append_sheet:uu,book_set_sheet_visibility:MF,cell_set_number_format:OF,cell_set_hyperlink:Jw,cell_set_internal_link:LF,cell_add_comment:NF,sheet_set_array_formula:BF,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const Po=px("file/loadTextFile",async i=>{const e=await fetch(i);if(!e.ok)throw new Error("Failed to fetch file");const t=await e.text();return ey(t)}),Io=px("file/readSelectedFile",async i=>new Promise((e,t)=>{const r=new FileReader;r.onload=()=>{if(typeof r.result=="string"){const a=ey(r.result);e(a)}else t(new Error("File content was not read as text"))},r.onerror=()=>t(r.error),r.readAsText(i)})),HF={content:[],headers:[],metadata:{},loading:!1,error:null},ey=i=>{console.log(i);let e;try{e=ml(i,{type:"string"})}catch(d){console.error("Error parsing CSV as UTF-8 text:",d);return}const t=e.SheetNames[0],r=e.Sheets[t],a=zF.sheet_to_json(r,{header:1});console.log(a);let s=a.shift();const o={};if(!s)return;for(;s[0]!==null&&typeof s[0]=="string"&&s[0].startsWith("#")&&(s[0].substring(1).split(";").forEach(p=>{const b=p.split(":");b.length===2&&(o[b[0]]=b[1])}),s=a.shift(),!!s););let u=[];s&&(u=PF(s)),console.log(o);const h=a.map(d=>{const p={};return s?(d.forEach((b,g)=>{const v=s==null?void 0:s[g];typeof v=="string"&&(p[v]=String(b))}),p):{}});return console.log(h),{data:h,headers:u,metadata:o}},PF=i=>{const e=[];for(const t of i)typeof t=="string"&&(t.toLowerCase()==="links"?e.push({title:t,field:t,maxWidth:80}):e.push({title:t,field:t}));return e},IF=mx({name:"file",initialState:HF,reducers:{},extraReducers:i=>{i.addCase(Po.pending,e=>{e.loading=!0,e.error=null,e.content=[],e.headers=[],e.metadata={}}).addCase(Po.fulfilled,(e,t)=>{var r,a,s;e.loading=!1,e.content=((r=t.payload)==null?void 0:r.data)||[],e.headers=((a=t.payload)==null?void 0:a.headers)||[],e.metadata=((s=t.payload)==null?void 0:s.metadata)||{}}).addCase(Po.rejected,(e,t)=>{e.loading=!1,e.error=t.error.message||"Error loading file",console.log("Error loading file")}).addCase(Io.pending,e=>{e.loading=!0,e.error=null,e.content=[],e.headers=[],e.metadata={}}).addCase(Io.fulfilled,(e,t)=>{var r,a,s;e.loading=!1,e.content=((r=t.payload)==null?void 0:r.data)||[],e.headers=((a=t.payload)==null?void 0:a.headers)||[],e.metadata=((s=t.payload)==null?void 0:s.metadata)||{}}).addCase(Io.rejected,(e,t)=>{e.loading=!1,e.error=t.error.message??"Error reading file",console.log("Error reading file")})}}),UF=IF.reducer,VF=rT({reducer:{counter:TT,file:UF}});var go={},Sb;function GF(){if(Sb)return go;Sb=1,Object.defineProperty(go,"__esModule",{value:!0}),go.parse=o,go.serialize=d;const i=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,e=/^[\u0021-\u003A\u003C-\u007E]*$/,t=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,r=/^[\u0020-\u003A\u003D-\u007E]*$/,a=Object.prototype.toString,s=(()=>{const g=function(){};return g.prototype=Object.create(null),g})();function o(g,v){const y=new s,C=g.length;if(C<2)return y;const E=(v==null?void 0:v.decode)||p;let w=0;do{const R=g.indexOf("=",w);if(R===-1)break;const T=g.indexOf(";",w),D=T===-1?C:T;if(R>D){w=g.lastIndexOf(";",R-1)+1;continue}const k=u(g,w,R),V=h(g,R,k),P=g.slice(k,V);if(y[P]===void 0){let U=u(g,R+1,D),N=h(g,D,U);const j=E(g.slice(U,N));y[P]=j}w=D+1}while(w<C);return y}function u(g,v,y){do{const C=g.charCodeAt(v);if(C!==32&&C!==9)return v}while(++v<y);return y}function h(g,v,y){for(;v>y;){const C=g.charCodeAt(--v);if(C!==32&&C!==9)return v+1}return y}function d(g,v,y){const C=(y==null?void 0:y.encode)||encodeURIComponent;if(!i.test(g))throw new TypeError(`argument name is invalid: ${g}`);const E=C(v);if(!e.test(E))throw new TypeError(`argument val is invalid: ${v}`);let w=g+"="+E;if(!y)return w;if(y.maxAge!==void 0){if(!Number.isInteger(y.maxAge))throw new TypeError(`option maxAge is invalid: ${y.maxAge}`);w+="; Max-Age="+y.maxAge}if(y.domain){if(!t.test(y.domain))throw new TypeError(`option domain is invalid: ${y.domain}`);w+="; Domain="+y.domain}if(y.path){if(!r.test(y.path))throw new TypeError(`option path is invalid: ${y.path}`);w+="; Path="+y.path}if(y.expires){if(!b(y.expires)||!Number.isFinite(y.expires.valueOf()))throw new TypeError(`option expires is invalid: ${y.expires}`);w+="; Expires="+y.expires.toUTCString()}if(y.httpOnly&&(w+="; HttpOnly"),y.secure&&(w+="; Secure"),y.partitioned&&(w+="; Partitioned"),y.priority)switch(typeof y.priority=="string"?y.priority.toLowerCase():void 0){case"low":w+="; Priority=Low";break;case"medium":w+="; Priority=Medium";break;case"high":w+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${y.priority}`)}if(y.sameSite)switch(typeof y.sameSite=="string"?y.sameSite.toLowerCase():y.sameSite){case!0:case"strict":w+="; SameSite=Strict";break;case"lax":w+="; SameSite=Lax";break;case"none":w+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${y.sameSite}`)}return w}function p(g){if(g.indexOf("%")===-1)return g;try{return decodeURIComponent(g)}catch{return g}}function b(g){return a.call(g)==="[object Date]"}return go}GF();/**
 * react-router v7.3.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var ty=i=>{throw TypeError(i)},WF=(i,e,t)=>e.has(i)||ty("Cannot "+t),Qd=(i,e,t)=>(WF(i,e,"read from private field"),t?t.call(i):e.get(i)),jF=(i,e,t)=>e.has(i)?ty("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(i):e.set(i,t),Rb="popstate";function XF(i={}){function e(r,a){let{pathname:s,search:o,hash:u}=r.location;return iu("",{pathname:s,search:o,hash:u},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function t(r,a){return typeof a=="string"?a:An(a)}return qF(e,t,null,i)}function _t(i,e){if(i===!1||i===null||typeof i>"u")throw new Error(e)}function Si(i,e){if(!i){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function YF(){return Math.random().toString(36).substring(2,10)}function kb(i,e){return{usr:i.state,key:i.key,idx:e}}function iu(i,e,t=null,r){return{pathname:typeof i=="string"?i:i.pathname,search:"",hash:"",...typeof e=="string"?Mn(e):e,state:t,key:e&&e.key||r||YF()}}function An({pathname:i="/",search:e="",hash:t=""}){return e&&e!=="?"&&(i+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(i+=t.charAt(0)==="#"?t:"#"+t),i}function Mn(i){let e={};if(i){let t=i.indexOf("#");t>=0&&(e.hash=i.substring(t),i=i.substring(0,t));let r=i.indexOf("?");r>=0&&(e.search=i.substring(r),i=i.substring(0,r)),i&&(e.pathname=i)}return e}function qF(i,e,t,r={}){let{window:a=document.defaultView,v5Compat:s=!1}=r,o=a.history,u="POP",h=null,d=p();d==null&&(d=0,o.replaceState({...o.state,idx:d},""));function p(){return(o.state||{idx:null}).idx}function b(){u="POP";let E=p(),w=E==null?null:E-d;d=E,h&&h({action:u,location:C.location,delta:w})}function g(E,w){u="PUSH";let R=iu(C.location,E,w);d=p()+1;let T=kb(R,d),D=C.createHref(R);try{o.pushState(T,"",D)}catch(k){if(k instanceof DOMException&&k.name==="DataCloneError")throw k;a.location.assign(D)}s&&h&&h({action:u,location:C.location,delta:1})}function v(E,w){u="REPLACE";let R=iu(C.location,E,w);d=p();let T=kb(R,d),D=C.createHref(R);o.replaceState(T,"",D),s&&h&&h({action:u,location:C.location,delta:0})}function y(E){let w=a.location.origin!=="null"?a.location.origin:a.location.href,R=typeof E=="string"?E:An(E);return R=R.replace(/ $/,"%20"),_t(w,`No window.location.(origin|href) available to create URL for href: ${R}`),new URL(R,w)}let C={get action(){return u},get location(){return i(a,o)},listen(E){if(h)throw new Error("A history only accepts one active listener");return a.addEventListener(Rb,b),h=E,()=>{a.removeEventListener(Rb,b),h=null}},createHref(E){return e(a,E)},createURL:y,encodeLocation(E){let w=y(E);return{pathname:w.pathname,search:w.search,hash:w.hash}},push:g,replace:v,go(E){return o.go(E)}};return C}var _o,Ab=class{constructor(i){if(jF(this,_o,new Map),i)for(let[e,t]of i)this.set(e,t)}get(i){if(Qd(this,_o).has(i))return Qd(this,_o).get(i);if(i.defaultValue!==void 0)return i.defaultValue;throw new Error("No value found for context")}set(i,e){Qd(this,_o).set(i,e)}};_o=new WeakMap;var KF=new Set(["lazy","caseSensitive","path","id","index","children"]);function $F(i){return i.index===!0}function ih(i,e,t=[],r={}){return i.map((a,s)=>{let o=[...t,String(s)],u=typeof a.id=="string"?a.id:o.join("-");if(_t(a.index!==!0||!a.children,"Cannot specify children on an index route"),_t(!r[u],`Found a route id collision on id "${u}".  Route id's must be globally unique within Data Router usages`),$F(a)){let h={...a,...e(a),id:u};return r[u]=h,h}else{let h={...a,...e(a),id:u,children:void 0};return r[u]=h,a.children&&(h.children=ih(a.children,e,o,r)),h}})}function En(i,e,t="/"){return Nc(i,e,t,!1)}function Nc(i,e,t,r){let a=typeof e=="string"?Mn(e):e,s=Ur(a.pathname||"/",t);if(s==null)return null;let o=iy(i);QF(o);let u=null;for(let h=0;u==null&&h<o.length;++h){let d=uM(s);u=lM(o[h],d,r)}return u}function ZF(i,e){let{route:t,pathname:r,params:a}=i;return{id:t.id,pathname:r,params:a,data:e[t.id],handle:t.handle}}function iy(i,e=[],t=[],r=""){let a=(s,o,u)=>{let h={relativePath:u===void 0?s.path||"":u,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};h.relativePath.startsWith("/")&&(_t(h.relativePath.startsWith(r),`Absolute route path "${h.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),h.relativePath=h.relativePath.slice(r.length));let d=ca([r,h.relativePath]),p=t.concat(h);s.children&&s.children.length>0&&(_t(s.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${d}".`),iy(s.children,e,p,d)),!(s.path==null&&!s.index)&&e.push({path:d,score:nM(d,s.index),routesMeta:p})};return i.forEach((s,o)=>{var u;if(s.path===""||!((u=s.path)!=null&&u.includes("?")))a(s,o);else for(let h of ry(s.path))a(s,o,h)}),e}function ry(i){let e=i.split("/");if(e.length===0)return[];let[t,...r]=e,a=t.endsWith("?"),s=t.replace(/\?$/,"");if(r.length===0)return a?[s,""]:[s];let o=ry(r.join("/")),u=[];return u.push(...o.map(h=>h===""?s:[s,h].join("/"))),a&&u.push(...o),u.map(h=>i.startsWith("/")&&h===""?"/":h)}function QF(i){i.sort((e,t)=>e.score!==t.score?t.score-e.score:sM(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}var JF=/^:[\w-]+$/,eM=3,tM=2,iM=1,rM=10,aM=-2,Db=i=>i==="*";function nM(i,e){let t=i.split("/"),r=t.length;return t.some(Db)&&(r+=aM),e&&(r+=tM),t.filter(a=>!Db(a)).reduce((a,s)=>a+(JF.test(s)?eM:s===""?iM:rM),r)}function sM(i,e){return i.length===e.length&&i.slice(0,-1).every((r,a)=>r===e[a])?i[i.length-1]-e[e.length-1]:0}function lM(i,e,t=!1){let{routesMeta:r}=i,a={},s="/",o=[];for(let u=0;u<r.length;++u){let h=r[u],d=u===r.length-1,p=s==="/"?e:e.slice(s.length)||"/",b=rh({path:h.relativePath,caseSensitive:h.caseSensitive,end:d},p),g=h.route;if(!b&&d&&t&&!r[r.length-1].route.index&&(b=rh({path:h.relativePath,caseSensitive:h.caseSensitive,end:!1},p)),!b)return null;Object.assign(a,b.params),o.push({params:a,pathname:ca([s,b.pathname]),pathnameBase:fM(ca([s,b.pathnameBase])),route:g}),b.pathnameBase!=="/"&&(s=ca([s,b.pathnameBase]))}return o}function rh(i,e){typeof i=="string"&&(i={path:i,caseSensitive:!1,end:!0});let[t,r]=oM(i.path,i.caseSensitive,i.end),a=e.match(t);if(!a)return null;let s=a[0],o=s.replace(/(.)\/+$/,"$1"),u=a.slice(1);return{params:r.reduce((d,{paramName:p,isOptional:b},g)=>{if(p==="*"){let y=u[g]||"";o=s.slice(0,s.length-y.length).replace(/(.)\/+$/,"$1")}const v=u[g];return b&&!v?d[p]=void 0:d[p]=(v||"").replace(/%2F/g,"/"),d},{}),pathname:s,pathnameBase:o,pattern:i}}function oM(i,e=!1,t=!0){Si(i==="*"||!i.endsWith("*")||i.endsWith("/*"),`Route path "${i}" will be treated as if it were "${i.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${i.replace(/\*$/,"/*")}".`);let r=[],a="^"+i.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,u,h)=>(r.push({paramName:u,isOptional:h!=null}),h?"/?([^\\/]+)?":"/([^\\/]+)"));return i.endsWith("*")?(r.push({paramName:"*"}),a+=i==="*"||i==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?a+="\\/*$":i!==""&&i!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),r]}function uM(i){try{return i.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Si(!1,`The URL path "${i}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),i}}function Ur(i,e){if(e==="/")return i;if(!i.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=i.charAt(t);return r&&r!=="/"?null:i.slice(t)||"/"}function cM(i,e="/"){let{pathname:t,search:r="",hash:a=""}=typeof i=="string"?Mn(i):i;return{pathname:t?t.startsWith("/")?t:hM(t,e):e,search:dM(r),hash:pM(a)}}function hM(i,e){let t=e.replace(/\/+$/,"").split("/");return i.split("/").forEach(a=>{a===".."?t.length>1&&t.pop():a!=="."&&t.push(a)}),t.length>1?t.join("/"):"/"}function Jd(i,e,t,r){return`Cannot include a '${i}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function ay(i){return i.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Cp(i){let e=ay(i);return e.map((t,r)=>r===e.length-1?t.pathname:t.pathnameBase)}function Tp(i,e,t,r=!1){let a;typeof i=="string"?a=Mn(i):(a={...i},_t(!a.pathname||!a.pathname.includes("?"),Jd("?","pathname","search",a)),_t(!a.pathname||!a.pathname.includes("#"),Jd("#","pathname","hash",a)),_t(!a.search||!a.search.includes("#"),Jd("#","search","hash",a)));let s=i===""||a.pathname==="",o=s?"/":a.pathname,u;if(o==null)u=t;else{let b=e.length-1;if(!r&&o.startsWith("..")){let g=o.split("/");for(;g[0]==="..";)g.shift(),b-=1;a.pathname=g.join("/")}u=b>=0?e[b]:"/"}let h=cM(a,u),d=o&&o!=="/"&&o.endsWith("/"),p=(s||o===".")&&t.endsWith("/");return!h.pathname.endsWith("/")&&(d||p)&&(h.pathname+="/"),h}var ca=i=>i.join("/").replace(/\/\/+/g,"/"),fM=i=>i.replace(/\/+$/,"").replace(/^\/*/,"/"),dM=i=>!i||i==="?"?"":i.startsWith("?")?i:"?"+i,pM=i=>!i||i==="#"?"":i.startsWith("#")?i:"#"+i,ah=class{constructor(i,e,t,r=!1){this.status=i,this.statusText=e||"",this.internal=r,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function xl(i){return i!=null&&typeof i.status=="number"&&typeof i.statusText=="string"&&typeof i.internal=="boolean"&&"data"in i}var ny=["POST","PUT","PATCH","DELETE"],mM=new Set(ny),gM=["GET",...ny],vM=new Set(gM),bM=new Set([301,302,303,307,308]),xM=new Set([307,308]),e0={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},wM={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},vo={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},_p=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,yM=i=>({hasErrorBoundary:!!i.hasErrorBoundary}),sy="remix-router-transitions",ly=Symbol("ResetLoaderData");function EM(i){const e=i.window?i.window:typeof window<"u"?window:void 0,t=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u";_t(i.routes.length>0,"You must provide a non-empty routes array to createRouter");let r=i.mapRouteProperties||yM,a={},s=ih(i.routes,r,void 0,a),o,u=i.basename||"/",h=i.dataStrategy||RM,d={unstable_middleware:!1,...i.future},p=null,b=new Set,g=null,v=null,y=null,C=i.hydrationData!=null,E=En(s,i.history.location,u),w=!1,R=null;if(E==null&&!i.patchRoutesOnNavigation){let K=Hr(404,{pathname:i.history.location.pathname}),{matches:re,route:fe}=Vb(s);E=re,R={[fe.id]:K}}E&&!i.hydrationData&&Ri(E,s,i.history.location.pathname).active&&(E=null);let T;if(E)if(E.some(K=>K.route.lazy))T=!1;else if(!E.some(K=>K.route.loader))T=!0;else{let K=i.hydrationData?i.hydrationData.loaderData:null,re=i.hydrationData?i.hydrationData.errors:null;if(re){let fe=E.findIndex(Ae=>re[Ae.route.id]!==void 0);T=E.slice(0,fe+1).every(Ae=>!x0(Ae.route,K,re))}else T=E.every(fe=>!x0(fe.route,K,re))}else{T=!1,E=[];let K=Ri(null,s,i.history.location.pathname);K.active&&K.matches&&(w=!0,E=K.matches)}let D,k={historyAction:i.history.action,location:i.history.location,matches:E,initialized:T,navigation:e0,restoreScrollPosition:i.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:i.hydrationData&&i.hydrationData.loaderData||{},actionData:i.hydrationData&&i.hydrationData.actionData||null,errors:i.hydrationData&&i.hydrationData.errors||R,fetchers:new Map,blockers:new Map},V="POP",P=!1,U,N=!1,j=new Map,Y=null,Z=!1,ce=!1,Le=new Set,ge=new Map,me=0,de=-1,ve=new Map,Me=new Set,F=new Map,he=new Map,_e=new Set,ye=new Map,pe,Ne=null;function Oe(){if(p=i.history.listen(({action:K,location:re,delta:fe})=>{if(pe){pe(),pe=void 0;return}Si(ye.size===0||fe!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let Ae=ri({currentLocation:k.location,nextLocation:re,historyAction:K});if(Ae&&fe!=null){let Ue=new Promise(Je=>{pe=Je});i.history.go(fe*-1),ii(Ae,{state:"blocked",location:re,proceed(){ii(Ae,{state:"proceeding",proceed:void 0,reset:void 0,location:re}),Ue.then(()=>i.history.go(fe))},reset(){let Je=new Map(k.blockers);Je.set(Ae,vo),q({blockers:Je})}});return}return H(K,re)}),t){PM(e,j);let K=()=>IM(e,j);e.addEventListener("pagehide",K),Y=()=>e.removeEventListener("pagehide",K)}return k.initialized||H("POP",k.location,{initialHydration:!0}),D}function qe(){p&&p(),Y&&Y(),b.clear(),U&&U.abort(),k.fetchers.forEach((K,re)=>At(re)),k.blockers.forEach((K,re)=>er(re))}function z(K){return b.add(K),()=>b.delete(K)}function q(K,re={}){k={...k,...K};let fe=[],Ae=[];k.fetchers.forEach((Ue,Je)=>{Ue.state==="idle"&&(_e.has(Je)?fe.push(Je):Ae.push(Je))}),_e.forEach(Ue=>{!k.fetchers.has(Ue)&&!ge.has(Ue)&&fe.push(Ue)}),[...b].forEach(Ue=>Ue(k,{deletedFetchers:fe,viewTransitionOpts:re.viewTransitionOpts,flushSync:re.flushSync===!0})),fe.forEach(Ue=>At(Ue)),Ae.forEach(Ue=>k.fetchers.delete(Ue))}function X(K,re,{flushSync:fe}={}){var S,L;let Ae=k.actionData!=null&&k.navigation.formMethod!=null&&Zr(k.navigation.formMethod)&&k.navigation.state==="loading"&&((S=K.state)==null?void 0:S._isRedirect)!==!0,Ue;re.actionData?Object.keys(re.actionData).length>0?Ue=re.actionData:Ue=null:Ae?Ue=k.actionData:Ue=null;let Je=re.loaderData?Ib(k.loaderData,re.loaderData,re.matches||[],re.errors):k.loaderData,et=k.blockers;et.size>0&&(et=new Map(et),et.forEach((A,M)=>et.set(M,vo)));let Ye=P===!0||k.navigation.formMethod!=null&&Zr(k.navigation.formMethod)&&((L=K.state)==null?void 0:L._isRedirect)!==!0;o&&(s=o,o=void 0),Z||V==="POP"||(V==="PUSH"?i.history.push(K,K.state):V==="REPLACE"&&i.history.replace(K,K.state));let Ke;if(V==="POP"){let A=j.get(k.location.pathname);A&&A.has(K.pathname)?Ke={currentLocation:k.location,nextLocation:K}:j.has(K.pathname)&&(Ke={currentLocation:K,nextLocation:k.location})}else if(N){let A=j.get(k.location.pathname);A?A.add(K.pathname):(A=new Set([K.pathname]),j.set(k.location.pathname,A)),Ke={currentLocation:k.location,nextLocation:K}}q({...re,actionData:Ue,loaderData:Je,historyAction:V,location:K,initialized:!0,navigation:e0,revalidation:"idle",restoreScrollPosition:da(K,re.matches||k.matches),preventScrollReset:Ye,blockers:et},{viewTransitionOpts:Ke,flushSync:fe===!0}),V="POP",P=!1,N=!1,Z=!1,ce=!1,Ne==null||Ne.resolve(),Ne=null}async function W(K,re){if(typeof K=="number"){i.history.go(K);return}let fe=b0(k.location,k.matches,u,K,re==null?void 0:re.fromRouteId,re==null?void 0:re.relative),{path:Ae,submission:Ue,error:Je}=Fb(!1,fe,re),et=k.location,Ye=iu(k.location,Ae,re&&re.state);Ye={...Ye,...i.history.encodeLocation(Ye)};let Ke=re&&re.replace!=null?re.replace:void 0,S="PUSH";Ke===!0?S="REPLACE":Ke===!1||Ue!=null&&Zr(Ue.formMethod)&&Ue.formAction===k.location.pathname+k.location.search&&(S="REPLACE");let L=re&&"preventScrollReset"in re?re.preventScrollReset===!0:void 0,A=(re&&re.flushSync)===!0,M=ri({currentLocation:et,nextLocation:Ye,historyAction:S});if(M){ii(M,{state:"blocked",location:Ye,proceed(){ii(M,{state:"proceeding",proceed:void 0,reset:void 0,location:Ye}),W(K,re)},reset(){let B=new Map(k.blockers);B.set(M,vo),q({blockers:B})}});return}await H(S,Ye,{submission:Ue,pendingError:Je,preventScrollReset:L,replace:re&&re.replace,enableViewTransition:re&&re.viewTransition,flushSync:A})}function we(){Ne||(Ne=UM()),rt(),q({revalidation:"loading"});let K=Ne.promise;return k.navigation.state==="submitting"?K:k.navigation.state==="idle"?(H(k.historyAction,k.location,{startUninterruptedRevalidation:!0}),K):(H(V||k.historyAction,k.navigation.location,{overrideNavigation:k.navigation,enableViewTransition:N===!0}),K)}async function H(K,re,fe){U&&U.abort(),U=null,V=K,Z=(fe&&fe.startUninterruptedRevalidation)===!0,Ga(k.location,k.matches),P=(fe&&fe.preventScrollReset)===!0,N=(fe&&fe.enableViewTransition)===!0;let Ae=o||s,Ue=fe&&fe.overrideNavigation,Je=fe!=null&&fe.initialHydration&&k.matches&&k.matches.length>0&&!w?k.matches:En(Ae,re,u),et=(fe&&fe.flushSync)===!0;if(Je&&k.initialized&&!ce&&LM(k.location,re)&&!(fe&&fe.submission&&Zr(fe.submission.formMethod))){X(re,{matches:Je},{flushSync:et});return}let Ye=Ri(Je,Ae,re.pathname);if(Ye.active&&Ye.matches&&(Je=Ye.matches),!Je){let{error:te,notFoundMatches:oe,route:ee}=Va(re.pathname);X(re,{matches:oe,loaderData:{},errors:{[ee.id]:te}},{flushSync:et});return}U=new AbortController;let Ke=rl(i.history,re,U.signal,fe&&fe.submission),S=new Ab(i.unstable_getContext?await i.unstable_getContext():void 0),L;if(fe&&fe.pendingError)L=[rs(Je).route.id,{type:"error",error:fe.pendingError}];else if(fe&&fe.submission&&Zr(fe.submission.formMethod)){let te=await ze(Ke,re,fe.submission,Je,S,Ye.active,{replace:fe.replace,flushSync:et});if(te.shortCircuited)return;if(te.pendingActionResult){let[oe,ee]=te.pendingActionResult;if(mr(ee)&&xl(ee.error)&&ee.error.status===404){U=null,X(re,{matches:te.matches,loaderData:{},errors:{[oe]:ee.error}});return}}Je=te.matches||Je,L=te.pendingActionResult,Ue=t0(re,fe.submission),et=!1,Ye.active=!1,Ke=rl(i.history,Ke.url,Ke.signal)}let{shortCircuited:A,matches:M,loaderData:B,errors:I}=await He(Ke,re,Je,S,Ye.active,Ue,fe&&fe.submission,fe&&fe.fetcherSubmission,fe&&fe.replace,fe&&fe.initialHydration===!0,et,L);A||(U=null,X(re,{matches:M||Je,...Ub(L),loaderData:B,errors:I}))}async function ze(K,re,fe,Ae,Ue,Je,et={}){rt();let Ye=zM(re,fe);if(q({navigation:Ye},{flushSync:et.flushSync===!0}),Je){let L=await Wr(Ae,re.pathname,K.signal);if(L.type==="aborted")return{shortCircuited:!0};if(L.type==="error"){let A=rs(L.partialMatches).route.id;return{matches:L.partialMatches,pendingActionResult:[A,{type:"error",error:L.error}]}}else if(L.matches)Ae=L.matches;else{let{notFoundMatches:A,error:M,route:B}=Va(re.pathname);return{matches:A,pendingActionResult:[B.id,{type:"error",error:M}]}}}let Ke,S=So(Ae,re);if(!S.route.action&&!S.route.lazy)Ke={type:"error",error:Hr(405,{method:K.method,pathname:re.pathname,routeId:S.route.id})};else{let L=await Lt("action",K,[S],Ae,Ue,null);if(Ke=L[S.route.id],!Ke){for(let A of Ae)if(L[A.route.id]){Ke=L[A.route.id];break}}if(K.signal.aborted)return{shortCircuited:!0}}if(ls(Ke)){let L;return et&&et.replace!=null?L=et.replace:L=zb(Ke.response.headers.get("Location"),new URL(K.url),u)===k.location.pathname+k.location.search,await ht(K,Ke,!0,{submission:fe,replace:L}),{shortCircuited:!0}}if(mr(Ke)){let L=rs(Ae,S.route.id);return(et&&et.replace)!==!0&&(V="PUSH"),{matches:Ae,pendingActionResult:[L.route.id,Ke]}}return{matches:Ae,pendingActionResult:[S.route.id,Ke]}}async function He(K,re,fe,Ae,Ue,Je,et,Ye,Ke,S,L,A){let M=Je||t0(re,et),B=et||Ye||Wb(M),I=!Z&&!S;if(Ue){if(I){let ut=De(A);q({navigation:M,...ut!==void 0?{actionData:ut}:{}},{flushSync:L})}let Ze=await Wr(fe,re.pathname,K.signal);if(Ze.type==="aborted")return{shortCircuited:!0};if(Ze.type==="error"){let ut=rs(Ze.partialMatches).route.id;return{matches:Ze.partialMatches,loaderData:{},errors:{[ut]:Ze.error}}}else if(Ze.matches)fe=Ze.matches;else{let{error:ut,notFoundMatches:li,route:lr}=Va(re.pathname);return{matches:li,loaderData:{},errors:{[lr.id]:ut}}}}let te=o||s,[oe,ee]=Ob(i.history,k,fe,B,re,S===!0,ce,Le,_e,F,Me,te,u,A);if(de=++me,oe.length===0&&ee.length===0){let Ze=bt();return X(re,{matches:fe,loaderData:{},errors:A&&mr(A[1])?{[A[0]]:A[1].error}:null,...Ub(A),...Ze?{fetchers:new Map(k.fetchers)}:{}},{flushSync:L}),{shortCircuited:!0}}if(I){let Ze={};if(!Ue){Ze.navigation=M;let ut=De(A);ut!==void 0&&(Ze.actionData=ut)}ee.length>0&&(Ze.fetchers=Xe(ee)),q(Ze,{flushSync:L})}ee.forEach(Ze=>{Xt(Ze.key),Ze.controller&&ge.set(Ze.key,Ze.controller)});let ae=()=>ee.forEach(Ze=>Xt(Ze.key));U&&U.signal.addEventListener("abort",ae);let{loaderResults:se,fetcherResults:Ce}=await Ve(fe,oe,ee,K,Ae);if(K.signal.aborted)return{shortCircuited:!0};U&&U.signal.removeEventListener("abort",ae),ee.forEach(Ze=>ge.delete(Ze.key));let ke=Oc(se);if(ke)return await ht(K,ke.result,!0,{replace:Ke}),{shortCircuited:!0};if(ke=Oc(Ce),ke)return Me.add(ke.key),await ht(K,ke.result,!0,{replace:Ke}),{shortCircuited:!0};let{loaderData:Pe,errors:Se}=Pb(k,fe,se,A,ee,Ce);S&&k.errors&&(Se={...k.errors,...Se});let Te=bt(),it=zt(de),Ft=Te||it||ee.length>0;return{matches:fe,loaderData:Pe,errors:Se,...Ft?{fetchers:new Map(k.fetchers)}:{}}}function De(K){if(K&&!mr(K[1]))return{[K[0]]:K[1].data};if(k.actionData)return Object.keys(k.actionData).length===0?null:k.actionData}function Xe(K){return K.forEach(re=>{let fe=k.fetchers.get(re.key),Ae=bo(void 0,fe?fe.data:void 0);k.fetchers.set(re.key,Ae)}),new Map(k.fetchers)}async function We(K,re,fe,Ae){Xt(K);let Ue=(Ae&&Ae.flushSync)===!0,Je=o||s,et=b0(k.location,k.matches,u,fe,re,Ae==null?void 0:Ae.relative),Ye=En(Je,et,u),Ke=Ri(Ye,Je,et);if(Ke.active&&Ke.matches&&(Ye=Ke.matches),!Ye){jt(K,re,Hr(404,{pathname:et}),{flushSync:Ue});return}let{path:S,submission:L,error:A}=Fb(!0,et,Ae);if(A){jt(K,re,A,{flushSync:Ue});return}let M=So(Ye,S),B=new Ab(i.unstable_getContext?await i.unstable_getContext():void 0),I=(Ae&&Ae.preventScrollReset)===!0;if(L&&Zr(L.formMethod)){await tt(K,re,S,M,Ye,B,Ke.active,Ue,I,L);return}F.set(K,{routeId:re,path:S}),await vt(K,re,S,M,Ye,B,Ke.active,Ue,I,L)}async function tt(K,re,fe,Ae,Ue,Je,et,Ye,Ke,S){rt(),F.delete(K);function L(Ht){if(!Ht.route.action&&!Ht.route.lazy){let ki=Hr(405,{method:S.formMethod,pathname:fe,routeId:re});return jt(K,re,ki,{flushSync:Ye}),!0}return!1}if(!et&&L(Ae))return;let A=k.fetchers.get(K);Fe(K,HM(S,A),{flushSync:Ye});let M=new AbortController,B=rl(i.history,fe,M.signal,S);if(et){let Ht=await Wr(Ue,fe,B.signal,K);if(Ht.type==="aborted")return;if(Ht.type==="error"){jt(K,re,Ht.error,{flushSync:Ye});return}else if(Ht.matches){if(Ue=Ht.matches,Ae=So(Ue,fe),L(Ae))return}else{jt(K,re,Hr(404,{pathname:fe}),{flushSync:Ye});return}}ge.set(K,M);let I=me,oe=(await Lt("action",B,[Ae],Ue,Je,K))[Ae.route.id];if(B.signal.aborted){ge.get(K)===M&&ge.delete(K);return}if(_e.has(K)){if(ls(oe)||mr(oe)){Fe(K,pn(void 0));return}}else{if(ls(oe))if(ge.delete(K),de>I){Fe(K,pn(void 0));return}else return Me.add(K),Fe(K,bo(S)),ht(B,oe,!1,{fetcherSubmission:S,preventScrollReset:Ke});if(mr(oe)){jt(K,re,oe.error);return}}let ee=k.navigation.location||k.location,ae=rl(i.history,ee,M.signal),se=o||s,Ce=k.navigation.state!=="idle"?En(se,k.navigation.location,u):k.matches;_t(Ce,"Didn't find any matches after fetcher action");let ke=++me;ve.set(K,ke);let Pe=bo(S,oe.data);k.fetchers.set(K,Pe);let[Se,Te]=Ob(i.history,k,Ce,S,ee,!1,ce,Le,_e,F,Me,se,u,[Ae.route.id,oe]);Te.filter(Ht=>Ht.key!==K).forEach(Ht=>{let ki=Ht.key,Wa=k.fetchers.get(ki),Hi=bo(void 0,Wa?Wa.data:void 0);k.fetchers.set(ki,Hi),Xt(ki),Ht.controller&&ge.set(ki,Ht.controller)}),q({fetchers:new Map(k.fetchers)});let it=()=>Te.forEach(Ht=>Xt(Ht.key));M.signal.addEventListener("abort",it);let{loaderResults:Ft,fetcherResults:Ze}=await Ve(Ce,Se,Te,ae,Je);if(M.signal.aborted)return;M.signal.removeEventListener("abort",it),ve.delete(K),ge.delete(K),Te.forEach(Ht=>ge.delete(Ht.key));let ut=Oc(Ft);if(ut)return ht(ae,ut.result,!1,{preventScrollReset:Ke});if(ut=Oc(Ze),ut)return Me.add(ut.key),ht(ae,ut.result,!1,{preventScrollReset:Ke});let{loaderData:li,errors:lr}=Pb(k,Ce,Ft,void 0,Te,Ze);if(k.fetchers.has(K)){let Ht=pn(oe.data);k.fetchers.set(K,Ht)}zt(ke),k.navigation.state==="loading"&&ke>de?(_t(V,"Expected pending action"),U&&U.abort(),X(k.navigation.location,{matches:Ce,loaderData:li,errors:lr,fetchers:new Map(k.fetchers)})):(q({errors:lr,loaderData:Ib(k.loaderData,li,Ce,lr),fetchers:new Map(k.fetchers)}),ce=!1)}async function vt(K,re,fe,Ae,Ue,Je,et,Ye,Ke,S){let L=k.fetchers.get(K);Fe(K,bo(S,L?L.data:void 0),{flushSync:Ye});let A=new AbortController,M=rl(i.history,fe,A.signal);if(et){let oe=await Wr(Ue,fe,M.signal,K);if(oe.type==="aborted")return;if(oe.type==="error"){jt(K,re,oe.error,{flushSync:Ye});return}else if(oe.matches)Ue=oe.matches,Ae=So(Ue,fe);else{jt(K,re,Hr(404,{pathname:fe}),{flushSync:Ye});return}}ge.set(K,A);let B=me,te=(await Lt("loader",M,[Ae],Ue,Je,K))[Ae.route.id];if(ge.get(K)===A&&ge.delete(K),!M.signal.aborted){if(_e.has(K)){Fe(K,pn(void 0));return}if(ls(te))if(de>B){Fe(K,pn(void 0));return}else{Me.add(K),await ht(M,te,!1,{preventScrollReset:Ke});return}if(mr(te)){jt(K,re,te.error);return}Fe(K,pn(te.data))}}async function ht(K,re,fe,{submission:Ae,fetcherSubmission:Ue,preventScrollReset:Je,replace:et}={}){re.response.headers.has("X-Remix-Revalidate")&&(ce=!0);let Ye=re.response.headers.get("Location");_t(Ye,"Expected a Location header on the redirect Response"),Ye=zb(Ye,new URL(K.url),u);let Ke=iu(k.location,Ye,{_isRedirect:!0});if(t){let I=!1;if(re.response.headers.has("X-Remix-Reload-Document"))I=!0;else if(_p.test(Ye)){const te=i.history.createURL(Ye);I=te.origin!==e.location.origin||Ur(te.pathname,u)==null}if(I){et?e.location.replace(Ye):e.location.assign(Ye);return}}U=null;let S=et===!0||re.response.headers.has("X-Remix-Replace")?"REPLACE":"PUSH",{formMethod:L,formAction:A,formEncType:M}=k.navigation;!Ae&&!Ue&&L&&A&&M&&(Ae=Wb(k.navigation));let B=Ae||Ue;if(xM.has(re.response.status)&&B&&Zr(B.formMethod))await H(S,Ke,{submission:{...B,formAction:Ye},preventScrollReset:Je||P,enableViewTransition:fe?N:void 0});else{let I=t0(Ke,Ae);await H(S,Ke,{overrideNavigation:I,fetcherSubmission:Ue,preventScrollReset:Je||P,enableViewTransition:fe?N:void 0})}}async function Lt(K,re,fe,Ae,Ue,Je){let et,Ye={};try{et=await AM(h,K,re,fe,Ae,Je,a,r,Ue,d.unstable_middleware)}catch(Ke){return fe.forEach(S=>{Ye[S.route.id]={type:"error",error:Ke}}),Ye}for(let[Ke,S]of Object.entries(et))if(NM(S)){let L=S.result;Ye[Ke]={type:"redirect",response:MM(L,re,Ke,Ae,u)}}else Ye[Ke]=await FM(S);return Ye}async function Ve(K,re,fe,Ae,Ue){let Je=Lt("loader",Ae,re,K,Ue,null),et=Promise.all(fe.map(async S=>{if(S.matches&&S.match&&S.controller){let A=(await Lt("loader",rl(i.history,S.path,S.controller.signal),[S.match],S.matches,Ue,S.key))[S.match.route.id];return{[S.key]:A}}else return Promise.resolve({[S.key]:{type:"error",error:Hr(404,{pathname:S.path})}})})),Ye=await Je,Ke=(await et).reduce((S,L)=>Object.assign(S,L),{});return{loaderResults:Ye,fetcherResults:Ke}}function rt(){ce=!0,F.forEach((K,re)=>{ge.has(re)&&Le.add(re),Xt(re)})}function Fe(K,re,fe={}){k.fetchers.set(K,re),q({fetchers:new Map(k.fetchers)},{flushSync:(fe&&fe.flushSync)===!0})}function jt(K,re,fe,Ae={}){let Ue=rs(k.matches,re);At(K),q({errors:{[Ue.route.id]:fe},fetchers:new Map(k.fetchers)},{flushSync:(Ae&&Ae.flushSync)===!0})}function ti(K){return he.set(K,(he.get(K)||0)+1),_e.has(K)&&_e.delete(K),k.fetchers.get(K)||wM}function At(K){let re=k.fetchers.get(K);ge.has(K)&&!(re&&re.state==="loading"&&ve.has(K))&&Xt(K),F.delete(K),ve.delete(K),Me.delete(K),_e.delete(K),Le.delete(K),k.fetchers.delete(K)}function qi(K){let re=(he.get(K)||0)-1;re<=0?(he.delete(K),_e.add(K)):he.set(K,re),q({fetchers:new Map(k.fetchers)})}function Xt(K){let re=ge.get(K);re&&(re.abort(),ge.delete(K))}function Ie(K){for(let re of K){let fe=ti(re),Ae=pn(fe.data);k.fetchers.set(re,Ae)}}function bt(){let K=[],re=!1;for(let fe of Me){let Ae=k.fetchers.get(fe);_t(Ae,`Expected fetcher: ${fe}`),Ae.state==="loading"&&(Me.delete(fe),K.push(fe),re=!0)}return Ie(K),re}function zt(K){let re=[];for(let[fe,Ae]of ve)if(Ae<K){let Ue=k.fetchers.get(fe);_t(Ue,`Expected fetcher: ${fe}`),Ue.state==="loading"&&(Xt(fe),ve.delete(fe),re.push(fe))}return Ie(re),re.length>0}function xt(K,re){let fe=k.blockers.get(K)||vo;return ye.get(K)!==re&&ye.set(K,re),fe}function er(K){k.blockers.delete(K),ye.delete(K)}function ii(K,re){let fe=k.blockers.get(K)||vo;_t(fe.state==="unblocked"&&re.state==="blocked"||fe.state==="blocked"&&re.state==="blocked"||fe.state==="blocked"&&re.state==="proceeding"||fe.state==="blocked"&&re.state==="unblocked"||fe.state==="proceeding"&&re.state==="unblocked",`Invalid blocker state transition: ${fe.state} -> ${re.state}`);let Ae=new Map(k.blockers);Ae.set(K,re),q({blockers:Ae})}function ri({currentLocation:K,nextLocation:re,historyAction:fe}){if(ye.size===0)return;ye.size>1&&Si(!1,"A router only supports one blocker at a time");let Ae=Array.from(ye.entries()),[Ue,Je]=Ae[Ae.length-1],et=k.blockers.get(Ue);if(!(et&&et.state==="proceeding")&&Je({currentLocation:K,nextLocation:re,historyAction:fe}))return Ue}function Va(K){let re=Hr(404,{pathname:K}),fe=o||s,{matches:Ae,route:Ue}=Vb(fe);return{notFoundMatches:Ae,route:Ue,error:re}}function Ts(K,re,fe){if(g=K,y=re,v=fe||null,!C&&k.navigation===e0){C=!0;let Ae=da(k.location,k.matches);Ae!=null&&q({restoreScrollPosition:Ae})}return()=>{g=null,y=null,v=null}}function Ln(K,re){return v&&v(K,re.map(Ae=>ZF(Ae,k.loaderData)))||K.key}function Ga(K,re){if(g&&y){let fe=Ln(K,re);g[fe]=y()}}function da(K,re){if(g){let fe=Ln(K,re),Ae=g[fe];if(typeof Ae=="number")return Ae}return null}function Ri(K,re,fe){if(i.patchRoutesOnNavigation)if(K){if(Object.keys(K[0].params).length>0)return{active:!0,matches:Nc(re,fe,u,!0)}}else return{active:!0,matches:Nc(re,fe,u,!0)||[]};return{active:!1,matches:null}}async function Wr(K,re,fe,Ae){if(!i.patchRoutesOnNavigation)return{type:"success",matches:K};let Ue=K;for(;;){let Je=o==null,et=o||s,Ye=a;try{await i.patchRoutesOnNavigation({signal:fe,path:re,matches:Ue,fetcherKey:Ae,patch:(L,A)=>{fe.aborted||Nb(L,A,et,Ye,r)}})}catch(L){return{type:"error",error:L,partialMatches:Ue}}finally{Je&&!fe.aborted&&(s=[...s])}if(fe.aborted)return{type:"aborted"};let Ke=En(et,re,u);if(Ke)return{type:"success",matches:Ke};let S=Nc(et,re,u,!0);if(!S||Ue.length===S.length&&Ue.every((L,A)=>L.route.id===S[A].route.id))return{type:"success",matches:null};Ue=S}}function pa(K){a={},o=ih(K,r,void 0,a)}function yl(K,re){let fe=o==null;Nb(K,re,o||s,a,r),fe&&(s=[...s],q({}))}return D={get basename(){return u},get future(){return d},get state(){return k},get routes(){return s},get window(){return e},initialize:Oe,subscribe:z,enableScrollRestoration:Ts,navigate:W,fetch:We,revalidate:we,createHref:K=>i.history.createHref(K),encodeLocation:K=>i.history.encodeLocation(K),getFetcher:ti,deleteFetcher:qi,dispose:qe,getBlocker:xt,deleteBlocker:er,patchRoutes:yl,_internalFetchControllers:ge,_internalSetRoutes:pa},D}function CM(i){return i!=null&&("formData"in i&&i.formData!=null||"body"in i&&i.body!==void 0)}function b0(i,e,t,r,a,s){let o,u;if(a){o=[];for(let d of e)if(o.push(d),d.route.id===a){u=d;break}}else o=e,u=e[e.length-1];let h=Tp(r||".",Cp(o),Ur(i.pathname,t)||i.pathname,s==="path");if(r==null&&(h.search=i.search,h.hash=i.hash),(r==null||r===""||r===".")&&u){let d=Sp(h.search);if(u.route.index&&!d)h.search=h.search?h.search.replace(/^\?/,"?index&"):"?index";else if(!u.route.index&&d){let p=new URLSearchParams(h.search),b=p.getAll("index");p.delete("index"),b.filter(v=>v).forEach(v=>p.append("index",v));let g=p.toString();h.search=g?`?${g}`:""}}return t!=="/"&&(h.pathname=h.pathname==="/"?t:ca([t,h.pathname])),An(h)}function Fb(i,e,t){if(!t||!CM(t))return{path:e};if(t.formMethod&&!BM(t.formMethod))return{path:e,error:Hr(405,{method:t.formMethod})};let r=()=>({path:e,error:Hr(400,{type:"invalid-body"})}),s=(t.formMethod||"get").toUpperCase(),o=cy(e);if(t.body!==void 0){if(t.formEncType==="text/plain"){if(!Zr(s))return r();let b=typeof t.body=="string"?t.body:t.body instanceof FormData||t.body instanceof URLSearchParams?Array.from(t.body.entries()).reduce((g,[v,y])=>`${g}${v}=${y}
`,""):String(t.body);return{path:e,submission:{formMethod:s,formAction:o,formEncType:t.formEncType,formData:void 0,json:void 0,text:b}}}else if(t.formEncType==="application/json"){if(!Zr(s))return r();try{let b=typeof t.body=="string"?JSON.parse(t.body):t.body;return{path:e,submission:{formMethod:s,formAction:o,formEncType:t.formEncType,formData:void 0,json:b,text:void 0}}}catch{return r()}}}_t(typeof FormData=="function","FormData is not available in this environment");let u,h;if(t.formData)u=y0(t.formData),h=t.formData;else if(t.body instanceof FormData)u=y0(t.body),h=t.body;else if(t.body instanceof URLSearchParams)u=t.body,h=Hb(u);else if(t.body==null)u=new URLSearchParams,h=new FormData;else try{u=new URLSearchParams(t.body),h=Hb(u)}catch{return r()}let d={formMethod:s,formAction:o,formEncType:t&&t.formEncType||"application/x-www-form-urlencoded",formData:h,json:void 0,text:void 0};if(Zr(d.formMethod))return{path:e,submission:d};let p=Mn(e);return i&&p.search&&Sp(p.search)&&u.append("index",""),p.search=`?${u}`,{path:An(p),submission:d}}function Mb(i,e,t=!1){let r=i.findIndex(a=>a.route.id===e);return r>=0?i.slice(0,t?r+1:r):i}function Ob(i,e,t,r,a,s,o,u,h,d,p,b,g,v){let y=v?mr(v[1])?v[1].error:v[1].data:void 0,C=i.createURL(e.location),E=i.createURL(a),w=t;s&&e.errors?w=Mb(t,Object.keys(e.errors)[0],!0):v&&mr(v[1])&&(w=Mb(t,v[0]));let R=v?v[1].statusCode:void 0,T=R&&R>=400,D=w.filter((V,P)=>{let{route:U}=V;if(U.lazy)return!0;if(U.loader==null)return!1;if(s)return x0(U,e.loaderData,e.errors);if(TM(e.loaderData,e.matches[P],V))return!0;let N=e.matches[P],j=V;return Lb(V,{currentUrl:C,currentParams:N.params,nextUrl:E,nextParams:j.params,...r,actionResult:y,actionStatus:R,defaultShouldRevalidate:T?!1:o||C.pathname+C.search===E.pathname+E.search||C.search!==E.search||_M(N,j)})}),k=[];return d.forEach((V,P)=>{if(s||!t.some(Z=>Z.route.id===V.routeId)||h.has(P))return;let U=En(b,V.path,g);if(!U){k.push({key:P,routeId:V.routeId,path:V.path,matches:null,match:null,controller:null});return}let N=e.fetchers.get(P),j=So(U,V.path),Y=!1;p.has(P)?Y=!1:u.has(P)?(u.delete(P),Y=!0):N&&N.state!=="idle"&&N.data===void 0?Y=o:Y=Lb(j,{currentUrl:C,currentParams:e.matches[e.matches.length-1].params,nextUrl:E,nextParams:t[t.length-1].params,...r,actionResult:y,actionStatus:R,defaultShouldRevalidate:T?!1:o}),Y&&k.push({key:P,routeId:V.routeId,path:V.path,matches:U,match:j,controller:new AbortController})}),[D,k]}function x0(i,e,t){if(i.lazy)return!0;if(!i.loader)return!1;let r=e!=null&&e[i.id]!==void 0,a=t!=null&&t[i.id]!==void 0;return!r&&a?!1:typeof i.loader=="function"&&i.loader.hydrate===!0?!0:!r&&!a}function TM(i,e,t){let r=!e||t.route.id!==e.route.id,a=!i.hasOwnProperty(t.route.id);return r||a}function _M(i,e){let t=i.route.path;return i.pathname!==e.pathname||t!=null&&t.endsWith("*")&&i.params["*"]!==e.params["*"]}function Lb(i,e){if(i.route.shouldRevalidate){let t=i.route.shouldRevalidate(e);if(typeof t=="boolean")return t}return e.defaultShouldRevalidate}function Nb(i,e,t,r,a){let s;if(i){let h=r[i];_t(h,`No route found to patch children into: routeId = ${i}`),h.children||(h.children=[]),s=h.children}else s=t;let o=e.filter(h=>!s.some(d=>oy(h,d))),u=ih(o,a,[i||"_","patch",String((s==null?void 0:s.length)||"0")],r);s.push(...u)}function oy(i,e){return"id"in i&&"id"in e&&i.id===e.id?!0:i.index===e.index&&i.path===e.path&&i.caseSensitive===e.caseSensitive?(!i.children||i.children.length===0)&&(!e.children||e.children.length===0)?!0:i.children.every((t,r)=>{var a;return(a=e.children)==null?void 0:a.some(s=>oy(t,s))}):!1}async function SM(i,e,t){if(!i.lazy)return;let r=await i.lazy();if(!i.lazy)return;let a=t[i.id];_t(a,"No route found in manifest");let s={};for(let o in r){let h=a[o]!==void 0&&o!=="hasErrorBoundary";Si(!h,`Route "${a.id}" has a static property "${o}" defined but its lazy function is also returning a value for this property. The lazy route property "${o}" will be ignored.`),!h&&!KF.has(o)&&(s[o]=r[o])}Object.assign(a,s),Object.assign(a,{...e(a),lazy:void 0})}async function Bb(i){let e=i.matches.filter(a=>a.shouldLoad),t={};return(await Promise.all(e.map(a=>a.resolve()))).forEach((a,s)=>{t[e[s].route.id]=a}),t}async function RM(i){return i.matches.some(e=>e.route.unstable_middleware)?kM(i,!1,()=>Bb(i),e=>({[e.routeId]:{type:"error",result:e.error}})):Bb(i)}async function kM(i,e,t,r){let{matches:a,request:s,params:o,context:u}=i,h={handlerResult:void 0,propagateResult:e};try{let d=a.flatMap(b=>b.route.unstable_middleware?b.route.unstable_middleware.map(g=>[b.route.id,g]):[]),p=await uy({request:s,params:o,context:u},d,h,t);return h.propagateResult?p:h.handlerResult}catch(d){if(!(d instanceof w0))throw d;let p=await r(d);return h.handlerResult?Object.assign(h.handlerResult,p):p}}var w0=class{constructor(i,e){this.routeId=i,this.error=e}};async function uy(i,e,t,r,a=0){let{request:s}=i;if(s.signal.aborted)throw s.signal.reason?s.signal.reason:new Error(`Request aborted without an \`AbortSignal.reason\`: ${s.method} ${s.url}`);let o=e[a];if(!o)return t.handlerResult=await r(),t.handlerResult;let[u,h]=o,d=!1,p,b=async()=>{if(d)throw new Error("You may only call `next()` once per middleware");d=!0;let g=await uy(i,e,t,r,a+1);if(t.propagateResult)return p=g,p};try{let g=await h({request:i.request,params:i.params,context:i.context},b);return d?g===void 0?p:g:b()}catch(g){throw g instanceof w0?g:new w0(u,g)}}async function AM(i,e,t,r,a,s,o,u,h,d){let p=a.map(v=>v.route.lazy?SM(v.route,u,o):void 0);d&&await Promise.all(p);let b=a.map((v,y)=>{let C=p[y],E=r.some(R=>R.route.id===v.route.id);return{...v,shouldLoad:E,resolve:async R=>(R&&t.method==="GET"&&(v.route.lazy||v.route.loader)&&(E=!0),E?DM(e,t,v,C,R,h):Promise.resolve({type:"data",result:void 0}))}}),g=await i({matches:b,request:t,params:a[0].params,fetcherKey:s,context:h});try{await Promise.all(p)}catch{}return g}async function DM(i,e,t,r,a,s){let o,u,h=d=>{let p,b=new Promise((y,C)=>p=C);u=()=>p(),e.signal.addEventListener("abort",u);let g=y=>typeof d!="function"?Promise.reject(new Error(`You cannot call the handler for a route which defines a boolean "${i}" [routeId: ${t.route.id}]`)):d({request:e,params:t.params,context:s},...y!==void 0?[y]:[]),v=(async()=>{try{return{type:"data",result:await(a?a(C=>g(C)):g())}}catch(y){return{type:"error",result:y}}})();return Promise.race([v,b])};try{let d=t.route[i];if(r)if(d){let p,[b]=await Promise.all([h(d).catch(g=>{p=g}),r]);if(p!==void 0)throw p;o=b}else if(await r,d=t.route[i],d)o=await h(d);else if(i==="action"){let p=new URL(e.url),b=p.pathname+p.search;throw Hr(405,{method:e.method,pathname:b,routeId:t.route.id})}else return{type:"data",result:void 0};else if(d)o=await h(d);else{let p=new URL(e.url),b=p.pathname+p.search;throw Hr(404,{pathname:b})}}catch(d){return{type:"error",result:d}}finally{u&&e.signal.removeEventListener("abort",u)}return o}async function FM(i){var r,a,s,o,u,h;let{result:e,type:t}=i;if(hy(e)){let d;try{let p=e.headers.get("Content-Type");p&&/\bapplication\/json\b/.test(p)?e.body==null?d=null:d=await e.json():d=await e.text()}catch(p){return{type:"error",error:p}}return t==="error"?{type:"error",error:new ah(e.status,e.statusText,d),statusCode:e.status,headers:e.headers}:{type:"data",data:d,statusCode:e.status,headers:e.headers}}return t==="error"?Gb(e)?e.data instanceof Error?{type:"error",error:e.data,statusCode:(r=e.init)==null?void 0:r.status,headers:(a=e.init)!=null&&a.headers?new Headers(e.init.headers):void 0}:{type:"error",error:new ah(((s=e.init)==null?void 0:s.status)||500,void 0,e.data),statusCode:xl(e)?e.status:void 0,headers:(o=e.init)!=null&&o.headers?new Headers(e.init.headers):void 0}:{type:"error",error:e,statusCode:xl(e)?e.status:void 0}:Gb(e)?{type:"data",data:e.data,statusCode:(u=e.init)==null?void 0:u.status,headers:(h=e.init)!=null&&h.headers?new Headers(e.init.headers):void 0}:{type:"data",data:e}}function MM(i,e,t,r,a){let s=i.headers.get("Location");if(_t(s,"Redirects returned/thrown from loaders/actions must have a Location header"),!_p.test(s)){let o=r.slice(0,r.findIndex(u=>u.route.id===t)+1);s=b0(new URL(e.url),o,a,s),i.headers.set("Location",s)}return i}function zb(i,e,t){if(_p.test(i)){let r=i,a=r.startsWith("//")?new URL(e.protocol+r):new URL(r),s=Ur(a.pathname,t)!=null;if(a.origin===e.origin&&s)return a.pathname+a.search+a.hash}return i}function rl(i,e,t,r){let a=i.createURL(cy(e)).toString(),s={signal:t};if(r&&Zr(r.formMethod)){let{formMethod:o,formEncType:u}=r;s.method=o.toUpperCase(),u==="application/json"?(s.headers=new Headers({"Content-Type":u}),s.body=JSON.stringify(r.json)):u==="text/plain"?s.body=r.text:u==="application/x-www-form-urlencoded"&&r.formData?s.body=y0(r.formData):s.body=r.formData}return new Request(a,s)}function y0(i){let e=new URLSearchParams;for(let[t,r]of i.entries())e.append(t,typeof r=="string"?r:r.name);return e}function Hb(i){let e=new FormData;for(let[t,r]of i.entries())e.append(t,r);return e}function OM(i,e,t,r=!1,a=!1){let s={},o=null,u,h=!1,d={},p=t&&mr(t[1])?t[1].error:void 0;return i.forEach(b=>{if(!(b.route.id in e))return;let g=b.route.id,v=e[g];if(_t(!ls(v),"Cannot handle redirect results in processLoaderData"),mr(v)){let y=v.error;if(p!==void 0&&(y=p,p=void 0),o=o||{},a)o[g]=y;else{let C=rs(i,g);o[C.route.id]==null&&(o[C.route.id]=y)}r||(s[g]=ly),h||(h=!0,u=xl(v.error)?v.error.status:500),v.headers&&(d[g]=v.headers)}else s[g]=v.data,v.statusCode&&v.statusCode!==200&&!h&&(u=v.statusCode),v.headers&&(d[g]=v.headers)}),p!==void 0&&t&&(o={[t[0]]:p},s[t[0]]=void 0),{loaderData:s,errors:o,statusCode:u||200,loaderHeaders:d}}function Pb(i,e,t,r,a,s){let{loaderData:o,errors:u}=OM(e,t,r);return a.forEach(h=>{let{key:d,match:p,controller:b}=h,g=s[d];if(_t(g,"Did not find corresponding fetcher result"),!(b&&b.signal.aborted))if(mr(g)){let v=rs(i.matches,p==null?void 0:p.route.id);u&&u[v.route.id]||(u={...u,[v.route.id]:g.error}),i.fetchers.delete(d)}else if(ls(g))_t(!1,"Unhandled fetcher revalidation redirect");else{let v=pn(g.data);i.fetchers.set(d,v)}}),{loaderData:o,errors:u}}function Ib(i,e,t,r){let a=Object.entries(e).filter(([,s])=>s!==ly).reduce((s,[o,u])=>(s[o]=u,s),{});for(let s of t){let o=s.route.id;if(!e.hasOwnProperty(o)&&i.hasOwnProperty(o)&&s.route.loader&&(a[o]=i[o]),r&&r.hasOwnProperty(o))break}return a}function Ub(i){return i?mr(i[1])?{actionData:{}}:{actionData:{[i[0]]:i[1].data}}:{}}function rs(i,e){return(e?i.slice(0,i.findIndex(r=>r.route.id===e)+1):[...i]).reverse().find(r=>r.route.hasErrorBoundary===!0)||i[0]}function Vb(i){let e=i.length===1?i[0]:i.find(t=>t.index||!t.path||t.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function Hr(i,{pathname:e,routeId:t,method:r,type:a,message:s}={}){let o="Unknown Server Error",u="Unknown @remix-run/router error";return i===400?(o="Bad Request",r&&e&&t?u=`You made a ${r} request to "${e}" but did not provide a \`loader\` for route "${t}", so there is no way to handle the request.`:a==="invalid-body"&&(u="Unable to encode submission body")):i===403?(o="Forbidden",u=`Route "${t}" does not match URL "${e}"`):i===404?(o="Not Found",u=`No route matches URL "${e}"`):i===405&&(o="Method Not Allowed",r&&e&&t?u=`You made a ${r.toUpperCase()} request to "${e}" but did not provide an \`action\` for route "${t}", so there is no way to handle the request.`:r&&(u=`Invalid request method "${r.toUpperCase()}"`)),new ah(i||500,o,new Error(u),!0)}function Oc(i){let e=Object.entries(i);for(let t=e.length-1;t>=0;t--){let[r,a]=e[t];if(ls(a))return{key:r,result:a}}}function cy(i){let e=typeof i=="string"?Mn(i):i;return An({...e,hash:""})}function LM(i,e){return i.pathname!==e.pathname||i.search!==e.search?!1:i.hash===""?e.hash!=="":i.hash===e.hash?!0:e.hash!==""}function NM(i){return hy(i.result)&&bM.has(i.result.status)}function mr(i){return i.type==="error"}function ls(i){return(i&&i.type)==="redirect"}function Gb(i){return typeof i=="object"&&i!=null&&"type"in i&&"data"in i&&"init"in i&&i.type==="DataWithResponseInit"}function hy(i){return i!=null&&typeof i.status=="number"&&typeof i.statusText=="string"&&typeof i.headers=="object"&&typeof i.body<"u"}function BM(i){return vM.has(i.toUpperCase())}function Zr(i){return mM.has(i.toUpperCase())}function Sp(i){return new URLSearchParams(i).getAll("index").some(e=>e==="")}function So(i,e){let t=typeof e=="string"?Mn(e).search:e.search;if(i[i.length-1].route.index&&Sp(t||""))return i[i.length-1];let r=ay(i);return r[r.length-1]}function Wb(i){let{formMethod:e,formAction:t,formEncType:r,text:a,formData:s,json:o}=i;if(!(!e||!t||!r)){if(a!=null)return{formMethod:e,formAction:t,formEncType:r,formData:void 0,json:void 0,text:a};if(s!=null)return{formMethod:e,formAction:t,formEncType:r,formData:s,json:void 0,text:void 0};if(o!==void 0)return{formMethod:e,formAction:t,formEncType:r,formData:void 0,json:o,text:void 0}}}function t0(i,e){return e?{state:"loading",location:i,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:i,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function zM(i,e){return{state:"submitting",location:i,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function bo(i,e){return i?{state:"loading",formMethod:i.formMethod,formAction:i.formAction,formEncType:i.formEncType,formData:i.formData,json:i.json,text:i.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function HM(i,e){return{state:"submitting",formMethod:i.formMethod,formAction:i.formAction,formEncType:i.formEncType,formData:i.formData,json:i.json,text:i.text,data:e?e.data:void 0}}function pn(i){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:i}}function PM(i,e){try{let t=i.sessionStorage.getItem(sy);if(t){let r=JSON.parse(t);for(let[a,s]of Object.entries(r||{}))s&&Array.isArray(s)&&e.set(a,new Set(s||[]))}}catch{}}function IM(i,e){if(e.size>0){let t={};for(let[r,a]of e)t[r]=[...a];try{i.sessionStorage.setItem(sy,JSON.stringify(t))}catch(r){Si(!1,`Failed to save applied view transitions in sessionStorage (${r}).`)}}}function UM(){let i,e,t=new Promise((r,a)=>{i=async s=>{r(s);try{await t}catch{}},e=async s=>{a(s);try{await t}catch{}}});return{promise:t,resolve:i,reject:e}}var Cs=ne.createContext(null);Cs.displayName="DataRouter";var cu=ne.createContext(null);cu.displayName="DataRouterState";var Rp=ne.createContext({isTransitioning:!1});Rp.displayName="ViewTransition";var fy=ne.createContext(new Map);fy.displayName="Fetchers";var nh=ne.createContext(null);nh.displayName="Await";var ha=ne.createContext(null);ha.displayName="Navigation";var xh=ne.createContext(null);xh.displayName="Location";var fa=ne.createContext({outlet:null,matches:[],isDataRoute:!1});fa.displayName="Route";var kp=ne.createContext(null);kp.displayName="RouteError";function VM(i,{relative:e}={}){_t(hu(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:r}=ne.useContext(ha),{hash:a,pathname:s,search:o}=fu(i,{relative:e}),u=s;return t!=="/"&&(u=s==="/"?t:ca([t,s])),r.createHref({pathname:u,search:o,hash:a})}function hu(){return ne.useContext(xh)!=null}function On(){return _t(hu(),"useLocation() may be used only in the context of a <Router> component."),ne.useContext(xh).location}var dy="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function py(i){ne.useContext(ha).static||ne.useLayoutEffect(i)}function my(){let{isDataRoute:i}=ne.useContext(fa);return i?rO():GM()}function GM(){_t(hu(),"useNavigate() may be used only in the context of a <Router> component.");let i=ne.useContext(Cs),{basename:e,navigator:t}=ne.useContext(ha),{matches:r}=ne.useContext(fa),{pathname:a}=On(),s=JSON.stringify(Cp(r)),o=ne.useRef(!1);return py(()=>{o.current=!0}),ne.useCallback((h,d={})=>{if(Si(o.current,dy),!o.current)return;if(typeof h=="number"){t.go(h);return}let p=Tp(h,JSON.parse(s),a,d.relative==="path");i==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:ca([e,p.pathname])),(d.replace?t.replace:t.push)(p,d.state,d)},[e,t,s,a,i])}var WM=ne.createContext(null);function jM(i){let e=ne.useContext(fa).outlet;return e&&ne.createElement(WM.Provider,{value:i},e)}function fu(i,{relative:e}={}){let{matches:t}=ne.useContext(fa),{pathname:r}=On(),a=JSON.stringify(Cp(t));return ne.useMemo(()=>Tp(i,JSON.parse(a),r,e==="path"),[i,a,r,e])}function XM(i,e,t,r){_t(hu(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a,static:s}=ne.useContext(ha),{matches:o}=ne.useContext(fa),u=o[o.length-1],h=u?u.params:{},d=u?u.pathname:"/",p=u?u.pathnameBase:"/",b=u&&u.route;{let R=b&&b.path||"";by(d,!b||R.endsWith("*")||R.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${R}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${R}"> to <Route path="${R==="/"?"*":`${R}/*`}">.`)}let g=On(),v;v=g;let y=v.pathname||"/",C=y;if(p!=="/"){let R=p.replace(/^\//,"").split("/");C="/"+y.replace(/^\//,"").split("/").slice(R.length).join("/")}let E=!s&&t&&t.matches&&t.matches.length>0?t.matches:En(i,{pathname:C});return Si(b||E!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),Si(E==null||E[E.length-1].route.element!==void 0||E[E.length-1].route.Component!==void 0||E[E.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`),ZM(E&&E.map(R=>Object.assign({},R,{params:Object.assign({},h,R.params),pathname:ca([p,a.encodeLocation?a.encodeLocation(R.pathname).pathname:R.pathname]),pathnameBase:R.pathnameBase==="/"?p:ca([p,a.encodeLocation?a.encodeLocation(R.pathnameBase).pathname:R.pathnameBase])})),o,t,r)}function YM(){let i=vy(),e=xl(i)?`${i.status} ${i.statusText}`:i instanceof Error?i.message:JSON.stringify(i),t=i instanceof Error?i.stack:null,r="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:r},s={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",i),o=ne.createElement(ne.Fragment,null,ne.createElement("p",null," Hey developer "),ne.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",ne.createElement("code",{style:s},"ErrorBoundary")," or"," ",ne.createElement("code",{style:s},"errorElement")," prop on your route.")),ne.createElement(ne.Fragment,null,ne.createElement("h2",null,"Unexpected Application Error!"),ne.createElement("h3",{style:{fontStyle:"italic"}},e),t?ne.createElement("pre",{style:a},t):null,o)}var qM=ne.createElement(YM,null),KM=class extends ne.Component{constructor(i){super(i),this.state={location:i.location,revalidation:i.revalidation,error:i.error}}static getDerivedStateFromError(i){return{error:i}}static getDerivedStateFromProps(i,e){return e.location!==i.location||e.revalidation!=="idle"&&i.revalidation==="idle"?{error:i.error,location:i.location,revalidation:i.revalidation}:{error:i.error!==void 0?i.error:e.error,location:e.location,revalidation:i.revalidation||e.revalidation}}componentDidCatch(i,e){console.error("React Router caught the following error during render",i,e)}render(){return this.state.error!==void 0?ne.createElement(fa.Provider,{value:this.props.routeContext},ne.createElement(kp.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function $M({routeContext:i,match:e,children:t}){let r=ne.useContext(Cs);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),ne.createElement(fa.Provider,{value:i},t)}function ZM(i,e=[],t=null,r=null){if(i==null){if(!t)return null;if(t.errors)i=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)i=t.matches;else return null}let a=i,s=t==null?void 0:t.errors;if(s!=null){let h=a.findIndex(d=>d.route.id&&(s==null?void 0:s[d.route.id])!==void 0);_t(h>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(s).join(",")}`),a=a.slice(0,Math.min(a.length,h+1))}let o=!1,u=-1;if(t)for(let h=0;h<a.length;h++){let d=a[h];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(u=h),d.route.id){let{loaderData:p,errors:b}=t,g=d.route.loader&&!p.hasOwnProperty(d.route.id)&&(!b||b[d.route.id]===void 0);if(d.route.lazy||g){o=!0,u>=0?a=a.slice(0,u+1):a=[a[0]];break}}}return a.reduceRight((h,d,p)=>{let b,g=!1,v=null,y=null;t&&(b=s&&d.route.id?s[d.route.id]:void 0,v=d.route.errorElement||qM,o&&(u<0&&p===0?(by("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),g=!0,y=null):u===p&&(g=!0,y=d.route.hydrateFallbackElement||null)));let C=e.concat(a.slice(0,p+1)),E=()=>{let w;return b?w=v:g?w=y:d.route.Component?w=ne.createElement(d.route.Component,null):d.route.element?w=d.route.element:w=h,ne.createElement($M,{match:d,routeContext:{outlet:h,matches:C,isDataRoute:t!=null},children:w})};return t&&(d.route.ErrorBoundary||d.route.errorElement||p===0)?ne.createElement(KM,{location:t.location,revalidation:t.revalidation,component:v,error:b,children:E(),routeContext:{outlet:null,matches:C,isDataRoute:!0}}):E()},null)}function Ap(i){return`${i} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function QM(i){let e=ne.useContext(Cs);return _t(e,Ap(i)),e}function gy(i){let e=ne.useContext(cu);return _t(e,Ap(i)),e}function JM(i){let e=ne.useContext(fa);return _t(e,Ap(i)),e}function wh(i){let e=JM(i),t=e.matches[e.matches.length-1];return _t(t.route.id,`${i} can only be used on routes that contain a unique "id"`),t.route.id}function eO(){return wh("useRouteId")}function tO(){let i=gy("useLoaderData"),e=wh("useLoaderData");return i.loaderData[e]}function vy(){var r;let i=ne.useContext(kp),e=gy("useRouteError"),t=wh("useRouteError");return i!==void 0?i:(r=e.errors)==null?void 0:r[t]}function iO(){let i=ne.useContext(nh);return i==null?void 0:i._data}function rO(){let{router:i}=QM("useNavigate"),e=wh("useNavigate"),t=ne.useRef(!1);return py(()=>{t.current=!0}),ne.useCallback(async(a,s={})=>{Si(t.current,dy),t.current&&(typeof a=="number"?i.navigate(a):await i.navigate(a,{fromRouteId:e,...s}))},[i,e])}var jb={};function by(i,e,t){!e&&!jb[i]&&(jb[i]=!0,Si(!1,t))}var Xb={};function Yb(i,e){!i&&!Xb[e]&&(Xb[e]=!0,console.warn(e))}function aO(i){let e={hasErrorBoundary:i.hasErrorBoundary||i.ErrorBoundary!=null||i.errorElement!=null};return i.Component&&(i.element&&Si(!1,"You should not include both `Component` and `element` on your route - `Component` will be used."),Object.assign(e,{element:ne.createElement(i.Component),Component:void 0})),i.HydrateFallback&&(i.hydrateFallbackElement&&Si(!1,"You should not include both `HydrateFallback` and `hydrateFallbackElement` on your route - `HydrateFallback` will be used."),Object.assign(e,{hydrateFallbackElement:ne.createElement(i.HydrateFallback),HydrateFallback:void 0})),i.ErrorBoundary&&(i.errorElement&&Si(!1,"You should not include both `ErrorBoundary` and `errorElement` on your route - `ErrorBoundary` will be used."),Object.assign(e,{errorElement:ne.createElement(i.ErrorBoundary),ErrorBoundary:void 0})),e}var nO=class{constructor(){this.status="pending",this.promise=new Promise((i,e)=>{this.resolve=t=>{this.status==="pending"&&(this.status="resolved",i(t))},this.reject=t=>{this.status==="pending"&&(this.status="rejected",e(t))}})}};function sO({router:i,flushSync:e}){let[t,r]=ne.useState(i.state),[a,s]=ne.useState(),[o,u]=ne.useState({isTransitioning:!1}),[h,d]=ne.useState(),[p,b]=ne.useState(),[g,v]=ne.useState(),y=ne.useRef(new Map),C=ne.useCallback((T,{deletedFetchers:D,flushSync:k,viewTransitionOpts:V})=>{T.fetchers.forEach((U,N)=>{U.data!==void 0&&y.current.set(N,U.data)}),D.forEach(U=>y.current.delete(U)),Yb(k===!1||e!=null,'You provided the `flushSync` option to a router update, but you are not using the `<RouterProvider>` from `react-router/dom` so `ReactDOM.flushSync()` is unavailable.  Please update your app to `import { RouterProvider } from "react-router/dom"` and ensure you have `react-dom` installed as a dependency to use the `flushSync` option.');let P=i.window!=null&&i.window.document!=null&&typeof i.window.document.startViewTransition=="function";if(Yb(V==null||P,"You provided the `viewTransition` option to a router update, but you do not appear to be running in a DOM environment as `window.startViewTransition` is not available."),!V||!P){e&&k?e(()=>r(T)):ne.startTransition(()=>r(T));return}if(e&&k){e(()=>{p&&(h&&h.resolve(),p.skipTransition()),u({isTransitioning:!0,flushSync:!0,currentLocation:V.currentLocation,nextLocation:V.nextLocation})});let U=i.window.document.startViewTransition(()=>{e(()=>r(T))});U.finished.finally(()=>{e(()=>{d(void 0),b(void 0),s(void 0),u({isTransitioning:!1})})}),e(()=>b(U));return}p?(h&&h.resolve(),p.skipTransition(),v({state:T,currentLocation:V.currentLocation,nextLocation:V.nextLocation})):(s(T),u({isTransitioning:!0,flushSync:!1,currentLocation:V.currentLocation,nextLocation:V.nextLocation}))},[i.window,e,p,h]);ne.useLayoutEffect(()=>i.subscribe(C),[i,C]),ne.useEffect(()=>{o.isTransitioning&&!o.flushSync&&d(new nO)},[o]),ne.useEffect(()=>{if(h&&a&&i.window){let T=a,D=h.promise,k=i.window.document.startViewTransition(async()=>{ne.startTransition(()=>r(T)),await D});k.finished.finally(()=>{d(void 0),b(void 0),s(void 0),u({isTransitioning:!1})}),b(k)}},[a,h,i.window]),ne.useEffect(()=>{h&&a&&t.location.key===a.location.key&&h.resolve()},[h,p,t.location,a]),ne.useEffect(()=>{!o.isTransitioning&&g&&(s(g.state),u({isTransitioning:!0,flushSync:!1,currentLocation:g.currentLocation,nextLocation:g.nextLocation}),v(void 0))},[o.isTransitioning,g]);let E=ne.useMemo(()=>({createHref:i.createHref,encodeLocation:i.encodeLocation,go:T=>i.navigate(T),push:(T,D,k)=>i.navigate(T,{state:D,preventScrollReset:k==null?void 0:k.preventScrollReset}),replace:(T,D,k)=>i.navigate(T,{replace:!0,state:D,preventScrollReset:k==null?void 0:k.preventScrollReset})}),[i]),w=i.basename||"/",R=ne.useMemo(()=>({router:i,navigator:E,static:!1,basename:w}),[i,E,w]);return ne.createElement(ne.Fragment,null,ne.createElement(Cs.Provider,{value:R},ne.createElement(cu.Provider,{value:t},ne.createElement(fy.Provider,{value:y.current},ne.createElement(Rp.Provider,{value:o},ne.createElement(cO,{basename:w,location:t.location,navigationType:t.historyAction,navigator:E},ne.createElement(lO,{routes:i.routes,future:i.future,state:t})))))),null)}var lO=ne.memo(oO);function oO({routes:i,future:e,state:t}){return XM(i,void 0,t,e)}function uO(i){return jM(i.context)}function cO({basename:i="/",children:e=null,location:t,navigationType:r="POP",navigator:a,static:s=!1}){_t(!hu(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=i.replace(/^\/*/,"/"),u=ne.useMemo(()=>({basename:o,navigator:a,static:s,future:{}}),[o,a,s]);typeof t=="string"&&(t=Mn(t));let{pathname:h="/",search:d="",hash:p="",state:b=null,key:g="default"}=t,v=ne.useMemo(()=>{let y=Ur(h,o);return y==null?null:{location:{pathname:y,search:d,hash:p,state:b,key:g},navigationType:r}},[o,h,d,p,b,g,r]);return Si(v!=null,`<Router basename="${o}"> is not able to match the URL "${h}${d}${p}" because it does not start with the basename, so the <Router> won't render anything.`),v==null?null:ne.createElement(ha.Provider,{value:u},ne.createElement(xh.Provider,{children:e,value:v}))}function hO({children:i,errorElement:e,resolve:t}){return ne.createElement(fO,{resolve:t,errorElement:e},ne.createElement(dO,null,i))}var fO=class extends ne.Component{constructor(i){super(i),this.state={error:null}}static getDerivedStateFromError(i){return{error:i}}componentDidCatch(i,e){console.error("<Await> caught the following error during render",i,e)}render(){let{children:i,errorElement:e,resolve:t}=this.props,r=null,a=0;if(!(t instanceof Promise))a=1,r=Promise.resolve(),Object.defineProperty(r,"_tracked",{get:()=>!0}),Object.defineProperty(r,"_data",{get:()=>t});else if(this.state.error){a=2;let s=this.state.error;r=Promise.reject().catch(()=>{}),Object.defineProperty(r,"_tracked",{get:()=>!0}),Object.defineProperty(r,"_error",{get:()=>s})}else t._tracked?(r=t,a="_error"in r?2:"_data"in r?1:0):(a=0,Object.defineProperty(t,"_tracked",{get:()=>!0}),r=t.then(s=>Object.defineProperty(t,"_data",{get:()=>s}),s=>Object.defineProperty(t,"_error",{get:()=>s})));if(a===2&&!e)throw r._error;if(a===2)return ne.createElement(nh.Provider,{value:r,children:e});if(a===1)return ne.createElement(nh.Provider,{value:r,children:i});throw r}};function dO({children:i}){let e=iO(),t=typeof i=="function"?i(e):i;return ne.createElement(ne.Fragment,null,t)}var Bc="get",zc="application/x-www-form-urlencoded";function yh(i){return i!=null&&typeof i.tagName=="string"}function pO(i){return yh(i)&&i.tagName.toLowerCase()==="button"}function mO(i){return yh(i)&&i.tagName.toLowerCase()==="form"}function gO(i){return yh(i)&&i.tagName.toLowerCase()==="input"}function vO(i){return!!(i.metaKey||i.altKey||i.ctrlKey||i.shiftKey)}function bO(i,e){return i.button===0&&(!e||e==="_self")&&!vO(i)}function E0(i=""){return new URLSearchParams(typeof i=="string"||Array.isArray(i)||i instanceof URLSearchParams?i:Object.keys(i).reduce((e,t)=>{let r=i[t];return e.concat(Array.isArray(r)?r.map(a=>[t,a]):[[t,r]])},[]))}function xO(i,e){let t=E0(i);return e&&e.forEach((r,a)=>{t.has(a)||e.getAll(a).forEach(s=>{t.append(a,s)})}),t}var Lc=null;function wO(){if(Lc===null)try{new FormData(document.createElement("form"),0),Lc=!1}catch{Lc=!0}return Lc}var yO=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function i0(i){return i!=null&&!yO.has(i)?(Si(!1,`"${i}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${zc}"`),null):i}function EO(i,e){let t,r,a,s,o;if(mO(i)){let u=i.getAttribute("action");r=u?Ur(u,e):null,t=i.getAttribute("method")||Bc,a=i0(i.getAttribute("enctype"))||zc,s=new FormData(i)}else if(pO(i)||gO(i)&&(i.type==="submit"||i.type==="image")){let u=i.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let h=i.getAttribute("formaction")||u.getAttribute("action");if(r=h?Ur(h,e):null,t=i.getAttribute("formmethod")||u.getAttribute("method")||Bc,a=i0(i.getAttribute("formenctype"))||i0(u.getAttribute("enctype"))||zc,s=new FormData(u,i),!wO()){let{name:d,type:p,value:b}=i;if(p==="image"){let g=d?`${d}.`:"";s.append(`${g}x`,"0"),s.append(`${g}y`,"0")}else d&&s.append(d,b)}}else{if(yh(i))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Bc,r=null,a=zc,o=i}return s&&a==="text/plain"&&(o=s,s=void 0),{action:r,method:t.toLowerCase(),encType:a,formData:s,body:o}}function Dp(i,e){if(i===!1||i===null||typeof i>"u")throw new Error(e)}async function CO(i,e){if(i.id in e)return e[i.id];try{let t=await import(i.module);return e[i.id]=t,t}catch(t){return console.error(`Error loading route module \`${i.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function TO(i){return i==null?!1:i.href==null?i.rel==="preload"&&typeof i.imageSrcSet=="string"&&typeof i.imageSizes=="string":typeof i.rel=="string"&&typeof i.href=="string"}async function _O(i,e,t){let r=await Promise.all(i.map(async a=>{let s=e.routes[a.route.id];if(s){let o=await CO(s,t);return o.links?o.links():[]}return[]}));return AO(r.flat(1).filter(TO).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function qb(i,e,t,r,a,s){let o=(h,d)=>t[d]?h.route.id!==t[d].route.id:!0,u=(h,d)=>{var p;return t[d].pathname!==h.pathname||((p=t[d].route.path)==null?void 0:p.endsWith("*"))&&t[d].params["*"]!==h.params["*"]};return s==="assets"?e.filter((h,d)=>o(h,d)||u(h,d)):s==="data"?e.filter((h,d)=>{var b;let p=r.routes[h.route.id];if(!p||!p.hasLoader)return!1;if(o(h,d)||u(h,d))return!0;if(h.route.shouldRevalidate){let g=h.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((b=t[0])==null?void 0:b.params)||{},nextUrl:new URL(i,window.origin),nextParams:h.params,defaultShouldRevalidate:!0});if(typeof g=="boolean")return g}return!0}):[]}function SO(i,e,{includeHydrateFallback:t}={}){return RO(i.map(r=>{let a=e.routes[r.route.id];if(!a)return[];let s=[a.module];return a.clientActionModule&&(s=s.concat(a.clientActionModule)),a.clientLoaderModule&&(s=s.concat(a.clientLoaderModule)),t&&a.hydrateFallbackModule&&(s=s.concat(a.hydrateFallbackModule)),a.imports&&(s=s.concat(a.imports)),s}).flat(1))}function RO(i){return[...new Set(i)]}function kO(i){let e={},t=Object.keys(i).sort();for(let r of t)e[r]=i[r];return e}function AO(i,e){let t=new Set;return new Set(e),i.reduce((r,a)=>{let s=JSON.stringify(kO(a));return t.has(s)||(t.add(s),r.push({key:s,link:a})),r},[])}function DO(i,e){let t=typeof i=="string"?new URL(i,typeof window>"u"?"server://singlefetch/":window.location.origin):i;return t.pathname==="/"?t.pathname="_root.data":e&&Ur(t.pathname,e)==="/"?t.pathname=`${e.replace(/\/$/,"")}/_root.data`:t.pathname=`${t.pathname.replace(/\/$/,"")}.data`,t}function xy(){let i=ne.useContext(Cs);return Dp(i,"You must render this element inside a <DataRouterContext.Provider> element"),i}function FO(){let i=ne.useContext(cu);return Dp(i,"You must render this element inside a <DataRouterStateContext.Provider> element"),i}var Fp=ne.createContext(void 0);Fp.displayName="FrameworkContext";function wy(){let i=ne.useContext(Fp);return Dp(i,"You must render this element inside a <HydratedRouter> element"),i}function MO(i,e){let t=ne.useContext(Fp),[r,a]=ne.useState(!1),[s,o]=ne.useState(!1),{onFocus:u,onBlur:h,onMouseEnter:d,onMouseLeave:p,onTouchStart:b}=e,g=ne.useRef(null);ne.useEffect(()=>{if(i==="render"&&o(!0),i==="viewport"){let C=w=>{w.forEach(R=>{o(R.isIntersecting)})},E=new IntersectionObserver(C,{threshold:.5});return g.current&&E.observe(g.current),()=>{E.disconnect()}}},[i]),ne.useEffect(()=>{if(r){let C=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(C)}}},[r]);let v=()=>{a(!0)},y=()=>{a(!1),o(!1)};return t?i!=="intent"?[s,g,{}]:[s,g,{onFocus:xo(u,v),onBlur:xo(h,y),onMouseEnter:xo(d,v),onMouseLeave:xo(p,y),onTouchStart:xo(b,v)}]:[!1,g,{}]}function xo(i,e){return t=>{i&&i(t),t.defaultPrevented||e(t)}}function OO({page:i,...e}){let{router:t}=xy(),r=ne.useMemo(()=>En(t.routes,i,t.basename),[t.routes,i,t.basename]);return r?ne.createElement(NO,{page:i,matches:r,...e}):null}function LO(i){let{manifest:e,routeModules:t}=wy(),[r,a]=ne.useState([]);return ne.useEffect(()=>{let s=!1;return _O(i,e,t).then(o=>{s||a(o)}),()=>{s=!0}},[i,e,t]),r}function NO({page:i,matches:e,...t}){let r=On(),{manifest:a,routeModules:s}=wy(),{basename:o}=xy(),{loaderData:u,matches:h}=FO(),d=ne.useMemo(()=>qb(i,e,h,a,r,"data"),[i,e,h,a,r]),p=ne.useMemo(()=>qb(i,e,h,a,r,"assets"),[i,e,h,a,r]),b=ne.useMemo(()=>{if(i===r.pathname+r.search+r.hash)return[];let y=new Set,C=!1;if(e.forEach(w=>{var T;let R=a.routes[w.route.id];!R||!R.hasLoader||(!d.some(D=>D.route.id===w.route.id)&&w.route.id in u&&((T=s[w.route.id])!=null&&T.shouldRevalidate)||R.hasClientLoader?C=!0:y.add(w.route.id))}),y.size===0)return[];let E=DO(i,o);return C&&y.size>0&&E.searchParams.set("_routes",e.filter(w=>y.has(w.route.id)).map(w=>w.route.id).join(",")),[E.pathname+E.search]},[o,u,r,a,d,e,i,s]),g=ne.useMemo(()=>SO(p,a),[p,a]),v=LO(p);return ne.createElement(ne.Fragment,null,b.map(y=>ne.createElement("link",{key:y,rel:"prefetch",as:"fetch",href:y,...t})),g.map(y=>ne.createElement("link",{key:y,rel:"modulepreload",href:y,...t})),v.map(({key:y,link:C})=>ne.createElement("link",{key:y,...C})))}function BO(...i){return e=>{i.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var yy=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{yy&&(window.__reactRouterVersion="7.3.0")}catch{}function zO(i,e){return EM({basename:e==null?void 0:e.basename,unstable_getContext:e==null?void 0:e.unstable_getContext,future:e==null?void 0:e.future,history:XF({window:e==null?void 0:e.window}),hydrationData:HO(),routes:i,mapRouteProperties:aO,dataStrategy:e==null?void 0:e.dataStrategy,patchRoutesOnNavigation:e==null?void 0:e.patchRoutesOnNavigation,window:e==null?void 0:e.window}).initialize()}function HO(){let i=window==null?void 0:window.__staticRouterHydrationData;return i&&i.errors&&(i={...i,errors:PO(i.errors)}),i}function PO(i){if(!i)return null;let e=Object.entries(i),t={};for(let[r,a]of e)if(a&&a.__type==="RouteErrorResponse")t[r]=new ah(a.status,a.statusText,a.data,a.internal===!0);else if(a&&a.__type==="Error"){if(a.__subType){let s=window[a.__subType];if(typeof s=="function")try{let o=new s(a.message);o.stack="",t[r]=o}catch{}}if(t[r]==null){let s=new Error(a.message);s.stack="",t[r]=s}}else t[r]=a;return t}var Ey=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Cy=ne.forwardRef(function({onClick:e,discover:t="render",prefetch:r="none",relative:a,reloadDocument:s,replace:o,state:u,target:h,to:d,preventScrollReset:p,viewTransition:b,...g},v){let{basename:y}=ne.useContext(ha),C=typeof d=="string"&&Ey.test(d),E,w=!1;if(typeof d=="string"&&C&&(E=d,yy))try{let N=new URL(window.location.href),j=d.startsWith("//")?new URL(N.protocol+d):new URL(d),Y=Ur(j.pathname,y);j.origin===N.origin&&Y!=null?d=Y+j.search+j.hash:w=!0}catch{Si(!1,`<Link to="${d}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let R=VM(d,{relative:a}),[T,D,k]=MO(r,g),V=GO(d,{replace:o,state:u,target:h,preventScrollReset:p,relative:a,viewTransition:b});function P(N){e&&e(N),N.defaultPrevented||V(N)}let U=ne.createElement("a",{...g,...k,href:E||R,onClick:w||s?e:P,ref:BO(v,D),target:h,"data-discover":!C&&t==="render"?"true":void 0});return T&&!C?ne.createElement(ne.Fragment,null,U,ne.createElement(OO,{page:R})):U});Cy.displayName="Link";var IO=ne.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:r="",end:a=!1,style:s,to:o,viewTransition:u,children:h,...d},p){let b=fu(o,{relative:d.relative}),g=On(),v=ne.useContext(cu),{navigator:y,basename:C}=ne.useContext(ha),E=v!=null&&KO(b)&&u===!0,w=y.encodeLocation?y.encodeLocation(b).pathname:b.pathname,R=g.pathname,T=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;t||(R=R.toLowerCase(),T=T?T.toLowerCase():null,w=w.toLowerCase()),T&&C&&(T=Ur(T,C)||T);const D=w!=="/"&&w.endsWith("/")?w.length-1:w.length;let k=R===w||!a&&R.startsWith(w)&&R.charAt(D)==="/",V=T!=null&&(T===w||!a&&T.startsWith(w)&&T.charAt(w.length)==="/"),P={isActive:k,isPending:V,isTransitioning:E},U=k?e:void 0,N;typeof r=="function"?N=r(P):N=[r,k?"active":null,V?"pending":null,E?"transitioning":null].filter(Boolean).join(" ");let j=typeof s=="function"?s(P):s;return ne.createElement(Cy,{...d,"aria-current":U,className:N,ref:p,style:j,to:o,viewTransition:u},typeof h=="function"?h(P):h)});IO.displayName="NavLink";var UO=ne.forwardRef(({discover:i="render",fetcherKey:e,navigate:t,reloadDocument:r,replace:a,state:s,method:o=Bc,action:u,onSubmit:h,relative:d,preventScrollReset:p,viewTransition:b,...g},v)=>{let y=YO(),C=qO(u,{relative:d}),E=o.toLowerCase()==="get"?"get":"post",w=typeof u=="string"&&Ey.test(u),R=T=>{if(h&&h(T),T.defaultPrevented)return;T.preventDefault();let D=T.nativeEvent.submitter,k=(D==null?void 0:D.getAttribute("formmethod"))||o;y(D||T.currentTarget,{fetcherKey:e,method:k,navigate:t,replace:a,state:s,relative:d,preventScrollReset:p,viewTransition:b})};return ne.createElement("form",{ref:v,method:E,action:C,onSubmit:r?h:R,...g,"data-discover":!w&&i==="render"?"true":void 0})});UO.displayName="Form";function VO(i){return`${i} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Ty(i){let e=ne.useContext(Cs);return _t(e,VO(i)),e}function GO(i,{target:e,replace:t,state:r,preventScrollReset:a,relative:s,viewTransition:o}={}){let u=my(),h=On(),d=fu(i,{relative:s});return ne.useCallback(p=>{if(bO(p,e)){p.preventDefault();let b=t!==void 0?t:An(h)===An(d);u(i,{replace:b,state:r,preventScrollReset:a,relative:s,viewTransition:o})}},[h,u,d,t,r,e,i,a,s,o])}function WO(i){Si(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=ne.useRef(E0(i)),t=ne.useRef(!1),r=On(),a=ne.useMemo(()=>xO(r.search,t.current?null:e.current),[r.search]),s=my(),o=ne.useCallback((u,h)=>{const d=E0(typeof u=="function"?u(a):u);t.current=!0,s("?"+d,h)},[s,a]);return[a,o]}var jO=0,XO=()=>`__${String(++jO)}__`;function YO(){let{router:i}=Ty("useSubmit"),{basename:e}=ne.useContext(ha),t=eO();return ne.useCallback(async(r,a={})=>{let{action:s,method:o,encType:u,formData:h,body:d}=EO(r,e);if(a.navigate===!1){let p=a.fetcherKey||XO();await i.fetch(p,t,a.action||s,{preventScrollReset:a.preventScrollReset,formData:h,body:d,formMethod:a.method||o,formEncType:a.encType||u,flushSync:a.flushSync})}else await i.navigate(a.action||s,{preventScrollReset:a.preventScrollReset,formData:h,body:d,formMethod:a.method||o,formEncType:a.encType||u,replace:a.replace,state:a.state,fromRouteId:t,flushSync:a.flushSync,viewTransition:a.viewTransition})},[i,e,t])}function qO(i,{relative:e}={}){let{basename:t}=ne.useContext(ha),r=ne.useContext(fa);_t(r,"useFormAction must be used inside a RouteContext");let[a]=r.matches.slice(-1),s={...fu(i||".",{relative:e})},o=On();if(i==null){s.search=o.search;let u=new URLSearchParams(s.search),h=u.getAll("index");if(h.some(p=>p==="")){u.delete("index"),h.filter(b=>b).forEach(b=>u.append("index",b));let p=u.toString();s.search=p?`?${p}`:""}}return(!i||i===".")&&a.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(s.pathname=s.pathname==="/"?t:ca([t,s.pathname])),An(s)}function KO(i,e={}){let t=ne.useContext(Rp);_t(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=Ty("useViewTransitionState"),a=fu(i,{relative:e.relative});if(!t.isTransitioning)return!1;let s=Ur(t.currentLocation.pathname,r)||t.currentLocation.pathname,o=Ur(t.nextLocation.pathname,r)||t.nextLocation.pathname;return rh(a.pathname,o)!=null||rh(a.pathname,s)!=null}new TextEncoder;var $O=ex();/**
 * react-router v7.3.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ZO(i){return ne.createElement(sO,{flushSync:$O.flushSync,...i})}function QO(){const{user:i}=tO();return nt.jsx("div",{children:nt.jsx(ne.Suspense,{fallback:nt.jsx("p",{children:"Loading..."}),children:nt.jsx(hO,{resolve:i,children:e=>nt.jsxs("div",{children:[nt.jsxs("p",{style:{display:"none"},children:["Welcome, ",e.name,"!"]}),nt.jsx(uO,{})]})})})})}async function JO(){return{name:"Betty"}}async function eL(i){return console.log(i.request.url),{user:JO()}}const du=()=>k2(),pu=F2;function tL(){const i=pu(t=>t.counter.value),e=du();return nt.jsxs("div",{children:[nt.jsx("h2",{children:"Home Page"}),nt.jsxs("p",{children:["Count: ",i]}),nt.jsx("button",{onClick:()=>e(vx()),children:"Increment"}),nt.jsx("button",{onClick:()=>e(bx(5)),children:"Add 5"})]})}function iL(){const i=pu(t=>t.counter.value),e=du();return nt.jsxs("div",{children:[nt.jsx("h2",{children:"About"}),nt.jsxs("p",{children:["Count: ",i]}),nt.jsx("button",{onClick:()=>e(vx()),children:"Increment"}),nt.jsx("button",{onClick:()=>e(bx(5)),children:"Add 5"})]})}function rL(){const i=du(),{content:e,loading:t,error:r}=pu(a=>a.file);return ne.useEffect(()=>{i(Po("/path/to/file.txt"))},[i]),t?nt.jsx("div",{children:"Loading..."}):r?nt.jsxs("div",{style:{color:"red"},children:["Error: ",r]}):nt.jsx("pre",{children:e[0]&&e[0].title})}function aL(){const i=du(),{content:e,loading:t,error:r}=pu(s=>s.file),a=s=>{var u;const o=(u=s.target.files)==null?void 0:u[0];o&&i(Io(o))};return nt.jsxs("div",{children:[nt.jsx("input",{type:"file",id:"fileInput",accept:".xlsx,.csv,.txt",onChange:a}),t&&nt.jsx("p",{children:"Loading file..."}),r&&nt.jsxs("p",{style:{color:"red"},children:["Error: ",r]}),nt.jsx("pre",{children:e.length&&e[0].title})]})}function Kb(){const i=vy();return xl(i)?i.status===404?nt.jsx("h2",{children:"404 - Page Not Found"}):nt.jsxs("div",{children:[nt.jsxs("h2",{children:["Error ",i.status]}),nt.jsx("p",{children:i.statusText})]}):nt.jsx("h2",{children:"Resource Not Found"})}class zi{constructor(e){this.table=e}reloadData(e,t,r){return this.table.dataLoader.load(e,void 0,void 0,void 0,t,r)}langText(){return this.table.modules.localize.getText(...arguments)}langBind(){return this.table.modules.localize.bind(...arguments)}langLocale(){return this.table.modules.localize.getLocale(...arguments)}commsConnections(){return this.table.modules.comms.getConnections(...arguments)}commsSend(){return this.table.modules.comms.send(...arguments)}layoutMode(){return this.table.modules.layout.getMode()}layoutRefresh(e){return this.table.modules.layout.layout(e)}subscribe(){return this.table.eventBus.subscribe(...arguments)}unsubscribe(){return this.table.eventBus.unsubscribe(...arguments)}subscribed(e){return this.table.eventBus.subscribed(e)}subscriptionChange(){return this.table.eventBus.subscriptionChange(...arguments)}dispatch(){return this.table.eventBus.dispatch(...arguments)}chain(){return this.table.eventBus.chain(...arguments)}confirm(){return this.table.eventBus.confirm(...arguments)}dispatchExternal(){return this.table.externalEvents.dispatch(...arguments)}subscribedExternal(e){return this.table.externalEvents.subscribed(e)}subscriptionChangeExternal(){return this.table.externalEvents.subscriptionChange(...arguments)}options(e){return this.table.options[e]}setOption(e,t){return typeof t<"u"&&(this.table.options[e]=t),this.table.options[e]}deprecationCheck(e,t,r){return this.table.deprecationAdvisor.check(e,t,r)}deprecationCheckMsg(e,t){return this.table.deprecationAdvisor.checkMsg(e,t)}deprecationMsg(e){return this.table.deprecationAdvisor.msg(e)}module(e){return this.table.module(e)}}class Wt{static elVisible(e){return!(e.offsetWidth<=0&&e.offsetHeight<=0)}static elOffset(e){var t=e.getBoundingClientRect();return{top:t.top+window.pageYOffset-document.documentElement.clientTop,left:t.left+window.pageXOffset-document.documentElement.clientLeft}}static retrieveNestedData(e,t,r){var a=e?t.split(e):[t],s=a.length,o;for(let u=0;u<s&&(r=r[a[u]],o=r,!!r);u++);return o}static deepClone(e,t,r=[]){var a={}.__proto__,s=[].__proto__;t||(t=Object.assign(Array.isArray(e)?[]:{},e));for(var o in e){let u=e[o],h,d;u!=null&&typeof u=="object"&&(u.__proto__===a||u.__proto__===s)&&(h=r.findIndex(p=>p.subject===u),h>-1?t[o]=r[h].copy:(d=Object.assign(Array.isArray(u)?[]:{},u),r.unshift({subject:u,copy:d}),t[o]=this.deepClone(u,d,r)))}return t}}let nL=class _y extends zi{constructor(e,t,r){super(e),this.element=t,this.container=this._lookupContainer(),this.parent=r,this.reversedX=!1,this.childPopup=null,this.blurable=!1,this.blurCallback=null,this.blurEventsBound=!1,this.renderedCallback=null,this.visible=!1,this.hideable=!0,this.element.classList.add("tabulator-popup-container"),this.blurEvent=this.hide.bind(this,!1),this.escEvent=this._escapeCheck.bind(this),this.destroyBinding=this.tableDestroyed.bind(this),this.destroyed=!1}tableDestroyed(){this.destroyed=!0,this.hide(!0)}_lookupContainer(){var e=this.table.options.popupContainer;return typeof e=="string"?(e=document.querySelector(e),e||console.warn("Menu Error - no container element found matching selector:",this.table.options.popupContainer,"(defaulting to document body)")):e===!0&&(e=this.table.element),e&&!this._checkContainerIsParent(e)&&(e=!1,console.warn("Menu Error - container element does not contain this table:",this.table.options.popupContainer,"(defaulting to document body)")),e||(e=document.body),e}_checkContainerIsParent(e,t=this.table.element){return e===t?!0:t.parentNode?this._checkContainerIsParent(e,t.parentNode):!1}renderCallback(e){this.renderedCallback=e}containerEventCoords(e){var t=!(e instanceof MouseEvent),r=t?e.touches[0].pageX:e.pageX,a=t?e.touches[0].pageY:e.pageY;if(this.container!==document.body){let s=Wt.elOffset(this.container);r-=s.left,a-=s.top}return{x:r,y:a}}elementPositionCoords(e,t="right"){var r=Wt.elOffset(e),a,s,o;switch(this.container!==document.body&&(a=Wt.elOffset(this.container),r.left-=a.left,r.top-=a.top),t){case"right":s=r.left+e.offsetWidth,o=r.top-1;break;case"bottom":s=r.left,o=r.top+e.offsetHeight;break;case"left":s=r.left,o=r.top-1;break;case"top":s=r.left,o=r.top;break;case"center":s=r.left+e.offsetWidth/2,o=r.top+e.offsetHeight/2;break}return{x:s,y:o,offset:r}}show(e,t){var r,a,s,o,u;return this.destroyed||this.table.destroyed?this:(e instanceof HTMLElement?(s=e,u=this.elementPositionCoords(e,t),o=u.offset,r=u.x,a=u.y):typeof e=="number"?(o={top:0,left:0},r=e,a=t):(u=this.containerEventCoords(e),r=u.x,a=u.y,this.reversedX=!1),this.element.style.top=a+"px",this.element.style.left=r+"px",this.container.appendChild(this.element),typeof this.renderedCallback=="function"&&this.renderedCallback(),this._fitToScreen(r,a,s,o,t),this.visible=!0,this.subscribe("table-destroy",this.destroyBinding),this.element.addEventListener("mousedown",h=>{h.stopPropagation()}),this)}_fitToScreen(e,t,r,a,s){var o=this.container===document.body?document.documentElement.scrollTop:this.container.scrollTop;(e+this.element.offsetWidth>=this.container.offsetWidth||this.reversedX)&&(this.element.style.left="",r?this.element.style.right=this.container.offsetWidth-a.left+"px":this.element.style.right=this.container.offsetWidth-e+"px",this.reversedX=!0);let u=Math.max(this.container.offsetHeight,o?this.container.scrollHeight:0);if(t+this.element.offsetHeight>u)if(r)switch(s){case"bottom":this.element.style.top=parseInt(this.element.style.top)-this.element.offsetHeight-r.offsetHeight-1+"px";break;default:this.element.style.top=parseInt(this.element.style.top)-this.element.offsetHeight+r.offsetHeight+1+"px"}else this.element.style.height=u+"px"}isVisible(){return this.visible}hideOnBlur(e){return this.blurable=!0,this.visible&&(setTimeout(()=>{this.visible&&(this.table.rowManager.element.addEventListener("scroll",this.blurEvent),this.subscribe("cell-editing",this.blurEvent),document.body.addEventListener("click",this.blurEvent),document.body.addEventListener("contextmenu",this.blurEvent),document.body.addEventListener("mousedown",this.blurEvent),window.addEventListener("resize",this.blurEvent),document.body.addEventListener("keydown",this.escEvent),this.blurEventsBound=!0)},100),this.blurCallback=e),this}_escapeCheck(e){e.keyCode==27&&this.hide()}blockHide(){this.hideable=!1}restoreHide(){this.hideable=!0}hide(e=!1){return this.visible&&this.hideable&&(this.blurable&&this.blurEventsBound&&(document.body.removeEventListener("keydown",this.escEvent),document.body.removeEventListener("click",this.blurEvent),document.body.removeEventListener("contextmenu",this.blurEvent),document.body.removeEventListener("mousedown",this.blurEvent),window.removeEventListener("resize",this.blurEvent),this.table.rowManager.element.removeEventListener("scroll",this.blurEvent),this.unsubscribe("cell-editing",this.blurEvent),this.blurEventsBound=!1),this.childPopup&&this.childPopup.hide(),this.parent&&(this.parent.childPopup=null),this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.visible=!1,this.blurCallback&&!e&&this.blurCallback(),this.unsubscribe("table-destroy",this.destroyBinding)),this}child(e){return this.childPopup&&this.childPopup.hide(),this.childPopup=new _y(this.table,e,this),this.childPopup}};class ct extends zi{constructor(e,t){super(e),this._handler=null}initialize(){}registerTableOption(e,t){this.table.optionsList.register(e,t)}registerColumnOption(e,t){this.table.columnManager.optionsList.register(e,t)}registerTableFunction(e,t){typeof this.table[e]>"u"?this.table[e]=(...r)=>(this.table.initGuard(e),t(...r)):console.warn("Unable to bind table function, name already in use",e)}registerComponentFunction(e,t,r){return this.table.componentFunctionBinder.bind(e,t,r)}registerDataHandler(e,t){this.table.rowManager.registerDataPipelineHandler(e,t),this._handler=e}registerDisplayHandler(e,t){this.table.rowManager.registerDisplayPipelineHandler(e,t),this._handler=e}displayRows(e){var t=this.table.rowManager.displayRows.length-1,r;if(this._handler&&(r=this.table.rowManager.displayPipeline.findIndex(a=>a.handler===this._handler),r>-1&&(t=r)),e&&(t=t+e),this._handler)return t>-1?this.table.rowManager.getDisplayRows(t):this.activeRows()}activeRows(){return this.table.rowManager.activeRows}refreshData(e,t){t||(t=this._handler),t&&this.table.rowManager.refreshActiveData(t,!1,e)}footerAppend(e){return this.table.footerManager.append(e)}footerPrepend(e){return this.table.footerManager.prepend(e)}footerRemove(e){return this.table.footerManager.remove(e)}popup(e,t){return new nL(this.table,e,t)}alert(e,t){return this.table.alertManager.alert(e,t)}clearAlert(){return this.table.alertManager.clear()}}var sL={rownum:function(i,e,t,r,a,s){return s.getPosition()}};const ol=class ol extends ct{constructor(e){super(e),this.allowedTypes=["","data","download","clipboard","print","htmlOutput"],this.registerColumnOption("accessor"),this.registerColumnOption("accessorParams"),this.registerColumnOption("accessorData"),this.registerColumnOption("accessorDataParams"),this.registerColumnOption("accessorDownload"),this.registerColumnOption("accessorDownloadParams"),this.registerColumnOption("accessorClipboard"),this.registerColumnOption("accessorClipboardParams"),this.registerColumnOption("accessorPrint"),this.registerColumnOption("accessorPrintParams"),this.registerColumnOption("accessorHtmlOutput"),this.registerColumnOption("accessorHtmlOutputParams")}initialize(){this.subscribe("column-layout",this.initializeColumn.bind(this)),this.subscribe("row-data-retrieve",this.transformRow.bind(this))}initializeColumn(e){var t=!1,r={};this.allowedTypes.forEach(a=>{var s="accessor"+(a.charAt(0).toUpperCase()+a.slice(1)),o;e.definition[s]&&(o=this.lookupAccessor(e.definition[s]),o&&(t=!0,r[s]={accessor:o,params:e.definition[s+"Params"]||{}}))}),t&&(e.modules.accessor=r)}lookupAccessor(e){var t=!1;switch(typeof e){case"string":ol.accessors[e]?t=ol.accessors[e]:console.warn("Accessor Error - No such accessor found, ignoring: ",e);break;case"function":t=e;break}return t}transformRow(e,t){var r="accessor"+(t.charAt(0).toUpperCase()+t.slice(1)),a=e.getComponent(),s=Wt.deepClone(e.data||{});return this.table.columnManager.traverse(function(o){var u,h,d,p;o.modules.accessor&&(h=o.modules.accessor[r]||o.modules.accessor.accessor||!1,h&&(u=o.getFieldValue(s),u!="undefined"&&(p=o.getComponent(),d=typeof h.params=="function"?h.params(u,s,t,p,a):h.params,o.setFieldValue(s,h.accessor(u,s,t,d,p,a)))))}),s}};Be(ol,"moduleName","accessor"),Be(ol,"accessors",sL);let C0=ol;var lL={method:"GET"};function T0(i,e){var t=[];if(e=e||"",Array.isArray(i))i.forEach((a,s)=>{t=t.concat(T0(a,e?e+"["+s+"]":s))});else if(typeof i=="object")for(var r in i)t=t.concat(T0(i[r],e?e+"["+r+"]":r));else t.push({key:e,value:i});return t}function oL(i){var e=T0(i),t=[];return e.forEach(function(r){t.push(encodeURIComponent(r.key)+"="+encodeURIComponent(r.value))}),t.join("&")}function Sy(i,e,t){return i&&t&&Object.keys(t).length&&(!e.method||e.method.toLowerCase()=="get")&&(e.method="get",i+=(i.includes("?")?"&":"?")+oL(t)),i}function uL(i,e,t){var r;return new Promise((a,s)=>{if(i=this.urlGenerator.call(this.table,i,e,t),e.method.toUpperCase()!="GET")if(r=typeof this.table.options.ajaxContentType=="object"?this.table.options.ajaxContentType:this.contentTypeFormatters[this.table.options.ajaxContentType],r){for(var o in r.headers)e.headers||(e.headers={}),typeof e.headers[o]>"u"&&(e.headers[o]=r.headers[o]);e.body=r.body.call(this,i,e,t)}else console.warn("Ajax Error - Invalid ajaxContentType value:",this.table.options.ajaxContentType);i?(typeof e.headers>"u"&&(e.headers={}),typeof e.headers.Accept>"u"&&(e.headers.Accept="application/json"),typeof e.headers["X-Requested-With"]>"u"&&(e.headers["X-Requested-With"]="XMLHttpRequest"),typeof e.mode>"u"&&(e.mode="cors"),e.mode=="cors"?(typeof e.headers.Origin>"u"&&(e.headers.Origin=window.location.origin),typeof e.credentials>"u"&&(e.credentials="same-origin")):typeof e.credentials>"u"&&(e.credentials="include"),fetch(i,e).then(u=>{u.ok?u.json().then(h=>{a(h)}).catch(h=>{s(h),console.warn("Ajax Load Error - Invalid JSON returned",h)}):(console.error("Ajax Load Error - Connection Error: "+u.status,u.statusText),s(u))}).catch(u=>{console.error("Ajax Load Error - Connection Error: ",u),s(u)})):(console.warn("Ajax Load Error - No URL Set"),a([]))})}function _0(i,e){var t=[];if(e=e||"",Array.isArray(i))i.forEach((a,s)=>{t=t.concat(_0(a,e?e+"["+s+"]":s))});else if(typeof i=="object")for(var r in i)t=t.concat(_0(i[r],e?e+"["+r+"]":r));else t.push({key:e,value:i});return t}var cL={json:{headers:{"Content-Type":"application/json"},body:function(i,e,t){return JSON.stringify(t)}},form:{headers:{},body:function(i,e,t){var r=_0(t),a=new FormData;return r.forEach(function(s){a.append(s.key,s.value)}),a}}};const $r=class $r extends ct{constructor(e){super(e),this.config={},this.url="",this.urlGenerator=!1,this.params=!1,this.loaderPromise=!1,this.registerTableOption("ajaxURL",!1),this.registerTableOption("ajaxURLGenerator",!1),this.registerTableOption("ajaxParams",{}),this.registerTableOption("ajaxConfig","get"),this.registerTableOption("ajaxContentType","form"),this.registerTableOption("ajaxRequestFunc",!1),this.registerTableOption("ajaxRequesting",function(){}),this.registerTableOption("ajaxResponse",!1),this.contentTypeFormatters=$r.contentTypeFormatters}initialize(){this.loaderPromise=this.table.options.ajaxRequestFunc||$r.defaultLoaderPromise,this.urlGenerator=this.table.options.ajaxURLGenerator||$r.defaultURLGenerator,this.table.options.ajaxURL&&this.setUrl(this.table.options.ajaxURL),this.setDefaultConfig(this.table.options.ajaxConfig),this.registerTableFunction("getAjaxUrl",this.getUrl.bind(this)),this.subscribe("data-loading",this.requestDataCheck.bind(this)),this.subscribe("data-params",this.requestParams.bind(this)),this.subscribe("data-load",this.requestData.bind(this))}requestParams(e,t,r,a){var s=this.table.options.ajaxParams;return s&&(typeof s=="function"&&(s=s.call(this.table)),a=Object.assign(Object.assign({},s),a)),a}requestDataCheck(e,t,r,a){return!!(!e&&this.url||typeof e=="string")}requestData(e,t,r,a,s){var o;return!s&&this.requestDataCheck(e)?(e&&this.setUrl(e),o=this.generateConfig(r),this.sendRequest(this.url,t,o)):s}setDefaultConfig(e={}){this.config=Object.assign({},$r.defaultConfig),typeof e=="string"?this.config.method=e:Object.assign(this.config,e)}generateConfig(e={}){var t=Object.assign({},this.config);return typeof e=="string"?t.method=e:Object.assign(t,e),t}setUrl(e){this.url=e}getUrl(){return this.url}sendRequest(e,t,r){return this.table.options.ajaxRequesting.call(this.table,e,t)!==!1?this.loaderPromise(e,r,t).then(a=>(this.table.options.ajaxResponse&&(a=this.table.options.ajaxResponse.call(this.table,e,t,a)),a)):Promise.reject()}};Be($r,"moduleName","ajax"),Be($r,"defaultConfig",lL),Be($r,"defaultURLGenerator",Sy),Be($r,"defaultLoaderPromise",uL),Be($r,"contentTypeFormatters",cL);let S0=$r;var hL={replace:function(i){return this.table.setData(i)},update:function(i){return this.table.updateOrAddData(i)},insert:function(i){return this.table.addData(i)}},fL={table:function(i){var e=[],t=!0,r=this.table.columnManager.columns,a=[],s=[];return i=i.split(`
`),i.forEach(function(o){e.push(o.split("	"))}),e.length&&!(e.length===1&&e[0].length<2)?(e[0].forEach(function(o){var u=r.find(function(h){return o&&h.definition.title&&o.trim()&&h.definition.title.trim()===o.trim()});u?a.push(u):t=!1}),t||(t=!0,a=[],e[0].forEach(function(o){var u=r.find(function(h){return o&&h.field&&o.trim()&&h.field.trim()===o.trim()});u?a.push(u):t=!1}),t||(a=this.table.columnManager.columnsByIndex)),t&&e.shift(),e.forEach(function(o){var u={};o.forEach(function(h,d){a[d]&&(u[a[d].field]=h)}),s.push(u)}),s):!1}},dL={copyToClipboard:["ctrl + 67","meta + 67"]},pL={copyToClipboard:function(i){this.table.modules.edit.currentCell||this.table.modExists("clipboard",!0)&&this.table.modules.clipboard.copy(!1,!0)}},mL={keybindings:{bindings:dL,actions:pL}};const mn=class mn extends ct{constructor(e){super(e),this.mode=!0,this.pasteParser=function(){},this.pasteAction=function(){},this.customSelection=!1,this.rowRange=!1,this.blocked=!0,this.registerTableOption("clipboard",!1),this.registerTableOption("clipboardCopyStyled",!0),this.registerTableOption("clipboardCopyConfig",!1),this.registerTableOption("clipboardCopyFormatter",!1),this.registerTableOption("clipboardCopyRowRange","active"),this.registerTableOption("clipboardPasteParser","table"),this.registerTableOption("clipboardPasteAction","insert"),this.registerColumnOption("clipboard"),this.registerColumnOption("titleClipboard")}initialize(){this.mode=this.table.options.clipboard,this.rowRange=this.table.options.clipboardCopyRowRange,(this.mode===!0||this.mode==="copy")&&this.table.element.addEventListener("copy",e=>{var t,r,a;this.blocked||(e.preventDefault(),this.customSelection?(t=this.customSelection,this.table.options.clipboardCopyFormatter&&(t=this.table.options.clipboardCopyFormatter("plain",t))):(a=this.table.modules.export.generateExportList(this.table.options.clipboardCopyConfig,this.table.options.clipboardCopyStyled,this.rowRange,"clipboard"),r=this.table.modules.export.generateHTMLTable(a),t=r?this.generatePlainContent(a):"",this.table.options.clipboardCopyFormatter&&(t=this.table.options.clipboardCopyFormatter("plain",t),r=this.table.options.clipboardCopyFormatter("html",r))),window.clipboardData&&window.clipboardData.setData?window.clipboardData.setData("Text",t):e.clipboardData&&e.clipboardData.setData?(e.clipboardData.setData("text/plain",t),r&&e.clipboardData.setData("text/html",r)):e.originalEvent&&e.originalEvent.clipboardData.setData&&(e.originalEvent.clipboardData.setData("text/plain",t),r&&e.originalEvent.clipboardData.setData("text/html",r)),this.dispatchExternal("clipboardCopied",t,r),this.reset())}),(this.mode===!0||this.mode==="paste")&&this.table.element.addEventListener("paste",e=>{this.paste(e)}),this.setPasteParser(this.table.options.clipboardPasteParser),this.setPasteAction(this.table.options.clipboardPasteAction),this.registerTableFunction("copyToClipboard",this.copy.bind(this))}reset(){this.blocked=!0,this.customSelection=!1}generatePlainContent(e){var t=[];return e.forEach(r=>{var a=[];r.columns.forEach(s=>{var o="";if(s)if(r.type==="group"&&(s.value=s.component.getKey()),s.value===null)o="";else switch(typeof s.value){case"object":o=JSON.stringify(s.value);break;case"undefined":o="";break;default:o=s.value}a.push(o)}),t.push(a.join("	"))}),t.join(`
`)}copy(e,t){var r,a;this.blocked=!1,this.customSelection=!1,(this.mode===!0||this.mode==="copy")&&(this.rowRange=e||this.table.options.clipboardCopyRowRange,typeof window.getSelection<"u"&&typeof document.createRange<"u"?(e=document.createRange(),e.selectNodeContents(this.table.element),r=window.getSelection(),r.toString()&&t&&(this.customSelection=r.toString()),r.removeAllRanges(),r.addRange(e)):typeof document.selection<"u"&&typeof document.body.createTextRange<"u"&&(a=document.body.createTextRange(),a.moveToElementText(this.table.element),a.select()),document.execCommand("copy"),r&&r.removeAllRanges())}setPasteAction(e){switch(typeof e){case"string":this.pasteAction=mn.pasteActions[e],this.pasteAction||console.warn("Clipboard Error - No such paste action found:",e);break;case"function":this.pasteAction=e;break}}setPasteParser(e){switch(typeof e){case"string":this.pasteParser=mn.pasteParsers[e],this.pasteParser||console.warn("Clipboard Error - No such paste parser found:",e);break;case"function":this.pasteParser=e;break}}paste(e){var t,r,a;this.checkPasteOrigin(e)&&(t=this.getPasteData(e),r=this.pasteParser.call(this,t),r?(e.preventDefault(),this.table.modExists("mutator")&&(r=this.mutateData(r)),a=this.pasteAction.call(this,r),this.dispatchExternal("clipboardPasted",t,r,a)):this.dispatchExternal("clipboardPasteError",t))}mutateData(e){var t=[];return Array.isArray(e)?e.forEach(r=>{t.push(this.table.modules.mutator.transformRow(r,"clipboard"))}):t=e,t}checkPasteOrigin(e){var t=!0,r=this.confirm("clipboard-paste",[e]);return(r||!["DIV","SPAN"].includes(e.target.tagName))&&(t=!1),t}getPasteData(e){var t;return window.clipboardData&&window.clipboardData.getData?t=window.clipboardData.getData("Text"):e.clipboardData&&e.clipboardData.getData?t=e.clipboardData.getData("text/plain"):e.originalEvent&&e.originalEvent.clipboardData.getData&&(t=e.originalEvent.clipboardData.getData("text/plain")),t}};Be(mn,"moduleName","clipboard"),Be(mn,"moduleExtensions",mL),Be(mn,"pasteActions",hL),Be(mn,"pasteParsers",fL);let R0=mn;class gL{constructor(e){return this._row=e,new Proxy(this,{get:function(t,r,a){return typeof t[r]<"u"?t[r]:t._row.table.componentFunctionBinder.handle("row",t._row,r)}})}getData(e){return this._row.getData(e)}getElement(){return this._row.getElement()}getTable(){return this._row.table}getCells(){var e=[];return this._row.getCells().forEach(function(t){e.push(t.getComponent())}),e}getCell(e){var t=this._row.getCell(e);return t?t.getComponent():!1}_getSelf(){return this._row}}class Ry{constructor(e){return this._cell=e,new Proxy(this,{get:function(t,r,a){return typeof t[r]<"u"?t[r]:t._cell.table.componentFunctionBinder.handle("cell",t._cell,r)}})}getValue(){return this._cell.getValue()}getOldValue(){return this._cell.getOldValue()}getInitialValue(){return this._cell.initialValue}getElement(){return this._cell.getElement()}getRow(){return this._cell.row.getComponent()}getData(e){return this._cell.row.getData(e)}getType(){return"cell"}getField(){return this._cell.column.getField()}getColumn(){return this._cell.column.getComponent()}setValue(e,t){typeof t>"u"&&(t=!0),this._cell.setValue(e,t)}restoreOldValue(){this._cell.setValueActual(this._cell.getOldValue())}restoreInitialValue(){this._cell.setValueActual(this._cell.initialValue)}checkHeight(){this._cell.checkHeight()}getTable(){return this._cell.table}_getSelf(){return this._cell}}class mu extends zi{constructor(e,t){super(e.table),this.table=e.table,this.column=e,this.row=t,this.element=null,this.value=null,this.initialValue,this.oldValue=null,this.modules={},this.height=null,this.width=null,this.minWidth=null,this.component=null,this.loaded=!1,this.build()}build(){this.generateElement(),this.setWidth(),this._configureCell(),this.setValueActual(this.column.getFieldValue(this.row.data)),this.initialValue=this.value}generateElement(){this.element=document.createElement("div"),this.element.className="tabulator-cell",this.element.setAttribute("role","gridcell"),this.column.isRowHeader&&this.element.classList.add("tabulator-row-header")}_configureCell(){var e=this.element,t=this.column.getField(),r={top:"flex-start",bottom:"flex-end",middle:"center"},a={left:"flex-start",right:"flex-end",center:"center"};if(e.style.textAlign=this.column.hozAlign,this.column.vertAlign&&(e.style.display="inline-flex",e.style.alignItems=r[this.column.vertAlign]||"",this.column.hozAlign&&(e.style.justifyContent=a[this.column.hozAlign]||"")),t&&e.setAttribute("tabulator-field",t),this.column.definition.cssClass){var s=this.column.definition.cssClass.split(" ");s.forEach(o=>{e.classList.add(o)})}this.dispatch("cell-init",this),this.column.visible||this.hide()}_generateContents(){var e;switch(e=this.chain("cell-format",this,null,()=>this.element.innerHTML=this.value),typeof e){case"object":if(e instanceof Node){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.element.appendChild(e)}else this.element.innerHTML="",e!=null&&console.warn("Format Error - Formatter has returned a type of object, the only valid formatter object return is an instance of Node, the formatter returned:",e);break;case"undefined":this.element.innerHTML="";break;default:this.element.innerHTML=e}}cellRendered(){this.dispatch("cell-rendered",this)}getElement(e){return this.loaded||(this.loaded=!0,e||this.layoutElement()),this.element}getValue(){return this.value}getOldValue(){return this.oldValue}setValue(e,t,r){var a=this.setValueProcessData(e,t,r);a&&(this.dispatch("cell-value-updated",this),this.cellRendered(),this.column.definition.cellEdited&&this.column.definition.cellEdited.call(this.table,this.getComponent()),this.dispatchExternal("cellEdited",this.getComponent()),this.subscribedExternal("dataChanged")&&this.dispatchExternal("dataChanged",this.table.rowManager.getData()))}setValueProcessData(e,t,r){var a=!1;return(this.value!==e||r)&&(a=!0,t&&(e=this.chain("cell-value-changing",[this,e],null,e))),this.setValueActual(e),a&&this.dispatch("cell-value-changed",this),a}setValueActual(e){this.oldValue=this.value,this.value=e,this.dispatch("cell-value-save-before",this),this.column.setFieldValue(this.row.data,e),this.dispatch("cell-value-save-after",this),this.loaded&&this.layoutElement()}layoutElement(){this._generateContents(),this.dispatch("cell-layout",this)}setWidth(){this.width=this.column.width,this.element.style.width=this.column.widthStyled}clearWidth(){this.width="",this.element.style.width=""}getWidth(){return this.width||this.element.offsetWidth}setMinWidth(){this.minWidth=this.column.minWidth,this.element.style.minWidth=this.column.minWidthStyled}setMaxWidth(){this.maxWidth=this.column.maxWidth,this.element.style.maxWidth=this.column.maxWidthStyled}checkHeight(){this.row.reinitializeHeight()}clearHeight(){this.element.style.height="",this.height=null,this.dispatch("cell-height",this,"")}setHeight(){this.height=this.row.height,this.element.style.height=this.row.heightStyled,this.dispatch("cell-height",this,this.row.heightStyled)}getHeight(){return this.height||this.element.offsetHeight}show(){this.element.style.display=this.column.vertAlign?"inline-flex":""}hide(){this.element.style.display="none"}delete(){this.dispatch("cell-delete",this),!this.table.rowManager.redrawBlock&&this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.element=!1,this.column.deleteCell(this),this.row.deleteCell(this),this.calcs={}}getIndex(){return this.row.getCellIndex(this)}getComponent(){return this.component||(this.component=new Ry(this)),this.component}}class ky{constructor(e){return this._column=e,this.type="ColumnComponent",new Proxy(this,{get:function(t,r,a){return typeof t[r]<"u"?t[r]:t._column.table.componentFunctionBinder.handle("column",t._column,r)}})}getElement(){return this._column.getElement()}getDefinition(){return this._column.getDefinition()}getField(){return this._column.getField()}getTitleDownload(){return this._column.getTitleDownload()}getCells(){var e=[];return this._column.cells.forEach(function(t){e.push(t.getComponent())}),e}isVisible(){return this._column.visible}show(){this._column.isGroup?this._column.columns.forEach(function(e){e.show()}):this._column.show()}hide(){this._column.isGroup?this._column.columns.forEach(function(e){e.hide()}):this._column.hide()}toggle(){this._column.visible?this.hide():this.show()}delete(){return this._column.delete()}getSubColumns(){var e=[];return this._column.columns.length&&this._column.columns.forEach(function(t){e.push(t.getComponent())}),e}getParentColumn(){return this._column.getParentComponent()}_getSelf(){return this._column}scrollTo(e,t){return this._column.table.columnManager.scrollToColumn(this._column,e,t)}getTable(){return this._column.table}move(e,t){var r=this._column.table.columnManager.findColumn(e);r?this._column.table.columnManager.moveColumn(this._column,r,t):console.warn("Move Error - No matching column found:",r)}getNextColumn(){var e=this._column.nextColumn();return e?e.getComponent():!1}getPrevColumn(){var e=this._column.prevColumn();return e?e.getComponent():!1}updateDefinition(e){return this._column.updateDefinition(e)}getWidth(){return this._column.getWidth()}setWidth(e){var t;return e===!0?t=this._column.reinitializeWidth(!0):t=this._column.setWidth(e),this._column.table.columnManager.rerenderColumns(!0),t}}var Ay={title:void 0,field:void 0,columns:void 0,visible:void 0,hozAlign:void 0,vertAlign:void 0,width:void 0,minWidth:40,maxWidth:void 0,maxInitialWidth:void 0,cssClass:void 0,variableHeight:void 0,headerVertical:void 0,headerHozAlign:void 0,headerWordWrap:!1,editableTitle:void 0};const as=class as extends zi{constructor(e,t,r){super(t.table),this.definition=e,this.parent=t,this.type="column",this.columns=[],this.cells=[],this.isGroup=!1,this.isRowHeader=r,this.element=this.createElement(),this.contentElement=!1,this.titleHolderElement=!1,this.titleElement=!1,this.groupElement=this.createGroupElement(),this.hozAlign="",this.vertAlign="",this.field="",this.fieldStructure="",this.getFieldValue="",this.setFieldValue="",this.titleDownload=null,this.titleFormatterRendered=!1,this.mapDefinitions(),this.setField(this.definition.field),this.modules={},this.width=null,this.widthStyled="",this.maxWidth=null,this.maxWidthStyled="",this.maxInitialWidth=null,this.minWidth=null,this.minWidthStyled="",this.widthFixed=!1,this.visible=!0,this.component=null,this.definition.columns?(this.isGroup=!0,this.definition.columns.forEach((a,s)=>{var o=new as(a,this);this.attachColumn(o)}),this.checkColumnVisibility()):t.registerColumnField(this),this._initialize()}createElement(){var e=document.createElement("div");switch(e.classList.add("tabulator-col"),e.setAttribute("role","columnheader"),e.setAttribute("aria-sort","none"),this.isRowHeader&&e.classList.add("tabulator-row-header"),this.table.options.columnHeaderVertAlign){case"middle":e.style.justifyContent="center";break;case"bottom":e.style.justifyContent="flex-end";break}return e}createGroupElement(){var e=document.createElement("div");return e.classList.add("tabulator-col-group-cols"),e}mapDefinitions(){var e=this.table.options.columnDefaults;if(e)for(let t in e)typeof this.definition[t]>"u"&&(this.definition[t]=e[t]);this.definition=this.table.columnManager.optionsList.generate(as.defaultOptionList,this.definition)}checkDefinition(){Object.keys(this.definition).forEach(e=>{as.defaultOptionList.indexOf(e)===-1&&console.warn("Invalid column definition option in '"+(this.field||this.definition.title)+"' column:",e)})}setField(e){this.field=e,this.fieldStructure=e?this.table.options.nestedFieldSeparator?e.split(this.table.options.nestedFieldSeparator):[e]:[],this.getFieldValue=this.fieldStructure.length>1?this._getNestedData:this._getFlatData,this.setFieldValue=this.fieldStructure.length>1?this._setNestedData:this._setFlatData}registerColumnPosition(e){this.parent.registerColumnPosition(e)}registerColumnField(e){this.parent.registerColumnField(e)}reRegisterPosition(){this.isGroup?this.columns.forEach(function(e){e.reRegisterPosition()}):this.registerColumnPosition(this)}_initialize(){for(var e=this.definition;this.element.firstChild;)this.element.removeChild(this.element.firstChild);e.headerVertical&&(this.element.classList.add("tabulator-col-vertical"),e.headerVertical==="flip"&&this.element.classList.add("tabulator-col-vertical-flip")),this.contentElement=this._buildColumnHeaderContent(),this.element.appendChild(this.contentElement),this.isGroup?this._buildGroupHeader():this._buildColumnHeader(),this.dispatch("column-init",this)}_buildColumnHeader(){var e=this.definition;if(this.dispatch("column-layout",this),typeof e.visible<"u"&&(e.visible?this.show(!0):this.hide(!0)),e.cssClass){var t=e.cssClass.split(" ");t.forEach(r=>{this.element.classList.add(r)})}e.field&&this.element.setAttribute("tabulator-field",e.field),this.setMinWidth(parseInt(e.minWidth)),e.maxInitialWidth&&(this.maxInitialWidth=parseInt(e.maxInitialWidth)),e.maxWidth&&this.setMaxWidth(parseInt(e.maxWidth)),this.reinitializeWidth(),this.hozAlign=this.definition.hozAlign,this.vertAlign=this.definition.vertAlign,this.titleElement.style.textAlign=this.definition.headerHozAlign}_buildColumnHeaderContent(){var e=document.createElement("div");return e.classList.add("tabulator-col-content"),this.titleHolderElement=document.createElement("div"),this.titleHolderElement.classList.add("tabulator-col-title-holder"),e.appendChild(this.titleHolderElement),this.titleElement=this._buildColumnHeaderTitle(),this.titleHolderElement.appendChild(this.titleElement),e}_buildColumnHeaderTitle(){var e=this.definition,t=document.createElement("div");if(t.classList.add("tabulator-col-title"),e.headerWordWrap&&t.classList.add("tabulator-col-title-wrap"),e.editableTitle){var r=document.createElement("input");r.classList.add("tabulator-title-editor"),r.addEventListener("click",a=>{a.stopPropagation(),r.focus()}),r.addEventListener("mousedown",a=>{a.stopPropagation()}),r.addEventListener("change",()=>{e.title=r.value,this.dispatchExternal("columnTitleChanged",this.getComponent())}),t.appendChild(r),e.field?this.langBind("columns|"+e.field,a=>{r.value=a||e.title||"&nbsp;"}):r.value=e.title||"&nbsp;"}else e.field?this.langBind("columns|"+e.field,a=>{this._formatColumnHeaderTitle(t,a||e.title||"&nbsp;")}):this._formatColumnHeaderTitle(t,e.title||"&nbsp;");return t}_formatColumnHeaderTitle(e,t){var r=this.chain("column-format",[this,t,e],null,()=>t);switch(typeof r){case"object":r instanceof Node?e.appendChild(r):(e.innerHTML="",console.warn("Format Error - Title formatter has returned a type of object, the only valid formatter object return is an instance of Node, the formatter returned:",r));break;case"undefined":e.innerHTML="";break;default:e.innerHTML=r}}_buildGroupHeader(){if(this.element.classList.add("tabulator-col-group"),this.element.setAttribute("role","columngroup"),this.element.setAttribute("aria-title",this.definition.title),this.definition.cssClass){var e=this.definition.cssClass.split(" ");e.forEach(t=>{this.element.classList.add(t)})}this.titleElement.style.textAlign=this.definition.headerHozAlign,this.element.appendChild(this.groupElement)}_getFlatData(e){return e[this.field]}_getNestedData(e){var t=e,r=this.fieldStructure,a=r.length,s;for(let o=0;o<a&&(t=t[r[o]],s=t,!!t);o++);return s}_setFlatData(e,t){this.field&&(e[this.field]=t)}_setNestedData(e,t){var r=e,a=this.fieldStructure,s=a.length;for(let o=0;o<s;o++)if(o==s-1)r[a[o]]=t;else{if(!r[a[o]])if(typeof t<"u")r[a[o]]={};else break;r=r[a[o]]}}attachColumn(e){this.groupElement?(this.columns.push(e),this.groupElement.appendChild(e.getElement()),e.columnRendered()):console.warn("Column Warning - Column being attached to another column instead of column group")}verticalAlign(e,t){var r=this.parent.isGroup?this.parent.getGroupElement().clientHeight:t||this.parent.getHeadersElement().clientHeight;this.element.style.height=r+"px",this.dispatch("column-height",this,this.element.style.height),this.isGroup&&(this.groupElement.style.minHeight=r-this.contentElement.offsetHeight+"px"),this.columns.forEach(function(a){a.verticalAlign(e)})}clearVerticalAlign(){this.element.style.paddingTop="",this.element.style.height="",this.element.style.minHeight="",this.groupElement.style.minHeight="",this.columns.forEach(function(e){e.clearVerticalAlign()}),this.dispatch("column-height",this,"")}getElement(){return this.element}getGroupElement(){return this.groupElement}getField(){return this.field}getTitleDownload(){return this.titleDownload}getFirstColumn(){return this.isGroup?this.columns.length?this.columns[0].getFirstColumn():!1:this}getLastColumn(){return this.isGroup?this.columns.length?this.columns[this.columns.length-1].getLastColumn():!1:this}getColumns(e){var t=[];return e?this.columns.forEach(r=>{t.push(r),t=t.concat(r.getColumns(!0))}):t=this.columns,t}getCells(){return this.cells}getTopColumn(){return this.parent.isGroup?this.parent.getTopColumn():this}getDefinition(e){var t=[];return this.isGroup&&e&&(this.columns.forEach(function(r){t.push(r.getDefinition(!0))}),this.definition.columns=t),this.definition}checkColumnVisibility(){var e=!1;this.columns.forEach(function(t){t.visible&&(e=!0)}),e?(this.show(),this.dispatchExternal("columnVisibilityChanged",this.getComponent(),!1)):this.hide()}show(e,t){this.visible||(this.visible=!0,this.element.style.display="",this.parent.isGroup&&this.parent.checkColumnVisibility(),this.cells.forEach(function(r){r.show()}),!this.isGroup&&this.width===null&&this.reinitializeWidth(),this.table.columnManager.verticalAlignHeaders(),this.dispatch("column-show",this,t),e||this.dispatchExternal("columnVisibilityChanged",this.getComponent(),!0),this.parent.isGroup&&this.parent.matchChildWidths(),this.silent||this.table.columnManager.rerenderColumns())}hide(e,t){this.visible&&(this.visible=!1,this.element.style.display="none",this.table.columnManager.verticalAlignHeaders(),this.parent.isGroup&&this.parent.checkColumnVisibility(),this.cells.forEach(function(r){r.hide()}),this.dispatch("column-hide",this,t),e||this.dispatchExternal("columnVisibilityChanged",this.getComponent(),!1),this.parent.isGroup&&this.parent.matchChildWidths(),this.silent||this.table.columnManager.rerenderColumns())}matchChildWidths(){var e=0;this.contentElement&&this.columns.length&&(this.columns.forEach(function(t){t.visible&&(e+=t.getWidth())}),this.contentElement.style.maxWidth=e-1+"px",this.table.initialized&&(this.element.style.width=e+"px"),this.parent.isGroup&&this.parent.matchChildWidths())}removeChild(e){var t=this.columns.indexOf(e);t>-1&&this.columns.splice(t,1),this.columns.length||this.delete()}setWidth(e){this.widthFixed=!0,this.setWidthActual(e)}setWidthActual(e){isNaN(e)&&(e=Math.floor(this.table.element.clientWidth/100*parseInt(e))),e=Math.max(this.minWidth,e),this.maxWidth&&(e=Math.min(this.maxWidth,e)),this.width=e,this.widthStyled=e?e+"px":"",this.element.style.width=this.widthStyled,this.isGroup||this.cells.forEach(function(t){t.setWidth()}),this.parent.isGroup&&this.parent.matchChildWidths(),this.dispatch("column-width",this),this.subscribedExternal("columnWidth")&&this.dispatchExternal("columnWidth",this.getComponent())}checkCellHeights(){var e=[];this.cells.forEach(function(t){t.row.heightInitialized&&(t.row.getElement().offsetParent!==null?(e.push(t.row),t.row.clearCellHeight()):t.row.heightInitialized=!1)}),e.forEach(function(t){t.calcHeight()}),e.forEach(function(t){t.setCellHeight()})}getWidth(){var e=0;return this.isGroup?this.columns.forEach(function(t){t.visible&&(e+=t.getWidth())}):e=this.width,e}getLeftOffset(){var e=this.element.offsetLeft;return this.parent.isGroup&&(e+=this.parent.getLeftOffset()),e}getHeight(){return Math.ceil(this.element.getBoundingClientRect().height)}setMinWidth(e){this.maxWidth&&e>this.maxWidth&&(e=this.maxWidth,console.warn("the minWidth ("+e+"px) for column '"+this.field+"' cannot be bigger that its maxWidth ("+this.maxWidthStyled+")")),this.minWidth=e,this.minWidthStyled=e?e+"px":"",this.element.style.minWidth=this.minWidthStyled,this.cells.forEach(function(t){t.setMinWidth()})}setMaxWidth(e){this.minWidth&&e<this.minWidth&&(e=this.minWidth,console.warn("the maxWidth ("+e+"px) for column '"+this.field+"' cannot be smaller that its minWidth ("+this.minWidthStyled+")")),this.maxWidth=e,this.maxWidthStyled=e?e+"px":"",this.element.style.maxWidth=this.maxWidthStyled,this.cells.forEach(function(t){t.setMaxWidth()})}delete(){return new Promise((e,t)=>{this.isGroup&&this.columns.forEach(function(a){a.delete()}),this.dispatch("column-delete",this);var r=this.cells.length;for(let a=0;a<r;a++)this.cells[0].delete();this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.element=!1,this.contentElement=!1,this.titleElement=!1,this.groupElement=!1,this.parent.isGroup&&this.parent.removeChild(this),this.table.columnManager.deregisterColumn(this),this.table.columnManager.rerenderColumns(!0),this.dispatch("column-deleted",this),e()})}columnRendered(){this.titleFormatterRendered&&this.titleFormatterRendered(),this.dispatch("column-rendered",this)}generateCell(e){var t=new mu(this,e);return this.cells.push(t),t}nextColumn(){var e=this.table.columnManager.findColumnIndex(this);return e>-1?this._nextVisibleColumn(e+1):!1}_nextVisibleColumn(e){var t=this.table.columnManager.getColumnByIndex(e);return!t||t.visible?t:this._nextVisibleColumn(e+1)}prevColumn(){var e=this.table.columnManager.findColumnIndex(this);return e>-1?this._prevVisibleColumn(e-1):!1}_prevVisibleColumn(e){var t=this.table.columnManager.getColumnByIndex(e);return!t||t.visible?t:this._prevVisibleColumn(e-1)}reinitializeWidth(e){this.widthFixed=!1,typeof this.definition.width<"u"&&!e&&this.setWidth(this.definition.width),this.dispatch("column-width-fit-before",this),this.fitToData(e),this.dispatch("column-width-fit-after",this)}fitToData(e){if(!this.isGroup){this.widthFixed||(this.element.style.width="",this.cells.forEach(a=>{a.clearWidth()}));var t=this.element.offsetWidth;if((!this.width||!this.widthFixed)&&(this.cells.forEach(a=>{var s=a.getWidth();s>t&&(t=s)}),t)){var r=t+1;e?this.setWidth(r):(this.maxInitialWidth&&!e&&(r=Math.min(r,this.maxInitialWidth)),this.setWidthActual(r))}}}updateDefinition(e){var t;return this.isGroup||this.parent.isGroup?(console.error("Column Update Error - The updateDefinition function is only available on ungrouped columns"),Promise.reject("Column Update Error - The updateDefinition function is only available on columns, not column groups")):(t=Object.assign({},this.getDefinition()),t=Object.assign(t,e),this.table.columnManager.addColumn(t,!1,this).then(r=>(t.field==this.field&&(this.field=!1),this.delete().then(()=>r.getComponent()))))}deleteCell(e){var t=this.cells.indexOf(e);t>-1&&this.cells.splice(t,1)}getComponent(){return this.component||(this.component=new ky(this)),this.component}getPosition(){return this.table.columnManager.getVisibleColumnsByIndex().indexOf(this)+1}getParentComponent(){return this.parent instanceof as?this.parent.getComponent():!1}};Be(as,"defaultOptionList",Ay);let fs=as;class Eh{constructor(e){return this._row=e,new Proxy(this,{get:function(t,r,a){return typeof t[r]<"u"?t[r]:t._row.table.componentFunctionBinder.handle("row",t._row,r)}})}getData(e){return this._row.getData(e)}getElement(){return this._row.getElement()}getCells(){var e=[];return this._row.getCells().forEach(function(t){e.push(t.getComponent())}),e}getCell(e){var t=this._row.getCell(e);return t?t.getComponent():!1}getIndex(){return this._row.getData("data")[this._row.table.options.index]}getPosition(){return this._row.getPosition()}watchPosition(e){return this._row.watchPosition(e)}delete(){return this._row.delete()}scrollTo(e,t){return this._row.table.rowManager.scrollToRow(this._row,e,t)}move(e,t){this._row.moveToRow(e,t)}update(e){return this._row.updateData(e)}normalizeHeight(){this._row.normalizeHeight(!0)}_getSelf(){return this._row}reformat(){return this._row.reinitialize()}getTable(){return this._row.table}getNextRow(){var e=this._row.nextRow();return e&&e.getComponent()}getPrevRow(){var e=this._row.prevRow();return e&&e.getComponent()}}class Gi extends zi{constructor(e,t,r="row"){super(t.table),this.parent=t,this.data={},this.type=r,this.element=!1,this.modules={},this.cells=[],this.height=0,this.heightStyled="",this.manualHeight=!1,this.outerHeight=0,this.initialized=!1,this.heightInitialized=!1,this.position=0,this.positionWatchers=[],this.component=null,this.created=!1,this.setData(e)}create(){this.created||(this.created=!0,this.generateElement())}createElement(){var e=document.createElement("div");e.classList.add("tabulator-row"),e.setAttribute("role","row"),this.element=e}getElement(){return this.create(),this.element}detachElement(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element)}generateElement(){this.createElement(),this.dispatch("row-init",this)}generateCells(){this.cells=this.table.columnManager.generateCells(this)}initialize(e,t){if(this.create(),!this.initialized||e){for(this.deleteCells();this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.dispatch("row-layout-before",this),this.generateCells(),this.initialized=!0,this.table.columnManager.renderer.renderRowCells(this,t),e&&this.normalizeHeight(),this.dispatch("row-layout",this),this.table.options.rowFormatter&&this.table.options.rowFormatter(this.getComponent()),this.dispatch("row-layout-after",this)}else this.table.columnManager.renderer.rerenderRowCells(this,t)}rendered(){this.cells.forEach(e=>{e.cellRendered()})}reinitializeHeight(){this.heightInitialized=!1,this.element&&this.element.offsetParent!==null&&this.normalizeHeight(!0)}deinitialize(){this.initialized=!1}deinitializeHeight(){this.heightInitialized=!1}reinitialize(e){this.initialized=!1,this.heightInitialized=!1,this.manualHeight||(this.height=0,this.heightStyled=""),this.element&&this.element.offsetParent!==null&&this.initialize(!0),this.dispatch("row-relayout",this)}calcHeight(e){var t=0,r=0;this.table.options.rowHeight?this.height=this.table.options.rowHeight:(r=this.calcMinHeight(),t=this.calcMaxHeight(),e?this.height=Math.max(t,r):this.height=this.manualHeight?this.height:Math.max(t,r)),this.heightStyled=this.height?this.height+"px":"",this.outerHeight=this.element.offsetHeight}calcMinHeight(){return this.table.options.resizableRows?this.element.clientHeight:0}calcMaxHeight(){var e=0;return this.cells.forEach(function(t){var r=t.getHeight();r>e&&(e=r)}),e}setCellHeight(){this.cells.forEach(function(e){e.setHeight()}),this.heightInitialized=!0}clearCellHeight(){this.cells.forEach(function(e){e.clearHeight()})}normalizeHeight(e){e&&!this.table.options.rowHeight&&this.clearCellHeight(),this.calcHeight(e),this.setCellHeight()}setHeight(e,t){(this.height!=e||t)&&(this.manualHeight=!0,this.height=e,this.heightStyled=e?e+"px":"",this.setCellHeight(),this.outerHeight=this.element.offsetHeight,this.subscribedExternal("rowHeight")&&this.dispatchExternal("rowHeight",this.getComponent()))}getHeight(){return this.outerHeight}getWidth(){return this.element.offsetWidth}deleteCell(e){var t=this.cells.indexOf(e);t>-1&&this.cells.splice(t,1)}setData(e){this.data=this.chain("row-data-init-before",[this,e],void 0,e),this.dispatch("row-data-init-after",this)}updateData(e){var t=this.element&&Wt.elVisible(this.element),r={},a;return new Promise((s,o)=>{typeof e=="string"&&(e=JSON.parse(e)),this.dispatch("row-data-save-before",this),this.subscribed("row-data-changing")&&(r=Object.assign(r,this.data),r=Object.assign(r,e)),a=this.chain("row-data-changing",[this,r,e],null,e);for(let u in a)this.data[u]=a[u];this.dispatch("row-data-save-after",this);for(let u in e)this.table.columnManager.getColumnsByFieldRoot(u).forEach(d=>{let p=this.getCell(d.getField());if(p){let b=d.getFieldValue(a);p.getValue()!==b&&(p.setValueProcessData(b),t&&p.cellRendered())}});t?(this.normalizeHeight(!0),this.table.options.rowFormatter&&this.table.options.rowFormatter(this.getComponent())):(this.initialized=!1,this.height=0,this.heightStyled=""),this.dispatch("row-data-changed",this,t,e),this.dispatchExternal("rowUpdated",this.getComponent()),this.subscribedExternal("dataChanged")&&this.dispatchExternal("dataChanged",this.table.rowManager.getData()),s()})}getData(e){return e?this.chain("row-data-retrieve",[this,e],null,this.data):this.data}getCell(e){var t=!1;return e=this.table.columnManager.findColumn(e),!this.initialized&&this.cells.length===0&&this.generateCells(),t=this.cells.find(function(r){return r.column===e}),t}getCellIndex(e){return this.cells.findIndex(function(t){return t===e})}findCell(e){return this.cells.find(t=>t.element===e)}getCells(){return!this.initialized&&this.cells.length===0&&this.generateCells(),this.cells}nextRow(){var e=this.table.rowManager.nextDisplayRow(this,!0);return e||!1}prevRow(){var e=this.table.rowManager.prevDisplayRow(this,!0);return e||!1}moveToRow(e,t){var r=this.table.rowManager.findRow(e);r?(this.table.rowManager.moveRowActual(this,r,!t),this.table.rowManager.refreshActiveData("display",!1,!0)):console.warn("Move Error - No matching row found:",e)}delete(){return this.dispatch("row-delete",this),this.deleteActual(),Promise.resolve()}deleteActual(e){this.detachModules(),this.table.rowManager.deleteRow(this,e),this.deleteCells(),this.initialized=!1,this.heightInitialized=!1,this.element=!1,this.dispatch("row-deleted",this)}detachModules(){this.dispatch("row-deleting",this)}deleteCells(){var e=this.cells.length;for(let t=0;t<e;t++)this.cells[0].delete()}wipe(){if(this.detachModules(),this.deleteCells(),this.element){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.element.parentNode&&this.element.parentNode.removeChild(this.element)}this.element=!1,this.modules={}}isDisplayed(){return this.table.rowManager.getDisplayRows().includes(this)}getPosition(){return this.isDisplayed()?this.position:!1}setPosition(e){e!=this.position&&(this.position=e,this.positionWatchers.forEach(t=>{t(this.position)}))}watchPosition(e){this.positionWatchers.push(e),e(this.position)}getGroup(){return this.modules.group||!1}getComponent(){return this.component||(this.component=new Eh(this)),this.component}}var vL={avg:function(i,e,t){var r=0,a=typeof t.precision<"u"?t.precision:2;return i.length&&(r=i.reduce(function(s,o){return Number(s)+Number(o)}),r=r/i.length,r=a!==!1?r.toFixed(a):r),parseFloat(r).toString()},max:function(i,e,t){var r=null,a=typeof t.precision<"u"?t.precision:!1;return i.forEach(function(s){s=Number(s),(s>r||r===null)&&(r=s)}),r!==null?a!==!1?r.toFixed(a):r:""},min:function(i,e,t){var r=null,a=typeof t.precision<"u"?t.precision:!1;return i.forEach(function(s){s=Number(s),(s<r||r===null)&&(r=s)}),r!==null?a!==!1?r.toFixed(a):r:""},sum:function(i,e,t){var r=0,a=typeof t.precision<"u"?t.precision:!1;return i.length&&i.forEach(function(s){s=Number(s),r+=isNaN(s)?0:Number(s)}),a!==!1?r.toFixed(a):r},concat:function(i,e,t){var r=0;return i.length&&(r=i.reduce(function(a,s){return String(a)+String(s)})),r},count:function(i,e,t){var r=0;return i.length&&i.forEach(function(a){a&&r++}),r},unique:function(i,e,t){var r=i.filter((a,s)=>(i||a===0)&&i.indexOf(a)===s);return r.length}};const gn=class gn extends ct{constructor(e){super(e),this.topCalcs=[],this.botCalcs=[],this.genColumn=!1,this.topElement=this.createElement(),this.botElement=this.createElement(),this.topRow=!1,this.botRow=!1,this.topInitialized=!1,this.botInitialized=!1,this.blocked=!1,this.recalcAfterBlock=!1,this.registerTableOption("columnCalcs",!0),this.registerColumnOption("topCalc"),this.registerColumnOption("topCalcParams"),this.registerColumnOption("topCalcFormatter"),this.registerColumnOption("topCalcFormatterParams"),this.registerColumnOption("bottomCalc"),this.registerColumnOption("bottomCalcParams"),this.registerColumnOption("bottomCalcFormatter"),this.registerColumnOption("bottomCalcFormatterParams")}createElement(){var e=document.createElement("div");return e.classList.add("tabulator-calcs-holder"),e}initialize(){this.genColumn=new fs({field:"value"},this),this.subscribe("cell-value-changed",this.cellValueChanged.bind(this)),this.subscribe("column-init",this.initializeColumnCheck.bind(this)),this.subscribe("row-deleted",this.rowsUpdated.bind(this)),this.subscribe("scroll-horizontal",this.scrollHorizontal.bind(this)),this.subscribe("row-added",this.rowsUpdated.bind(this)),this.subscribe("column-moved",this.recalcActiveRows.bind(this)),this.subscribe("column-add",this.recalcActiveRows.bind(this)),this.subscribe("data-refreshed",this.recalcActiveRowsRefresh.bind(this)),this.subscribe("table-redraw",this.tableRedraw.bind(this)),this.subscribe("rows-visible",this.visibleRows.bind(this)),this.subscribe("scrollbar-vertical",this.adjustForScrollbar.bind(this)),this.subscribe("redraw-blocked",this.blockRedraw.bind(this)),this.subscribe("redraw-restored",this.restoreRedraw.bind(this)),this.subscribe("table-redrawing",this.resizeHolderWidth.bind(this)),this.subscribe("column-resized",this.resizeHolderWidth.bind(this)),this.subscribe("column-show",this.resizeHolderWidth.bind(this)),this.subscribe("column-hide",this.resizeHolderWidth.bind(this)),this.registerTableFunction("getCalcResults",this.getResults.bind(this)),this.registerTableFunction("recalc",this.userRecalc.bind(this)),this.resizeHolderWidth()}resizeHolderWidth(){this.topElement.style.minWidth=this.table.columnManager.headersElement.offsetWidth+"px"}tableRedraw(e){this.recalc(this.table.rowManager.activeRows),e&&this.redraw()}blockRedraw(){this.blocked=!0,this.recalcAfterBlock=!1}restoreRedraw(){this.blocked=!1,this.recalcAfterBlock&&(this.recalcAfterBlock=!1,this.recalcActiveRowsRefresh())}userRecalc(){this.recalc(this.table.rowManager.activeRows)}blockCheck(){return this.blocked&&(this.recalcAfterBlock=!0),this.blocked}visibleRows(e,t){return this.topRow&&t.unshift(this.topRow),this.botRow&&t.push(this.botRow),t}rowsUpdated(e){this.table.options.groupBy?this.recalcRowGroup(e):this.recalcActiveRows()}recalcActiveRowsRefresh(){this.table.options.groupBy&&this.table.options.dataTreeStartExpanded&&this.table.options.dataTree?this.recalcAll():this.recalcActiveRows()}recalcActiveRows(){this.recalc(this.table.rowManager.activeRows)}cellValueChanged(e){(e.column.definition.topCalc||e.column.definition.bottomCalc)&&(this.table.options.groupBy?((this.table.options.columnCalcs=="table"||this.table.options.columnCalcs=="both")&&this.recalcActiveRows(),this.table.options.columnCalcs!="table"&&this.recalcRowGroup(e.row)):this.recalcActiveRows())}initializeColumnCheck(e){(e.definition.topCalc||e.definition.bottomCalc)&&this.initializeColumn(e)}initializeColumn(e){var t=e.definition,r={topCalcParams:t.topCalcParams||{},botCalcParams:t.bottomCalcParams||{}};if(t.topCalc){switch(typeof t.topCalc){case"string":gn.calculations[t.topCalc]?r.topCalc=gn.calculations[t.topCalc]:console.warn("Column Calc Error - No such calculation found, ignoring: ",t.topCalc);break;case"function":r.topCalc=t.topCalc;break}r.topCalc&&(e.modules.columnCalcs=r,this.topCalcs.push(e),this.table.options.columnCalcs!="group"&&this.initializeTopRow())}if(t.bottomCalc){switch(typeof t.bottomCalc){case"string":gn.calculations[t.bottomCalc]?r.botCalc=gn.calculations[t.bottomCalc]:console.warn("Column Calc Error - No such calculation found, ignoring: ",t.bottomCalc);break;case"function":r.botCalc=t.bottomCalc;break}r.botCalc&&(e.modules.columnCalcs=r,this.botCalcs.push(e),this.table.options.columnCalcs!="group"&&this.initializeBottomRow())}}registerColumnField(){}removeCalcs(){var e=!1;this.topInitialized&&(this.topInitialized=!1,this.topElement.parentNode.removeChild(this.topElement),e=!0),this.botInitialized&&(this.botInitialized=!1,this.footerRemove(this.botElement),e=!0),e&&this.table.rowManager.adjustTableSize()}reinitializeCalcs(){this.topCalcs.length&&this.initializeTopRow(),this.botCalcs.length&&this.initializeBottomRow()}initializeTopRow(){var e=document.createDocumentFragment();this.topInitialized||(e.appendChild(document.createElement("br")),e.appendChild(this.topElement),this.table.columnManager.getContentsElement().insertBefore(e,this.table.columnManager.headersElement.nextSibling),this.topInitialized=!0)}initializeBottomRow(){this.botInitialized||(this.footerPrepend(this.botElement),this.botInitialized=!0)}scrollHorizontal(e){this.botInitialized&&this.botRow&&(this.botElement.scrollLeft=e)}recalc(e){var t,r;if(!this.blockCheck()&&(this.topInitialized||this.botInitialized)){if(t=this.rowsToData(e),this.topInitialized){for(this.topRow&&this.topRow.deleteCells(),r=this.generateRow("top",t),this.topRow=r;this.topElement.firstChild;)this.topElement.removeChild(this.topElement.firstChild);this.topElement.appendChild(r.getElement()),r.initialize(!0)}if(this.botInitialized){for(this.botRow&&this.botRow.deleteCells(),r=this.generateRow("bottom",t),this.botRow=r;this.botElement.firstChild;)this.botElement.removeChild(this.botElement.firstChild);this.botElement.appendChild(r.getElement()),r.initialize(!0)}this.table.rowManager.adjustTableSize(),this.table.modExists("frozenColumns")&&this.table.modules.frozenColumns.layout()}}recalcRowGroup(e){this.recalcGroup(this.table.modules.groupRows.getRowGroup(e))}recalcAll(){if((this.topCalcs.length||this.botCalcs.length)&&(this.table.options.columnCalcs!=="group"&&this.recalcActiveRows(),this.table.options.groupBy&&this.table.options.columnCalcs!=="table")){var e=this.table.modules.groupRows.getChildGroups();e.forEach(t=>{this.recalcGroup(t)})}}recalcGroup(e){var t,r;this.blockCheck()||e&&e.calcs&&(e.calcs.bottom&&(t=this.rowsToData(e.rows),r=this.generateRowData("bottom",t),e.calcs.bottom.updateData(r),e.calcs.bottom.reinitialize()),e.calcs.top&&(t=this.rowsToData(e.rows),r=this.generateRowData("top",t),e.calcs.top.updateData(r),e.calcs.top.reinitialize()))}generateTopRow(e){return this.generateRow("top",this.rowsToData(e))}generateBottomRow(e){return this.generateRow("bottom",this.rowsToData(e))}rowsToData(e){var t=[],r=this.table.options.dataTree&&this.table.options.dataTreeChildColumnCalcs,a=this.table.modules.dataTree;return e.forEach(s=>{var o;t.push(s.getData()),r&&((o=s.modules.dataTree)!=null&&o.open)&&this.rowsToData(a.getFilteredTreeChildren(s)).forEach(u=>{t.push(s)})}),t}generateRow(e,t){var r=this.generateRowData(e,t),a;return this.table.modExists("mutator")&&this.table.modules.mutator.disable(),a=new Gi(r,this,"calc"),this.table.modExists("mutator")&&this.table.modules.mutator.enable(),a.getElement().classList.add("tabulator-calcs","tabulator-calcs-"+e),a.component=!1,a.getComponent=()=>(a.component||(a.component=new gL(a)),a.component),a.generateCells=()=>{var s=[];this.table.columnManager.columnsByIndex.forEach(o=>{this.genColumn.setField(o.getField()),this.genColumn.hozAlign=o.hozAlign,o.definition[e+"CalcFormatter"]&&this.table.modExists("format")?this.genColumn.modules.format={formatter:this.table.modules.format.lookupFormatter(o.definition[e+"CalcFormatter"]),params:o.definition[e+"CalcFormatterParams"]||{}}:this.genColumn.modules.format={formatter:this.table.modules.format.lookupFormatter("plaintext"),params:{}},this.genColumn.definition.cssClass=o.definition.cssClass;var u=new mu(this.genColumn,a);u.getElement(),u.column=o,u.setWidth(),o.cells.push(u),s.push(u),o.visible||u.hide()}),a.cells=s},a}generateRowData(e,t){var r={},a=e=="top"?this.topCalcs:this.botCalcs,s=e=="top"?"topCalc":"botCalc",o,u;return a.forEach(function(h){var d=[];h.modules.columnCalcs&&h.modules.columnCalcs[s]&&(t.forEach(function(p){d.push(h.getFieldValue(p))}),u=s+"Params",o=typeof h.modules.columnCalcs[u]=="function"?h.modules.columnCalcs[u](d,t):h.modules.columnCalcs[u],h.setFieldValue(r,h.modules.columnCalcs[s](d,t,o)))}),r}hasTopCalcs(){return!!this.topCalcs.length}hasBottomCalcs(){return!!this.botCalcs.length}redraw(){this.topRow&&this.topRow.normalizeHeight(!0),this.botRow&&this.botRow.normalizeHeight(!0)}getResults(){var e={},t;return this.table.options.groupBy&&this.table.modExists("groupRows")?(t=this.table.modules.groupRows.getGroups(!0),t.forEach(r=>{e[r.getKey()]=this.getGroupResults(r)})):e={top:this.topRow?this.topRow.getData():{},bottom:this.botRow?this.botRow.getData():{}},e}getGroupResults(e){var t=e._getSelf(),r=e.getSubGroups(),a={},s={};return r.forEach(o=>{a[o.getKey()]=this.getGroupResults(o)}),s={top:t.calcs.top?t.calcs.top.getData():{},bottom:t.calcs.bottom?t.calcs.bottom.getData():{},groups:a},s}adjustForScrollbar(e){this.botRow&&(this.table.rtl?this.botElement.style.paddingLeft=e+"px":this.botElement.style.paddingRight=e+"px")}};Be(gn,"moduleName","columnCalcs"),Be(gn,"calculations",vL);let k0=gn;class Dy extends ct{constructor(e){super(e),this.indent=10,this.field="",this.collapseEl=null,this.expandEl=null,this.branchEl=null,this.elementField=!1,this.startOpen=function(){},this.registerTableOption("dataTree",!1),this.registerTableOption("dataTreeFilter",!0),this.registerTableOption("dataTreeSort",!0),this.registerTableOption("dataTreeElementColumn",!1),this.registerTableOption("dataTreeBranchElement",!0),this.registerTableOption("dataTreeChildIndent",9),this.registerTableOption("dataTreeChildField","_children"),this.registerTableOption("dataTreeCollapseElement",!1),this.registerTableOption("dataTreeExpandElement",!1),this.registerTableOption("dataTreeStartExpanded",!1),this.registerTableOption("dataTreeChildColumnCalcs",!1),this.registerTableOption("dataTreeSelectPropagate",!1),this.registerComponentFunction("row","treeCollapse",this.collapseRow.bind(this)),this.registerComponentFunction("row","treeExpand",this.expandRow.bind(this)),this.registerComponentFunction("row","treeToggle",this.toggleRow.bind(this)),this.registerComponentFunction("row","getTreeParent",this.getTreeParent.bind(this)),this.registerComponentFunction("row","getTreeChildren",this.getRowChildren.bind(this)),this.registerComponentFunction("row","addTreeChild",this.addTreeChildRow.bind(this)),this.registerComponentFunction("row","isTreeExpanded",this.isRowExpanded.bind(this))}initialize(){if(this.table.options.dataTree){var e=null,t=this.table.options;switch(this.field=t.dataTreeChildField,this.indent=t.dataTreeChildIndent,this.options("movableRows")&&console.warn("The movableRows option is not available with dataTree enabled, moving of child rows could result in unpredictable behavior"),t.dataTreeBranchElement?t.dataTreeBranchElement===!0?(this.branchEl=document.createElement("div"),this.branchEl.classList.add("tabulator-data-tree-branch")):typeof t.dataTreeBranchElement=="string"?(e=document.createElement("div"),e.innerHTML=t.dataTreeBranchElement,this.branchEl=e.firstChild):this.branchEl=t.dataTreeBranchElement:(this.branchEl=document.createElement("div"),this.branchEl.classList.add("tabulator-data-tree-branch-empty")),t.dataTreeCollapseElement?typeof t.dataTreeCollapseElement=="string"?(e=document.createElement("div"),e.innerHTML=t.dataTreeCollapseElement,this.collapseEl=e.firstChild):this.collapseEl=t.dataTreeCollapseElement:(this.collapseEl=document.createElement("div"),this.collapseEl.classList.add("tabulator-data-tree-control"),this.collapseEl.tabIndex=0,this.collapseEl.innerHTML="<div class='tabulator-data-tree-control-collapse'></div>"),t.dataTreeExpandElement?typeof t.dataTreeExpandElement=="string"?(e=document.createElement("div"),e.innerHTML=t.dataTreeExpandElement,this.expandEl=e.firstChild):this.expandEl=t.dataTreeExpandElement:(this.expandEl=document.createElement("div"),this.expandEl.classList.add("tabulator-data-tree-control"),this.expandEl.tabIndex=0,this.expandEl.innerHTML="<div class='tabulator-data-tree-control-expand'></div>"),typeof t.dataTreeStartExpanded){case"boolean":this.startOpen=function(r,a){return t.dataTreeStartExpanded};break;case"function":this.startOpen=t.dataTreeStartExpanded;break;default:this.startOpen=function(r,a){return t.dataTreeStartExpanded[a]};break}this.subscribe("row-init",this.initializeRow.bind(this)),this.subscribe("row-layout-after",this.layoutRow.bind(this)),this.subscribe("row-deleting",this.rowDeleting.bind(this)),this.subscribe("row-deleted",this.rowDelete.bind(this),0),this.subscribe("row-data-changed",this.rowDataChanged.bind(this),10),this.subscribe("cell-value-updated",this.cellValueChanged.bind(this)),this.subscribe("edit-cancelled",this.cellValueChanged.bind(this)),this.subscribe("column-moving-rows",this.columnMoving.bind(this)),this.subscribe("table-built",this.initializeElementField.bind(this)),this.subscribe("table-redrawing",this.tableRedrawing.bind(this)),this.registerDisplayHandler(this.getRows.bind(this),30)}}tableRedrawing(e){var t;e&&(t=this.table.rowManager.getRows(),t.forEach(r=>{this.reinitializeRowChildren(r)}))}initializeElementField(){var e=this.table.columnManager.getFirstVisibleColumn();this.elementField=this.table.options.dataTreeElementColumn||(e?e.field:!1)}getRowChildren(e){return this.getTreeChildren(e,!0)}columnMoving(){var e=[];return this.table.rowManager.rows.forEach(t=>{e=e.concat(this.getTreeChildren(t,!1,!0))}),e}rowDataChanged(e,t,r){this.redrawNeeded(r)&&(this.initializeRow(e),t&&(this.layoutRow(e),this.refreshData(!0)))}cellValueChanged(e){var t=e.column.getField();t===this.elementField&&this.layoutRow(e.row)}initializeRow(e){var t=e.getData()[this.field],r=Array.isArray(t),a=r||!r&&typeof t=="object"&&t!==null;!a&&e.modules.dataTree&&e.modules.dataTree.branchEl&&e.modules.dataTree.branchEl.parentNode.removeChild(e.modules.dataTree.branchEl),!a&&e.modules.dataTree&&e.modules.dataTree.controlEl&&e.modules.dataTree.controlEl.parentNode.removeChild(e.modules.dataTree.controlEl),e.modules.dataTree={index:e.modules.dataTree?e.modules.dataTree.index:0,open:a?e.modules.dataTree?e.modules.dataTree.open:this.startOpen(e.getComponent(),0):!1,controlEl:e.modules.dataTree&&a?e.modules.dataTree.controlEl:!1,branchEl:e.modules.dataTree&&a?e.modules.dataTree.branchEl:!1,parent:e.modules.dataTree?e.modules.dataTree.parent:!1,children:a}}reinitializeRowChildren(e){var t=this.getTreeChildren(e,!1,!0);t.forEach(function(r){r.reinitialize(!0)})}layoutRow(e){var t=this.elementField?e.getCell(this.elementField):e.getCells()[0],r=t.getElement(),a=e.modules.dataTree;a.branchEl&&(a.branchEl.parentNode&&a.branchEl.parentNode.removeChild(a.branchEl),a.branchEl=!1),a.controlEl&&(a.controlEl.parentNode&&a.controlEl.parentNode.removeChild(a.controlEl),a.controlEl=!1),this.generateControlElement(e,r),e.getElement().classList.add("tabulator-tree-level-"+a.index),a.index&&(this.branchEl?(a.branchEl=this.branchEl.cloneNode(!0),r.insertBefore(a.branchEl,r.firstChild),this.table.rtl?a.branchEl.style.marginRight=(a.branchEl.offsetWidth+a.branchEl.style.marginLeft)*(a.index-1)+a.index*this.indent+"px":a.branchEl.style.marginLeft=(a.branchEl.offsetWidth+a.branchEl.style.marginRight)*(a.index-1)+a.index*this.indent+"px"):this.table.rtl?r.style.paddingRight=parseInt(window.getComputedStyle(r,null).getPropertyValue("padding-right"))+a.index*this.indent+"px":r.style.paddingLeft=parseInt(window.getComputedStyle(r,null).getPropertyValue("padding-left"))+a.index*this.indent+"px")}generateControlElement(e,t){var r=e.modules.dataTree,a=r.controlEl;t=t||e.getCells()[0].getElement(),r.children!==!1&&(r.open?(r.controlEl=this.collapseEl.cloneNode(!0),r.controlEl.addEventListener("click",s=>{s.stopPropagation(),this.collapseRow(e)})):(r.controlEl=this.expandEl.cloneNode(!0),r.controlEl.addEventListener("click",s=>{s.stopPropagation(),this.expandRow(e)})),r.controlEl.addEventListener("mousedown",s=>{s.stopPropagation()}),a&&a.parentNode===t?a.parentNode.replaceChild(r.controlEl,a):t.insertBefore(r.controlEl,t.firstChild))}getRows(e){var t=[];return e.forEach((r,a)=>{var s,o;t.push(r),r instanceof Gi&&(r.create(),s=r.modules.dataTree,!s.index&&s.children!==!1&&(o=this.getChildren(r,!1,!0),o.forEach(u=>{u.create(),t.push(u)})))}),t}getChildren(e,t,r){var a=e.modules.dataTree,s=[],o=[];return a.children!==!1&&(a.open||t)&&(Array.isArray(a.children)||(a.children=this.generateChildren(e)),this.table.modExists("filter")&&this.table.options.dataTreeFilter?s=this.table.modules.filter.filter(a.children):s=a.children,this.table.modExists("sort")&&this.table.options.dataTreeSort&&this.table.modules.sort.sort(s,r),s.forEach(u=>{o.push(u);var h=this.getChildren(u,!1,!0);h.forEach(d=>{o.push(d)})})),o}generateChildren(e){var t=[],r=e.getData()[this.field];return Array.isArray(r)||(r=[r]),r.forEach(a=>{var s=new Gi(a||{},this.table.rowManager);s.create(),s.modules.dataTree.index=e.modules.dataTree.index+1,s.modules.dataTree.parent=e,s.modules.dataTree.children&&(s.modules.dataTree.open=this.startOpen(s.getComponent(),s.modules.dataTree.index)),t.push(s)}),t}expandRow(e,t){var r=e.modules.dataTree;r.children!==!1&&(r.open=!0,e.reinitialize(),this.refreshData(!0),this.dispatchExternal("dataTreeRowExpanded",e.getComponent(),e.modules.dataTree.index))}collapseRow(e){var t=e.modules.dataTree;t.children!==!1&&(t.open=!1,e.reinitialize(),this.refreshData(!0),this.dispatchExternal("dataTreeRowCollapsed",e.getComponent(),e.modules.dataTree.index))}toggleRow(e){var t=e.modules.dataTree;t.children!==!1&&(t.open?this.collapseRow(e):this.expandRow(e))}isRowExpanded(e){return e.modules.dataTree.open}getTreeParent(e){return e.modules.dataTree.parent?e.modules.dataTree.parent.getComponent():!1}getTreeParentRoot(e){return e.modules.dataTree&&e.modules.dataTree.parent?this.getTreeParentRoot(e.modules.dataTree.parent):e}getFilteredTreeChildren(e){var t=e.modules.dataTree,r=[],a;return t.children&&(Array.isArray(t.children)||(t.children=this.generateChildren(e)),this.table.modExists("filter")&&this.table.options.dataTreeFilter?a=this.table.modules.filter.filter(t.children):a=t.children,a.forEach(s=>{s instanceof Gi&&r.push(s)})),r}rowDeleting(e){var t=e.modules.dataTree;t&&t.children&&Array.isArray(t.children)&&t.children.forEach(r=>{r instanceof Gi&&r.wipe()})}rowDelete(e){var t=e.modules.dataTree.parent,r;t&&(r=this.findChildIndex(e,t),r!==!1&&t.data[this.field].splice(r,1),t.data[this.field].length||delete t.data[this.field],this.initializeRow(t),this.layoutRow(t)),this.refreshData(!0)}addTreeChildRow(e,t,r,a){var s=!1;typeof t=="string"&&(t=JSON.parse(t)),Array.isArray(e.data[this.field])||(e.data[this.field]=[],e.modules.dataTree.open=this.startOpen(e.getComponent(),e.modules.dataTree.index)),typeof a<"u"&&(s=this.findChildIndex(a,e),s!==!1&&e.data[this.field].splice(r?s:s+1,0,t)),s===!1&&(r?e.data[this.field].unshift(t):e.data[this.field].push(t)),this.initializeRow(e),this.layoutRow(e),this.refreshData(!0)}findChildIndex(e,t){var r=!1;return typeof e=="object"?e instanceof Gi?r=e.data:e instanceof Eh?r=e._getSelf().data:typeof HTMLElement<"u"&&e instanceof HTMLElement?t.modules.dataTree&&(r=t.modules.dataTree.children.find(a=>a instanceof Gi?a.element===e:!1),r&&(r=r.data)):e===null&&(r=!1):typeof e>"u"?r=!1:r=t.data[this.field].find(a=>a.data[this.table.options.index]==e),r&&(Array.isArray(t.data[this.field])&&(r=t.data[this.field].indexOf(r)),r==-1&&(r=!1)),r}getTreeChildren(e,t,r){var a=e.modules.dataTree,s=[];return a&&a.children&&(Array.isArray(a.children)||(a.children=this.generateChildren(e)),a.children.forEach(o=>{o instanceof Gi&&(s.push(t?o.getComponent():o),r&&this.getTreeChildren(o,t,r).forEach(u=>{s.push(u)}))})),s}getChildField(){return this.field}redrawNeeded(e){return(this.field?typeof e[this.field]<"u":!1)||(this.elementField?typeof e[this.elementField]<"u":!1)}}Be(Dy,"moduleName","dataTree");function bL(i,e={},t){var r=e.delimiter?e.delimiter:",",a=[],s=[];i.forEach(o=>{var u=[];switch(o.type){case"group":console.warn("Download Warning - CSV downloader cannot process row groups");break;case"calc":console.warn("Download Warning - CSV downloader cannot process column calculations");break;case"header":o.columns.forEach((h,d)=>{h&&h.depth===1&&(s[d]=typeof h.value>"u"||h.value===null?"":'"'+String(h.value).split('"').join('""')+'"')});break;case"row":o.columns.forEach(h=>{if(h){switch(typeof h.value){case"object":h.value=h.value!==null?JSON.stringify(h.value):"";break;case"undefined":h.value="";break}u.push('"'+String(h.value).split('"').join('""')+'"')}}),a.push(u.join(r));break}}),s.length&&a.unshift(s.join(r)),a=a.join(`
`),e.bom&&(a="\uFEFF"+a),t(a,"text/csv")}function xL(i,e,t){var r=[];i.forEach(a=>{var s={};switch(a.type){case"header":break;case"group":console.warn("Download Warning - JSON downloader cannot process row groups");break;case"calc":console.warn("Download Warning - JSON downloader cannot process column calculations");break;case"row":a.columns.forEach(o=>{o&&(s[o.component.getTitleDownload()||o.component.getField()]=o.value)}),r.push(s);break}}),r=JSON.stringify(r,null,"	"),t(r,"application/json")}function wL(i,e={},t){var r=[],a=[],s={},o=e.rowGroupStyles||{fontStyle:"bold",fontSize:12,cellPadding:6,fillColor:220},u=e.rowCalcStyles||{fontStyle:"bold",fontSize:10,cellPadding:4,fillColor:232},h=e.jsPDF||{},d=e.title?e.title:"",p,b;h.orientation||(h.orientation=e.orientation||"landscape"),h.unit||(h.unit="pt"),i.forEach(v=>{switch(v.type){case"header":r.push(g(v));break;case"group":a.push(g(v,o));break;case"calc":a.push(g(v,u));break;case"row":a.push(g(v));break}});function g(v,y){var C=[];return v.columns.forEach(E=>{var w;if(E){switch(typeof E.value){case"object":E.value=E.value!==null?JSON.stringify(E.value):"";break;case"undefined":E.value="";break}w={content:E.value,colSpan:E.width,rowSpan:E.height},y&&(w.styles=y),C.push(w)}}),C}p=this.dependencyRegistry.lookup("jspdf","jsPDF"),b=new p(h),e.autoTable&&(typeof e.autoTable=="function"?s=e.autoTable(b)||{}:s=e.autoTable),d&&(s.didDrawPage=function(v){b.text(d,40,30)}),s.head=r,s.body=a,b.autoTable(s),e.documentProcessing&&e.documentProcessing(b),t(b.output("arraybuffer"),"application/pdf")}function yL(i,e,t){var r=this,a=e.sheetName||"Sheet1",s=this.dependencyRegistry.lookup("XLSX"),o=s.utils.book_new(),u=new zi(this),h="compress"in e?e.compress:!0,d=e.writeOptions||{bookType:"xlsx",bookSST:!0,compression:h},p;d.type="binary",o.SheetNames=[],o.Sheets={};function b(){var y=[],C=[],E={},w={s:{c:0,r:0},e:{c:i[0]?i[0].columns.reduce((R,T)=>R+(T&&T.width?T.width:1),0):0,r:i.length}};return i.forEach((R,T)=>{var D=[];R.columns.forEach(function(k,V){k?(D.push(!(k.value instanceof Date)&&typeof k.value=="object"?JSON.stringify(k.value):k.value),(k.width>1||k.height>-1)&&(k.height>1||k.width>1)&&C.push({s:{r:T,c:V},e:{r:T+k.height-1,c:V+k.width-1}})):D.push("")}),y.push(D)}),s.utils.sheet_add_aoa(E,y),E["!ref"]=s.utils.encode_range(w),C.length&&(E["!merges"]=C),E}if(e.sheetOnly){t(b());return}if(e.sheets)for(var g in e.sheets)e.sheets[g]===!0?(o.SheetNames.push(g),o.Sheets[g]=b()):(o.SheetNames.push(g),u.commsSend(e.sheets[g],"download","intercept",{type:"xlsx",options:{sheetOnly:!0},active:r.active,intercept:function(y){o.Sheets[g]=y}}));else o.SheetNames.push(a),o.Sheets[a]=b();e.documentProcessing&&(o=e.documentProcessing(o));function v(y){for(var C=new ArrayBuffer(y.length),E=new Uint8Array(C),w=0;w!=y.length;++w)E[w]=y.charCodeAt(w)&255;return C}p=s.write(o,d),t(v(p),"application/octet-stream")}function EL(i,e,t){this.modExists("export",!0)&&t(this.modules.export.generateHTMLTable(i),"text/html")}function CL(i,e,t){const r=[];i.forEach(a=>{const s={};switch(a.type){case"header":break;case"group":console.warn("Download Warning - JSON downloader cannot process row groups");break;case"calc":console.warn("Download Warning - JSON downloader cannot process column calculations");break;case"row":a.columns.forEach(o=>{o&&(s[o.component.getTitleDownload()||o.component.getField()]=o.value)}),r.push(JSON.stringify(s));break}}),t(r.join(`
`),"application/x-ndjson")}var TL={csv:bL,json:xL,jsonLines:CL,pdf:wL,xlsx:yL,html:EL};const ul=class ul extends ct{constructor(e){super(e),this.registerTableOption("downloadEncoder",function(t,r){return new Blob([t],{type:r})}),this.registerTableOption("downloadConfig",{}),this.registerTableOption("downloadRowRange","active"),this.registerColumnOption("download"),this.registerColumnOption("titleDownload")}initialize(){this.deprecatedOptionsCheck(),this.registerTableFunction("download",this.download.bind(this)),this.registerTableFunction("downloadToTab",this.downloadToTab.bind(this))}deprecatedOptionsCheck(){}downloadToTab(e,t,r,a){this.download(e,t,r,a,!0)}download(e,t,r,a,s){var o=!1;function u(d,p){s?s===!0?this.triggerDownload(d,p,e,t,!0):s(d):this.triggerDownload(d,p,e,t)}if(typeof e=="function"?o=e:ul.downloaders[e]?o=ul.downloaders[e]:console.warn("Download Error - No such download type found: ",e),o){var h=this.generateExportList(a);o.call(this.table,h,r||{},u.bind(this))}}generateExportList(e){var t=this.table.modules.export.generateExportList(this.table.options.downloadConfig,!1,e||this.table.options.downloadRowRange,"download"),r=this.table.options.groupHeaderDownload;return r&&!Array.isArray(r)&&(r=[r]),t.forEach(a=>{var s;a.type==="group"&&(s=a.columns[0],r&&r[a.indent]&&(s.value=r[a.indent](s.value,a.component._group.getRowCount(),a.component._group.getData(),a.component)))}),t}triggerDownload(e,t,r,a,s){var o=document.createElement("a"),u=this.table.options.downloadEncoder(e,t);u&&(s?window.open(window.URL.createObjectURL(u)):(a=a||"Tabulator."+(typeof r=="function"?"txt":r),navigator.msSaveOrOpenBlob?navigator.msSaveOrOpenBlob(u,a):(o.setAttribute("href",window.URL.createObjectURL(u)),o.setAttribute("download",a),o.style.display="none",document.body.appendChild(o),o.click(),document.body.removeChild(o))),this.dispatchExternal("downloadComplete"))}commsReceived(e,t,r){switch(t){case"intercept":this.download(r.type,"",r.options,r.active,r.intercept);break}}};Be(ul,"moduleName","download"),Be(ul,"downloaders",TL);let A0=ul;function Ch(i,e){var t=e.mask,r=typeof e.maskLetterChar<"u"?e.maskLetterChar:"A",a=typeof e.maskNumberChar<"u"?e.maskNumberChar:"9",s=typeof e.maskWildcardChar<"u"?e.maskWildcardChar:"*";function o(u){var h=t[u];typeof h<"u"&&h!==s&&h!==r&&h!==a&&(i.value=i.value+""+h,o(u+1))}i.addEventListener("keydown",u=>{var h=i.value.length,d=u.key;if(u.keyCode>46&&!u.ctrlKey&&!u.metaKey){if(h>=t.length)return u.preventDefault(),u.stopPropagation(),!1;switch(t[h]){case r:if(d.toUpperCase()==d.toLowerCase())return u.preventDefault(),u.stopPropagation(),!1;break;case a:if(isNaN(d))return u.preventDefault(),u.stopPropagation(),!1;break;case s:break;default:if(d!==t[h])return u.preventDefault(),u.stopPropagation(),!1}}}),i.addEventListener("keyup",u=>{u.keyCode>46&&e.maskAutoFill&&o(i.value.length)}),i.placeholder||(i.placeholder=t),e.maskAutoFill&&o(i.value.length)}function _L(i,e,t,r,a){var s=i.getValue(),o=document.createElement("input");if(o.setAttribute("type",a.search?"search":"text"),o.style.padding="4px",o.style.width="100%",o.style.boxSizing="border-box",a.elementAttributes&&typeof a.elementAttributes=="object")for(let h in a.elementAttributes)h.charAt(0)=="+"?(h=h.slice(1),o.setAttribute(h,o.getAttribute(h)+a.elementAttributes["+"+h])):o.setAttribute(h,a.elementAttributes[h]);o.value=typeof s<"u"?s:"",e(function(){i.getType()==="cell"&&(o.focus({preventScroll:!0}),o.style.height="100%",a.selectContents&&o.select())});function u(h){(s===null||typeof s>"u")&&o.value!==""||o.value!==s?t(o.value)&&(s=o.value):r()}return o.addEventListener("change",u),o.addEventListener("blur",u),o.addEventListener("keydown",function(h){switch(h.keyCode){case 13:u();break;case 27:r();break;case 35:case 36:h.stopPropagation();break}}),a.mask&&Ch(o,a),o}function SL(i,e,t,r,a){var s=i.getValue(),o=a.verticalNavigation||"hybrid",u=String(s!==null&&typeof s<"u"?s:""),h=document.createElement("textarea"),d=0;if(h.style.display="block",h.style.padding="2px",h.style.height="100%",h.style.width="100%",h.style.boxSizing="border-box",h.style.whiteSpace="pre-wrap",h.style.resize="none",a.elementAttributes&&typeof a.elementAttributes=="object")for(let b in a.elementAttributes)b.charAt(0)=="+"?(b=b.slice(1),h.setAttribute(b,h.getAttribute(b)+a.elementAttributes["+"+b])):h.setAttribute(b,a.elementAttributes[b]);h.value=u,e(function(){i.getType()==="cell"&&(h.focus({preventScroll:!0}),h.style.height="100%",h.scrollHeight,h.style.height=h.scrollHeight+"px",i.getRow().normalizeHeight(),a.selectContents&&h.select())});function p(b){(s===null||typeof s>"u")&&h.value!==""||h.value!==s?(t(h.value)&&(s=h.value),setTimeout(function(){i.getRow().normalizeHeight()},300)):r()}return h.addEventListener("change",p),h.addEventListener("blur",p),h.addEventListener("keyup",function(){h.style.height="";var b=h.scrollHeight;h.style.height=b+"px",b!=d&&(d=b,i.getRow().normalizeHeight())}),h.addEventListener("keydown",function(b){switch(b.keyCode){case 13:b.shiftKey&&a.shiftEnterSubmit&&p();break;case 27:r();break;case 38:(o=="editor"||o=="hybrid"&&h.selectionStart)&&(b.stopImmediatePropagation(),b.stopPropagation());break;case 40:(o=="editor"||o=="hybrid"&&h.selectionStart!==h.value.length)&&(b.stopImmediatePropagation(),b.stopPropagation());break;case 35:case 36:b.stopPropagation();break}}),a.mask&&Ch(h,a),h}function RL(i,e,t,r,a){var s=i.getValue(),o=a.verticalNavigation||"editor",u=document.createElement("input");if(u.setAttribute("type","number"),typeof a.max<"u"&&u.setAttribute("max",a.max),typeof a.min<"u"&&u.setAttribute("min",a.min),typeof a.step<"u"&&u.setAttribute("step",a.step),u.style.padding="4px",u.style.width="100%",u.style.boxSizing="border-box",a.elementAttributes&&typeof a.elementAttributes=="object")for(let p in a.elementAttributes)p.charAt(0)=="+"?(p=p.slice(1),u.setAttribute(p,u.getAttribute(p)+a.elementAttributes["+"+p])):u.setAttribute(p,a.elementAttributes[p]);u.value=s;var h=function(p){d()};e(function(){i.getType()==="cell"&&(u.removeEventListener("blur",h),u.focus({preventScroll:!0}),u.style.height="100%",u.addEventListener("blur",h),a.selectContents&&u.select())});function d(){var p=u.value;!isNaN(p)&&p!==""&&(p=Number(p)),p!==s?t(p)&&(s=p):r()}return u.addEventListener("keydown",function(p){switch(p.keyCode){case 13:d();break;case 27:r();break;case 38:case 40:o=="editor"&&(p.stopImmediatePropagation(),p.stopPropagation());break;case 35:case 36:p.stopPropagation();break}}),a.mask&&Ch(u,a),u}function kL(i,e,t,r,a){var s=i.getValue(),o=document.createElement("input");if(o.setAttribute("type","range"),typeof a.max<"u"&&o.setAttribute("max",a.max),typeof a.min<"u"&&o.setAttribute("min",a.min),typeof a.step<"u"&&o.setAttribute("step",a.step),o.style.padding="4px",o.style.width="100%",o.style.boxSizing="border-box",a.elementAttributes&&typeof a.elementAttributes=="object")for(let h in a.elementAttributes)h.charAt(0)=="+"?(h=h.slice(1),o.setAttribute(h,o.getAttribute(h)+a.elementAttributes["+"+h])):o.setAttribute(h,a.elementAttributes[h]);o.value=s,e(function(){i.getType()==="cell"&&(o.focus({preventScroll:!0}),o.style.height="100%")});function u(){var h=o.value;!isNaN(h)&&h!==""&&(h=Number(h)),h!=s?t(h)&&(s=h):r()}return o.addEventListener("blur",function(h){u()}),o.addEventListener("keydown",function(h){switch(h.keyCode){case 13:u();break;case 27:r();break}}),o}function AL(i,e,t,r,a){var s=a.format,o=a.verticalNavigation||"editor",u=s?window.DateTime||luxon.DateTime:null,h=i.getValue(),d=document.createElement("input");function p(g){var v;return u.isDateTime(g)?v=g:s==="iso"?v=u.fromISO(String(g)):v=u.fromFormat(String(g),s),v.toFormat("yyyy-MM-dd")}if(d.type="date",d.style.padding="4px",d.style.width="100%",d.style.boxSizing="border-box",a.max&&d.setAttribute("max",s?p(a.max):a.max),a.min&&d.setAttribute("min",s?p(a.min):a.min),a.elementAttributes&&typeof a.elementAttributes=="object")for(let g in a.elementAttributes)g.charAt(0)=="+"?(g=g.slice(1),d.setAttribute(g,d.getAttribute(g)+a.elementAttributes["+"+g])):d.setAttribute(g,a.elementAttributes[g]);h=typeof h<"u"?h:"",s&&(u?h=p(h):console.error("Editor Error - 'date' editor 'format' param is dependant on luxon.js")),d.value=h,e(function(){i.getType()==="cell"&&(d.focus({preventScroll:!0}),d.style.height="100%",a.selectContents&&d.select())});function b(){var g=d.value,v;if((h===null||typeof h>"u")&&g!==""||g!==h){if(g&&s)switch(v=u.fromFormat(String(g),"yyyy-MM-dd"),s){case!0:g=v;break;case"iso":g=v.toISO();break;default:g=v.toFormat(s)}t(g)&&(h=d.value)}else r()}return d.addEventListener("blur",function(g){(g.relatedTarget||g.rangeParent||g.explicitOriginalTarget!==d)&&b()}),d.addEventListener("keydown",function(g){switch(g.keyCode){case 13:b();break;case 27:r();break;case 35:case 36:g.stopPropagation();break;case 38:case 40:o=="editor"&&(g.stopImmediatePropagation(),g.stopPropagation());break}}),d}function DL(i,e,t,r,a){var s=a.format,o=a.verticalNavigation||"editor",u=s?window.DateTime||luxon.DateTime:null,h,d=i.getValue(),p=document.createElement("input");if(p.type="time",p.style.padding="4px",p.style.width="100%",p.style.boxSizing="border-box",a.elementAttributes&&typeof a.elementAttributes=="object")for(let g in a.elementAttributes)g.charAt(0)=="+"?(g=g.slice(1),p.setAttribute(g,p.getAttribute(g)+a.elementAttributes["+"+g])):p.setAttribute(g,a.elementAttributes[g]);d=typeof d<"u"?d:"",s&&(u?(u.isDateTime(d)?h=d:s==="iso"?h=u.fromISO(String(d)):h=u.fromFormat(String(d),s),d=h.toFormat("HH:mm")):console.error("Editor Error - 'date' editor 'format' param is dependant on luxon.js")),p.value=d,e(function(){i.getType()=="cell"&&(p.focus({preventScroll:!0}),p.style.height="100%",a.selectContents&&p.select())});function b(){var g=p.value,v;if((d===null||typeof d>"u")&&g!==""||g!==d){if(g&&s)switch(v=u.fromFormat(String(g),"hh:mm"),s){case!0:g=v;break;case"iso":g=v.toISO();break;default:g=v.toFormat(s)}t(g)&&(d=p.value)}else r()}return p.addEventListener("blur",function(g){(g.relatedTarget||g.rangeParent||g.explicitOriginalTarget!==p)&&b()}),p.addEventListener("keydown",function(g){switch(g.keyCode){case 13:b();break;case 27:r();break;case 35:case 36:g.stopPropagation();break;case 38:case 40:o=="editor"&&(g.stopImmediatePropagation(),g.stopPropagation());break}}),p}function FL(i,e,t,r,a){var s=a.format,o=a.verticalNavigation||"editor",u=s?this.table.dependencyRegistry.lookup(["luxon","DateTime"],"DateTime"):null,h,d=i.getValue(),p=document.createElement("input");if(p.type="datetime-local",p.style.padding="4px",p.style.width="100%",p.style.boxSizing="border-box",a.elementAttributes&&typeof a.elementAttributes=="object")for(let g in a.elementAttributes)g.charAt(0)=="+"?(g=g.slice(1),p.setAttribute(g,p.getAttribute(g)+a.elementAttributes["+"+g])):p.setAttribute(g,a.elementAttributes[g]);d=typeof d<"u"?d:"",s&&(u?(u.isDateTime(d)?h=d:s==="iso"?h=u.fromISO(String(d)):h=u.fromFormat(String(d),s),d=h.toFormat("yyyy-MM-dd")+"T"+h.toFormat("HH:mm")):console.error("Editor Error - 'date' editor 'format' param is dependant on luxon.js")),p.value=d,e(function(){i.getType()==="cell"&&(p.focus({preventScroll:!0}),p.style.height="100%",a.selectContents&&p.select())});function b(){var g=p.value,v;if((d===null||typeof d>"u")&&g!==""||g!==d){if(g&&s)switch(v=u.fromISO(String(g)),s){case!0:g=v;break;case"iso":g=v.toISO();break;default:g=v.toFormat(s)}t(g)&&(d=p.value)}else r()}return p.addEventListener("blur",function(g){(g.relatedTarget||g.rangeParent||g.explicitOriginalTarget!==p)&&b()}),p.addEventListener("keydown",function(g){switch(g.keyCode){case 13:b();break;case 27:r();break;case 35:case 36:g.stopPropagation();break;case 38:case 40:o=="editor"&&(g.stopImmediatePropagation(),g.stopPropagation());break}}),p}let ML=class{constructor(e,t,r,a,s,o){this.edit=e,this.table=e.table,this.cell=t,this.params=this._initializeParams(o),this.data=[],this.displayItems=[],this.currentItems=[],this.focusedItem=null,this.input=this._createInputElement(),this.listEl=this._createListElement(),this.initialValues=null,this.isFilter=t.getType()==="header",this.filterTimeout=null,this.filtered=!1,this.typing=!1,this.values=[],this.popup=null,this.listIteration=0,this.lastAction="",this.filterTerm="",this.blurable=!0,this.actions={success:a,cancel:s},this._deprecatedOptionsCheck(),this._initializeValue(),r(this._onRendered.bind(this))}_deprecatedOptionsCheck(){}_initializeValue(){var e=this.cell.getValue();typeof e>"u"&&typeof this.params.defaultValue<"u"&&(e=this.params.defaultValue),this.initialValues=this.params.multiselect?e:[e],this.isFilter&&(this.input.value=this.initialValues?this.initialValues.join(","):"",this.headerFilterInitialListGen())}_onRendered(){var e=this.cell.getElement();function t(r){r.stopPropagation()}this.isFilter||(this.input.style.height="100%",this.input.focus({preventScroll:!0})),e.addEventListener("click",t),setTimeout(()=>{e.removeEventListener("click",t)},1e3),this.input.addEventListener("mousedown",this._preventPopupBlur.bind(this))}_createListElement(){var e=document.createElement("div");return e.classList.add("tabulator-edit-list"),e.addEventListener("mousedown",this._preventBlur.bind(this)),e.addEventListener("keydown",this._inputKeyDown.bind(this)),e}_setListWidth(){var e=this.isFilter?this.input:this.cell.getElement();this.listEl.style.minWidth=e.offsetWidth+"px",this.params.maxWidth&&(this.params.maxWidth===!0?this.listEl.style.maxWidth=e.offsetWidth+"px":typeof this.params.maxWidth=="number"?this.listEl.style.maxWidth=this.params.maxWidth+"px":this.listEl.style.maxWidth=this.params.maxWidth)}_createInputElement(){var e=this.params.elementAttributes,t=document.createElement("input");if(t.setAttribute("type",this.params.clearable?"search":"text"),t.style.padding="4px",t.style.width="100%",t.style.boxSizing="border-box",this.params.autocomplete||(t.style.cursor="default",t.style.caretColor="transparent"),e&&typeof e=="object")for(let r in e)r.charAt(0)=="+"?(r=r.slice(1),t.setAttribute(r,t.getAttribute(r)+e["+"+r])):t.setAttribute(r,e[r]);return this.params.mask&&Ch(t,this.params),this._bindInputEvents(t),t}_initializeParams(e){var t=["values","valuesURL","valuesLookup"],r;return e=Object.assign({},e),e.verticalNavigation=e.verticalNavigation||"editor",e.placeholderLoading=typeof e.placeholderLoading>"u"?"Searching ...":e.placeholderLoading,e.placeholderEmpty=typeof e.placeholderEmpty>"u"?"No Results Found":e.placeholderEmpty,e.filterDelay=typeof e.filterDelay>"u"?300:e.filterDelay,e.emptyValue=Object.keys(e).includes("emptyValue")?e.emptyValue:"",r=Object.keys(e).filter(a=>t.includes(a)).length,r?r>1&&console.warn("list editor config error - only one of the values, valuesURL, or valuesLookup options can be set on the same editor"):console.warn("list editor config error - either the values, valuesURL, or valuesLookup option must be set"),e.autocomplete?e.multiselect&&(e.multiselect=!1,console.warn("list editor config error - multiselect option is not available when autocomplete is enabled")):(e.freetext&&(e.freetext=!1,console.warn("list editor config error - freetext option is only available when autocomplete is enabled")),e.filterFunc&&(e.filterFunc=!1,console.warn("list editor config error - filterFunc option is only available when autocomplete is enabled")),e.filterRemote&&(e.filterRemote=!1,console.warn("list editor config error - filterRemote option is only available when autocomplete is enabled")),e.mask&&(e.mask=!1,console.warn("list editor config error - mask option is only available when autocomplete is enabled")),e.allowEmpty&&(e.allowEmpty=!1,console.warn("list editor config error - allowEmpty option is only available when autocomplete is enabled")),e.listOnEmpty&&(e.listOnEmpty=!1,console.warn("list editor config error - listOnEmpty option is only available when autocomplete is enabled"))),e.filterRemote&&!(typeof e.valuesLookup=="function"||e.valuesURL)&&(e.filterRemote=!1,console.warn("list editor config error - filterRemote option should only be used when values list is populated from a remote source")),e}_bindInputEvents(e){e.addEventListener("focus",this._inputFocus.bind(this)),e.addEventListener("click",this._inputClick.bind(this)),e.addEventListener("blur",this._inputBlur.bind(this)),e.addEventListener("keydown",this._inputKeyDown.bind(this)),e.addEventListener("search",this._inputSearch.bind(this)),this.params.autocomplete&&e.addEventListener("keyup",this._inputKeyUp.bind(this))}_inputFocus(e){this.rebuildOptionsList()}_filter(){this.params.filterRemote?(clearTimeout(this.filterTimeout),this.filterTimeout=setTimeout(()=>{this.rebuildOptionsList()},this.params.filterDelay)):this._filterList()}_inputClick(e){e.stopPropagation()}_inputBlur(e){this.blurable&&(this.popup?this.popup.hide():this._resolveValue(!0))}_inputSearch(){this._clearChoices()}_inputKeyDown(e){switch(e.keyCode){case 38:this._keyUp(e);break;case 40:this._keyDown(e);break;case 37:case 39:this._keySide(e);break;case 13:this._keyEnter();break;case 27:this._keyEsc();break;case 36:case 35:this._keyHomeEnd(e);break;case 9:this._keyTab(e);break;default:this._keySelectLetter(e)}}_inputKeyUp(e){switch(e.keyCode){case 38:case 37:case 39:case 40:case 13:case 27:break;default:this._keyAutoCompLetter(e)}}_preventPopupBlur(){this.popup&&this.popup.blockHide(),setTimeout(()=>{this.popup&&this.popup.restoreHide()},10)}_preventBlur(){this.blurable=!1,setTimeout(()=>{this.blurable=!0},10)}_keyTab(e){this.params.autocomplete&&this.lastAction==="typing"?this._resolveValue(!0):this.focusedItem&&this._chooseItem(this.focusedItem,!0)}_keyUp(e){var t=this.displayItems.indexOf(this.focusedItem);(this.params.verticalNavigation=="editor"||this.params.verticalNavigation=="hybrid"&&t)&&(e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault(),t>0&&this._focusItem(this.displayItems[t-1]))}_keyDown(e){var t=this.displayItems.indexOf(this.focusedItem);(this.params.verticalNavigation=="editor"||this.params.verticalNavigation=="hybrid"&&t<this.displayItems.length-1)&&(e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault(),t<this.displayItems.length-1&&(t==-1?this._focusItem(this.displayItems[0]):this._focusItem(this.displayItems[t+1])))}_keySide(e){this.params.autocomplete||(e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault())}_keyEnter(e){this.params.autocomplete&&this.lastAction==="typing"?this._resolveValue(!0):this.focusedItem&&this._chooseItem(this.focusedItem)}_keyEsc(e){this._cancel()}_keyHomeEnd(e){this.params.autocomplete&&e.stopImmediatePropagation()}_keySelectLetter(e){this.params.autocomplete||(e.preventDefault(),e.keyCode>=38&&e.keyCode<=90&&this._scrollToValue(e.keyCode))}_keyAutoCompLetter(e){this._filter(),this.lastAction="typing",this.typing=!0}_scrollToValue(e){clearTimeout(this.filterTimeout);var t=String.fromCharCode(e).toLowerCase();this.filterTerm+=t.toLowerCase();var r=this.displayItems.find(a=>typeof a.label<"u"&&a.label.toLowerCase().startsWith(this.filterTerm));r&&this._focusItem(r),this.filterTimeout=setTimeout(()=>{this.filterTerm=""},800)}_focusItem(e){this.lastAction="focus",this.focusedItem&&this.focusedItem.element&&this.focusedItem.element.classList.remove("focused"),this.focusedItem=e,e&&e.element&&(e.element.classList.add("focused"),e.element.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"}))}headerFilterInitialListGen(){this._generateOptions(!0)}rebuildOptionsList(){this._generateOptions().then(this._sortOptions.bind(this)).then(this._buildList.bind(this)).then(this._showList.bind(this)).catch(e=>{Number.isInteger(e)||console.error("List generation error",e)})}_filterList(){this._buildList(this._filterOptions()),this._showList()}_generateOptions(e){var t=[],r=++this.listIteration;return this.filtered=!1,this.params.values?t=this.params.values:this.params.valuesURL?t=this._ajaxRequest(this.params.valuesURL,this.input.value):typeof this.params.valuesLookup=="function"?t=this.params.valuesLookup(this.cell,this.input.value):this.params.valuesLookup&&(t=this._uniqueColumnValues(this.params.valuesLookupField)),t instanceof Promise?(e||this._addPlaceholder(this.params.placeholderLoading),t.then().then(a=>this.listIteration===r?this._parseList(a):Promise.reject(r))):Promise.resolve(this._parseList(t))}_addPlaceholder(e){var t=document.createElement("div");typeof e=="function"&&(e=e(this.cell.getComponent(),this.listEl)),e&&(this._clearList(),e instanceof HTMLElement?t=e:(t.classList.add("tabulator-edit-list-placeholder"),t.innerHTML=e),this.listEl.appendChild(t),this._showList())}_ajaxRequest(e,t){var r=this.params.filterRemote?{term:t}:{};return e=Sy(e,{},r),fetch(e).then(a=>a.ok?a.json().catch(s=>(console.warn("List Ajax Load Error - Invalid JSON returned",s),Promise.reject(s))):(console.error("List Ajax Load Error - Connection Error: "+a.status,a.statusText),Promise.reject(a))).catch(a=>(console.error("List Ajax Load Error - Connection Error: ",a),Promise.reject(a)))}_uniqueColumnValues(e){var t={},r=this.table.getData(this.params.valuesLookup),a;return e?a=this.table.columnManager.getColumnByField(e):a=this.cell.getColumn()._getSelf(),a?r.forEach(s=>{var o=a.getFieldValue(s);this._emptyValueCheck(o)||(this.params.multiselect&&Array.isArray(o)?o.forEach(u=>{this._emptyValueCheck(u)||(t[u]=!0)}):t[o]=!0)}):(console.warn("unable to find matching column to create select lookup list:",e),t=[]),Object.keys(t)}_emptyValueCheck(e){return e===null||typeof e>"u"||e===""}_parseList(e){var t=[];return Array.isArray(e)||(e=Object.entries(e).map(([r,a])=>({label:a,value:r}))),e.forEach(r=>{typeof r!="object"&&(r={label:r,value:r}),this._parseListItem(r,t,0)}),!this.currentItems.length&&this.params.freetext&&(this.input.value=this.initialValues,this.typing=!0,this.lastAction="typing"),this.data=t,t}_parseListItem(e,t,r){var a={};e.options?a=this._parseListGroup(e,r+1):(a={label:e.label,value:e.value,itemParams:e.itemParams,elementAttributes:e.elementAttributes,element:!1,selected:!1,visible:!0,level:r,original:e},this.initialValues&&this.initialValues.indexOf(e.value)>-1&&this._chooseItem(a,!0)),t.push(a)}_parseListGroup(e,t){var r={label:e.label,group:!0,itemParams:e.itemParams,elementAttributes:e.elementAttributes,element:!1,visible:!0,level:t,options:[],original:e};return e.options.forEach(a=>{this._parseListItem(a,r.options,t)}),r}_sortOptions(e){var t;return this.params.sort&&(t=typeof this.params.sort=="function"?this.params.sort:this._defaultSortFunction.bind(this),this._sortGroup(t,e)),e}_sortGroup(e,t){t.sort((r,a)=>e(r.label,a.label,r.value,a.value,r.original,a.original)),t.forEach(r=>{r.group&&this._sortGroup(e,r.options)})}_defaultSortFunction(e,t){var r,a,s,o,u=0,h,d=/(\d+)|(\D+)/g,p=/\d/,b=0;if(this.params.sort==="desc"&&([e,t]=[t,e]),!e&&e!==0)b=!t&&t!==0?0:-1;else if(!t&&t!==0)b=1;else{if(isFinite(e)&&isFinite(t))return e-t;if(r=String(e).toLowerCase(),a=String(t).toLowerCase(),r===a)return 0;if(!(p.test(r)&&p.test(a)))return r>a?1:-1;for(r=r.match(d),a=a.match(d),h=r.length>a.length?a.length:r.length;u<h;)if(s=r[u],o=a[u++],s!==o)return isFinite(s)&&isFinite(o)?(s.charAt(0)==="0"&&(s="."+s),o.charAt(0)==="0"&&(o="."+o),s-o):s>o?1:-1;return r.length>a.length}return b}_filterOptions(){var e=this.params.filterFunc||this._defaultFilterFunc,t=this.input.value;return t?(this.filtered=!0,this.data.forEach(r=>{this._filterItem(e,t,r)})):this.filtered=!1,this.data}_filterItem(e,t,r){var a=!1;return r.group?(r.options.forEach(s=>{this._filterItem(e,t,s)&&(a=!0)}),r.visible=a):r.visible=e(t,r.label,r.value,r.original),r.visible}_defaultFilterFunc(e,t,r,a){return e=String(e).toLowerCase(),t!==null&&typeof t<"u"&&(String(t).toLowerCase().indexOf(e)>-1||String(r).toLowerCase().indexOf(e)>-1)}_clearList(){for(;this.listEl.firstChild;)this.listEl.removeChild(this.listEl.firstChild);this.displayItems=[]}_buildList(e){this._clearList(),e.forEach(t=>{this._buildItem(t)}),this.displayItems.length||this._addPlaceholder(this.params.placeholderEmpty)}_buildItem(e){var t=e.element,r;if(!this.filtered||e.visible){if(!t){if(t=document.createElement("div"),t.tabIndex=0,r=this.params.itemFormatter?this.params.itemFormatter(e.label,e.value,e.original,t):e.label,r instanceof HTMLElement?t.appendChild(r):t.innerHTML=r,e.group?t.classList.add("tabulator-edit-list-group"):t.classList.add("tabulator-edit-list-item"),t.classList.add("tabulator-edit-list-group-level-"+e.level),e.elementAttributes&&typeof e.elementAttributes=="object")for(let a in e.elementAttributes)a.charAt(0)=="+"?(a=a.slice(1),t.setAttribute(a,this.input.getAttribute(a)+e.elementAttributes["+"+a])):t.setAttribute(a,e.elementAttributes[a]);e.group?t.addEventListener("click",this._groupClick.bind(this,e)):t.addEventListener("click",this._itemClick.bind(this,e)),t.addEventListener("mousedown",this._preventBlur.bind(this)),e.element=t}this._styleItem(e),this.listEl.appendChild(t),e.group?e.options.forEach(a=>{this._buildItem(a)}):this.displayItems.push(e)}}_showList(){var e=this.popup&&this.popup.isVisible();if(this.input.parentNode){if(this.params.autocomplete&&this.input.value===""&&!this.params.listOnEmpty){this.popup&&this.popup.hide(!0);return}this._setListWidth(),this.popup||(this.popup=this.edit.popup(this.listEl)),this.popup.show(this.cell.getElement(),"bottom"),e||setTimeout(()=>{this.popup.hideOnBlur(this._resolveValue.bind(this,!0))},10)}}_styleItem(e){e&&e.element&&(e.selected?e.element.classList.add("active"):e.element.classList.remove("active"))}_itemClick(e,t){t.stopPropagation(),this._chooseItem(e)}_groupClick(e,t){t.stopPropagation()}_cancel(){this.popup.hide(!0),this.actions.cancel()}_clearChoices(){this.typing=!0,this.currentItems.forEach(e=>{e.selected=!1,this._styleItem(e)}),this.currentItems=[],this.focusedItem=null}_chooseItem(e,t){var r;this.typing=!1,this.params.multiselect?(r=this.currentItems.indexOf(e),r>-1?(this.currentItems.splice(r,1),e.selected=!1):(this.currentItems.push(e),e.selected=!0),this.input.value=this.currentItems.map(a=>a.label).join(","),this._styleItem(e)):(this.currentItems=[e],e.selected=!0,this.input.value=e.label,this._styleItem(e),t||this._resolveValue()),this._focusItem(e)}_resolveValue(e){var t,r;if(this.popup&&this.popup.hide(!0),this.params.multiselect)t=this.currentItems.map(a=>a.value);else if(e&&this.params.autocomplete&&this.typing)if(this.params.freetext||this.params.allowEmpty&&this.input.value==="")t=this.input.value;else{this.actions.cancel();return}else this.currentItems[0]?t=this.currentItems[0].value:(r=Array.isArray(this.initialValues)?this.initialValues[0]:this.initialValues,r===null||typeof r>"u"||r===""?t=r:t=this.params.emptyValue);t===""&&(t=this.params.emptyValue),this.actions.success(t),this.isFilter&&(this.initialValues=t&&!Array.isArray(t)?[t]:t,this.currentItems=[])}};function OL(i,e,t,r,a){var s=new ML(this,i,e,t,r,a);return s.input}function LL(i,e,t,r,a){var s=this,o=i.getElement(),u=i.getValue(),h=o.getElementsByTagName("svg").length||5,d=o.getElementsByTagName("svg")[0]?o.getElementsByTagName("svg")[0].getAttribute("width"):14,p=[],b=document.createElement("div"),g=document.createElementNS("http://www.w3.org/2000/svg","svg");function v(w){p.forEach(function(R,T){T<w?(s.table.browser=="ie"?R.setAttribute("class","tabulator-star-active"):R.classList.replace("tabulator-star-inactive","tabulator-star-active"),R.innerHTML='<polygon fill="#488CE9" stroke="#014AAE" stroke-width="37.6152" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 "/>'):(s.table.browser=="ie"?R.setAttribute("class","tabulator-star-inactive"):R.classList.replace("tabulator-star-active","tabulator-star-inactive"),R.innerHTML='<polygon fill="#010155" stroke="#686868" stroke-width="37.6152" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 "/>')})}function y(w){var R=document.createElement("span"),T=g.cloneNode(!0);p.push(T),R.addEventListener("mouseenter",function(D){D.stopPropagation(),D.stopImmediatePropagation(),v(w)}),R.addEventListener("mousemove",function(D){D.stopPropagation(),D.stopImmediatePropagation()}),R.addEventListener("click",function(D){D.stopPropagation(),D.stopImmediatePropagation(),t(w),o.blur()}),R.appendChild(T),b.appendChild(R)}function C(w){u=w,v(w)}if(o.style.whiteSpace="nowrap",o.style.overflow="hidden",o.style.textOverflow="ellipsis",b.style.verticalAlign="middle",b.style.display="inline-block",b.style.padding="4px",g.setAttribute("width",d),g.setAttribute("height",d),g.setAttribute("viewBox","0 0 512 512"),g.setAttribute("xml:space","preserve"),g.style.padding="0 1px",a.elementAttributes&&typeof a.elementAttributes=="object")for(let w in a.elementAttributes)w.charAt(0)=="+"?(w=w.slice(1),b.setAttribute(w,b.getAttribute(w)+a.elementAttributes["+"+w])):b.setAttribute(w,a.elementAttributes[w]);for(var E=1;E<=h;E++)y(E);return u=Math.min(parseInt(u),h),v(u),b.addEventListener("mousemove",function(w){v(0)}),b.addEventListener("click",function(w){t(0)}),o.addEventListener("blur",function(w){r()}),o.addEventListener("keydown",function(w){switch(w.keyCode){case 39:C(u+1);break;case 37:C(u-1);break;case 13:t(u);break;case 27:r();break}}),b}function NL(i,e,t,r,a){var s=i.getElement(),o=typeof a.max>"u"?s.getElementsByTagName("div")[0]&&s.getElementsByTagName("div")[0].getAttribute("max")||100:a.max,u=typeof a.min>"u"?s.getElementsByTagName("div")[0]&&s.getElementsByTagName("div")[0].getAttribute("min")||0:a.min,h=(o-u)/100,d=i.getValue()||0,p=document.createElement("div"),b=document.createElement("div"),g,v;function y(){var C=window.getComputedStyle(s,null),E=h*Math.round(b.offsetWidth/((s.clientWidth-parseInt(C.getPropertyValue("padding-left"))-parseInt(C.getPropertyValue("padding-right")))/100))+u;t(E),s.setAttribute("aria-valuenow",E),s.setAttribute("aria-label",d)}if(p.style.position="absolute",p.style.right="0",p.style.top="0",p.style.bottom="0",p.style.width="5px",p.classList.add("tabulator-progress-handle"),b.style.display="inline-block",b.style.position="relative",b.style.height="100%",b.style.backgroundColor="#488CE9",b.style.maxWidth="100%",b.style.minWidth="0%",a.elementAttributes&&typeof a.elementAttributes=="object")for(let C in a.elementAttributes)C.charAt(0)=="+"?(C=C.slice(1),b.setAttribute(C,b.getAttribute(C)+a.elementAttributes["+"+C])):b.setAttribute(C,a.elementAttributes[C]);return s.style.padding="4px 4px",d=Math.min(parseFloat(d),o),d=Math.max(parseFloat(d),u),d=Math.round((d-u)/h),b.style.width=d+"%",s.setAttribute("aria-valuemin",u),s.setAttribute("aria-valuemax",o),b.appendChild(p),p.addEventListener("mousedown",function(C){g=C.screenX,v=b.offsetWidth}),p.addEventListener("mouseover",function(){p.style.cursor="ew-resize"}),s.addEventListener("mousemove",function(C){g&&(b.style.width=v+C.screenX-g+"px")}),s.addEventListener("mouseup",function(C){g&&(C.stopPropagation(),C.stopImmediatePropagation(),g=!1,v=!1,y())}),s.addEventListener("keydown",function(C){switch(C.keyCode){case 39:C.preventDefault(),b.style.width=b.clientWidth+s.clientWidth/100+"px";break;case 37:C.preventDefault(),b.style.width=b.clientWidth-s.clientWidth/100+"px";break;case 9:case 13:y();break;case 27:r();break}}),s.addEventListener("blur",function(){r()}),b}function BL(i,e,t,r,a){var s=i.getValue(),o=document.createElement("input"),u=a.tristate,h=typeof a.indeterminateValue>"u"?null:a.indeterminateValue,d=!1,p=Object.keys(a).includes("trueValue"),b=Object.keys(a).includes("falseValue");if(o.setAttribute("type","checkbox"),o.style.marginTop="5px",o.style.boxSizing="border-box",a.elementAttributes&&typeof a.elementAttributes=="object")for(let v in a.elementAttributes)v.charAt(0)=="+"?(v=v.slice(1),o.setAttribute(v,o.getAttribute(v)+a.elementAttributes["+"+v])):o.setAttribute(v,a.elementAttributes[v]);o.value=s,u&&(typeof s>"u"||s===h||s==="")&&(d=!0,o.indeterminate=!0),this.table.browser!="firefox"&&this.table.browser!="safari"&&e(function(){i.getType()==="cell"&&o.focus({preventScroll:!0})}),o.checked=p?s===a.trueValue:s===!0||s==="true"||s==="True"||s===1;function g(v){var y=o.checked;return p&&y?y=a.trueValue:b&&!y&&(y=a.falseValue),u?v?d?h:y:o.checked&&!d?(o.checked=!1,o.indeterminate=!0,d=!0,h):(d=!1,y):y}return o.addEventListener("change",function(v){t(g())}),o.addEventListener("blur",function(v){t(g(!0))}),o.addEventListener("keydown",function(v){v.keyCode==13&&t(g()),v.keyCode==27&&r()}),o}function zL(i,e,t,r,a){var s=i._getSelf().column,o,u,h;function d(p){var b=p.getValue(),g="input";switch(typeof b){case"number":g="number";break;case"boolean":g="tickCross";break;case"string":b.includes(`
`)&&(g="textarea");break}return g}return o=a.editorLookup?a.editorLookup(i):d(i),a.paramsLookup&&(h=typeof a.paramsLookup=="function"?a.paramsLookup(o,i):a.paramsLookup[o]),u=this.table.modules.edit.lookupEditor(o,s),u.call(this,i,e,t,r,h||{})}var HL={input:_L,textarea:SL,number:RL,range:kL,date:AL,time:DL,datetime:FL,list:OL,star:LL,progress:NL,tickCross:BL,adaptable:zL};const Uo=class Uo extends ct{constructor(e){super(e),this.currentCell=!1,this.mouseClick=!1,this.recursionBlock=!1,this.invalidEdit=!1,this.editedCells=[],this.convertEmptyValues=!1,this.editors=Uo.editors,this.registerTableOption("editTriggerEvent","focus"),this.registerTableOption("editorEmptyValue"),this.registerTableOption("editorEmptyValueFunc",this.emptyValueCheck.bind(this)),this.registerColumnOption("editable"),this.registerColumnOption("editor"),this.registerColumnOption("editorParams"),this.registerColumnOption("editorEmptyValue"),this.registerColumnOption("editorEmptyValueFunc"),this.registerColumnOption("cellEditing"),this.registerColumnOption("cellEdited"),this.registerColumnOption("cellEditCancelled"),this.registerTableFunction("getEditedCells",this.getEditedCells.bind(this)),this.registerTableFunction("clearCellEdited",this.clearCellEdited.bind(this)),this.registerTableFunction("navigatePrev",this.navigatePrev.bind(this)),this.registerTableFunction("navigateNext",this.navigateNext.bind(this)),this.registerTableFunction("navigateLeft",this.navigateLeft.bind(this)),this.registerTableFunction("navigateRight",this.navigateRight.bind(this)),this.registerTableFunction("navigateUp",this.navigateUp.bind(this)),this.registerTableFunction("navigateDown",this.navigateDown.bind(this)),this.registerComponentFunction("cell","isEdited",this.cellIsEdited.bind(this)),this.registerComponentFunction("cell","clearEdited",this.clearEdited.bind(this)),this.registerComponentFunction("cell","edit",this.editCell.bind(this)),this.registerComponentFunction("cell","cancelEdit",this.cellCancelEdit.bind(this)),this.registerComponentFunction("cell","navigatePrev",this.navigatePrev.bind(this)),this.registerComponentFunction("cell","navigateNext",this.navigateNext.bind(this)),this.registerComponentFunction("cell","navigateLeft",this.navigateLeft.bind(this)),this.registerComponentFunction("cell","navigateRight",this.navigateRight.bind(this)),this.registerComponentFunction("cell","navigateUp",this.navigateUp.bind(this)),this.registerComponentFunction("cell","navigateDown",this.navigateDown.bind(this))}initialize(){this.subscribe("cell-init",this.bindEditor.bind(this)),this.subscribe("cell-delete",this.clearEdited.bind(this)),this.subscribe("cell-value-changed",this.updateCellClass.bind(this)),this.subscribe("column-layout",this.initializeColumnCheck.bind(this)),this.subscribe("column-delete",this.columnDeleteCheck.bind(this)),this.subscribe("row-deleting",this.rowDeleteCheck.bind(this)),this.subscribe("row-layout",this.rowEditableCheck.bind(this)),this.subscribe("data-refreshing",this.cancelEdit.bind(this)),this.subscribe("clipboard-paste",this.pasteBlocker.bind(this)),this.subscribe("keybinding-nav-prev",this.navigatePrev.bind(this,void 0)),this.subscribe("keybinding-nav-next",this.keybindingNavigateNext.bind(this)),this.subscribe("keybinding-nav-up",this.navigateUp.bind(this,void 0)),this.subscribe("keybinding-nav-down",this.navigateDown.bind(this,void 0)),Object.keys(this.table.options).includes("editorEmptyValue")&&(this.convertEmptyValues=!0)}pasteBlocker(e){if(this.currentCell)return!0}keybindingNavigateNext(e){var t=this.currentCell,r=this.options("tabEndNewRow");t&&(this.navigateNext(t,e)||r&&(t.getElement().firstChild.blur(),this.invalidEdit||(r===!0?r=this.table.addRow({}):typeof r=="function"?r=this.table.addRow(r(t.row.getComponent())):r=this.table.addRow(Object.assign({},r)),r.then(()=>{setTimeout(()=>{t.getComponent().navigateNext()})}))))}cellIsEdited(e){return!!e.modules.edit&&e.modules.edit.edited}cellCancelEdit(e){e===this.currentCell?this.table.modules.edit.cancelEdit():console.warn("Cancel Editor Error - This cell is not currently being edited ")}updateCellClass(e){this.allowEdit(e)?e.getElement().classList.add("tabulator-editable"):e.getElement().classList.remove("tabulator-editable")}clearCellEdited(e){e||(e=this.table.modules.edit.getEditedCells()),Array.isArray(e)||(e=[e]),e.forEach(t=>{this.table.modules.edit.clearEdited(t._getSelf())})}navigatePrev(e=this.currentCell,t){var r,a;if(e){if(t&&t.preventDefault(),r=this.navigateLeft(),r)return!0;if(a=this.table.rowManager.prevDisplayRow(e.row,!0),a&&(r=this.findPrevEditableCell(a,a.cells.length),r))return r.getComponent().edit(),!0}return!1}navigateNext(e=this.currentCell,t){var r,a;if(e){if(t&&t.preventDefault(),r=this.navigateRight(),r)return!0;if(a=this.table.rowManager.nextDisplayRow(e.row,!0),a&&(r=this.findNextEditableCell(a,-1),r))return r.getComponent().edit(),!0}return!1}navigateLeft(e=this.currentCell,t){var r,a;return e&&(t&&t.preventDefault(),r=e.getIndex(),a=this.findPrevEditableCell(e.row,r),a)?(a.getComponent().edit(),!0):!1}navigateRight(e=this.currentCell,t){var r,a;return e&&(t&&t.preventDefault(),r=e.getIndex(),a=this.findNextEditableCell(e.row,r),a)?(a.getComponent().edit(),!0):!1}navigateUp(e=this.currentCell,t){var r,a;return e&&(t&&t.preventDefault(),r=e.getIndex(),a=this.table.rowManager.prevDisplayRow(e.row,!0),a)?(a.cells[r].getComponent().edit(),!0):!1}navigateDown(e=this.currentCell,t){var r,a;return e&&(t&&t.preventDefault(),r=e.getIndex(),a=this.table.rowManager.nextDisplayRow(e.row,!0),a)?(a.cells[r].getComponent().edit(),!0):!1}findNextEditableCell(e,t){var r=!1;if(t<e.cells.length-1)for(var a=t+1;a<e.cells.length;a++){let s=e.cells[a];if(s.column.modules.edit&&Wt.elVisible(s.getElement())&&this.allowEdit(s)){r=s;break}}return r}findPrevEditableCell(e,t){var r=!1;if(t>0)for(var a=t-1;a>=0;a--){let s=e.cells[a];if(s.column.modules.edit&&Wt.elVisible(s.getElement())&&this.allowEdit(s)){r=s;break}}return r}initializeColumnCheck(e){typeof e.definition.editor<"u"&&this.initializeColumn(e)}columnDeleteCheck(e){this.currentCell&&this.currentCell.column===e&&this.cancelEdit()}rowDeleteCheck(e){this.currentCell&&this.currentCell.row===e&&this.cancelEdit()}rowEditableCheck(e){e.getCells().forEach(t=>{t.column.modules.edit&&typeof t.column.modules.edit.check=="function"&&this.updateCellClass(t)})}initializeColumn(e){var t=Object.keys(e.definition).includes("editorEmptyValue"),r={editor:!1,blocked:!1,check:e.definition.editable,params:e.definition.editorParams||{},convertEmptyValues:t,editorEmptyValue:e.definition.editorEmptyValue,editorEmptyValueFunc:e.definition.editorEmptyValueFunc};r.editor=this.lookupEditor(e.definition.editor,e),r.editor&&(e.modules.edit=r)}lookupEditor(e,t){var r;switch(typeof e){case"string":this.editors[e]?r=this.editors[e]:console.warn("Editor Error - No such editor found: ",e);break;case"function":r=e;break;case"boolean":e===!0&&(typeof t.definition.formatter!="function"?this.editors[t.definition.formatter]?r=this.editors[t.definition.formatter]:r=this.editors.input:console.warn("Editor Error - Cannot auto lookup editor for a custom formatter: ",t.definition.formatter));break}return r}getCurrentCell(){return this.currentCell?this.currentCell.getComponent():!1}clearEditor(e){var t=this.currentCell,r;if(this.invalidEdit=!1,t){for(this.currentCell=!1,r=t.getElement(),this.dispatch("edit-editor-clear",t,e),r.classList.remove("tabulator-editing");r.firstChild;)r.removeChild(r.firstChild);t.row.getElement().classList.remove("tabulator-editing"),t.table.element.classList.remove("tabulator-editing")}}cancelEdit(){if(this.currentCell){var e=this.currentCell,t=this.currentCell.getComponent();this.clearEditor(!0),e.setValueActual(e.getValue()),e.cellRendered(),(e.column.definition.editor=="textarea"||e.column.definition.variableHeight)&&e.row.normalizeHeight(!0),e.column.definition.cellEditCancelled&&e.column.definition.cellEditCancelled.call(this.table,t),this.dispatch("edit-cancelled",e),this.dispatchExternal("cellEditCancelled",t)}}bindEditor(e){if(e.column.modules.edit){var t=this,r=e.getElement(!0);this.updateCellClass(e),r.setAttribute("tabindex",0),r.addEventListener("mousedown",function(a){a.button===2?a.preventDefault():t.mouseClick=!0}),this.options("editTriggerEvent")==="dblclick"&&r.addEventListener("dblclick",function(a){r.classList.contains("tabulator-editing")||(r.focus({preventScroll:!0}),t.edit(e,a,!1))}),(this.options("editTriggerEvent")==="focus"||this.options("editTriggerEvent")==="click")&&r.addEventListener("click",function(a){r.classList.contains("tabulator-editing")||(r.focus({preventScroll:!0}),t.edit(e,a,!1))}),this.options("editTriggerEvent")==="focus"&&r.addEventListener("focus",function(a){t.recursionBlock||t.edit(e,a,!1)})}}focusCellNoEvent(e,t){this.recursionBlock=!0,t&&this.table.browser==="ie"||e.getElement().focus({preventScroll:!0}),this.recursionBlock=!1}editCell(e,t){this.focusCellNoEvent(e),this.edit(e,!1,t)}focusScrollAdjust(e){if(this.table.rowManager.getRenderMode()=="virtual"){var t=this.table.rowManager.element.scrollTop,r=this.table.rowManager.element.clientHeight+this.table.rowManager.element.scrollTop,a=e.row.getElement();a.offsetTop<t?this.table.rowManager.element.scrollTop-=t-a.offsetTop:a.offsetTop+a.offsetHeight>r&&(this.table.rowManager.element.scrollTop+=a.offsetTop+a.offsetHeight-r);var s=this.table.rowManager.element.scrollLeft,o=this.table.rowManager.element.clientWidth+this.table.rowManager.element.scrollLeft,u=e.getElement();this.table.modExists("frozenColumns")&&(s+=parseInt(this.table.modules.frozenColumns.leftMargin||0),o-=parseInt(this.table.modules.frozenColumns.rightMargin||0)),this.table.options.renderHorizontal==="virtual"&&(s-=parseInt(this.table.columnManager.renderer.vDomPadLeft),o-=parseInt(this.table.columnManager.renderer.vDomPadLeft)),u.offsetLeft<s?this.table.rowManager.element.scrollLeft-=s-u.offsetLeft:u.offsetLeft+u.offsetWidth>o&&(this.table.rowManager.element.scrollLeft+=u.offsetLeft+u.offsetWidth-o)}}allowEdit(e){var t=!!e.column.modules.edit;if(e.column.modules.edit)switch(typeof e.column.modules.edit.check){case"function":e.row.initialized&&(t=e.column.modules.edit.check(e.getComponent()));break;case"string":t=!!e.row.data[e.column.modules.edit.check];break;case"boolean":t=e.column.modules.edit.check;break}return t}edit(e,t,r){var a=this,s=!0,o=function(){},u=e.getElement(),h=!1,d,p,b;if(this.currentCell){!this.invalidEdit&&this.currentCell!==e&&this.cancelEdit();return}function g(w){if(a.currentCell===e&&!h){var R=a.chain("edit-success",[e,w],!0,!0);return R===!0||a.table.options.validationMode==="highlight"?(h=!0,a.clearEditor(),e.modules.edit||(e.modules.edit={}),e.modules.edit.edited=!0,a.editedCells.indexOf(e)==-1&&a.editedCells.push(e),w=a.transformEmptyValues(w,e),e.setValue(w,!0),R===!0):(h=!0,a.invalidEdit=!0,a.focusCellNoEvent(e,!0),o(),setTimeout(()=>{h=!1},10),!1)}}function v(){a.currentCell===e&&!h&&a.cancelEdit()}function y(w){o=w}if(e.column.modules.edit.blocked)return this.mouseClick=!1,this.blur(u),!1;if(t&&t.stopPropagation(),s=this.allowEdit(e),s||r){if(a.cancelEdit(),a.currentCell=e,this.focusScrollAdjust(e),p=e.getComponent(),this.mouseClick&&(this.mouseClick=!1,e.column.definition.cellClick&&e.column.definition.cellClick.call(this.table,t,p)),e.column.definition.cellEditing&&e.column.definition.cellEditing.call(this.table,p),this.dispatch("cell-editing",e),this.dispatchExternal("cellEditing",p),b=typeof e.column.modules.edit.params=="function"?e.column.modules.edit.params(p):e.column.modules.edit.params,d=e.column.modules.edit.editor.call(a,p,y,g,v,b),this.currentCell&&d!==!1)if(d instanceof Node){for(u.classList.add("tabulator-editing"),e.row.getElement().classList.add("tabulator-editing"),e.table.element.classList.add("tabulator-editing");u.firstChild;)u.removeChild(u.firstChild);u.appendChild(d),o();for(var C=u.children,E=0;E<C.length;E++)C[E].addEventListener("click",function(w){w.stopPropagation()})}else return console.warn("Edit Error - Editor should return an instance of Node, the editor returned:",d),this.blur(u),!1;else return this.blur(u),!1;return!0}else return this.mouseClick=!1,this.blur(u),!1}emptyValueCheck(e){return e===""||e===null||typeof e>"u"}transformEmptyValues(e,t){var r=t.column.modules.edit,a=r.convertEmptyValues||this.convertEmptyValues,s;return a&&(s=r.editorEmptyValueFunc||this.options("editorEmptyValueFunc"),s&&s(e)&&(e=r.convertEmptyValues?r.editorEmptyValue:this.options("editorEmptyValue"))),e}blur(e){this.confirm("edit-blur",[e])||e.blur()}getEditedCells(){var e=[];return this.editedCells.forEach(t=>{e.push(t.getComponent())}),e}clearEdited(e){var t;e.modules.edit&&e.modules.edit.edited&&(e.modules.edit.edited=!1,this.dispatch("edit-edited-clear",e)),t=this.editedCells.indexOf(e),t>-1&&this.editedCells.splice(t,1)}};Be(Uo,"moduleName","edit"),Be(Uo,"editors",HL);let D0=Uo;class $b{constructor(e,t,r,a){this.type=e,this.columns=t,this.component=r||!1,this.indent=a||0}}class r0{constructor(e,t,r,a,s){this.value=e,this.component=t||!1,this.width=r,this.height=a,this.depth=s}}var PL={},IL={visible:function(){return this.rowManager.getVisibleRows(!1,!0)},all:function(){return this.rowManager.rows},selected:function(){return this.modules.selectRow.selectedRows},active:function(){return this.options.pagination?this.rowManager.getDisplayRows(this.rowManager.displayRows.length-2):this.rowManager.getDisplayRows()}};const vn=class vn extends ct{constructor(e){super(e),this.config={},this.cloneTableStyle=!0,this.colVisProp="",this.colVisPropAttach="",this.registerTableOption("htmlOutputConfig",!1),this.registerColumnOption("htmlOutput"),this.registerColumnOption("titleHtmlOutput")}initialize(){this.registerTableFunction("getHtml",this.getHtml.bind(this))}generateExportList(e,t,r,a){var s,o,u,h;return this.cloneTableStyle=t,this.config=e||{},this.colVisProp=a,this.colVisPropAttach=this.colVisProp.charAt(0).toUpperCase()+this.colVisProp.slice(1),h=vn.columnLookups[r],h&&(u=h.call(this.table),u=u.filter(d=>this.columnVisCheck(d))),s=this.config.columnHeaders!==!1?this.headersToExportRows(this.generateColumnGroupHeaders(u)):[],u&&(u=u.map(d=>d.getComponent())),o=this.bodyToExportRows(this.rowLookup(r),u),s.concat(o)}generateTable(e,t,r,a){var s=this.generateExportList(e,t,r,a);return this.generateTableElement(s)}rowLookup(e){var t=[],r;return typeof e=="function"?e.call(this.table).forEach(a=>{a=this.table.rowManager.findRow(a),a&&t.push(a)}):(r=vn.rowLookups[e]||vn.rowLookups.active,t=r.call(this.table)),Object.assign([],t)}generateColumnGroupHeaders(e){var t=[];return e||(e=this.config.columnGroups!==!1?this.table.columnManager.columns:this.table.columnManager.columnsByIndex),e.forEach(r=>{var a=this.processColumnGroup(r);a&&t.push(a)}),t}processColumnGroup(e){var t=e.columns,r=0,a=e.definition["title"+this.colVisPropAttach]||e.definition.title,s={title:a,column:e,depth:1};if(t.length){if(s.subGroups=[],s.width=0,t.forEach(o=>{var u=this.processColumnGroup(o);u&&(s.width+=u.width,s.subGroups.push(u),u.depth>r&&(r=u.depth))}),s.depth+=r,!s.width)return!1}else if(this.columnVisCheck(e))s.width=1;else return!1;return s}columnVisCheck(e){var t=e.definition[this.colVisProp];return this.config.rowHeaders===!1&&e.isRowHeader?!1:(typeof t=="function"&&(t=t.call(this.table,e.getComponent())),t===!1||t===!0?t:e.visible&&e.field)}headersToExportRows(e){var t=[],r=0,a=[];function s(o,u){var h=r-u;if(typeof t[u]>"u"&&(t[u]=[]),o.height=o.subGroups?1:h-o.depth+1,t[u].push(o),o.height>1)for(let d=1;d<o.height;d++)typeof t[u+d]>"u"&&(t[u+d]=[]),t[u+d].push(!1);if(o.width>1)for(let d=1;d<o.width;d++)t[u].push(!1);o.subGroups&&o.subGroups.forEach(function(d){s(d,u+1)})}return e.forEach(function(o){o.depth>r&&(r=o.depth)}),e.forEach(function(o){s(o,0)}),t.forEach(o=>{var u=[];o.forEach(h=>{if(h){let d=typeof h.title>"u"?"":h.title;u.push(new r0(d,h.column.getComponent(),h.width,h.height,h.depth))}else u.push(null)}),a.push(new $b("header",u))}),a}bodyToExportRows(e,t=[]){var r=[];return t.length===0&&this.table.columnManager.columnsByIndex.forEach(a=>{this.columnVisCheck(a)&&t.push(a.getComponent())}),this.config.columnCalcs!==!1&&this.table.modExists("columnCalcs")&&(this.table.modules.columnCalcs.topInitialized&&e.unshift(this.table.modules.columnCalcs.topRow),this.table.modules.columnCalcs.botInitialized&&e.push(this.table.modules.columnCalcs.botRow)),e=e.filter(a=>{switch(a.type){case"group":return this.config.rowGroups!==!1;case"calc":return this.config.columnCalcs!==!1;case"row":return!(this.table.options.dataTree&&this.config.dataTree===!1&&a.modules.dataTree.parent)}return!0}),e.forEach((a,s)=>{var o=a.getData(this.colVisProp),u=[],h=0;switch(a.type){case"group":h=a.level,u.push(new r0(a.key,a.getComponent(),t.length,1));break;case"calc":case"row":t.forEach(d=>{u.push(new r0(d._column.getFieldValue(o),d,1,1))}),this.table.options.dataTree&&this.config.dataTree!==!1&&(h=a.modules.dataTree.index);break}r.push(new $b(a.type,u,a.getComponent(),h))}),r}generateTableElement(e){var t=document.createElement("table"),r=document.createElement("thead"),a=document.createElement("tbody"),s=this.lookupTableStyles(),o=this.table.options["rowFormatter"+this.colVisPropAttach],u={};return u.rowFormatter=o!==null?o:this.table.options.rowFormatter,this.table.options.dataTree&&this.config.dataTree!==!1&&this.table.modExists("columnCalcs")&&(u.treeElementField=this.table.modules.dataTree.elementField),u.groupHeader=this.table.options["groupHeader"+this.colVisPropAttach],u.groupHeader&&!Array.isArray(u.groupHeader)&&(u.groupHeader=[u.groupHeader]),t.classList.add("tabulator-print-table"),this.mapElementStyles(this.table.columnManager.getHeadersElement(),r,["border-top","border-left","border-right","border-bottom","background-color","color","font-weight","font-family","font-size"]),e.length>1e3&&console.warn("It may take a long time to render an HTML table with more than 1000 rows"),e.forEach((h,d)=>{let p;switch(h.type){case"header":r.appendChild(this.generateHeaderElement(h,u,s));break;case"group":a.appendChild(this.generateGroupElement(h,u,s));break;case"calc":a.appendChild(this.generateCalcElement(h,u,s));break;case"row":p=this.generateRowElement(h,u,s),this.mapElementStyles(d%2&&s.evenRow?s.evenRow:s.oddRow,p,["border-top","border-left","border-right","border-bottom","color","font-weight","font-family","font-size","background-color"]),a.appendChild(p);break}}),r.innerHTML&&t.appendChild(r),t.appendChild(a),this.mapElementStyles(this.table.element,t,["border-top","border-left","border-right","border-bottom"]),t}lookupTableStyles(){var e={};return this.cloneTableStyle&&window.getComputedStyle&&(e.oddRow=this.table.element.querySelector(".tabulator-row-odd:not(.tabulator-group):not(.tabulator-calcs)"),e.evenRow=this.table.element.querySelector(".tabulator-row-even:not(.tabulator-group):not(.tabulator-calcs)"),e.calcRow=this.table.element.querySelector(".tabulator-row.tabulator-calcs"),e.firstRow=this.table.element.querySelector(".tabulator-row:not(.tabulator-group):not(.tabulator-calcs)"),e.firstGroup=this.table.element.getElementsByClassName("tabulator-group")[0],e.firstRow&&(e.styleCells=e.firstRow.getElementsByClassName("tabulator-cell"),e.styleRowHeader=e.firstRow.getElementsByClassName("tabulator-row-header")[0],e.firstCell=e.styleCells[0],e.lastCell=e.styleCells[e.styleCells.length-1])),e}generateHeaderElement(e,t,r){var a=document.createElement("tr");return e.columns.forEach(s=>{if(s){var o=document.createElement("th"),u=s.component._column.definition.cssClass?s.component._column.definition.cssClass.split(" "):[];o.colSpan=s.width,o.rowSpan=s.height,o.innerHTML=s.value,this.cloneTableStyle&&(o.style.boxSizing="border-box"),u.forEach(function(h){o.classList.add(h)}),this.mapElementStyles(s.component.getElement(),o,["text-align","border-left","border-right","background-color","color","font-weight","font-family","font-size"]),this.mapElementStyles(s.component._column.contentElement,o,["padding-top","padding-left","padding-right","padding-bottom"]),s.component._column.visible?this.mapElementStyles(s.component.getElement(),o,["width"]):s.component._column.definition.width&&(o.style.width=s.component._column.definition.width+"px"),s.component._column.parent&&s.component._column.parent.isGroup?this.mapElementStyles(s.component._column.parent.groupElement,o,["border-top"]):this.mapElementStyles(s.component.getElement(),o,["border-top"]),s.component._column.isGroup?this.mapElementStyles(s.component.getElement(),o,["border-bottom"]):this.mapElementStyles(this.table.columnManager.getElement(),o,["border-bottom"]),a.appendChild(o)}}),a}generateGroupElement(e,t,r){var a=document.createElement("tr"),s=document.createElement("td"),o=e.columns[0];return a.classList.add("tabulator-print-table-row"),t.groupHeader&&t.groupHeader[e.indent]?o.value=t.groupHeader[e.indent](o.value,e.component._group.getRowCount(),e.component._group.getData(),e.component):t.groupHeader!==!1&&(o.value=e.component._group.generator(o.value,e.component._group.getRowCount(),e.component._group.getData(),e.component)),s.colSpan=o.width,s.innerHTML=o.value,a.classList.add("tabulator-print-table-group"),a.classList.add("tabulator-group-level-"+e.indent),o.component.isVisible()&&a.classList.add("tabulator-group-visible"),this.mapElementStyles(r.firstGroup,a,["border-top","border-left","border-right","border-bottom","color","font-weight","font-family","font-size","background-color"]),this.mapElementStyles(r.firstGroup,s,["padding-top","padding-left","padding-right","padding-bottom"]),a.appendChild(s),a}generateCalcElement(e,t,r){var a=this.generateRowElement(e,t,r);return a.classList.add("tabulator-print-table-calcs"),this.mapElementStyles(r.calcRow,a,["border-top","border-left","border-right","border-bottom","color","font-weight","font-family","font-size","background-color"]),a}generateRowElement(e,t,r){var a=document.createElement("tr");if(a.classList.add("tabulator-print-table-row"),e.columns.forEach((s,o)=>{if(s){var u=document.createElement("td"),h=s.component._column,d=this.table,p=d.columnManager.findColumnIndex(h),b=s.value,g,v,y={modules:{},getValue:function(){return b},getField:function(){return h.definition.field},getElement:function(){return u},getType:function(){return"cell"},getColumn:function(){return h.getComponent()},getData:function(){return e.component.getData()},getRow:function(){return e.component},getTable:function(){return d},getComponent:function(){return y},column:h},C=h.definition.cssClass?h.definition.cssClass.split(" "):[];if(C.forEach(function(E){u.classList.add(E)}),this.table.modExists("format")&&this.config.formatCells!==!1)b=this.table.modules.format.formatExportValue(y,this.colVisProp);else switch(typeof b){case"object":b=b!==null?JSON.stringify(b):"";break;case"undefined":b="";break}b instanceof Node?u.appendChild(b):u.innerHTML=b,v=["padding-top","padding-left","padding-right","padding-bottom","border-top","border-left","border-right","border-bottom","color","font-weight","font-family","font-size","text-align"],h.isRowHeader?(g=r.styleRowHeader,v.push("background-color")):g=r.styleCells&&r.styleCells[p]?r.styleCells[p]:r.firstCell,g&&(this.mapElementStyles(g,u,v),h.definition.align&&(u.style.textAlign=h.definition.align)),this.table.options.dataTree&&this.config.dataTree!==!1&&(t.treeElementField&&t.treeElementField==h.field||!t.treeElementField&&o==0)&&(e.component._row.modules.dataTree.controlEl&&u.insertBefore(e.component._row.modules.dataTree.controlEl.cloneNode(!0),u.firstChild),e.component._row.modules.dataTree.branchEl&&u.insertBefore(e.component._row.modules.dataTree.branchEl.cloneNode(!0),u.firstChild)),a.appendChild(u),y.modules.format&&y.modules.format.renderedCallback&&y.modules.format.renderedCallback()}}),t.rowFormatter&&e.type==="row"&&this.config.formatCells!==!1){let s=Object.assign(e.component);s.getElement=function(){return a},t.rowFormatter(e.component)}return a}generateHTMLTable(e){var t=document.createElement("div");return t.appendChild(this.generateTableElement(e)),t.innerHTML}getHtml(e,t,r,a){var s=this.generateExportList(r||this.table.options.htmlOutputConfig,t,e,a||"htmlOutput");return this.generateHTMLTable(s)}mapElementStyles(e,t,r){if(this.cloneTableStyle&&e&&t){var a={"background-color":"backgroundColor",color:"fontColor",width:"width","font-weight":"fontWeight","font-family":"fontFamily","font-size":"fontSize","text-align":"textAlign","border-top":"borderTop","border-left":"borderLeft","border-right":"borderRight","border-bottom":"borderBottom","padding-top":"paddingTop","padding-left":"paddingLeft","padding-right":"paddingRight","padding-bottom":"paddingBottom"};if(window.getComputedStyle){var s=window.getComputedStyle(e);r.forEach(function(o){t.style[a[o]]||(t.style[a[o]]=s.getPropertyValue(o))})}}}};Be(vn,"moduleName","export"),Be(vn,"columnLookups",PL),Be(vn,"rowLookups",IL);let F0=vn;var UL={"=":function(i,e,t,r){return e==i},"<":function(i,e,t,r){return e<i},"<=":function(i,e,t,r){return e<=i},">":function(i,e,t,r){return e>i},">=":function(i,e,t,r){return e>=i},"!=":function(i,e,t,r){return e!=i},regex:function(i,e,t,r){return typeof i=="string"&&(i=new RegExp(i)),i.test(e)},like:function(i,e,t,r){return i===null||typeof i>"u"?e===i:typeof e<"u"&&e!==null?String(e).toLowerCase().indexOf(i.toLowerCase())>-1:!1},keywords:function(i,e,t,r){var a=i.toLowerCase().split(typeof r.separator>"u"?" ":r.separator),s=String(e===null||typeof e>"u"?"":e).toLowerCase(),o=[];return a.forEach(u=>{s.includes(u)&&o.push(!0)}),r.matchAll?o.length===a.length:!!o.length},starts:function(i,e,t,r){return i===null||typeof i>"u"?e===i:typeof e<"u"&&e!==null?String(e).toLowerCase().startsWith(i.toLowerCase()):!1},ends:function(i,e,t,r){return i===null||typeof i>"u"?e===i:typeof e<"u"&&e!==null?String(e).toLowerCase().endsWith(i.toLowerCase()):!1},in:function(i,e,t,r){return Array.isArray(i)?i.length?i.indexOf(e)>-1:!0:(console.warn("Filter Error - filter value is not an array:",i),!1)}};const Fa=class Fa extends ct{constructor(e){super(e),this.filterList=[],this.headerFilters={},this.headerFilterColumns=[],this.prevHeaderFilterChangeCheck="",this.prevHeaderFilterChangeCheck="{}",this.changed=!1,this.tableInitialized=!1,this.registerTableOption("filterMode","local"),this.registerTableOption("initialFilter",!1),this.registerTableOption("initialHeaderFilter",!1),this.registerTableOption("headerFilterLiveFilterDelay",300),this.registerTableOption("placeholderHeaderFilter",!1),this.registerColumnOption("headerFilter"),this.registerColumnOption("headerFilterPlaceholder"),this.registerColumnOption("headerFilterParams"),this.registerColumnOption("headerFilterEmptyCheck"),this.registerColumnOption("headerFilterFunc"),this.registerColumnOption("headerFilterFuncParams"),this.registerColumnOption("headerFilterLiveFilter"),this.registerTableFunction("searchRows",this.searchRows.bind(this)),this.registerTableFunction("searchData",this.searchData.bind(this)),this.registerTableFunction("setFilter",this.userSetFilter.bind(this)),this.registerTableFunction("refreshFilter",this.userRefreshFilter.bind(this)),this.registerTableFunction("addFilter",this.userAddFilter.bind(this)),this.registerTableFunction("getFilters",this.getFilters.bind(this)),this.registerTableFunction("setHeaderFilterFocus",this.userSetHeaderFilterFocus.bind(this)),this.registerTableFunction("getHeaderFilterValue",this.userGetHeaderFilterValue.bind(this)),this.registerTableFunction("setHeaderFilterValue",this.userSetHeaderFilterValue.bind(this)),this.registerTableFunction("getHeaderFilters",this.getHeaderFilters.bind(this)),this.registerTableFunction("removeFilter",this.userRemoveFilter.bind(this)),this.registerTableFunction("clearFilter",this.userClearFilter.bind(this)),this.registerTableFunction("clearHeaderFilter",this.userClearHeaderFilter.bind(this)),this.registerComponentFunction("column","headerFilterFocus",this.setHeaderFilterFocus.bind(this)),this.registerComponentFunction("column","reloadHeaderFilter",this.reloadHeaderFilter.bind(this)),this.registerComponentFunction("column","getHeaderFilterValue",this.getHeaderFilterValue.bind(this)),this.registerComponentFunction("column","setHeaderFilterValue",this.setHeaderFilterValue.bind(this))}initialize(){this.subscribe("column-init",this.initializeColumnHeaderFilter.bind(this)),this.subscribe("column-width-fit-before",this.hideHeaderFilterElements.bind(this)),this.subscribe("column-width-fit-after",this.showHeaderFilterElements.bind(this)),this.subscribe("table-built",this.tableBuilt.bind(this)),this.subscribe("placeholder",this.generatePlaceholder.bind(this)),this.table.options.filterMode==="remote"&&this.subscribe("data-params",this.remoteFilterParams.bind(this)),this.registerDataHandler(this.filter.bind(this),10)}tableBuilt(){this.table.options.initialFilter&&this.setFilter(this.table.options.initialFilter),this.table.options.initialHeaderFilter&&this.table.options.initialHeaderFilter.forEach(e=>{var t=this.table.columnManager.findColumn(e.field);if(t)this.setHeaderFilterValue(t,e.value);else return console.warn("Column Filter Error - No matching column found:",e.field),!1}),this.tableInitialized=!0}remoteFilterParams(e,t,r,a){return a.filter=this.getFilters(!0,!0),a}generatePlaceholder(e){if(this.table.options.placeholderHeaderFilter&&Object.keys(this.headerFilters).length)return this.table.options.placeholderHeaderFilter}userSetFilter(e,t,r,a){this.setFilter(e,t,r,a),this.refreshFilter()}userRefreshFilter(){this.refreshFilter()}userAddFilter(e,t,r,a){this.addFilter(e,t,r,a),this.refreshFilter()}userSetHeaderFilterFocus(e){var t=this.table.columnManager.findColumn(e);if(t)this.setHeaderFilterFocus(t);else return console.warn("Column Filter Focus Error - No matching column found:",e),!1}userGetHeaderFilterValue(e){var t=this.table.columnManager.findColumn(e);if(t)return this.getHeaderFilterValue(t);console.warn("Column Filter Error - No matching column found:",e)}userSetHeaderFilterValue(e,t){var r=this.table.columnManager.findColumn(e);if(r)this.setHeaderFilterValue(r,t);else return console.warn("Column Filter Error - No matching column found:",e),!1}userRemoveFilter(e,t,r){this.removeFilter(e,t,r),this.refreshFilter()}userClearFilter(e){this.clearFilter(e),this.refreshFilter()}userClearHeaderFilter(){this.clearHeaderFilter(),this.refreshFilter()}searchRows(e,t,r){return this.search("rows",e,t,r)}searchData(e,t,r){return this.search("data",e,t,r)}initializeColumnHeaderFilter(e){var t=e.definition;t.headerFilter&&this.initializeColumn(e)}initializeColumn(e,t){var r=this,a=e.getField();function s(o){var u=e.modules.filter.tagType=="input"&&e.modules.filter.attrType=="text"||e.modules.filter.tagType=="textarea"?"partial":"match",h="",d="",p;if(typeof e.modules.filter.prevSuccess>"u"||e.modules.filter.prevSuccess!==o){if(e.modules.filter.prevSuccess=o,e.modules.filter.emptyFunc(o))delete r.headerFilters[a];else{switch(e.modules.filter.value=o,typeof e.definition.headerFilterFunc){case"string":Fa.filters[e.definition.headerFilterFunc]?(h=e.definition.headerFilterFunc,p=function(b){var g=e.definition.headerFilterFuncParams||{},v=e.getFieldValue(b);return g=typeof g=="function"?g(o,v,b):g,Fa.filters[e.definition.headerFilterFunc](o,v,b,g)}):console.warn("Header Filter Error - Matching filter function not found: ",e.definition.headerFilterFunc);break;case"function":p=function(b){var g=e.definition.headerFilterFuncParams||{},v=e.getFieldValue(b);return g=typeof g=="function"?g(o,v,b):g,e.definition.headerFilterFunc(o,v,b,g)},h=p;break}if(!p)switch(u){case"partial":p=function(b){var g=e.getFieldValue(b);return typeof g<"u"&&g!==null?String(g).toLowerCase().indexOf(String(o).toLowerCase())>-1:!1},h="like";break;default:p=function(b){return e.getFieldValue(b)==o},h="="}r.headerFilters[a]={value:o,func:p,type:h}}e.modules.filter.value=o,d=JSON.stringify(r.headerFilters),r.prevHeaderFilterChangeCheck!==d&&(r.prevHeaderFilterChangeCheck=d,r.trackChanges(),r.refreshFilter())}return!0}e.modules.filter={success:s,attrType:!1,tagType:!1,emptyFunc:!1},this.generateHeaderFilterElement(e)}generateHeaderFilterElement(e,t,r){var a=this,s=e.modules.filter.success,o=e.getField(),u,h,d,p,b,g,v,y;e.modules.filter.value=t;function C(){}function E(w){y=w}if(e.modules.filter.headerElement&&e.modules.filter.headerElement.parentNode&&e.contentElement.removeChild(e.modules.filter.headerElement.parentNode),o){switch(e.modules.filter.emptyFunc=e.definition.headerFilterEmptyCheck||function(w){return!w&&w!==0},u=document.createElement("div"),u.classList.add("tabulator-header-filter"),typeof e.definition.headerFilter){case"string":a.table.modules.edit.editors[e.definition.headerFilter]?(h=a.table.modules.edit.editors[e.definition.headerFilter],(e.definition.headerFilter==="tick"||e.definition.headerFilter==="tickCross")&&!e.definition.headerFilterEmptyCheck&&(e.modules.filter.emptyFunc=function(w){return w!==!0&&w!==!1})):console.warn("Filter Error - Cannot build header filter, No such editor found: ",e.definition.editor);break;case"function":h=e.definition.headerFilter;break;case"boolean":e.modules.edit&&e.modules.edit.editor?h=e.modules.edit.editor:e.definition.formatter&&a.table.modules.edit.editors[e.definition.formatter]?(h=a.table.modules.edit.editors[e.definition.formatter],(e.definition.formatter==="tick"||e.definition.formatter==="tickCross")&&!e.definition.headerFilterEmptyCheck&&(e.modules.filter.emptyFunc=function(w){return w!==!0&&w!==!1})):h=a.table.modules.edit.editors.input;break}if(h){if(p={getValue:function(){return typeof t<"u"?t:""},getField:function(){return e.definition.field},getElement:function(){return u},getColumn:function(){return e.getComponent()},getTable:()=>this.table,getType:()=>"header",getRow:function(){return{normalizeHeight:function(){}}}},v=e.definition.headerFilterParams||{},v=typeof v=="function"?v.call(a.table,p):v,d=h.call(this.table.modules.edit,p,E,s,C,v),!d){console.warn("Filter Error - Cannot add filter to "+o+" column, editor returned a value of false");return}if(!(d instanceof Node)){console.warn("Filter Error - Cannot add filter to "+o+" column, editor should return an instance of Node, the editor returned:",d);return}a.langBind("headerFilters|columns|"+e.definition.field,function(w){d.setAttribute("placeholder",typeof w<"u"&&w?w:e.definition.headerFilterPlaceholder||a.langText("headerFilters|default"))}),d.addEventListener("click",function(w){w.stopPropagation(),d.focus()}),d.addEventListener("focus",w=>{var R=this.table.columnManager.contentsElement.scrollLeft,T=this.table.rowManager.element.scrollLeft;R!==T&&(this.table.rowManager.scrollHorizontal(R),this.table.columnManager.scrollHorizontal(R))}),b=!1,g=function(w){b&&clearTimeout(b),b=setTimeout(function(){s(d.value)},a.table.options.headerFilterLiveFilterDelay)},e.modules.filter.headerElement=d,e.modules.filter.attrType=d.hasAttribute("type")?d.getAttribute("type").toLowerCase():"",e.modules.filter.tagType=d.tagName.toLowerCase(),e.definition.headerFilterLiveFilter!==!1&&(e.definition.headerFilter==="autocomplete"||e.definition.headerFilter==="tickCross"||(e.definition.editor==="autocomplete"||e.definition.editor==="tickCross")&&e.definition.headerFilter===!0||(d.addEventListener("keyup",g),d.addEventListener("search",g),e.modules.filter.attrType=="number"&&d.addEventListener("change",function(w){s(d.value)}),e.modules.filter.attrType=="text"&&this.table.browser!=="ie"&&d.setAttribute("type","search")),(e.modules.filter.tagType=="input"||e.modules.filter.tagType=="select"||e.modules.filter.tagType=="textarea")&&d.addEventListener("mousedown",function(w){w.stopPropagation()})),u.appendChild(d),e.contentElement.appendChild(u),r||a.headerFilterColumns.push(e),y&&y()}}else console.warn("Filter Error - Cannot add header filter, column has no field set:",e.definition.title)}hideHeaderFilterElements(){this.headerFilterColumns.forEach(function(e){e.modules.filter&&e.modules.filter.headerElement&&(e.modules.filter.headerElement.style.display="none")})}showHeaderFilterElements(){this.headerFilterColumns.forEach(function(e){e.modules.filter&&e.modules.filter.headerElement&&(e.modules.filter.headerElement.style.display="")})}setHeaderFilterFocus(e){e.modules.filter&&e.modules.filter.headerElement?e.modules.filter.headerElement.focus():console.warn("Column Filter Focus Error - No header filter set on column:",e.getField())}getHeaderFilterValue(e){if(e.modules.filter&&e.modules.filter.headerElement)return e.modules.filter.value;console.warn("Column Filter Error - No header filter set on column:",e.getField())}setHeaderFilterValue(e,t){e&&(e.modules.filter&&e.modules.filter.headerElement?(this.generateHeaderFilterElement(e,t,!0),e.modules.filter.success(t)):console.warn("Column Filter Error - No header filter set on column:",e.getField()))}reloadHeaderFilter(e){e&&(e.modules.filter&&e.modules.filter.headerElement?this.generateHeaderFilterElement(e,e.modules.filter.value,!0):console.warn("Column Filter Error - No header filter set on column:",e.getField()))}refreshFilter(){this.tableInitialized&&(this.table.options.filterMode==="remote"?this.reloadData(null,!1,!1):this.refreshData(!0))}trackChanges(){this.changed=!0,this.dispatch("filter-changed")}hasChanged(){var e=this.changed;return this.changed=!1,e}setFilter(e,t,r,a){this.filterList=[],Array.isArray(e)||(e=[{field:e,type:t,value:r,params:a}]),this.addFilter(e)}addFilter(e,t,r,a){var s=!1;Array.isArray(e)||(e=[{field:e,type:t,value:r,params:a}]),e.forEach(o=>{o=this.findFilter(o),o&&(this.filterList.push(o),s=!0)}),s&&this.trackChanges()}findFilter(e){var t;if(Array.isArray(e))return this.findSubFilters(e);var r=!1;return typeof e.field=="function"?r=function(a){return e.field(a,e.type||{})}:Fa.filters[e.type]?(t=this.table.columnManager.getColumnByField(e.field),t?r=function(a){return Fa.filters[e.type](e.value,t.getFieldValue(a),a,e.params||{})}:r=function(a){return Fa.filters[e.type](e.value,a[e.field],a,e.params||{})}):console.warn("Filter Error - No such filter type found, ignoring: ",e.type),e.func=r,e.func?e:!1}findSubFilters(e){var t=[];return e.forEach(r=>{r=this.findFilter(r),r&&t.push(r)}),t.length?t:!1}getFilters(e,t){var r=[];return e&&(r=this.getHeaderFilters()),t&&r.forEach(function(a){typeof a.type=="function"&&(a.type="function")}),r=r.concat(this.filtersToArray(this.filterList,t)),r}filtersToArray(e,t){var r=[];return e.forEach(a=>{var s;Array.isArray(a)?r.push(this.filtersToArray(a,t)):(s={field:a.field,type:a.type,value:a.value},t&&typeof s.type=="function"&&(s.type="function"),r.push(s))}),r}getHeaderFilters(){var e=[];for(var t in this.headerFilters)e.push({field:t,type:this.headerFilters[t].type,value:this.headerFilters[t].value});return e}removeFilter(e,t,r){Array.isArray(e)||(e=[{field:e,type:t,value:r}]),e.forEach(a=>{var s=-1;typeof a.field=="object"?s=this.filterList.findIndex(o=>a===o):s=this.filterList.findIndex(o=>a.field===o.field&&a.type===o.type&&a.value===o.value),s>-1?this.filterList.splice(s,1):console.warn("Filter Error - No matching filter type found, ignoring: ",a.type)}),this.trackChanges()}clearFilter(e){this.filterList=[],e&&this.clearHeaderFilter(),this.trackChanges()}clearHeaderFilter(){this.headerFilters={},this.prevHeaderFilterChangeCheck="{}",this.headerFilterColumns.forEach(e=>{typeof e.modules.filter.value<"u"&&delete e.modules.filter.value,e.modules.filter.prevSuccess=void 0,this.reloadHeaderFilter(e)}),this.trackChanges()}search(e,t,r,a){var s=[],o=[];return Array.isArray(t)||(t=[{field:t,type:r,value:a}]),t.forEach(u=>{u=this.findFilter(u),u&&o.push(u)}),this.table.rowManager.rows.forEach(u=>{var h=!0;o.forEach(d=>{this.filterRecurse(d,u.getData())||(h=!1)}),h&&s.push(e==="data"?u.getData("data"):u.getComponent())}),s}filter(e,t){var r=[],a=[];return this.subscribedExternal("dataFiltering")&&this.dispatchExternal("dataFiltering",this.getFilters(!0)),this.table.options.filterMode!=="remote"&&(this.filterList.length||Object.keys(this.headerFilters).length)?e.forEach(s=>{this.filterRow(s)&&r.push(s)}):r=e.slice(0),this.subscribedExternal("dataFiltered")&&(r.forEach(s=>{a.push(s.getComponent())}),this.dispatchExternal("dataFiltered",this.getFilters(!0),a)),r}filterRow(e,t){var r=!0,a=e.getData();this.filterList.forEach(o=>{this.filterRecurse(o,a)||(r=!1)});for(var s in this.headerFilters)this.headerFilters[s].func(a)||(r=!1);return r}filterRecurse(e,t){var r=!1;return Array.isArray(e)?e.forEach(a=>{this.filterRecurse(a,t)&&(r=!0)}):r=e.func(t),r}};Be(Fa,"moduleName","filter"),Be(Fa,"filters",UL);let M0=Fa;function VL(i,e,t){return this.emptyToSpace(this.sanitizeHTML(i.getValue()))}function GL(i,e,t){return i.getValue()}function WL(i,e,t){return i.getElement().style.whiteSpace="pre-wrap",this.emptyToSpace(this.sanitizeHTML(i.getValue()))}function jL(i,e,t){var r=parseFloat(i.getValue()),a="",s,o,u,h,d,p=e.decimal||".",b=e.thousand||",",g=e.negativeSign||"-",v=e.symbol||"",y=!!e.symbolAfter,C=typeof e.precision<"u"?e.precision:2;if(isNaN(r))return this.emptyToSpace(this.sanitizeHTML(i.getValue()));if(r<0&&(r=Math.abs(r),a=g),s=C!==!1?r.toFixed(C):r,s=String(s).split("."),o=s[0],u=s.length>1?p+s[1]:"",e.thousand!==!1)for(h=/(\d+)(\d{3})/;h.test(o);)o=o.replace(h,"$1"+b+"$2");return d=o+u,a===!0?(d="("+d+")",y?d+v:v+d):y?a+d+v:a+v+d}function XL(i,e,t){var r=i.getValue(),a=e.urlPrefix||"",s=e.download,o=r,u=document.createElement("a"),h;function d(p,b){var g=p.shift(),v=b[g];return p.length&&typeof v=="object"?d(p,v):v}if(e.labelField&&(h=i.getData(),o=d(e.labelField.split(this.table.options.nestedFieldSeparator),h)),e.label)switch(typeof e.label){case"string":o=e.label;break;case"function":o=e.label(i);break}if(o){if(e.urlField&&(h=i.getData(),r=Wt.retrieveNestedData(this.table.options.nestedFieldSeparator,e.urlField,h)),e.url)switch(typeof e.url){case"string":r=e.url;break;case"function":r=e.url(i);break}return u.setAttribute("href",a+r),e.target&&u.setAttribute("target",e.target),e.download&&(typeof s=="function"?s=s(i):s=s===!0?"":s,u.setAttribute("download",s)),u.innerHTML=this.emptyToSpace(this.sanitizeHTML(o)),u}else return"&nbsp;"}function YL(i,e,t){var r=document.createElement("img"),a=i.getValue();switch(e.urlPrefix&&(a=e.urlPrefix+i.getValue()),e.urlSuffix&&(a=a+e.urlSuffix),r.setAttribute("src",a),typeof e.height){case"number":r.style.height=e.height+"px";break;case"string":r.style.height=e.height;break}switch(typeof e.width){case"number":r.style.width=e.width+"px";break;case"string":r.style.width=e.width;break}return r.addEventListener("load",function(){i.getRow().normalizeHeight()}),r}function qL(i,e,t){var r=i.getValue(),a=i.getElement(),s=e.allowEmpty,o=e.allowTruthy,u=Object.keys(e).includes("trueValue"),h=typeof e.tickElement<"u"?e.tickElement:'<svg enable-background="new 0 0 24 24" height="14" width="14" viewBox="0 0 24 24" xml:space="preserve" ><path fill="#2DC214" clip-rule="evenodd" d="M21.652,3.211c-0.293-0.295-0.77-0.295-1.061,0L9.41,14.34  c-0.293,0.297-0.771,0.297-1.062,0L3.449,9.351C3.304,9.203,3.114,9.13,2.923,9.129C2.73,9.128,2.534,9.201,2.387,9.351  l-2.165,1.946C0.078,11.445,0,11.63,0,11.823c0,0.194,0.078,0.397,0.223,0.544l4.94,5.184c0.292,0.296,0.771,0.776,1.062,1.07  l2.124,2.141c0.292,0.293,0.769,0.293,1.062,0l14.366-14.34c0.293-0.294,0.293-0.777,0-1.071L21.652,3.211z" fill-rule="evenodd"/></svg>',d=typeof e.crossElement<"u"?e.crossElement:'<svg enable-background="new 0 0 24 24" height="14" width="14"  viewBox="0 0 24 24" xml:space="preserve" ><path fill="#CE1515" d="M22.245,4.015c0.313,0.313,0.313,0.826,0,1.139l-6.276,6.27c-0.313,0.312-0.313,0.826,0,1.14l6.273,6.272  c0.313,0.313,0.313,0.826,0,1.14l-2.285,2.277c-0.314,0.312-0.828,0.312-1.142,0l-6.271-6.271c-0.313-0.313-0.828-0.313-1.141,0  l-6.276,6.267c-0.313,0.313-0.828,0.313-1.141,0l-2.282-2.28c-0.313-0.313-0.313-0.826,0-1.14l6.278-6.269  c0.313-0.312,0.313-0.826,0-1.14L1.709,5.147c-0.314-0.313-0.314-0.827,0-1.14l2.284-2.278C4.308,1.417,4.821,1.417,5.135,1.73  L11.405,8c0.314,0.314,0.828,0.314,1.141,0.001l6.276-6.267c0.312-0.312,0.826-0.312,1.141,0L22.245,4.015z"/></svg>';return u&&r===e.trueValue||!u&&(o&&r||r===!0||r==="true"||r==="True"||r===1||r==="1")?(a.setAttribute("aria-checked",!0),h||""):s&&(r==="null"||r===""||r===null||typeof r>"u")?(a.setAttribute("aria-checked","mixed"),""):(a.setAttribute("aria-checked",!1),d||"")}function KL(i,e,t){var r=this.table.dependencyRegistry.lookup(["luxon","DateTime"],"DateTime"),a=e.inputFormat||"yyyy-MM-dd HH:mm:ss",s=e.outputFormat||"dd/MM/yyyy HH:mm:ss",o=typeof e.invalidPlaceholder<"u"?e.invalidPlaceholder:"",u=i.getValue();if(typeof r<"u"){var h;return r.isDateTime(u)?h=u:a==="iso"?h=r.fromISO(String(u)):h=r.fromFormat(String(u),a),h.isValid?(e.timezone&&(h=h.setZone(e.timezone)),h.toFormat(s)):o===!0||!u?u:typeof o=="function"?o(u):o}else console.error("Format Error - 'datetime' formatter is dependant on luxon.js")}function $L(i,e,t){var r=this.table.dependencyRegistry.lookup(["luxon","DateTime"],"DateTime"),a=e.inputFormat||"yyyy-MM-dd HH:mm:ss",s=typeof e.invalidPlaceholder<"u"?e.invalidPlaceholder:"",o=typeof e.suffix<"u"?e.suffix:!1,u=typeof e.unit<"u"?e.unit:"days",h=typeof e.humanize<"u"?e.humanize:!1,d=typeof e.date<"u"?e.date:r.now(),p=i.getValue();if(typeof r<"u"){var b;return r.isDateTime(p)?b=p:a==="iso"?b=r.fromISO(String(p)):b=r.fromFormat(String(p),a),b.isValid?h?b.diff(d,u).toHuman()+(o?" "+o:""):parseInt(b.diff(d,u)[u])+(o?" "+o:""):s===!0?p:typeof s=="function"?s(p):s}else console.error("Format Error - 'datetimediff' formatter is dependant on luxon.js")}function ZL(i,e,t){var r=i.getValue();return typeof e[r]>"u"?(console.warn("Missing display value for "+r),r):e[r]}function QL(i,e,t){var r=i.getValue(),a=i.getElement(),s=e&&e.stars?e.stars:5,o=document.createElement("span"),u=document.createElementNS("http://www.w3.org/2000/svg","svg"),h='<polygon fill="#FFEA00" stroke="#C1AB60" stroke-width="37.6152" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 "/>',d='<polygon fill="#D2D2D2" stroke="#686868" stroke-width="37.6152" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 "/>';o.style.verticalAlign="middle",u.setAttribute("width","14"),u.setAttribute("height","14"),u.setAttribute("viewBox","0 0 512 512"),u.setAttribute("xml:space","preserve"),u.style.padding="0 1px",r=r&&!isNaN(r)?parseInt(r):0,r=Math.max(0,Math.min(r,s));for(var p=1;p<=s;p++){var b=u.cloneNode(!0);b.innerHTML=p<=r?h:d,o.appendChild(b)}return a.style.whiteSpace="nowrap",a.style.overflow="hidden",a.style.textOverflow="ellipsis",a.setAttribute("aria-label",r),o}function JL(i,e,t){var r=this.sanitizeHTML(i.getValue())||0,a=document.createElement("span"),s=e&&e.max?e.max:100,o=e&&e.min?e.min:0,u=e&&typeof e.color<"u"?e.color:["red","orange","green"],h="#666666",d,p;if(!(isNaN(r)||typeof i.getValue()>"u")){switch(a.classList.add("tabulator-traffic-light"),p=parseFloat(r)<=s?parseFloat(r):s,p=parseFloat(p)>=o?parseFloat(p):o,d=(s-o)/100,p=Math.round((p-o)/d),typeof u){case"string":h=u;break;case"function":h=u(r);break;case"object":if(Array.isArray(u)){var b=100/u.length,g=Math.floor(p/b);g=Math.min(g,u.length-1),g=Math.max(g,0),h=u[g];break}}return a.style.backgroundColor=h,a}}function e6(i,e={},t){var r=this.sanitizeHTML(i.getValue())||0,a=i.getElement(),s=e.max?e.max:100,o=e.min?e.min:0,u=e.legendAlign?e.legendAlign:"center",h,d,p,b,g;switch(d=parseFloat(r)<=s?parseFloat(r):s,d=parseFloat(d)>=o?parseFloat(d):o,h=(s-o)/100,d=Math.round((d-o)/h),typeof e.color){case"string":p=e.color;break;case"function":p=e.color(r);break;case"object":if(Array.isArray(e.color)){let E=100/e.color.length,w=Math.floor(d/E);w=Math.min(w,e.color.length-1),w=Math.max(w,0),p=e.color[w];break}default:p="#2DC214"}switch(typeof e.legend){case"string":b=e.legend;break;case"function":b=e.legend(r);break;case"boolean":b=r;break;default:b=!1}switch(typeof e.legendColor){case"string":g=e.legendColor;break;case"function":g=e.legendColor(r);break;case"object":if(Array.isArray(e.legendColor)){let E=100/e.legendColor.length,w=Math.floor(d/E);w=Math.min(w,e.legendColor.length-1),w=Math.max(w,0),g=e.legendColor[w]}break;default:g="#000"}a.style.minWidth="30px",a.style.position="relative",a.setAttribute("aria-label",d);var v=document.createElement("div");v.style.display="inline-block",v.style.width=d+"%",v.style.backgroundColor=p,v.style.height="100%",v.setAttribute("data-max",s),v.setAttribute("data-min",o);var y=document.createElement("div");if(y.style.position="relative",y.style.width="100%",y.style.height="100%",b){var C=document.createElement("div");C.style.position="absolute",C.style.top=0,C.style.left=0,C.style.textAlign=u,C.style.width="100%",C.style.color=g,C.innerHTML=b}return t(function(){if(!(i instanceof Ry)){var E=document.createElement("div");E.style.position="absolute",E.style.top="4px",E.style.bottom="4px",E.style.left="4px",E.style.right="4px",a.appendChild(E),a=E}a.appendChild(y),y.appendChild(v),b&&y.appendChild(C)}),""}function t6(i,e,t){return i.getElement().style.backgroundColor=this.sanitizeHTML(i.getValue()),""}function i6(i,e,t){return'<svg enable-background="new 0 0 24 24" height="14" width="14" viewBox="0 0 24 24" xml:space="preserve" ><path fill="#2DC214" clip-rule="evenodd" d="M21.652,3.211c-0.293-0.295-0.77-0.295-1.061,0L9.41,14.34  c-0.293,0.297-0.771,0.297-1.062,0L3.449,9.351C3.304,9.203,3.114,9.13,2.923,9.129C2.73,9.128,2.534,9.201,2.387,9.351  l-2.165,1.946C0.078,11.445,0,11.63,0,11.823c0,0.194,0.078,0.397,0.223,0.544l4.94,5.184c0.292,0.296,0.771,0.776,1.062,1.07  l2.124,2.141c0.292,0.293,0.769,0.293,1.062,0l14.366-14.34c0.293-0.294,0.293-0.777,0-1.071L21.652,3.211z" fill-rule="evenodd"/></svg>'}function r6(i,e,t){return'<svg enable-background="new 0 0 24 24" height="14" width="14" viewBox="0 0 24 24" xml:space="preserve" ><path fill="#CE1515" d="M22.245,4.015c0.313,0.313,0.313,0.826,0,1.139l-6.276,6.27c-0.313,0.312-0.313,0.826,0,1.14l6.273,6.272  c0.313,0.313,0.313,0.826,0,1.14l-2.285,2.277c-0.314,0.312-0.828,0.312-1.142,0l-6.271-6.271c-0.313-0.313-0.828-0.313-1.141,0  l-6.276,6.267c-0.313,0.313-0.828,0.313-1.141,0l-2.282-2.28c-0.313-0.313-0.313-0.826,0-1.14l6.278-6.269  c0.313-0.312,0.313-0.826,0-1.14L1.709,5.147c-0.314-0.313-0.314-0.827,0-1.14l2.284-2.278C4.308,1.417,4.821,1.417,5.135,1.73  L11.405,8c0.314,0.314,0.828,0.314,1.141,0.001l6.276-6.267c0.312-0.312,0.826-0.312,1.141,0L22.245,4.015z"/></svg>'}function a6(i,e,t){var r=i.getValue(),a=e.size||15,s=a+"px",o,u,h=e.hasOwnProperty("onValue")?e.onValue:!0,d=e.hasOwnProperty("offValue")?e.offValue:!1,p=e.onTruthy?r:r===h;return o=document.createElement("div"),o.classList.add("tabulator-toggle"),p?(o.classList.add("tabulator-toggle-on"),o.style.flexDirection="row-reverse",e.onColor&&(o.style.background=e.onColor)):e.offColor&&(o.style.background=e.offColor),o.style.width=2.5*a+"px",o.style.borderRadius=s,e.clickable&&o.addEventListener("click",b=>{i.setValue(p?d:h)}),u=document.createElement("div"),u.classList.add("tabulator-toggle-switch"),u.style.height=s,u.style.width=s,u.style.borderRadius=s,o.appendChild(u),o}function n6(i,e,t){var r=document.createElement("span"),a=i.getRow(),s=i.getTable();return a.watchPosition(o=>{e.relativeToPage&&(o+=s.modules.page.getPageSize()*(s.modules.page.getPage()-1)),r.innerText=o}),r}function s6(i,e,t){return i.getElement().classList.add("tabulator-row-handle"),"<div class='tabulator-row-handle-box'><div class='tabulator-row-handle-bar'></div><div class='tabulator-row-handle-bar'></div><div class='tabulator-row-handle-bar'></div></div>"}function l6(i,e,t){var r,a,s;function o(u){var h=u.getValue(),d="plaintext";switch(typeof h){case"boolean":d="tickCross";break;case"string":h.includes(`
`)&&(d="textarea");break}return d}return r=e.formatterLookup?e.formatterLookup(i):o(i),e.paramsLookup&&(s=typeof e.paramsLookup=="function"?e.paramsLookup(r,i):e.paramsLookup[r]),a=this.table.modules.format.lookupFormatter(r),a.call(this,i,s||{},t)}function o6(i,e,t){var r=e.delimiter||",",a=i.getValue(),s=this.table,o;return e.valueMap&&(typeof e.valueMap=="string"?o=function(u){return u.map(h=>Wt.retrieveNestedData(s.options.nestedFieldSeparator,e.valueMap,h))}:o=e.valueMap),Array.isArray(a)?(o&&(a=o(a)),a.join(r)):a}function u6(i,e,t){var r=e.indent||"	",a=typeof e.multiline>"u"?!0:e.multiline,s=e.replacer||null,o=i.getValue();return a&&(i.getElement().style.whiteSpace="pre-wrap"),JSON.stringify(o,s,r)}var c6={plaintext:VL,html:GL,textarea:WL,money:jL,link:XL,image:YL,tickCross:qL,datetime:KL,datetimediff:$L,lookup:ZL,star:QL,traffic:JL,progress:e6,color:t6,buttonTick:i6,buttonCross:r6,toggle:a6,rownum:n6,handle:s6,adaptable:l6,array:o6,json:u6};const bn=class bn extends ct{constructor(e){super(e),this.registerColumnOption("formatter"),this.registerColumnOption("formatterParams"),this.registerColumnOption("formatterPrint"),this.registerColumnOption("formatterPrintParams"),this.registerColumnOption("formatterClipboard"),this.registerColumnOption("formatterClipboardParams"),this.registerColumnOption("formatterHtmlOutput"),this.registerColumnOption("formatterHtmlOutputParams"),this.registerColumnOption("titleFormatter"),this.registerColumnOption("titleFormatterParams")}initialize(){this.subscribe("cell-format",this.formatValue.bind(this)),this.subscribe("cell-rendered",this.cellRendered.bind(this)),this.subscribe("column-layout",this.initializeColumn.bind(this)),this.subscribe("column-format",this.formatHeader.bind(this))}initializeColumn(e){e.modules.format=this.lookupTypeFormatter(e,""),typeof e.definition.formatterPrint<"u"&&(e.modules.format.print=this.lookupTypeFormatter(e,"Print")),typeof e.definition.formatterClipboard<"u"&&(e.modules.format.clipboard=this.lookupTypeFormatter(e,"Clipboard")),typeof e.definition.formatterHtmlOutput<"u"&&(e.modules.format.htmlOutput=this.lookupTypeFormatter(e,"HtmlOutput"))}lookupTypeFormatter(e,t){var r={params:e.definition["formatter"+t+"Params"]||{}},a=e.definition["formatter"+t];return r.formatter=this.lookupFormatter(a),r}lookupFormatter(e){var t;switch(typeof e){case"string":bn.formatters[e]?t=bn.formatters[e]:(console.warn("Formatter Error - No such formatter found: ",e),t=bn.formatters.plaintext);break;case"function":t=e;break;default:t=bn.formatters.plaintext;break}return t}cellRendered(e){e.modules.format&&e.modules.format.renderedCallback&&!e.modules.format.rendered&&(e.modules.format.renderedCallback(),e.modules.format.rendered=!0)}formatHeader(e,t,r){var a,s,o,u;return e.definition.titleFormatter?(a=this.lookupFormatter(e.definition.titleFormatter),o=h=>{e.titleFormatterRendered=h},u={getValue:function(){return t},getElement:function(){return r},getType:function(){return"header"},getColumn:function(){return e.getComponent()},getTable:()=>this.table},s=e.definition.titleFormatterParams||{},s=typeof s=="function"?s():s,a.call(this,u,s,o)):t}formatValue(e){var t=e.getComponent(),r=typeof e.column.modules.format.params=="function"?e.column.modules.format.params(t):e.column.modules.format.params;function a(s){e.modules.format||(e.modules.format={}),e.modules.format.renderedCallback=s,e.modules.format.rendered=!1}return e.column.modules.format.formatter.call(this,t,r,a)}formatExportValue(e,t){var r=e.column.modules.format[t],a;if(r){let o=function(u){e.modules.format||(e.modules.format={}),e.modules.format.renderedCallback=u,e.modules.format.rendered=!1};var s=o;return a=typeof r.params=="function"?r.params(e.getComponent()):r.params,r.formatter.call(this,e.getComponent(),a,o)}else return this.formatValue(e)}sanitizeHTML(e){if(e){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};return String(e).replace(/[&<>"'`=/]/g,function(r){return t[r]})}else return e}emptyToSpace(e){return e===null||typeof e>"u"||e===""?"&nbsp;":e}};Be(bn,"moduleName","format"),Be(bn,"formatters",c6);let O0=bn;class Fy extends ct{constructor(e){super(e),this.leftColumns=[],this.rightColumns=[],this.initializationMode="left",this.active=!1,this.blocked=!0,this.registerColumnOption("frozen")}reset(){this.initializationMode="left",this.leftColumns=[],this.rightColumns=[],this.active=!1}initialize(){this.subscribe("cell-layout",this.layoutCell.bind(this)),this.subscribe("column-init",this.initializeColumn.bind(this)),this.subscribe("column-width",this.layout.bind(this)),this.subscribe("row-layout-after",this.layoutRow.bind(this)),this.subscribe("table-layout",this.layout.bind(this)),this.subscribe("columns-loading",this.reset.bind(this)),this.subscribe("column-add",this.reinitializeColumns.bind(this)),this.subscribe("column-deleted",this.reinitializeColumns.bind(this)),this.subscribe("column-hide",this.reinitializeColumns.bind(this)),this.subscribe("column-show",this.reinitializeColumns.bind(this)),this.subscribe("columns-loaded",this.reinitializeColumns.bind(this)),this.subscribe("table-redraw",this.layout.bind(this)),this.subscribe("layout-refreshing",this.blockLayout.bind(this)),this.subscribe("layout-refreshed",this.unblockLayout.bind(this)),this.subscribe("scrollbar-vertical",this.adjustForScrollbar.bind(this))}blockLayout(){this.blocked=!0}unblockLayout(){this.blocked=!1}layoutCell(e){this.layoutElement(e.element,e.column)}reinitializeColumns(){this.reset(),this.table.columnManager.columnsByIndex.forEach(e=>{this.initializeColumn(e)}),this.layout()}initializeColumn(e){var t={margin:0,edge:!1};e.isGroup||(this.frozenCheck(e)?(t.position=this.initializationMode,this.initializationMode=="left"?this.leftColumns.push(e):this.rightColumns.unshift(e),this.active=!0,e.modules.frozen=t):this.initializationMode="right")}frozenCheck(e){return e.parent.isGroup&&e.definition.frozen&&console.warn("Frozen Column Error - Parent column group must be frozen, not individual columns or sub column groups"),e.parent.isGroup?this.frozenCheck(e.parent):e.definition.frozen}layoutCalcRows(){this.table.modExists("columnCalcs")&&(this.table.modules.columnCalcs.topInitialized&&this.table.modules.columnCalcs.topRow&&this.layoutRow(this.table.modules.columnCalcs.topRow),this.table.modules.columnCalcs.botInitialized&&this.table.modules.columnCalcs.botRow&&this.layoutRow(this.table.modules.columnCalcs.botRow),this.table.modExists("groupRows")&&this.layoutGroupCalcs(this.table.modules.groupRows.getGroups()))}layoutGroupCalcs(e){e.forEach(t=>{t.calcs.top&&this.layoutRow(t.calcs.top),t.calcs.bottom&&this.layoutRow(t.calcs.bottom),t.groupList&&t.groupList.length&&this.layoutGroupCalcs(t.groupList)})}layoutColumnPosition(e){var t=[],r=0,a=0;this.leftColumns.forEach((s,o)=>{if(s.modules.frozen.marginValue=r,s.modules.frozen.margin=s.modules.frozen.marginValue+"px",s.visible&&(r+=s.getWidth()),o==this.leftColumns.length-1?s.modules.frozen.edge=!0:s.modules.frozen.edge=!1,s.parent.isGroup){var u=this.getColGroupParentElement(s);t.includes(u)||(this.layoutElement(u,s),t.push(u)),u.classList.toggle("tabulator-frozen-left",s.modules.frozen.edge&&s.modules.frozen.position==="left"),u.classList.toggle("tabulator-frozen-right",s.modules.frozen.edge&&s.modules.frozen.position==="right")}else this.layoutElement(s.getElement(),s);e&&s.cells.forEach(h=>{this.layoutElement(h.getElement(!0),s)})}),this.rightColumns.forEach((s,o)=>{s.modules.frozen.marginValue=a,s.modules.frozen.margin=s.modules.frozen.marginValue+"px",s.visible&&(a+=s.getWidth()),o==this.rightColumns.length-1?s.modules.frozen.edge=!0:s.modules.frozen.edge=!1,s.parent.isGroup?this.layoutElement(this.getColGroupParentElement(s),s):this.layoutElement(s.getElement(),s),e&&s.cells.forEach(u=>{this.layoutElement(u.getElement(!0),s)})})}getColGroupParentElement(e){return e.parent.isGroup?this.getColGroupParentElement(e.parent):e.getElement()}layout(){this.active&&!this.blocked&&(this.layoutColumnPosition(),this.reinitializeRows(),this.layoutCalcRows())}reinitializeRows(){var e=this.table.rowManager.getVisibleRows(!0),t=this.table.rowManager.getRows().filter(r=>!e.includes(r));t.forEach(r=>{r.deinitialize()}),e.forEach(r=>{r.type==="row"&&this.layoutRow(r)})}layoutRow(e){this.table.options.layout==="fitDataFill"&&this.rightColumns.length&&(this.table.rowManager.getTableElement().style.minWidth="calc(100% - "+this.rightMargin+")"),this.leftColumns.forEach(t=>{var r=e.getCell(t);r&&this.layoutElement(r.getElement(!0),t)}),this.rightColumns.forEach(t=>{var r=e.getCell(t);r&&this.layoutElement(r.getElement(!0),t)})}layoutElement(e,t){var r;t.modules.frozen&&e&&(e.style.position="sticky",this.table.rtl?r=t.modules.frozen.position==="left"?"right":"left":r=t.modules.frozen.position,e.style[r]=t.modules.frozen.margin,e.classList.add("tabulator-frozen"),e.classList.toggle("tabulator-frozen-left",t.modules.frozen.edge&&t.modules.frozen.position==="left"),e.classList.toggle("tabulator-frozen-right",t.modules.frozen.edge&&t.modules.frozen.position==="right"))}adjustForScrollbar(e){this.rightColumns.length&&(this.table.columnManager.getContentsElement().style.width="calc(100% - "+e+"px)")}getFrozenColumns(){return this.leftColumns.concat(this.rightColumns)}_calcSpace(e,t){var r=0;for(let a=0;a<t;a++)e[a].visible&&(r+=e[a].getWidth());return r}}Be(Fy,"moduleName","frozenColumns");class My extends ct{constructor(e){super(e),this.topElement=document.createElement("div"),this.rows=[],this.registerComponentFunction("row","freeze",this.freezeRow.bind(this)),this.registerComponentFunction("row","unfreeze",this.unfreezeRow.bind(this)),this.registerComponentFunction("row","isFrozen",this.isRowFrozen.bind(this)),this.registerTableOption("frozenRowsField","id"),this.registerTableOption("frozenRows",!1)}initialize(){var e=document.createDocumentFragment();this.rows=[],this.topElement.classList.add("tabulator-frozen-rows-holder"),e.appendChild(document.createElement("br")),e.appendChild(this.topElement),this.table.columnManager.getContentsElement().insertBefore(e,this.table.columnManager.headersElement.nextSibling),this.subscribe("row-deleting",this.detachRow.bind(this)),this.subscribe("rows-visible",this.visibleRows.bind(this)),this.registerDisplayHandler(this.getRows.bind(this),10),this.table.options.frozenRows&&(this.subscribe("data-processed",this.initializeRows.bind(this)),this.subscribe("row-added",this.initializeRow.bind(this)),this.subscribe("table-redrawing",this.resizeHolderWidth.bind(this)),this.subscribe("column-resized",this.resizeHolderWidth.bind(this)),this.subscribe("column-show",this.resizeHolderWidth.bind(this)),this.subscribe("column-hide",this.resizeHolderWidth.bind(this))),this.resizeHolderWidth()}resizeHolderWidth(){this.topElement.style.minWidth=this.table.columnManager.headersElement.offsetWidth+"px"}initializeRows(){this.table.rowManager.getRows().forEach(e=>{this.initializeRow(e)})}initializeRow(e){var t=this.table.options.frozenRows,r=typeof t;r==="number"?e.getPosition()&&e.getPosition()+this.rows.length<=t&&this.freezeRow(e):r==="function"?t.call(this.table,e.getComponent())&&this.freezeRow(e):Array.isArray(t)&&t.includes(e.data[this.options("frozenRowsField")])&&this.freezeRow(e)}isRowFrozen(e){var t=this.rows.indexOf(e);return t>-1}isFrozen(){return!!this.rows.length}visibleRows(e,t){return this.rows.forEach(r=>{t.push(r)}),t}getRows(e){var t=e.slice(0);return this.rows.forEach(function(r){var a=t.indexOf(r);a>-1&&t.splice(a,1)}),t}freezeRow(e){e.modules.frozen?console.warn("Freeze Error - Row is already frozen"):(e.modules.frozen=!0,this.topElement.appendChild(e.getElement()),e.initialize(),e.normalizeHeight(),this.rows.push(e),this.refreshData(!1,"display"),this.table.rowManager.adjustTableSize(),this.styleRows())}unfreezeRow(e){e.modules.frozen?(e.modules.frozen=!1,this.detachRow(e),this.table.rowManager.adjustTableSize(),this.refreshData(!1,"display"),this.rows.length&&this.styleRows()):console.warn("Freeze Error - Row is already unfrozen")}detachRow(e){var t=this.rows.indexOf(e);if(t>-1){var r=e.getElement();r.parentNode&&r.parentNode.removeChild(r),this.rows.splice(t,1)}}styleRows(e){this.rows.forEach((t,r)=>{this.table.rowManager.styleRow(t,r)})}}Be(My,"moduleName","frozenRows");class h6{constructor(e){return this._group=e,this.type="GroupComponent",new Proxy(this,{get:function(t,r,a){return typeof t[r]<"u"?t[r]:t._group.groupManager.table.componentFunctionBinder.handle("group",t._group,r)}})}getKey(){return this._group.key}getField(){return this._group.field}getElement(){return this._group.element}getRows(){return this._group.getRows(!0)}getSubGroups(){return this._group.getSubGroups(!0)}getParentGroup(){return this._group.parent?this._group.parent.getComponent():!1}isVisible(){return this._group.visible}show(){this._group.show()}hide(){this._group.hide()}toggle(){this._group.toggleVisibility()}scrollTo(e,t){return this._group.groupManager.table.rowManager.scrollToRow(this._group,e,t)}_getSelf(){return this._group}getTable(){return this._group.groupManager.table}}class ll{constructor(e,t,r,a,s,o,u){this.groupManager=e,this.parent=t,this.key=a,this.level=r,this.field=s,this.hasSubGroups=r<e.groupIDLookups.length-1,this.addRow=this.hasSubGroups?this._addRowToGroup:this._addRow,this.type="group",this.old=u,this.rows=[],this.groups=[],this.groupList=[],this.generator=o,this.element=!1,this.elementContents=!1,this.height=0,this.outerHeight=0,this.initialized=!1,this.calcs={},this.initialized=!1,this.modules={},this.arrowElement=!1,this.visible=u?u.visible:typeof e.startOpen[r]<"u"?e.startOpen[r]:e.startOpen[0],this.component=null,this.createElements(),this.addBindings(),this.createValueGroups()}wipe(e){e||(this.groupList.length?this.groupList.forEach(function(t){t.wipe()}):this.rows.forEach(t=>{t.modules&&delete t.modules.group})),this.element=!1,this.arrowElement=!1,this.elementContents=!1}createElements(){var e=document.createElement("div");e.classList.add("tabulator-arrow"),this.element=document.createElement("div"),this.element.classList.add("tabulator-row"),this.element.classList.add("tabulator-group"),this.element.classList.add("tabulator-group-level-"+this.level),this.element.setAttribute("role","rowgroup"),this.arrowElement=document.createElement("div"),this.arrowElement.classList.add("tabulator-group-toggle"),this.arrowElement.appendChild(e),this.groupManager.table.options.movableRows!==!1&&this.groupManager.table.modExists("moveRow")&&this.groupManager.table.modules.moveRow.initializeGroupHeader(this)}createValueGroups(){var e=this.level+1;this.groupManager.allowedValues&&this.groupManager.allowedValues[e]&&this.groupManager.allowedValues[e].forEach(t=>{this._createGroup(t,e)})}addBindings(){var e;this.groupManager.table.options.groupToggleElement&&(e=this.groupManager.table.options.groupToggleElement=="arrow"?this.arrowElement:this.element,e.addEventListener("click",t=>{this.groupManager.table.options.groupToggleElement==="arrow"&&(t.stopPropagation(),t.stopImmediatePropagation()),setTimeout(()=>{this.toggleVisibility()})}))}_createGroup(e,t){var r=t+"_"+e,a=new ll(this.groupManager,this,t,e,this.groupManager.groupIDLookups[t].field,this.groupManager.headerGenerator[t]||this.groupManager.headerGenerator[0],this.old?this.old.groups[r]:!1);this.groups[r]=a,this.groupList.push(a)}_addRowToGroup(e){var t=this.level+1;if(this.hasSubGroups){var r=this.groupManager.groupIDLookups[t].func(e.getData()),a=t+"_"+r;this.groupManager.allowedValues&&this.groupManager.allowedValues[t]?this.groups[a]&&this.groups[a].addRow(e):(this.groups[a]||this._createGroup(r,t),this.groups[a].addRow(e))}}_addRow(e){this.rows.push(e),e.modules.group=this}insertRow(e,t,r){var a=this.conformRowData({});e.updateData(a);var s=this.rows.indexOf(t);s>-1?r?this.rows.splice(s+1,0,e):this.rows.splice(s,0,e):r?this.rows.push(e):this.rows.unshift(e),e.modules.group=this,this.groupManager.table.modExists("columnCalcs")&&this.groupManager.table.options.columnCalcs!="table"&&this.groupManager.table.modules.columnCalcs.recalcGroup(this),this.groupManager.updateGroupRows(!0)}scrollHeader(e){this.arrowElement&&(this.arrowElement.style.marginLeft=e,this.groupList.forEach(function(t){t.scrollHeader(e)}))}getRowIndex(e){}conformRowData(e){return this.field?e[this.field]=this.key:console.warn("Data Conforming Error - Cannot conform row data to match new group as groupBy is a function"),this.parent&&(e=this.parent.conformRowData(e)),e}removeRow(e){var t=this.rows.indexOf(e),r=e.getElement();t>-1&&this.rows.splice(t,1),!this.groupManager.table.options.groupValues&&!this.rows.length?(this.parent?this.parent.removeGroup(this):this.groupManager.removeGroup(this),this.groupManager.updateGroupRows(!0)):(r.parentNode&&r.parentNode.removeChild(r),this.groupManager.blockRedraw||(this.generateGroupHeaderContents(),this.groupManager.table.modExists("columnCalcs")&&this.groupManager.table.options.columnCalcs!="table"&&this.groupManager.table.modules.columnCalcs.recalcGroup(this)))}removeGroup(e){var t=e.level+"_"+e.key,r;this.groups[t]&&(delete this.groups[t],r=this.groupList.indexOf(e),r>-1&&this.groupList.splice(r,1),this.groupList.length||(this.parent?this.parent.removeGroup(this):this.groupManager.removeGroup(this)))}getHeadersAndRows(){var e=[];return e.push(this),this._visSet(),this.calcs.top&&(this.calcs.top.detachElement(),this.calcs.top.deleteCells()),this.calcs.bottom&&(this.calcs.bottom.detachElement(),this.calcs.bottom.deleteCells()),this.visible?this.groupList.length?this.groupList.forEach(function(t){e=e.concat(t.getHeadersAndRows())}):(this.groupManager.table.options.columnCalcs!="table"&&this.groupManager.table.modExists("columnCalcs")&&this.groupManager.table.modules.columnCalcs.hasTopCalcs()&&(this.calcs.top=this.groupManager.table.modules.columnCalcs.generateTopRow(this.rows),e.push(this.calcs.top)),e=e.concat(this.rows),this.groupManager.table.options.columnCalcs!="table"&&this.groupManager.table.modExists("columnCalcs")&&this.groupManager.table.modules.columnCalcs.hasBottomCalcs()&&(this.calcs.bottom=this.groupManager.table.modules.columnCalcs.generateBottomRow(this.rows),e.push(this.calcs.bottom))):!this.groupList.length&&this.groupManager.table.options.columnCalcs!="table"&&this.groupManager.table.modExists("columnCalcs")&&(this.groupManager.table.modules.columnCalcs.hasTopCalcs()&&this.groupManager.table.options.groupClosedShowCalcs&&(this.calcs.top=this.groupManager.table.modules.columnCalcs.generateTopRow(this.rows),e.push(this.calcs.top)),this.groupManager.table.modules.columnCalcs.hasBottomCalcs()&&this.groupManager.table.options.groupClosedShowCalcs&&(this.calcs.bottom=this.groupManager.table.modules.columnCalcs.generateBottomRow(this.rows),e.push(this.calcs.bottom))),e}getData(e,t){var r=[];return this._visSet(),(!e||e&&this.visible)&&this.rows.forEach(a=>{r.push(a.getData(t||"data"))}),r}getRowCount(){var e=0;return this.groupList.length?this.groupList.forEach(t=>{e+=t.getRowCount()}):e=this.rows.length,e}toggleVisibility(){this.visible?this.hide():this.show()}hide(){this.visible=!1,this.groupManager.table.rowManager.getRenderMode()=="basic"&&!this.groupManager.table.options.pagination?(this.element.classList.remove("tabulator-group-visible"),this.groupList.length?this.groupList.forEach(e=>{var t=e.getHeadersAndRows();t.forEach(r=>{r.detachElement()})}):this.rows.forEach(e=>{var t=e.getElement();t.parentNode.removeChild(t)}),this.groupManager.updateGroupRows(!0)):this.groupManager.updateGroupRows(!0),this.groupManager.table.externalEvents.dispatch("groupVisibilityChanged",this.getComponent(),!1)}show(){if(this.visible=!0,this.groupManager.table.rowManager.getRenderMode()=="basic"&&!this.groupManager.table.options.pagination){this.element.classList.add("tabulator-group-visible");var e=this.generateElement();this.groupList.length?this.groupList.forEach(t=>{var r=t.getHeadersAndRows();r.forEach(a=>{var s=a.getElement();e.parentNode.insertBefore(s,e.nextSibling),a.initialize(),e=s})}):this.rows.forEach(t=>{var r=t.getElement();e.parentNode.insertBefore(r,e.nextSibling),t.initialize(),e=r}),this.groupManager.updateGroupRows(!0)}else this.groupManager.updateGroupRows(!0);this.groupManager.table.externalEvents.dispatch("groupVisibilityChanged",this.getComponent(),!0)}_visSet(){var e=[];typeof this.visible=="function"&&(this.rows.forEach(function(t){e.push(t.getData())}),this.visible=this.visible(this.key,this.getRowCount(),e,this.getComponent()))}getRowGroup(e){var t=!1;return this.groupList.length?this.groupList.forEach(function(r){var a=r.getRowGroup(e);a&&(t=a)}):this.rows.find(function(r){return r===e})&&(t=this),t}getSubGroups(e){var t=[];return this.groupList.forEach(function(r){t.push(e?r.getComponent():r)}),t}getRows(e,t){var r=[];return t&&this.groupList.length?this.groupList.forEach(a=>{r=r.concat(a.getRows(e,t))}):this.rows.forEach(function(a){r.push(e?a.getComponent():a)}),r}generateGroupHeaderContents(){var e=[],t=this.getRows(!1,!0);for(t.forEach(function(r){e.push(r.getData())}),this.elementContents=this.generator(this.key,this.getRowCount(),e,this.getComponent());this.element.firstChild;)this.element.removeChild(this.element.firstChild);typeof this.elementContents=="string"?this.element.innerHTML=this.elementContents:this.element.appendChild(this.elementContents),this.element.insertBefore(this.arrowElement,this.element.firstChild)}getPath(e=[]){return e.unshift(this.key),this.parent&&this.parent.getPath(e),e}getElement(){return this.elementContents?this.element:this.generateElement()}generateElement(){this.addBindings=!1,this._visSet(),this.visible?this.element.classList.add("tabulator-group-visible"):this.element.classList.remove("tabulator-group-visible");for(var e=0;e<this.element.childNodes.length;++e)this.element.childNodes[e].parentNode.removeChild(this.element.childNodes[e]);return this.generateGroupHeaderContents(),this.element}detachElement(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element)}normalizeHeight(){this.setHeight(this.element.clientHeight)}initialize(e){(!this.initialized||e)&&(this.normalizeHeight(),this.initialized=!0)}reinitialize(){this.initialized=!1,this.height=0,Wt.elVisible(this.element)&&this.initialize(!0)}setHeight(e){this.height!=e&&(this.height=e,this.outerHeight=this.element.offsetHeight)}getHeight(){return this.outerHeight}getGroup(){return this}reinitializeHeight(){}calcHeight(){}setCellHeight(){}clearCellHeight(){}deinitializeHeight(){}rendered(){}getComponent(){return this.component||(this.component=new h6(this)),this.component}}class Oy extends ct{constructor(e){super(e),this.groupIDLookups=!1,this.startOpen=[function(){return!1}],this.headerGenerator=[function(){return""}],this.groupList=[],this.allowedValues=!1,this.groups={},this.displayHandler=this.getRows.bind(this),this.blockRedraw=!1,this.registerTableOption("groupBy",!1),this.registerTableOption("groupStartOpen",!0),this.registerTableOption("groupValues",!1),this.registerTableOption("groupUpdateOnCellEdit",!1),this.registerTableOption("groupHeader",!1),this.registerTableOption("groupHeaderPrint",null),this.registerTableOption("groupHeaderClipboard",null),this.registerTableOption("groupHeaderHtmlOutput",null),this.registerTableOption("groupHeaderDownload",null),this.registerTableOption("groupToggleElement","arrow"),this.registerTableOption("groupClosedShowCalcs",!1),this.registerTableFunction("setGroupBy",this.setGroupBy.bind(this)),this.registerTableFunction("setGroupValues",this.setGroupValues.bind(this)),this.registerTableFunction("setGroupStartOpen",this.setGroupStartOpen.bind(this)),this.registerTableFunction("setGroupHeader",this.setGroupHeader.bind(this)),this.registerTableFunction("getGroups",this.userGetGroups.bind(this)),this.registerTableFunction("getGroupedData",this.userGetGroupedData.bind(this)),this.registerComponentFunction("row","getGroup",this.rowGetGroup.bind(this))}initialize(){this.subscribe("table-destroy",this._blockRedrawing.bind(this)),this.subscribe("rows-wipe",this._blockRedrawing.bind(this)),this.subscribe("rows-wiped",this._restore_redrawing.bind(this)),this.table.options.groupBy&&(this.table.options.groupUpdateOnCellEdit&&(this.subscribe("cell-value-updated",this.cellUpdated.bind(this)),this.subscribe("row-data-changed",this.reassignRowToGroup.bind(this),0)),this.subscribe("table-built",this.configureGroupSetup.bind(this)),this.subscribe("row-deleting",this.rowDeleting.bind(this)),this.subscribe("row-deleted",this.rowsUpdated.bind(this)),this.subscribe("scroll-horizontal",this.scrollHeaders.bind(this)),this.subscribe("rows-wipe",this.wipe.bind(this)),this.subscribe("rows-added",this.rowsUpdated.bind(this)),this.subscribe("row-moving",this.rowMoving.bind(this)),this.subscribe("row-adding-index",this.rowAddingIndex.bind(this)),this.subscribe("rows-sample",this.rowSample.bind(this)),this.subscribe("render-virtual-fill",this.virtualRenderFill.bind(this)),this.registerDisplayHandler(this.displayHandler,20),this.initialized=!0)}_blockRedrawing(){this.blockRedraw=!0}_restore_redrawing(){this.blockRedraw=!1}configureGroupSetup(){if(this.table.options.groupBy){var e=this.table.options.groupBy,t=this.table.options.groupStartOpen,r=this.table.options.groupHeader;if(this.allowedValues=this.table.options.groupValues,Array.isArray(e)&&Array.isArray(r)&&e.length>r.length&&console.warn("Error creating group headers, groupHeader array is shorter than groupBy array"),this.headerGenerator=[function(){return""}],this.startOpen=[function(){return!1}],this.langBind("groups|item",(s,o)=>{this.headerGenerator[0]=(u,h,d)=>(typeof u>"u"?"":u)+"<span>("+h+" "+(h===1?s:o.groups.items)+")</span>"}),this.groupIDLookups=[],e)this.table.modExists("columnCalcs")&&this.table.options.columnCalcs!="table"&&this.table.options.columnCalcs!="both"&&this.table.modules.columnCalcs.removeCalcs();else if(this.table.modExists("columnCalcs")&&this.table.options.columnCalcs!="group"){var a=this.table.columnManager.getRealColumns();a.forEach(s=>{s.definition.topCalc&&this.table.modules.columnCalcs.initializeTopRow(),s.definition.bottomCalc&&this.table.modules.columnCalcs.initializeBottomRow()})}Array.isArray(e)||(e=[e]),e.forEach((s,o)=>{var u,h;typeof s=="function"?u=s:(h=this.table.columnManager.getColumnByField(s),h?u=function(d){return h.getFieldValue(d)}:u=function(d){return d[s]}),this.groupIDLookups.push({field:typeof s=="function"?!1:s,func:u,values:this.allowedValues?this.allowedValues[o]:!1})}),t&&(Array.isArray(t)||(t=[t]),t.forEach(s=>{}),this.startOpen=t),r&&(this.headerGenerator=Array.isArray(r)?r:[r])}else this.groupList=[],this.groups={}}rowSample(e,t){if(this.table.options.groupBy){var r=this.getGroups(!1)[0];t.push(r.getRows(!1)[0])}return t}virtualRenderFill(){var e=this.table.rowManager.tableElement,t=this.table.rowManager.getVisibleRows();if(this.table.options.groupBy)t=t.filter(r=>r.type!=="group"),e.style.minWidth=t.length?"":this.table.columnManager.getWidth()+"px";else return t}rowAddingIndex(e,t,r){if(this.table.options.groupBy){this.assignRowToGroup(e);var a=e.modules.group.rows;return a.length>1&&(!t||t&&a.indexOf(t)==-1?r?a[0]!==e&&(t=a[0],this.table.rowManager.moveRowInArray(e.modules.group.rows,e,t,!r)):a[a.length-1]!==e&&(t=a[a.length-1],this.table.rowManager.moveRowInArray(e.modules.group.rows,e,t,!r)):this.table.rowManager.moveRowInArray(e.modules.group.rows,e,t,!r)),t}}trackChanges(){this.dispatch("group-changed")}setGroupBy(e){this.table.options.groupBy=e,this.initialized||this.initialize(),this.configureGroupSetup(),!e&&this.table.modExists("columnCalcs")&&this.table.options.columnCalcs===!0&&this.table.modules.columnCalcs.reinitializeCalcs(),this.refreshData(),this.trackChanges()}setGroupValues(e){this.table.options.groupValues=e,this.configureGroupSetup(),this.refreshData(),this.trackChanges()}setGroupStartOpen(e){this.table.options.groupStartOpen=e,this.configureGroupSetup(),this.table.options.groupBy?(this.refreshData(),this.trackChanges()):console.warn("Grouping Update - cant refresh view, no groups have been set")}setGroupHeader(e){this.table.options.groupHeader=e,this.configureGroupSetup(),this.table.options.groupBy?(this.refreshData(),this.trackChanges()):console.warn("Grouping Update - cant refresh view, no groups have been set")}userGetGroups(e){return this.getGroups(!0)}userGetGroupedData(){return this.table.options.groupBy?this.getGroupedData():this.getData()}rowGetGroup(e){return e.modules.group?e.modules.group.getComponent():!1}rowMoving(e,t,r){if(this.table.options.groupBy){!r&&t instanceof ll&&(t=this.table.rowManager.prevDisplayRow(e)||t);var a=t instanceof ll?t:t.modules.group,s=e instanceof ll?e:e.modules.group;a===s?this.table.rowManager.moveRowInArray(a.rows,e,t,r):(s&&s.removeRow(e),a.insertRow(e,t,r))}}rowDeleting(e){this.table.options.groupBy&&e.modules.group&&e.modules.group.removeRow(e)}rowsUpdated(e){this.table.options.groupBy&&this.updateGroupRows(!0)}cellUpdated(e){this.table.options.groupBy&&this.reassignRowToGroup(e.row)}getRows(e){return this.table.options.groupBy&&this.groupIDLookups.length?(this.dispatchExternal("dataGrouping"),this.generateGroups(e),this.subscribedExternal("dataGrouped")&&this.dispatchExternal("dataGrouped",this.getGroups(!0)),this.updateGroupRows()):e.slice(0)}getGroups(e){var t=[];return this.groupList.forEach(function(r){t.push(e?r.getComponent():r)}),t}getChildGroups(e){var t=[];return e||(e=this),e.groupList.forEach(r=>{r.groupList.length?t=t.concat(this.getChildGroups(r)):t.push(r)}),t}wipe(){this.table.options.groupBy&&(this.groupList.forEach(function(e){e.wipe()}),this.groupList=[],this.groups={})}pullGroupListData(e){var t=[];return e.forEach(r=>{var a={};a.level=0,a.rowCount=0,a.headerContent="";var s=[];r.hasSubGroups?(s=this.pullGroupListData(r.groupList),a.level=r.level,a.rowCount=s.length-r.groupList.length,a.headerContent=r.generator(r.key,a.rowCount,r.rows,r),t.push(a),t=t.concat(s)):(a.level=r.level,a.headerContent=r.generator(r.key,r.rows.length,r.rows,r),a.rowCount=r.getRows().length,t.push(a),r.getRows().forEach(o=>{t.push(o.getData("data"))}))}),t}getGroupedData(){return this.pullGroupListData(this.groupList)}getRowGroup(e){var t=!1;return this.options("dataTree")&&(e=this.table.modules.dataTree.getTreeParentRoot(e)),this.groupList.forEach(r=>{var a=r.getRowGroup(e);a&&(t=a)}),t}countGroups(){return this.groupList.length}generateGroups(e){var t=this.groups;this.groups={},this.groupList=[],this.allowedValues&&this.allowedValues[0]?(this.allowedValues[0].forEach(r=>{this.createGroup(r,0,t)}),e.forEach(r=>{this.assignRowToExistingGroup(r,t)})):e.forEach(r=>{this.assignRowToGroup(r,t)}),Object.values(t).forEach(r=>{r.wipe(!0)})}createGroup(e,t,r){var a=t+"_"+e,s;r=r||[],s=new ll(this,!1,t,e,this.groupIDLookups[0].field,this.headerGenerator[0],r[a]),this.groups[a]=s,this.groupList.push(s)}assignRowToExistingGroup(e,t){var r=this.groupIDLookups[0].func(e.getData()),a="0_"+r;this.groups[a]&&this.groups[a].addRow(e)}assignRowToGroup(e,t){var r=this.groupIDLookups[0].func(e.getData()),a=!this.groups["0_"+r];return a&&this.createGroup(r,0,t),this.groups["0_"+r].addRow(e),!a}reassignRowToGroup(e){if(e.type==="row"){var t=e.modules.group,r=t.getPath(),a=this.getExpectedPath(e),s;s=r.length==a.length&&r.every((o,u)=>o===a[u]),s||(t.removeRow(e),this.assignRowToGroup(e,this.groups),this.refreshData(!0))}}getExpectedPath(e){var t=[],r=e.getData();return this.groupIDLookups.forEach(a=>{t.push(a.func(r))}),t}updateGroupRows(e){var t=[];return this.blockRedraw||(this.groupList.forEach(r=>{t=t.concat(r.getHeadersAndRows())}),e&&this.refreshData(!0)),t}scrollHeaders(e){this.table.options.groupBy&&(this.table.options.renderHorizontal==="virtual"&&(e-=this.table.columnManager.renderer.vDomPadLeft),e=e+"px",this.groupList.forEach(t=>{t.scrollHeader(e)}))}removeGroup(e){var t=e.level+"_"+e.key,r;this.groups[t]&&(delete this.groups[t],r=this.groupList.indexOf(e),r>-1&&this.groupList.splice(r,1))}checkBasicModeGroupHeaderWidth(){var e=this.table.rowManager.tableElement,t=!0;this.table.rowManager.getDisplayRows().forEach((r,a)=>{this.table.rowManager.styleRow(r,a),e.appendChild(r.getElement()),r.initialize(!0),r.type!=="group"&&(t=!1)}),t?e.style.minWidth=this.table.columnManager.getWidth()+"px":e.style.minWidth=""}}Be(Oy,"moduleName","groupRows");var f6={cellEdit:function(i){i.component.setValueProcessData(i.data.oldValue),i.component.cellRendered()},rowAdd:function(i){i.component.deleteActual(),this.table.rowManager.checkPlaceholder()},rowDelete:function(i){var e=this.table.rowManager.addRowActual(i.data.data,i.data.pos,i.data.index);this.table.options.groupBy&&this.table.modExists("groupRows")&&this.table.modules.groupRows.updateGroupRows(!0),this._rebindRow(i.component,e),this.table.rowManager.checkPlaceholder()},rowMove:function(i){var e=i.data.posFrom-i.data.posTo>0;this.table.rowManager.moveRowActual(i.component,this.table.rowManager.getRowFromPosition(i.data.posFrom),e),this.table.rowManager.regenerateRowPositions(),this.table.rowManager.reRenderInPosition()}},d6={cellEdit:function(i){i.component.setValueProcessData(i.data.newValue),i.component.cellRendered()},rowAdd:function(i){var e=this.table.rowManager.addRowActual(i.data.data,i.data.pos,i.data.index);this.table.options.groupBy&&this.table.modExists("groupRows")&&this.table.modules.groupRows.updateGroupRows(!0),this._rebindRow(i.component,e),this.table.rowManager.checkPlaceholder()},rowDelete:function(i){i.component.deleteActual(),this.table.rowManager.checkPlaceholder()},rowMove:function(i){this.table.rowManager.moveRowActual(i.component,this.table.rowManager.getRowFromPosition(i.data.posTo),i.data.after),this.table.rowManager.regenerateRowPositions(),this.table.rowManager.reRenderInPosition()}},p6={undo:["ctrl + 90","meta + 90"],redo:["ctrl + 89","meta + 89"]},m6={undo:function(i){var e=!1;this.table.options.history&&this.table.modExists("history")&&this.table.modExists("edit")&&(e=this.table.modules.edit.currentCell,e||(i.preventDefault(),this.table.modules.history.undo()))},redo:function(i){var e=!1;this.table.options.history&&this.table.modExists("history")&&this.table.modExists("edit")&&(e=this.table.modules.edit.currentCell,e||(i.preventDefault(),this.table.modules.history.redo()))}},g6={keybindings:{bindings:p6,actions:m6}};const xn=class xn extends ct{constructor(e){super(e),this.history=[],this.index=-1,this.registerTableOption("history",!1)}initialize(){this.table.options.history&&(this.subscribe("cell-value-updated",this.cellUpdated.bind(this)),this.subscribe("cell-delete",this.clearComponentHistory.bind(this)),this.subscribe("row-delete",this.rowDeleted.bind(this)),this.subscribe("rows-wipe",this.clear.bind(this)),this.subscribe("row-added",this.rowAdded.bind(this)),this.subscribe("row-move",this.rowMoved.bind(this))),this.registerTableFunction("undo",this.undo.bind(this)),this.registerTableFunction("redo",this.redo.bind(this)),this.registerTableFunction("getHistoryUndoSize",this.getHistoryUndoSize.bind(this)),this.registerTableFunction("getHistoryRedoSize",this.getHistoryRedoSize.bind(this)),this.registerTableFunction("clearHistory",this.clear.bind(this))}rowMoved(e,t,r){this.action("rowMove",e,{posFrom:e.getPosition(),posTo:t.getPosition(),to:t,after:r})}rowAdded(e,t,r,a){this.action("rowAdd",e,{data:t,pos:r,index:a})}rowDeleted(e){var t,r;this.table.options.groupBy?(r=e.getComponent().getGroup()._getSelf().rows,t=r.indexOf(e),t&&(t=r[t-1])):(t=e.table.rowManager.getRowIndex(e),t&&(t=e.table.rowManager.rows[t-1])),this.action("rowDelete",e,{data:e.getData(),pos:!t,index:t})}cellUpdated(e){this.action("cellEdit",e,{oldValue:e.oldValue,newValue:e.value})}clear(){this.history=[],this.index=-1}action(e,t,r){this.history=this.history.slice(0,this.index+1),this.history.push({type:e,component:t,data:r}),this.index++}getHistoryUndoSize(){return this.index+1}getHistoryRedoSize(){return this.history.length-(this.index+1)}clearComponentHistory(e){var t=this.history.findIndex(function(r){return r.component===e});t>-1&&(this.history.splice(t,1),t<=this.index&&this.index--,this.clearComponentHistory(e))}undo(){if(this.index>-1){let e=this.history[this.index];return xn.undoers[e.type].call(this,e),this.index--,this.dispatchExternal("historyUndo",e.type,e.component.getComponent(),e.data),!0}else return console.warn(this.options("history")?"History Undo Error - No more history to undo":"History module not enabled"),!1}redo(){if(this.history.length-1>this.index){this.index++;let e=this.history[this.index];return xn.redoers[e.type].call(this,e),this.dispatchExternal("historyRedo",e.type,e.component.getComponent(),e.data),!0}else return console.warn(this.options("history")?"History Redo Error - No more history to redo":"History module not enabled"),!1}_rebindRow(e,t){this.history.forEach(function(r){if(r.component instanceof Gi)r.component===e&&(r.component=t);else if(r.component instanceof mu&&r.component.row===e){var a=r.component.column.getField();a&&(r.component=t.getCell(a))}})}};Be(xn,"moduleName","history"),Be(xn,"moduleExtensions",g6),Be(xn,"undoers",f6),Be(xn,"redoers",d6);let L0=xn;class Ly extends ct{constructor(e){super(e),this.fieldIndex=[],this.hasIndex=!1}initialize(){this.tableElementCheck()}tableElementCheck(){this.table.originalElement&&this.table.originalElement.tagName==="TABLE"&&(this.table.originalElement.childNodes.length?this.parseTable():console.warn("Unable to parse data from empty table tag, Tabulator should be initialized on a div tag unless importing data from a table element."))}parseTable(){var e=this.table.originalElement,t=this.table.options,r=e.getElementsByTagName("th"),a=e.getElementsByTagName("tbody")[0],s=[];this.hasIndex=!1,this.dispatchExternal("htmlImporting"),a=a?a.getElementsByTagName("tr"):[],this._extractOptions(e,t),r.length?this._extractHeaders(r,a):this._generateBlankHeaders(r,a);for(var o=0;o<a.length;o++){var u=a[o],h=u.getElementsByTagName("td"),d={};this.hasIndex||(d[t.index]=o);for(var p=0;p<h.length;p++){var b=h[p];typeof this.fieldIndex[p]<"u"&&(d[this.fieldIndex[p]]=b.innerHTML)}s.push(d)}t.data=s,this.dispatchExternal("htmlImported")}_extractOptions(e,t,r){var a=e.attributes,s=Object.keys(r||t),o={};s.forEach(p=>{o[p.toLowerCase()]=p});for(var u in a){var h=a[u],d;h&&typeof h=="object"&&h.name&&h.name.indexOf("tabulator-")===0&&(d=h.name.replace("tabulator-",""),typeof o[d]<"u"&&(t[o[d]]=this._attribValue(h.value)))}}_attribValue(e){return e==="true"?!0:e==="false"?!1:e}_findCol(e){var t=this.table.options.columns.find(r=>r.title===e);return t||!1}_extractHeaders(e,t){for(var r=0;r<e.length;r++){var a=e[r],s=!1,o=this._findCol(a.textContent),u;o?s=!0:o={title:a.textContent.trim()},o.field||(o.field=a.textContent.trim().toLowerCase().replaceAll(" ","_")),u=a.getAttribute("width"),u&&!o.width&&(o.width=u),this._extractOptions(a,o,this.table.columnManager.optionsList.registeredDefaults),this.fieldIndex[r]=o.field,o.field==this.table.options.index&&(this.hasIndex=!0),s||this.table.options.columns.push(o)}}_generateBlankHeaders(e,t){for(var r=0;r<e.length;r++){var a=e[r],s={title:"",field:"col"+r};this.fieldIndex[r]=s.field;var o=a.getAttribute("width");o&&(s.width=o),this.table.options.columns.push(s)}}}Be(Ly,"moduleName","htmlTableImport");function v6(i){var e=[],t=0,r=0,a=!1;for(let s=0;s<i.length;s++){let o=i[s],u=i[s+1];if(e[t]||(e[t]=[]),e[t][r]||(e[t][r]=""),o=='"'&&a&&u=='"'){e[t][r]+=o,s++;continue}if(o=='"'){a=!a;continue}if(o==","&&!a){r++;continue}if(o=="\r"&&u==`
`&&!a){r=0,t++,s++;continue}if((o=="\r"||o==`
`)&&!a){r=0,t++;continue}e[t][r]+=o}return e}function b6(i){try{return JSON.parse(i)}catch(e){return console.warn("JSON Import Error - File contents is invalid JSON",e),Promise.reject()}}function x6(i){return i}function w6(i){var e=this.dependencyRegistry.lookup("XLSX"),t=e.read(i),r=t.Sheets[t.SheetNames[0]];return e.utils.sheet_to_json(r,{header:1})}var y6={csv:v6,json:b6,array:x6,xlsx:w6};const Vo=class Vo extends ct{constructor(e){super(e),this.registerTableOption("importFormat"),this.registerTableOption("importReader","text"),this.registerTableOption("importHeaderTransform"),this.registerTableOption("importValueTransform"),this.registerTableOption("importDataValidator"),this.registerTableOption("importFileValidator")}initialize(){this.registerTableFunction("import",this.importFromFile.bind(this)),this.table.options.importFormat&&(this.subscribe("data-loading",this.loadDataCheck.bind(this),10),this.subscribe("data-load",this.loadData.bind(this),10))}loadDataCheck(e){return this.table.options.importFormat&&(typeof e=="string"||Array.isArray(e)&&e.length&&Array.isArray(e))}loadData(e,t,r,a,s){return this.importData(this.lookupImporter(),e).then(this.structureData.bind(this)).catch(o=>(console.error("Import Error:",o||"Unable to import data"),Promise.reject(o)))}lookupImporter(e){var t;return e||(e=this.table.options.importFormat),typeof e=="string"?t=Vo.importers[e]:t=e,t||console.error("Import Error - Importer not found:",e),t}importFromFile(e,t,r){var a=this.lookupImporter(e);if(a)return this.pickFile(t,r).then(this.importData.bind(this,a)).then(this.structureData.bind(this)).then(this.mutateData.bind(this)).then(this.validateData.bind(this)).then(this.setData.bind(this)).catch(s=>(this.dispatch("import-error",s),this.dispatchExternal("importError",s),console.error("Import Error:",s||"Unable to import file"),this.table.dataLoader.alertError(),setTimeout(()=>{this.table.dataLoader.clearAlert()},3e3),Promise.reject(s)))}pickFile(e,t){return new Promise((r,a)=>{var s=document.createElement("input");s.type="file",s.accept=e,s.addEventListener("change",o=>{var u=s.files[0],h=new FileReader,d=this.validateFile(u);if(d===!0){switch(this.dispatch("import-importing",s.files),this.dispatchExternal("importImporting",s.files),t||this.table.options.importReader){case"buffer":h.readAsArrayBuffer(u);break;case"binary":h.readAsBinaryString(u);break;case"url":h.readAsDataURL(u);break;case"text":default:h.readAsText(u)}h.onload=p=>{r(h.result)},h.onerror=p=>{console.warn("File Load Error - Unable to read file"),a(p)}}else a(d)}),this.dispatch("import-choose"),this.dispatchExternal("importChoose"),s.click()})}importData(e,t){var r;return this.table.dataLoader.alertLoader(),new Promise((a,s)=>{setTimeout(()=>{r=e.call(this.table,t),r instanceof Promise||r?a(r):s()},10)})}structureData(e){var t=[];return Array.isArray(e)&&e.length&&Array.isArray(e[0])?(this.table.options.autoColumns?t=this.structureArrayToObject(e):t=this.structureArrayToColumns(e),t):e}mutateData(e){var t=[];return Array.isArray(e)?e.forEach(r=>{t.push(this.table.modules.mutator.transformRow(r,"import"))}):t=e,t}transformHeader(e){var t=[];if(this.table.options.importHeaderTransform)e.forEach(r=>{t.push(this.table.options.importHeaderTransform.call(this.table,r,e))});else return e;return t}transformData(e){var t=[];if(this.table.options.importValueTransform)e.forEach(r=>{t.push(this.table.options.importValueTransform.call(this.table,r,e))});else return e;return t}structureArrayToObject(e){var t=this.transformHeader(e.shift()),r=e.map(a=>{var s={};return a=this.transformData(a),t.forEach((o,u)=>{s[o]=a[u]}),s});return r}structureArrayToColumns(e){var t=[],r=this.transformHeader(e[0]),a=this.table.getColumns();return a[0]&&r[0]&&a[0].getDefinition().title===r[0]&&e.shift(),e.forEach(s=>{var o={};s=this.transformData(s),s.forEach((u,h)=>{var d=a[h];d&&(o[d.getField()]=u)}),t.push(o)}),t}validateFile(e){return this.table.options.importFileValidator?this.table.options.importFileValidator.call(this.table,e):!0}validateData(e){var t;return this.table.options.importDataValidator?(t=this.table.options.importDataValidator.call(this.table,e),t===!0?e:Promise.reject(t)):e}setData(e){return this.dispatch("import-imported",e),this.dispatchExternal("importImported",e),this.table.dataLoader.clearAlert(),this.table.setData(e)}};Be(Vo,"moduleName","import"),Be(Vo,"importers",y6);let N0=Vo;class Ny extends ct{constructor(e){super(e),this.eventMap={rowClick:"row-click",rowDblClick:"row-dblclick",rowContext:"row-contextmenu",rowMouseEnter:"row-mouseenter",rowMouseLeave:"row-mouseleave",rowMouseOver:"row-mouseover",rowMouseOut:"row-mouseout",rowMouseMove:"row-mousemove",rowMouseDown:"row-mousedown",rowMouseUp:"row-mouseup",rowTap:"row",rowDblTap:"row",rowTapHold:"row",cellClick:"cell-click",cellDblClick:"cell-dblclick",cellContext:"cell-contextmenu",cellMouseEnter:"cell-mouseenter",cellMouseLeave:"cell-mouseleave",cellMouseOver:"cell-mouseover",cellMouseOut:"cell-mouseout",cellMouseMove:"cell-mousemove",cellMouseDown:"cell-mousedown",cellMouseUp:"cell-mouseup",cellTap:"cell",cellDblTap:"cell",cellTapHold:"cell",headerClick:"column-click",headerDblClick:"column-dblclick",headerContext:"column-contextmenu",headerMouseEnter:"column-mouseenter",headerMouseLeave:"column-mouseleave",headerMouseOver:"column-mouseover",headerMouseOut:"column-mouseout",headerMouseMove:"column-mousemove",headerMouseDown:"column-mousedown",headerMouseUp:"column-mouseup",headerTap:"column",headerDblTap:"column",headerTapHold:"column",groupClick:"group-click",groupDblClick:"group-dblclick",groupContext:"group-contextmenu",groupMouseEnter:"group-mouseenter",groupMouseLeave:"group-mouseleave",groupMouseOver:"group-mouseover",groupMouseOut:"group-mouseout",groupMouseMove:"group-mousemove",groupMouseDown:"group-mousedown",groupMouseUp:"group-mouseup",groupTap:"group",groupDblTap:"group",groupTapHold:"group"},this.subscribers={},this.touchSubscribers={},this.columnSubscribers={},this.touchWatchers={row:{tap:null,tapDbl:null,tapHold:null},cell:{tap:null,tapDbl:null,tapHold:null},column:{tap:null,tapDbl:null,tapHold:null},group:{tap:null,tapDbl:null,tapHold:null}},this.registerColumnOption("headerClick"),this.registerColumnOption("headerDblClick"),this.registerColumnOption("headerContext"),this.registerColumnOption("headerMouseEnter"),this.registerColumnOption("headerMouseLeave"),this.registerColumnOption("headerMouseOver"),this.registerColumnOption("headerMouseOut"),this.registerColumnOption("headerMouseMove"),this.registerColumnOption("headerMouseDown"),this.registerColumnOption("headerMouseUp"),this.registerColumnOption("headerTap"),this.registerColumnOption("headerDblTap"),this.registerColumnOption("headerTapHold"),this.registerColumnOption("cellClick"),this.registerColumnOption("cellDblClick"),this.registerColumnOption("cellContext"),this.registerColumnOption("cellMouseEnter"),this.registerColumnOption("cellMouseLeave"),this.registerColumnOption("cellMouseOver"),this.registerColumnOption("cellMouseOut"),this.registerColumnOption("cellMouseMove"),this.registerColumnOption("cellMouseDown"),this.registerColumnOption("cellMouseUp"),this.registerColumnOption("cellTap"),this.registerColumnOption("cellDblTap"),this.registerColumnOption("cellTapHold")}initialize(){this.initializeExternalEvents(),this.subscribe("column-init",this.initializeColumn.bind(this)),this.subscribe("cell-dblclick",this.cellContentsSelectionFixer.bind(this)),this.subscribe("scroll-horizontal",this.clearTouchWatchers.bind(this)),this.subscribe("scroll-vertical",this.clearTouchWatchers.bind(this))}clearTouchWatchers(){var e=Object.values(this.touchWatchers);e.forEach(t=>{for(let r in t)t[r]=null})}cellContentsSelectionFixer(e,t){var r;if(!(this.table.modExists("edit")&&this.table.modules.edit.currentCell===t)){e.preventDefault();try{document.selection?(r=document.body.createTextRange(),r.moveToElementText(t.getElement()),r.select()):window.getSelection&&(r=document.createRange(),r.selectNode(t.getElement()),window.getSelection().removeAllRanges(),window.getSelection().addRange(r))}catch{}}}initializeExternalEvents(){for(let e in this.eventMap)this.subscriptionChangeExternal(e,this.subscriptionChanged.bind(this,e))}subscriptionChanged(e,t){t?this.subscribers[e]||(this.eventMap[e].includes("-")?(this.subscribers[e]=this.handle.bind(this,e),this.subscribe(this.eventMap[e],this.subscribers[e])):this.subscribeTouchEvents(e)):this.eventMap[e].includes("-")?this.subscribers[e]&&!this.columnSubscribers[e]&&!this.subscribedExternal(e)&&(this.unsubscribe(this.eventMap[e],this.subscribers[e]),delete this.subscribers[e]):this.unsubscribeTouchEvents(e)}subscribeTouchEvents(e){var t=this.eventMap[e];this.touchSubscribers[t+"-touchstart"]||(this.touchSubscribers[t+"-touchstart"]=this.handleTouch.bind(this,t,"start"),this.touchSubscribers[t+"-touchend"]=this.handleTouch.bind(this,t,"end"),this.subscribe(t+"-touchstart",this.touchSubscribers[t+"-touchstart"]),this.subscribe(t+"-touchend",this.touchSubscribers[t+"-touchend"])),this.subscribers[e]=!0}unsubscribeTouchEvents(e){var t=!0,r=this.eventMap[e];if(this.subscribers[e]&&!this.subscribedExternal(e)){delete this.subscribers[e];for(let a in this.eventMap)this.eventMap[a]===r&&this.subscribers[a]&&(t=!1);t&&(this.unsubscribe(r+"-touchstart",this.touchSubscribers[r+"-touchstart"]),this.unsubscribe(r+"-touchend",this.touchSubscribers[r+"-touchend"]),delete this.touchSubscribers[r+"-touchstart"],delete this.touchSubscribers[r+"-touchend"])}}initializeColumn(e){var t=e.definition;for(let r in this.eventMap)t[r]&&(this.subscriptionChanged(r,!0),this.columnSubscribers[r]||(this.columnSubscribers[r]=[]),this.columnSubscribers[r].push(e))}handle(e,t,r){this.dispatchEvent(e,t,r)}handleTouch(e,t,r,a){var s=this.touchWatchers[e];switch(e==="column"&&(e="header"),t){case"start":s.tap=!0,clearTimeout(s.tapHold),s.tapHold=setTimeout(()=>{clearTimeout(s.tapHold),s.tapHold=null,s.tap=null,clearTimeout(s.tapDbl),s.tapDbl=null,this.dispatchEvent(e+"TapHold",r,a)},1e3);break;case"end":s.tap&&(s.tap=null,this.dispatchEvent(e+"Tap",r,a)),s.tapDbl?(clearTimeout(s.tapDbl),s.tapDbl=null,this.dispatchEvent(e+"DblTap",r,a)):s.tapDbl=setTimeout(()=>{clearTimeout(s.tapDbl),s.tapDbl=null},300),clearTimeout(s.tapHold),s.tapHold=null;break}}dispatchEvent(e,t,r){var a=r.getComponent(),s;this.columnSubscribers[e]&&(r instanceof mu?s=r.column.definition[e]:r instanceof fs&&(s=r.definition[e]),s&&s(t,a)),this.dispatchExternal(e,t,a)}}Be(Ny,"moduleName","interaction");var E6={navPrev:"shift + 9",navNext:9,navUp:38,navDown:40,navLeft:37,navRight:39,scrollPageUp:33,scrollPageDown:34,scrollToStart:36,scrollToEnd:35},C6={keyBlock:function(i){i.stopPropagation(),i.preventDefault()},scrollPageUp:function(i){var e=this.table.rowManager,t=e.scrollTop-e.element.clientHeight;i.preventDefault(),e.displayRowsCount&&(t>=0?e.element.scrollTop=t:e.scrollToRow(e.getDisplayRows()[0])),this.table.element.focus()},scrollPageDown:function(i){var e=this.table.rowManager,t=e.scrollTop+e.element.clientHeight,r=e.element.scrollHeight;i.preventDefault(),e.displayRowsCount&&(t<=r?e.element.scrollTop=t:e.scrollToRow(e.getDisplayRows()[e.displayRowsCount-1])),this.table.element.focus()},scrollToStart:function(i){var e=this.table.rowManager;i.preventDefault(),e.displayRowsCount&&e.scrollToRow(e.getDisplayRows()[0]),this.table.element.focus()},scrollToEnd:function(i){var e=this.table.rowManager;i.preventDefault(),e.displayRowsCount&&e.scrollToRow(e.getDisplayRows()[e.displayRowsCount-1]),this.table.element.focus()},navPrev:function(i){this.dispatch("keybinding-nav-prev",i)},navNext:function(i){this.dispatch("keybinding-nav-next",i)},navLeft:function(i){this.dispatch("keybinding-nav-left",i)},navRight:function(i){this.dispatch("keybinding-nav-right",i)},navUp:function(i){this.dispatch("keybinding-nav-up",i)},navDown:function(i){this.dispatch("keybinding-nav-down",i)}};const wn=class wn extends ct{constructor(e){super(e),this.watchKeys=null,this.pressedKeys=null,this.keyupBinding=!1,this.keydownBinding=!1,this.registerTableOption("keybindings",{}),this.registerTableOption("tabEndNewRow",!1)}initialize(){var e=this.table.options.keybindings,t={};this.watchKeys={},this.pressedKeys=[],e!==!1&&(Object.assign(t,wn.bindings),Object.assign(t,e),this.mapBindings(t),this.bindEvents()),this.subscribe("table-destroy",this.clearBindings.bind(this))}mapBindings(e){for(let t in e)wn.actions[t]?e[t]&&(typeof e[t]!="object"&&(e[t]=[e[t]]),e[t].forEach(r=>{var a=Array.isArray(r)?r:[r];a.forEach(s=>{this.mapBinding(t,s)})})):console.warn("Key Binding Error - no such action:",t)}mapBinding(e,t){var r={action:wn.actions[e],keys:[],ctrl:!1,shift:!1,meta:!1},a=t.toString().toLowerCase().split(" ").join("").split("+");a.forEach(s=>{switch(s){case"ctrl":r.ctrl=!0;break;case"shift":r.shift=!0;break;case"meta":r.meta=!0;break;default:s=isNaN(s)?s.toUpperCase().charCodeAt(0):parseInt(s),r.keys.push(s),this.watchKeys[s]||(this.watchKeys[s]=[]),this.watchKeys[s].push(r)}})}bindEvents(){var e=this;this.keyupBinding=function(t){var r=t.keyCode,a=e.watchKeys[r];a&&(e.pressedKeys.push(r),a.forEach(function(s){e.checkBinding(t,s)}))},this.keydownBinding=function(t){var r=t.keyCode,a=e.watchKeys[r];if(a){var s=e.pressedKeys.indexOf(r);s>-1&&e.pressedKeys.splice(s,1)}},this.table.element.addEventListener("keydown",this.keyupBinding),this.table.element.addEventListener("keyup",this.keydownBinding)}clearBindings(){this.keyupBinding&&this.table.element.removeEventListener("keydown",this.keyupBinding),this.keydownBinding&&this.table.element.removeEventListener("keyup",this.keydownBinding)}checkBinding(e,t){var r=!0;return e.ctrlKey==t.ctrl&&e.shiftKey==t.shift&&e.metaKey==t.meta?(t.keys.forEach(a=>{var s=this.pressedKeys.indexOf(a);s==-1&&(r=!1)}),r&&t.action.call(this,e),!0):!1}};Be(wn,"moduleName","keybindings"),Be(wn,"bindings",E6),Be(wn,"actions",C6);let B0=wn;class By extends ct{constructor(e){super(e),this.menuContainer=null,this.nestedMenuBlock=!1,this.currentComponent=null,this.rootPopup=null,this.columnSubscribers={},this.registerTableOption("rowContextMenu",!1),this.registerTableOption("rowClickMenu",!1),this.registerTableOption("rowDblClickMenu",!1),this.registerTableOption("groupContextMenu",!1),this.registerTableOption("groupClickMenu",!1),this.registerTableOption("groupDblClickMenu",!1),this.registerColumnOption("headerContextMenu"),this.registerColumnOption("headerClickMenu"),this.registerColumnOption("headerDblClickMenu"),this.registerColumnOption("headerMenu"),this.registerColumnOption("headerMenuIcon"),this.registerColumnOption("contextMenu"),this.registerColumnOption("clickMenu"),this.registerColumnOption("dblClickMenu")}initialize(){this.deprecatedOptionsCheck(),this.initializeRowWatchers(),this.initializeGroupWatchers(),this.subscribe("column-init",this.initializeColumn.bind(this))}deprecatedOptionsCheck(){}initializeRowWatchers(){this.table.options.rowContextMenu&&(this.subscribe("row-contextmenu",this.loadMenuEvent.bind(this,this.table.options.rowContextMenu)),this.table.on("rowTapHold",this.loadMenuEvent.bind(this,this.table.options.rowContextMenu))),this.table.options.rowClickMenu&&this.subscribe("row-click",this.loadMenuEvent.bind(this,this.table.options.rowClickMenu)),this.table.options.rowDblClickMenu&&this.subscribe("row-dblclick",this.loadMenuEvent.bind(this,this.table.options.rowDblClickMenu))}initializeGroupWatchers(){this.table.options.groupContextMenu&&(this.subscribe("group-contextmenu",this.loadMenuEvent.bind(this,this.table.options.groupContextMenu)),this.table.on("groupTapHold",this.loadMenuEvent.bind(this,this.table.options.groupContextMenu))),this.table.options.groupClickMenu&&this.subscribe("group-click",this.loadMenuEvent.bind(this,this.table.options.groupClickMenu)),this.table.options.groupDblClickMenu&&this.subscribe("group-dblclick",this.loadMenuEvent.bind(this,this.table.options.groupDblClickMenu))}initializeColumn(e){var t=e.definition;t.headerContextMenu&&!this.columnSubscribers.headerContextMenu&&(this.columnSubscribers.headerContextMenu=this.loadMenuTableColumnEvent.bind(this,"headerContextMenu"),this.subscribe("column-contextmenu",this.columnSubscribers.headerContextMenu),this.table.on("headerTapHold",this.loadMenuTableColumnEvent.bind(this,"headerContextMenu"))),t.headerClickMenu&&!this.columnSubscribers.headerClickMenu&&(this.columnSubscribers.headerClickMenu=this.loadMenuTableColumnEvent.bind(this,"headerClickMenu"),this.subscribe("column-click",this.columnSubscribers.headerClickMenu)),t.headerDblClickMenu&&!this.columnSubscribers.headerDblClickMenu&&(this.columnSubscribers.headerDblClickMenu=this.loadMenuTableColumnEvent.bind(this,"headerDblClickMenu"),this.subscribe("column-dblclick",this.columnSubscribers.headerDblClickMenu)),t.headerMenu&&this.initializeColumnHeaderMenu(e),t.contextMenu&&!this.columnSubscribers.contextMenu&&(this.columnSubscribers.contextMenu=this.loadMenuTableCellEvent.bind(this,"contextMenu"),this.subscribe("cell-contextmenu",this.columnSubscribers.contextMenu),this.table.on("cellTapHold",this.loadMenuTableCellEvent.bind(this,"contextMenu"))),t.clickMenu&&!this.columnSubscribers.clickMenu&&(this.columnSubscribers.clickMenu=this.loadMenuTableCellEvent.bind(this,"clickMenu"),this.subscribe("cell-click",this.columnSubscribers.clickMenu)),t.dblClickMenu&&!this.columnSubscribers.dblClickMenu&&(this.columnSubscribers.dblClickMenu=this.loadMenuTableCellEvent.bind(this,"dblClickMenu"),this.subscribe("cell-dblclick",this.columnSubscribers.dblClickMenu))}initializeColumnHeaderMenu(e){var t=e.definition.headerMenuIcon,r;r=document.createElement("span"),r.classList.add("tabulator-header-popup-button"),t?(typeof t=="function"&&(t=t(e.getComponent())),t instanceof HTMLElement?r.appendChild(t):r.innerHTML=t):r.innerHTML="&vellip;",r.addEventListener("click",a=>{a.stopPropagation(),a.preventDefault(),this.loadMenuEvent(e.definition.headerMenu,a,e)}),e.titleElement.insertBefore(r,e.titleElement.firstChild)}loadMenuTableCellEvent(e,t,r){r._cell&&(r=r._cell),r.column.definition[e]&&this.loadMenuEvent(r.column.definition[e],t,r)}loadMenuTableColumnEvent(e,t,r){r._column&&(r=r._column),r.definition[e]&&this.loadMenuEvent(r.definition[e],t,r)}loadMenuEvent(e,t,r){r._group?r=r._group:r._row&&(r=r._row),e=typeof e=="function"?e.call(this.table,t,r.getComponent()):e,this.loadMenu(t,r,e)}loadMenu(e,t,r,a,s){var o=!(e instanceof MouseEvent),u=document.createElement("div"),h;if(u.classList.add("tabulator-menu"),o||e.preventDefault(),!(!r||!r.length)){if(a)h=s.child(u);else{if(this.nestedMenuBlock){if(this.rootPopup)return}else this.nestedMenuBlock=setTimeout(()=>{this.nestedMenuBlock=!1},100);this.rootPopup&&this.rootPopup.hide(),this.rootPopup=h=this.popup(u)}r.forEach(d=>{var p=document.createElement("div"),b=d.label,g=d.disabled;d.separator?p.classList.add("tabulator-menu-separator"):(p.classList.add("tabulator-menu-item"),typeof b=="function"&&(b=b.call(this.table,t.getComponent())),b instanceof Node?p.appendChild(b):p.innerHTML=b,typeof g=="function"&&(g=g.call(this.table,t.getComponent())),g?(p.classList.add("tabulator-menu-item-disabled"),p.addEventListener("click",v=>{v.stopPropagation()})):d.menu&&d.menu.length?p.addEventListener("click",v=>{v.stopPropagation(),this.loadMenu(v,t,d.menu,p,h)}):d.action&&p.addEventListener("click",v=>{d.action(v,t.getComponent())}),d.menu&&d.menu.length&&p.classList.add("tabulator-menu-item-submenu")),u.appendChild(p)}),u.addEventListener("click",d=>{this.rootPopup&&this.rootPopup.hide()}),h.show(a||e),h===this.rootPopup&&(this.rootPopup.hideOnBlur(()=>{this.rootPopup=null,this.currentComponent&&(this.dispatch("menu-closed",r,h),this.dispatchExternal("menuClosed",this.currentComponent.getComponent()),this.currentComponent=null)}),this.currentComponent=t,this.dispatch("menu-opened",r,h),this.dispatchExternal("menuOpened",t.getComponent()))}}}Be(By,"moduleName","menu");class zy extends ct{constructor(e){super(e),this.placeholderElement=this.createPlaceholderElement(),this.hoverElement=!1,this.checkTimeout=!1,this.checkPeriod=250,this.moving=!1,this.toCol=!1,this.toColAfter=!1,this.startX=0,this.autoScrollMargin=40,this.autoScrollStep=5,this.autoScrollTimeout=!1,this.touchMove=!1,this.moveHover=this.moveHover.bind(this),this.endMove=this.endMove.bind(this),this.registerTableOption("movableColumns",!1)}createPlaceholderElement(){var e=document.createElement("div");return e.classList.add("tabulator-col"),e.classList.add("tabulator-col-placeholder"),e}initialize(){this.table.options.movableColumns&&(this.subscribe("column-init",this.initializeColumn.bind(this)),this.subscribe("alert-show",this.abortMove.bind(this)))}abortMove(){clearTimeout(this.checkTimeout)}initializeColumn(e){var t=this,r={},a;!e.modules.frozen&&!e.isGroup&&!e.isRowHeader&&(a=e.getElement(),r.mousemove=(function(s){e.parent===t.moving.parent&&((t.touchMove?s.touches[0].pageX:s.pageX)-Wt.elOffset(a).left+t.table.columnManager.contentsElement.scrollLeft>e.getWidth()/2?(t.toCol!==e||!t.toColAfter)&&(a.parentNode.insertBefore(t.placeholderElement,a.nextSibling),t.moveColumn(e,!0)):(t.toCol!==e||t.toColAfter)&&(a.parentNode.insertBefore(t.placeholderElement,a),t.moveColumn(e,!1)))}).bind(t),a.addEventListener("mousedown",function(s){t.touchMove=!1,s.which===1&&(t.checkTimeout=setTimeout(function(){t.startMove(s,e)},t.checkPeriod))}),a.addEventListener("mouseup",function(s){s.which===1&&t.checkTimeout&&clearTimeout(t.checkTimeout)}),t.bindTouchEvents(e)),e.modules.moveColumn=r}bindTouchEvents(e){var t=e.getElement(),r=!1,a,s,o,u,h,d;t.addEventListener("touchstart",p=>{this.checkTimeout=setTimeout(()=>{this.touchMove=!0,a=e.nextColumn(),o=a?a.getWidth()/2:0,s=e.prevColumn(),u=s?s.getWidth()/2:0,h=0,d=0,r=!1,this.startMove(p,e)},this.checkPeriod)},{passive:!0}),t.addEventListener("touchmove",p=>{var b,g;this.moving&&(this.moveHover(p),r||(r=p.touches[0].pageX),b=p.touches[0].pageX-r,b>0?a&&b-h>o&&(g=a,g!==e&&(r=p.touches[0].pageX,g.getElement().parentNode.insertBefore(this.placeholderElement,g.getElement().nextSibling),this.moveColumn(g,!0))):s&&-b-d>u&&(g=s,g!==e&&(r=p.touches[0].pageX,g.getElement().parentNode.insertBefore(this.placeholderElement,g.getElement()),this.moveColumn(g,!1))),g&&(a=g.nextColumn(),h=o,o=a?a.getWidth()/2:0,s=g.prevColumn(),d=u,u=s?s.getWidth()/2:0))},{passive:!0}),t.addEventListener("touchend",p=>{this.checkTimeout&&clearTimeout(this.checkTimeout),this.moving&&this.endMove(p)})}startMove(e,t){var r=t.getElement(),a=this.table.columnManager.getContentsElement(),s=this.table.columnManager.getHeadersElement();this.table.modules.selectRange&&this.table.modules.selectRange.columnSelection&&this.table.modules.selectRange.mousedown&&this.table.modules.selectRange.selecting==="column"||(this.moving=t,this.startX=(this.touchMove?e.touches[0].pageX:e.pageX)-Wt.elOffset(r).left,this.table.element.classList.add("tabulator-block-select"),this.placeholderElement.style.width=t.getWidth()+"px",this.placeholderElement.style.height=t.getHeight()+"px",r.parentNode.insertBefore(this.placeholderElement,r),r.parentNode.removeChild(r),this.hoverElement=r.cloneNode(!0),this.hoverElement.classList.add("tabulator-moving"),a.appendChild(this.hoverElement),this.hoverElement.style.left="0",this.hoverElement.style.bottom=a.clientHeight-s.offsetHeight+"px",this.touchMove||(this._bindMouseMove(),document.body.addEventListener("mousemove",this.moveHover),document.body.addEventListener("mouseup",this.endMove)),this.moveHover(e),this.dispatch("column-moving",e,this.moving))}_bindMouseMove(){this.table.columnManager.columnsByIndex.forEach(function(e){e.modules.moveColumn.mousemove&&e.getElement().addEventListener("mousemove",e.modules.moveColumn.mousemove)})}_unbindMouseMove(){this.table.columnManager.columnsByIndex.forEach(function(e){e.modules.moveColumn.mousemove&&e.getElement().removeEventListener("mousemove",e.modules.moveColumn.mousemove)})}moveColumn(e,t){var r=this.moving.getCells();this.toCol=e,this.toColAfter=t,t?e.getCells().forEach(function(a,s){var o=a.getElement(!0);o.parentNode&&r[s]&&o.parentNode.insertBefore(r[s].getElement(),o.nextSibling)}):e.getCells().forEach(function(a,s){var o=a.getElement(!0);o.parentNode&&r[s]&&o.parentNode.insertBefore(r[s].getElement(),o)})}endMove(e){(e.which===1||this.touchMove)&&(this._unbindMouseMove(),this.placeholderElement.parentNode.insertBefore(this.moving.getElement(),this.placeholderElement.nextSibling),this.placeholderElement.parentNode.removeChild(this.placeholderElement),this.hoverElement.parentNode.removeChild(this.hoverElement),this.table.element.classList.remove("tabulator-block-select"),this.toCol&&this.table.columnManager.moveColumnActual(this.moving,this.toCol,this.toColAfter),this.moving=!1,this.toCol=!1,this.toColAfter=!1,this.touchMove||(document.body.removeEventListener("mousemove",this.moveHover),document.body.removeEventListener("mouseup",this.endMove)))}moveHover(e){var t=this.table.columnManager.getContentsElement(),r=t.scrollLeft,a=(this.touchMove?e.touches[0].pageX:e.pageX)-Wt.elOffset(t).left+r,s;this.hoverElement.style.left=a-this.startX+"px",a-r<this.autoScrollMargin&&(this.autoScrollTimeout||(this.autoScrollTimeout=setTimeout(()=>{s=Math.max(0,r-5),this.table.rowManager.getElement().scrollLeft=s,this.autoScrollTimeout=!1},1))),r+t.clientWidth-a<this.autoScrollMargin&&(this.autoScrollTimeout||(this.autoScrollTimeout=setTimeout(()=>{s=Math.min(t.clientWidth,r+5),this.table.rowManager.getElement().scrollLeft=s,this.autoScrollTimeout=!1},1)))}}Be(zy,"moduleName","moveColumn");var T6={delete:function(i,e,t){i.delete()}},_6={insert:function(i,e,t){return this.table.addRow(i.getData(),void 0,e),!0},add:function(i,e,t){return this.table.addRow(i.getData()),!0},update:function(i,e,t){return e?(e.update(i.getData()),!0):!1},replace:function(i,e,t){return e?(this.table.addRow(i.getData(),void 0,e),e.delete(),!0):!1}};const ns=class ns extends ct{constructor(e){super(e),this.placeholderElement=this.createPlaceholderElement(),this.hoverElement=!1,this.checkTimeout=!1,this.checkPeriod=150,this.moving=!1,this.toRow=!1,this.toRowAfter=!1,this.hasHandle=!1,this.startY=0,this.startX=0,this.moveHover=this.moveHover.bind(this),this.endMove=this.endMove.bind(this),this.tableRowDropEvent=!1,this.touchMove=!1,this.connection=!1,this.connectionSelectorsTables=!1,this.connectionSelectorsElements=!1,this.connectionElements=[],this.connections=[],this.connectedTable=!1,this.connectedRow=!1,this.registerTableOption("movableRows",!1),this.registerTableOption("movableRowsConnectedTables",!1),this.registerTableOption("movableRowsConnectedElements",!1),this.registerTableOption("movableRowsSender",!1),this.registerTableOption("movableRowsReceiver","insert"),this.registerColumnOption("rowHandle")}createPlaceholderElement(){var e=document.createElement("div");return e.classList.add("tabulator-row"),e.classList.add("tabulator-row-placeholder"),e}initialize(){this.table.options.movableRows&&(this.connectionSelectorsTables=this.table.options.movableRowsConnectedTables,this.connectionSelectorsElements=this.table.options.movableRowsConnectedElements,this.connection=this.connectionSelectorsTables||this.connectionSelectorsElements,this.subscribe("cell-init",this.initializeCell.bind(this)),this.subscribe("column-init",this.initializeColumn.bind(this)),this.subscribe("row-init",this.initializeRow.bind(this)))}initializeGroupHeader(e){var t=this,r={};r.mouseup=(function(a){t.tableRowDrop(a,e)}).bind(t),r.mousemove=(function(a){var s;a.pageY-Wt.elOffset(e.element).top+t.table.rowManager.element.scrollTop>e.getHeight()/2?(t.toRow!==e||!t.toRowAfter)&&(s=e.getElement(),s.parentNode.insertBefore(t.placeholderElement,s.nextSibling),t.moveRow(e,!0)):(t.toRow!==e||t.toRowAfter)&&(s=e.getElement(),s.previousSibling&&(s.parentNode.insertBefore(t.placeholderElement,s),t.moveRow(e,!1)))}).bind(t),e.modules.moveRow=r}initializeRow(e){var t=this,r={},a;r.mouseup=(function(s){t.tableRowDrop(s,e)}).bind(t),r.mousemove=(function(s){var o=e.getElement();s.pageY-Wt.elOffset(o).top+t.table.rowManager.element.scrollTop>e.getHeight()/2?(t.toRow!==e||!t.toRowAfter)&&(o.parentNode.insertBefore(t.placeholderElement,o.nextSibling),t.moveRow(e,!0)):(t.toRow!==e||t.toRowAfter)&&(o.parentNode.insertBefore(t.placeholderElement,o),t.moveRow(e,!1))}).bind(t),this.hasHandle||(a=e.getElement(),a.addEventListener("mousedown",function(s){s.which===1&&(t.checkTimeout=setTimeout(function(){t.startMove(s,e)},t.checkPeriod))}),a.addEventListener("mouseup",function(s){s.which===1&&t.checkTimeout&&clearTimeout(t.checkTimeout)}),this.bindTouchEvents(e,e.getElement())),e.modules.moveRow=r}initializeColumn(e){e.definition.rowHandle&&this.table.options.movableRows!==!1&&(this.hasHandle=!0)}initializeCell(e){if(e.column.definition.rowHandle&&this.table.options.movableRows!==!1){var t=this,r=e.getElement(!0);r.addEventListener("mousedown",function(a){a.which===1&&(t.checkTimeout=setTimeout(function(){t.startMove(a,e.row)},t.checkPeriod))}),r.addEventListener("mouseup",function(a){a.which===1&&t.checkTimeout&&clearTimeout(t.checkTimeout)}),this.bindTouchEvents(e.row,r)}}bindTouchEvents(e,t){var r=!1,a,s,o,u,h,d;t.addEventListener("touchstart",p=>{this.checkTimeout=setTimeout(()=>{this.touchMove=!0,a=e.nextRow(),o=a?a.getHeight()/2:0,s=e.prevRow(),u=s?s.getHeight()/2:0,h=0,d=0,r=!1,this.startMove(p,e)},this.checkPeriod)},{passive:!0}),this.moving,this.toRow,this.toRowAfter,t.addEventListener("touchmove",p=>{var b,g;this.moving&&(p.preventDefault(),this.moveHover(p),r||(r=p.touches[0].pageY),b=p.touches[0].pageY-r,b>0?a&&b-h>o&&(g=a,g!==e&&(r=p.touches[0].pageY,g.getElement().parentNode.insertBefore(this.placeholderElement,g.getElement().nextSibling),this.moveRow(g,!0))):s&&-b-d>u&&(g=s,g!==e&&(r=p.touches[0].pageY,g.getElement().parentNode.insertBefore(this.placeholderElement,g.getElement()),this.moveRow(g,!1))),g&&(a=g.nextRow(),h=o,o=a?a.getHeight()/2:0,s=g.prevRow(),d=u,u=s?s.getHeight()/2:0))}),t.addEventListener("touchend",p=>{this.checkTimeout&&clearTimeout(this.checkTimeout),this.moving&&(this.endMove(p),this.touchMove=!1)})}_bindMouseMove(){this.table.rowManager.getDisplayRows().forEach(e=>{(e.type==="row"||e.type==="group")&&e.modules.moveRow&&e.modules.moveRow.mousemove&&e.getElement().addEventListener("mousemove",e.modules.moveRow.mousemove)})}_unbindMouseMove(){this.table.rowManager.getDisplayRows().forEach(e=>{(e.type==="row"||e.type==="group")&&e.modules.moveRow&&e.modules.moveRow.mousemove&&e.getElement().removeEventListener("mousemove",e.modules.moveRow.mousemove)})}startMove(e,t){var r=t.getElement();this.setStartPosition(e,t),this.moving=t,this.table.element.classList.add("tabulator-block-select"),this.placeholderElement.style.width=t.getWidth()+"px",this.placeholderElement.style.height=t.getHeight()+"px",this.connection?(this.table.element.classList.add("tabulator-movingrow-sending"),this.connectToTables(t)):(r.parentNode.insertBefore(this.placeholderElement,r),r.parentNode.removeChild(r)),this.hoverElement=r.cloneNode(!0),this.hoverElement.classList.add("tabulator-moving"),this.connection?(document.body.appendChild(this.hoverElement),this.hoverElement.style.left="0",this.hoverElement.style.top="0",this.hoverElement.style.width=this.table.element.clientWidth+"px",this.hoverElement.style.whiteSpace="nowrap",this.hoverElement.style.overflow="hidden",this.hoverElement.style.pointerEvents="none"):(this.table.rowManager.getTableElement().appendChild(this.hoverElement),this.hoverElement.style.left="0",this.hoverElement.style.top="0",this._bindMouseMove()),document.body.addEventListener("mousemove",this.moveHover),document.body.addEventListener("mouseup",this.endMove),this.dispatchExternal("rowMoving",t.getComponent()),this.moveHover(e)}setStartPosition(e,t){var r=this.touchMove?e.touches[0].pageX:e.pageX,a=this.touchMove?e.touches[0].pageY:e.pageY,s,o;s=t.getElement(),this.connection?(o=s.getBoundingClientRect(),this.startX=o.left-r+window.pageXOffset,this.startY=o.top-a+window.pageYOffset):this.startY=a-s.getBoundingClientRect().top}endMove(e){(!e||e.which===1||this.touchMove)&&(this._unbindMouseMove(),this.connection||(this.placeholderElement.parentNode.insertBefore(this.moving.getElement(),this.placeholderElement.nextSibling),this.placeholderElement.parentNode.removeChild(this.placeholderElement)),this.hoverElement.parentNode.removeChild(this.hoverElement),this.table.element.classList.remove("tabulator-block-select"),this.toRow?this.table.rowManager.moveRow(this.moving,this.toRow,this.toRowAfter):this.dispatchExternal("rowMoveCancelled",this.moving.getComponent()),this.moving=!1,this.toRow=!1,this.toRowAfter=!1,document.body.removeEventListener("mousemove",this.moveHover),document.body.removeEventListener("mouseup",this.endMove),this.connection&&(this.table.element.classList.remove("tabulator-movingrow-sending"),this.disconnectFromTables()))}moveRow(e,t){this.toRow=e,this.toRowAfter=t}moveHover(e){this.connection?this.moveHoverConnections.call(this,e):this.moveHoverTable.call(this,e)}moveHoverTable(e){var t=this.table.rowManager.getElement(),r=t.scrollTop,a=(this.touchMove?e.touches[0].pageY:e.pageY)-t.getBoundingClientRect().top+r;this.hoverElement.style.top=Math.min(a-this.startY,this.table.rowManager.element.scrollHeight-this.hoverElement.offsetHeight)+"px"}moveHoverConnections(e){this.hoverElement.style.left=this.startX+(this.touchMove?e.touches[0].pageX:e.pageX)+"px",this.hoverElement.style.top=this.startY+(this.touchMove?e.touches[0].pageY:e.pageY)+"px"}elementRowDrop(e,t,r){this.dispatchExternal("movableRowsElementDrop",e,t,r?r.getComponent():!1)}connectToTables(e){var t;this.connectionSelectorsTables&&(t=this.commsConnections(this.connectionSelectorsTables),this.dispatchExternal("movableRowsSendingStart",t),this.commsSend(this.connectionSelectorsTables,"moveRow","connect",{row:e})),this.connectionSelectorsElements&&(this.connectionElements=[],Array.isArray(this.connectionSelectorsElements)||(this.connectionSelectorsElements=[this.connectionSelectorsElements]),this.connectionSelectorsElements.forEach(r=>{typeof r=="string"?this.connectionElements=this.connectionElements.concat(Array.prototype.slice.call(document.querySelectorAll(r))):this.connectionElements.push(r)}),this.connectionElements.forEach(r=>{var a=s=>{this.elementRowDrop(s,r,this.moving)};r.addEventListener("mouseup",a),r.tabulatorElementDropEvent=a,r.classList.add("tabulator-movingrow-receiving")}))}disconnectFromTables(){var e;this.connectionSelectorsTables&&(e=this.commsConnections(this.connectionSelectorsTables),this.dispatchExternal("movableRowsSendingStop",e),this.commsSend(this.connectionSelectorsTables,"moveRow","disconnect")),this.connectionElements.forEach(t=>{t.classList.remove("tabulator-movingrow-receiving"),t.removeEventListener("mouseup",t.tabulatorElementDropEvent),delete t.tabulatorElementDropEvent})}connect(e,t){return this.connectedTable?(console.warn("Move Row Error - Table cannot accept connection, already connected to table:",this.connectedTable),!1):(this.connectedTable=e,this.connectedRow=t,this.table.element.classList.add("tabulator-movingrow-receiving"),this.table.rowManager.getDisplayRows().forEach(r=>{r.type==="row"&&r.modules.moveRow&&r.modules.moveRow.mouseup&&r.getElement().addEventListener("mouseup",r.modules.moveRow.mouseup)}),this.tableRowDropEvent=this.tableRowDrop.bind(this),this.table.element.addEventListener("mouseup",this.tableRowDropEvent),this.dispatchExternal("movableRowsReceivingStart",t,e),!0)}disconnect(e){e===this.connectedTable?(this.connectedTable=!1,this.connectedRow=!1,this.table.element.classList.remove("tabulator-movingrow-receiving"),this.table.rowManager.getDisplayRows().forEach(t=>{t.type==="row"&&t.modules.moveRow&&t.modules.moveRow.mouseup&&t.getElement().removeEventListener("mouseup",t.modules.moveRow.mouseup)}),this.table.element.removeEventListener("mouseup",this.tableRowDropEvent),this.dispatchExternal("movableRowsReceivingStop",e)):console.warn("Move Row Error - trying to disconnect from non connected table")}dropComplete(e,t,r){var a=!1;if(r){switch(typeof this.table.options.movableRowsSender){case"string":a=ns.senders[this.table.options.movableRowsSender];break;case"function":a=this.table.options.movableRowsSender;break}a?a.call(this,this.moving?this.moving.getComponent():void 0,t?t.getComponent():void 0,e):this.table.options.movableRowsSender&&console.warn("Mover Row Error - no matching sender found:",this.table.options.movableRowsSender),this.dispatchExternal("movableRowsSent",this.moving.getComponent(),t?t.getComponent():void 0,e)}else this.dispatchExternal("movableRowsSentFailed",this.moving.getComponent(),t?t.getComponent():void 0,e);this.endMove()}tableRowDrop(e,t){var r=!1,a=!1;switch(e.stopImmediatePropagation(),typeof this.table.options.movableRowsReceiver){case"string":r=ns.receivers[this.table.options.movableRowsReceiver];break;case"function":r=this.table.options.movableRowsReceiver;break}r?a=r.call(this,this.connectedRow.getComponent(),t?t.getComponent():void 0,this.connectedTable):console.warn("Mover Row Error - no matching receiver found:",this.table.options.movableRowsReceiver),a?this.dispatchExternal("movableRowsReceived",this.connectedRow.getComponent(),t?t.getComponent():void 0,this.connectedTable):this.dispatchExternal("movableRowsReceivedFailed",this.connectedRow.getComponent(),t?t.getComponent():void 0,this.connectedTable),this.commsSend(this.connectedTable,"moveRow","dropcomplete",{row:t,success:a})}commsReceived(e,t,r){switch(t){case"connect":return this.connect(e,r.row);case"disconnect":return this.disconnect(e);case"dropcomplete":return this.dropComplete(e,r.row,r.success)}}};Be(ns,"moduleName","moveRow"),Be(ns,"senders",T6),Be(ns,"receivers",_6);let z0=ns;var S6={};const cl=class cl extends ct{constructor(e){super(e),this.allowedTypes=["","data","edit","clipboard","import"],this.enabled=!0,this.registerColumnOption("mutator"),this.registerColumnOption("mutatorParams"),this.registerColumnOption("mutatorData"),this.registerColumnOption("mutatorDataParams"),this.registerColumnOption("mutatorEdit"),this.registerColumnOption("mutatorEditParams"),this.registerColumnOption("mutatorClipboard"),this.registerColumnOption("mutatorClipboardParams"),this.registerColumnOption("mutatorImport"),this.registerColumnOption("mutatorImportParams"),this.registerColumnOption("mutateLink")}initialize(){this.subscribe("cell-value-changing",this.transformCell.bind(this)),this.subscribe("cell-value-changed",this.mutateLink.bind(this)),this.subscribe("column-layout",this.initializeColumn.bind(this)),this.subscribe("row-data-init-before",this.rowDataChanged.bind(this)),this.subscribe("row-data-changing",this.rowDataChanged.bind(this))}rowDataChanged(e,t,r){return this.transformRow(t,"data",r)}initializeColumn(e){var t=!1,r={};this.allowedTypes.forEach(a=>{var s="mutator"+(a.charAt(0).toUpperCase()+a.slice(1)),o;e.definition[s]&&(o=this.lookupMutator(e.definition[s]),o&&(t=!0,r[s]={mutator:o,params:e.definition[s+"Params"]||{}}))}),t&&(e.modules.mutate=r)}lookupMutator(e){var t=!1;switch(typeof e){case"string":cl.mutators[e]?t=cl.mutators[e]:console.warn("Mutator Error - No such mutator found, ignoring: ",e);break;case"function":t=e;break}return t}transformRow(e,t,r){var a="mutator"+(t.charAt(0).toUpperCase()+t.slice(1)),s;return this.enabled&&this.table.columnManager.traverse(o=>{var u,h,d;o.modules.mutate&&(u=o.modules.mutate[a]||o.modules.mutate.mutator||!1,u&&(s=o.getFieldValue(typeof r<"u"?r:e),(t=="data"&&!r||typeof s<"u")&&(d=o.getComponent(),h=typeof u.params=="function"?u.params(s,e,t,d):u.params,o.setFieldValue(e,u.mutator(s,e,t,h,d)))))}),e}transformCell(e,t){if(e.column.modules.mutate){var r=e.column.modules.mutate.mutatorEdit||e.column.modules.mutate.mutator||!1,a={};if(r)return a=Object.assign(a,e.row.getData()),e.column.setFieldValue(a,t),r.mutator(t,a,"edit",r.params,e.getComponent())}return t}mutateLink(e){var t=e.column.definition.mutateLink;t&&(Array.isArray(t)||(t=[t]),t.forEach(r=>{var a=e.row.getCell(r);a&&a.setValue(a.getValue(),!0,!0)}))}enable(){this.enabled=!0}disable(){this.enabled=!1}};Be(cl,"moduleName","mutator"),Be(cl,"mutators",S6);let H0=cl;function R6(i,e,t,r,a){var s=document.createElement("span"),o=document.createElement("span"),u=document.createElement("span"),h=document.createElement("span"),d=document.createElement("span"),p=document.createElement("span");return this.table.modules.localize.langBind("pagination|counter|showing",b=>{o.innerHTML=b}),this.table.modules.localize.langBind("pagination|counter|of",b=>{h.innerHTML=b}),this.table.modules.localize.langBind("pagination|counter|rows",b=>{p.innerHTML=b}),r?(u.innerHTML=" "+e+"-"+Math.min(e+i-1,r)+" ",d.innerHTML=" "+r+" ",s.appendChild(o),s.appendChild(u),s.appendChild(h),s.appendChild(d),s.appendChild(p)):(u.innerHTML=" 0 ",s.appendChild(o),s.appendChild(u),s.appendChild(p)),s}function k6(i,e,t,r,a){var s=document.createElement("span"),o=document.createElement("span"),u=document.createElement("span"),h=document.createElement("span"),d=document.createElement("span"),p=document.createElement("span");return this.table.modules.localize.langBind("pagination|counter|showing",b=>{o.innerHTML=b}),u.innerHTML=" "+t+" ",this.table.modules.localize.langBind("pagination|counter|of",b=>{h.innerHTML=b}),d.innerHTML=" "+a+" ",this.table.modules.localize.langBind("pagination|counter|pages",b=>{p.innerHTML=b}),s.appendChild(o),s.appendChild(u),s.appendChild(h),s.appendChild(d),s.appendChild(p),s}var A6={rows:R6,pages:k6};const Go=class Go extends ct{constructor(e){super(e),this.mode="local",this.progressiveLoad=!1,this.element=null,this.pageCounterElement=null,this.pageCounter=null,this.size=0,this.page=1,this.count=5,this.max=1,this.remoteRowCountEstimate=null,this.initialLoad=!0,this.dataChanging=!1,this.pageSizes=[],this.registerTableOption("pagination",!1),this.registerTableOption("paginationMode","local"),this.registerTableOption("paginationSize",!1),this.registerTableOption("paginationInitialPage",1),this.registerTableOption("paginationCounter",!1),this.registerTableOption("paginationCounterElement",!1),this.registerTableOption("paginationButtonCount",5),this.registerTableOption("paginationSizeSelector",!1),this.registerTableOption("paginationElement",!1),this.registerTableOption("paginationAddRow","page"),this.registerTableOption("paginationOutOfRange",!1),this.registerTableOption("progressiveLoad",!1),this.registerTableOption("progressiveLoadDelay",0),this.registerTableOption("progressiveLoadScrollMargin",0),this.registerTableFunction("setMaxPage",this.setMaxPage.bind(this)),this.registerTableFunction("setPage",this.setPage.bind(this)),this.registerTableFunction("setPageToRow",this.userSetPageToRow.bind(this)),this.registerTableFunction("setPageSize",this.userSetPageSize.bind(this)),this.registerTableFunction("getPageSize",this.getPageSize.bind(this)),this.registerTableFunction("previousPage",this.previousPage.bind(this)),this.registerTableFunction("nextPage",this.nextPage.bind(this)),this.registerTableFunction("getPage",this.getPage.bind(this)),this.registerTableFunction("getPageMax",this.getPageMax.bind(this)),this.registerComponentFunction("row","pageTo",this.setPageToRow.bind(this))}initialize(){this.table.options.pagination?(this.subscribe("row-deleted",this.rowsUpdated.bind(this)),this.subscribe("row-added",this.rowsUpdated.bind(this)),this.subscribe("data-processed",this.initialLoadComplete.bind(this)),this.subscribe("table-built",this.calculatePageSizes.bind(this)),this.subscribe("footer-redraw",this.footerRedraw.bind(this)),this.table.options.paginationAddRow=="page"&&this.subscribe("row-adding-position",this.rowAddingPosition.bind(this)),this.table.options.paginationMode==="remote"&&(this.subscribe("data-params",this.remotePageParams.bind(this)),this.subscribe("data-loaded",this._parseRemoteData.bind(this))),this.table.options.progressiveLoad&&console.error("Progressive Load Error - Pagination and progressive load cannot be used at the same time"),this.registerDisplayHandler(this.restOnRenderBefore.bind(this),40),this.registerDisplayHandler(this.getRows.bind(this),50),this.createElements(),this.initializePageCounter(),this.initializePaginator()):this.table.options.progressiveLoad&&(this.subscribe("data-params",this.remotePageParams.bind(this)),this.subscribe("data-loaded",this._parseRemoteData.bind(this)),this.subscribe("table-built",this.calculatePageSizes.bind(this)),this.subscribe("data-processed",this.initialLoadComplete.bind(this)),this.initializeProgressive(this.table.options.progressiveLoad),this.table.options.progressiveLoad==="scroll"&&this.subscribe("scroll-vertical",this.scrollVertical.bind(this)))}rowAddingPosition(e,t){var r=this.table.rowManager,a=r.getDisplayRows(),s;return t?a.length?s=a[0]:r.activeRows.length&&(s=r.activeRows[r.activeRows.length-1],t=!1):a.length&&(s=a[a.length-1],t=!(a.length<this.size)),{index:s,top:t}}calculatePageSizes(){var e,t;this.table.options.paginationSize?this.size=this.table.options.paginationSize:(e=document.createElement("div"),e.classList.add("tabulator-row"),e.style.visibility="hidden",t=document.createElement("div"),t.classList.add("tabulator-cell"),t.innerHTML="Page Row Test",e.appendChild(t),this.table.rowManager.getTableElement().appendChild(e),this.size=Math.floor(this.table.rowManager.getElement().clientHeight/e.offsetHeight),this.table.rowManager.getTableElement().removeChild(e)),this.dispatchExternal("pageSizeChanged",this.size),this.generatePageSizeSelectList()}initialLoadComplete(){this.initialLoad=!1}remotePageParams(e,t,r,a){return this.initialLoad||(this.progressiveLoad&&!r||!this.progressiveLoad&&!this.dataChanging)&&this.reset(!0),a.page=this.page,this.size&&(a.size=this.size),a}userSetPageToRow(e){return this.table.options.pagination&&(e=this.table.rowManager.findRow(e),e)?this.setPageToRow(e):Promise.reject()}userSetPageSize(e){return this.table.options.pagination?(this.setPageSize(e),this.setPage(1)):!1}scrollVertical(e,t){var r,a,s;!t&&!this.table.dataLoader.loading&&(r=this.table.rowManager.getElement(),a=r.scrollHeight-r.clientHeight-e,s=this.table.options.progressiveLoadScrollMargin||r.clientHeight*2,a<s&&this.nextPage().catch(()=>{}))}restOnRenderBefore(e,t){return t||this.mode==="local"&&this.reset(),e}rowsUpdated(){this.refreshData(!0,"all")}createElements(){var e;this.element=document.createElement("span"),this.element.classList.add("tabulator-paginator"),this.pagesElement=document.createElement("span"),this.pagesElement.classList.add("tabulator-pages"),e=document.createElement("button"),e.classList.add("tabulator-page"),e.setAttribute("type","button"),e.setAttribute("role","button"),e.setAttribute("aria-label",""),e.setAttribute("title",""),this.firstBut=e.cloneNode(!0),this.firstBut.setAttribute("data-page","first"),this.prevBut=e.cloneNode(!0),this.prevBut.setAttribute("data-page","prev"),this.nextBut=e.cloneNode(!0),this.nextBut.setAttribute("data-page","next"),this.lastBut=e.cloneNode(!0),this.lastBut.setAttribute("data-page","last"),this.table.options.paginationSizeSelector&&(this.pageSizeSelect=document.createElement("select"),this.pageSizeSelect.classList.add("tabulator-page-size"))}generatePageSizeSelectList(){var e=[];if(this.pageSizeSelect){if(Array.isArray(this.table.options.paginationSizeSelector))e=this.table.options.paginationSizeSelector,this.pageSizes=e,this.pageSizes.indexOf(this.size)==-1&&e.unshift(this.size);else if(this.pageSizes.indexOf(this.size)==-1){e=[];for(let t=1;t<5;t++)e.push(this.size*t);this.pageSizes=e}else e=this.pageSizes;for(;this.pageSizeSelect.firstChild;)this.pageSizeSelect.removeChild(this.pageSizeSelect.firstChild);e.forEach(t=>{var r=document.createElement("option");r.value=t,t===!0?this.langBind("pagination|all",function(a){r.innerHTML=a}):r.innerHTML=t,this.pageSizeSelect.appendChild(r)}),this.pageSizeSelect.value=this.size}}initializePageCounter(){var e=this.table.options.paginationCounter,t=null;e&&(typeof e=="function"?t=e:t=Go.pageCounters[e],t?(this.pageCounter=t,this.pageCounterElement=document.createElement("span"),this.pageCounterElement.classList.add("tabulator-page-counter")):console.warn("Pagination Error - No such page counter found: ",e))}initializePaginator(e){var t,r;e||(this.langBind("pagination|first",a=>{this.firstBut.innerHTML=a}),this.langBind("pagination|first_title",a=>{this.firstBut.setAttribute("aria-label",a),this.firstBut.setAttribute("title",a)}),this.langBind("pagination|prev",a=>{this.prevBut.innerHTML=a}),this.langBind("pagination|prev_title",a=>{this.prevBut.setAttribute("aria-label",a),this.prevBut.setAttribute("title",a)}),this.langBind("pagination|next",a=>{this.nextBut.innerHTML=a}),this.langBind("pagination|next_title",a=>{this.nextBut.setAttribute("aria-label",a),this.nextBut.setAttribute("title",a)}),this.langBind("pagination|last",a=>{this.lastBut.innerHTML=a}),this.langBind("pagination|last_title",a=>{this.lastBut.setAttribute("aria-label",a),this.lastBut.setAttribute("title",a)}),this.firstBut.addEventListener("click",()=>{this.setPage(1)}),this.prevBut.addEventListener("click",()=>{this.previousPage()}),this.nextBut.addEventListener("click",()=>{this.nextPage()}),this.lastBut.addEventListener("click",()=>{this.setPage(this.max)}),this.table.options.paginationElement&&(this.element=this.table.options.paginationElement),this.pageSizeSelect&&(t=document.createElement("label"),this.langBind("pagination|page_size",a=>{this.pageSizeSelect.setAttribute("aria-label",a),this.pageSizeSelect.setAttribute("title",a),t.innerHTML=a}),this.element.appendChild(t),this.element.appendChild(this.pageSizeSelect),this.pageSizeSelect.addEventListener("change",a=>{this.setPageSize(this.pageSizeSelect.value=="true"?!0:this.pageSizeSelect.value),this.setPage(1)})),this.element.appendChild(this.firstBut),this.element.appendChild(this.prevBut),this.element.appendChild(this.pagesElement),this.element.appendChild(this.nextBut),this.element.appendChild(this.lastBut),this.table.options.paginationElement||(this.table.options.paginationCounter&&(this.table.options.paginationCounterElement?this.table.options.paginationCounterElement instanceof HTMLElement?this.table.options.paginationCounterElement.appendChild(this.pageCounterElement):typeof this.table.options.paginationCounterElement=="string"&&(r=document.querySelector(this.table.options.paginationCounterElement),r?r.appendChild(this.pageCounterElement):console.warn("Pagination Error - Unable to find element matching paginationCounterElement selector:",this.table.options.paginationCounterElement)):this.footerAppend(this.pageCounterElement)),this.footerAppend(this.element)),this.page=this.table.options.paginationInitialPage,this.count=this.table.options.paginationButtonCount),this.mode=this.table.options.paginationMode}initializeProgressive(e){this.initializePaginator(!0),this.mode="progressive_"+e,this.progressiveLoad=!0}trackChanges(){this.dispatch("page-changed")}setMaxRows(e){e?this.max=this.size===!0?1:Math.ceil(e/this.size):this.max=1,this.page>this.max&&(this.page=this.max)}reset(e){this.initialLoad||(this.mode=="local"||e)&&(this.page=1,this.trackChanges())}setMaxPage(e){e=parseInt(e),this.max=e||1,this.page>this.max&&(this.page=this.max,this.trigger())}setPage(e){switch(e){case"first":return this.setPage(1);case"prev":return this.previousPage();case"next":return this.nextPage();case"last":return this.setPage(this.max)}return e=parseInt(e),e>0&&e<=this.max||this.mode!=="local"?(this.page=e,this.trackChanges(),this.trigger()):(console.warn("Pagination Error - Requested page is out of range of 1 - "+this.max+":",e),Promise.reject())}setPageToRow(e){var t=this.displayRows(-1),r=t.indexOf(e);if(r>-1){var a=this.size===!0?1:Math.ceil((r+1)/this.size);return this.setPage(a)}else return console.warn("Pagination Error - Requested row is not visible"),Promise.reject()}setPageSize(e){e!==!0&&(e=parseInt(e)),e>0&&(this.size=e,this.dispatchExternal("pageSizeChanged",e)),this.pageSizeSelect&&this.generatePageSizeSelectList(),this.trackChanges()}_setPageCounter(e,t,r){var a;if(this.pageCounter)switch(this.mode==="remote"&&(t=this.size,r=(this.page-1)*this.size+1,e=this.remoteRowCountEstimate),a=this.pageCounter.call(this,t,r,this.page,e,this.max),typeof a){case"object":if(a instanceof Node){for(;this.pageCounterElement.firstChild;)this.pageCounterElement.removeChild(this.pageCounterElement.firstChild);this.pageCounterElement.appendChild(a)}else this.pageCounterElement.innerHTML="",a!=null&&console.warn("Page Counter Error - Page Counter has returned a type of object, the only valid page counter object return is an instance of Node, the page counter returned:",a);break;case"undefined":this.pageCounterElement.innerHTML="";break;default:this.pageCounterElement.innerHTML=a}}_setPageButtons(){let e=Math.floor((this.count-1)/2),t=Math.ceil((this.count-1)/2),r=this.max-this.page+e+1<this.count?this.max-this.count+1:Math.max(this.page-e,1),a=this.page<=t?Math.min(this.count,this.max):Math.min(this.page+t,this.max);for(;this.pagesElement.firstChild;)this.pagesElement.removeChild(this.pagesElement.firstChild);this.page==1?(this.firstBut.disabled=!0,this.prevBut.disabled=!0):(this.firstBut.disabled=!1,this.prevBut.disabled=!1),this.page==this.max?(this.lastBut.disabled=!0,this.nextBut.disabled=!0):(this.lastBut.disabled=!1,this.nextBut.disabled=!1);for(let s=r;s<=a;s++)s>0&&s<=this.max&&this.pagesElement.appendChild(this._generatePageButton(s));this.footerRedraw()}_generatePageButton(e){var t=document.createElement("button");return t.classList.add("tabulator-page"),e==this.page&&t.classList.add("active"),t.setAttribute("type","button"),t.setAttribute("role","button"),this.langBind("pagination|page_title",r=>{t.setAttribute("aria-label",r+" "+e),t.setAttribute("title",r+" "+e)}),t.setAttribute("data-page",e),t.textContent=e,t.addEventListener("click",r=>{this.setPage(e)}),t}previousPage(){return this.page>1?(this.page--,this.trackChanges(),this.trigger()):(console.warn("Pagination Error - Previous page would be less than page 1:",0),Promise.reject())}nextPage(){return this.page<this.max?(this.page++,this.trackChanges(),this.trigger()):(this.progressiveLoad||console.warn("Pagination Error - Next page would be greater than maximum page of "+this.max+":",this.max+1),Promise.reject())}getPage(){return this.page}getPageMax(){return this.max}getPageSize(e){return this.size}getMode(){return this.mode}getRows(e){var t=0,r,a,s,o,u=e.filter(h=>h.type==="row");if(this.mode=="local"){r=[],this.setMaxRows(e.length),this.size===!0?(a=0,s=e.length):(a=this.size*(this.page-1),s=a+parseInt(this.size)),this._setPageButtons();for(let h=a;h<s;h++){let d=e[h];d&&(r.push(d),d.type==="row"&&(o||(o=d),t++))}return this._setPageCounter(u.length,t,o?u.indexOf(o)+1:0),r}else return this._setPageButtons(),this._setPageCounter(u.length),e.slice(0)}trigger(){var e;switch(this.mode){case"local":return e=this.table.rowManager.scrollLeft,this.refreshData(),this.table.rowManager.scrollHorizontal(e),this.dispatchExternal("pageLoaded",this.getPage()),Promise.resolve();case"remote":return this.dataChanging=!0,this.reloadData(null).finally(()=>{this.dataChanging=!1});case"progressive_load":case"progressive_scroll":return this.reloadData(null,!0);default:return console.warn("Pagination Error - no such pagination mode:",this.mode),Promise.reject()}}_parseRemoteData(e){var t,r;if(typeof e.last_page>"u"&&console.warn("Remote Pagination Error - Server response missing '"+(this.options("dataReceiveParams").last_page||"last_page")+"' property"),e.data)if(this.max=parseInt(e.last_page)||1,this.remoteRowCountEstimate=typeof e.last_row<"u"?e.last_row:e.last_page*this.size-(this.page==e.last_page?this.size-e.data.length:0),this.progressiveLoad){switch(this.mode){case"progressive_load":this.page==1?this.table.rowManager.setData(e.data,!1,this.page==1):this.table.rowManager.addRows(e.data),this.page<this.max&&setTimeout(()=>{this.nextPage()},this.table.options.progressiveLoadDelay);break;case"progressive_scroll":e=this.page===1?e.data:this.table.rowManager.getData().concat(e.data),this.table.rowManager.setData(e,this.page!==1,this.page==1),t=this.table.options.progressiveLoadScrollMargin||this.table.rowManager.element.clientHeight*2,this.table.rowManager.element.scrollHeight<=this.table.rowManager.element.clientHeight+t&&this.page<this.max&&setTimeout(()=>{this.nextPage()});break}return!1}else{if(this.page>this.max&&(console.warn("Remote Pagination Error - Server returned last page value lower than the current page"),r=this.options("paginationOutOfRange"),r))return this.setPage(typeof r=="function"?r.call(this,this.page,this.max):r);this.dispatchExternal("pageLoaded",this.getPage())}else console.warn("Remote Pagination Error - Server response missing '"+(this.options("dataReceiveParams").data||"data")+"' property");return e.data}footerRedraw(){var e=this.table.footerManager.containerElement;Math.ceil(e.clientWidth)-e.scrollWidth<0?this.pagesElement.style.display="none":(this.pagesElement.style.display="",Math.ceil(e.clientWidth)-e.scrollWidth<0&&(this.pagesElement.style.display="none"))}};Be(Go,"moduleName","page"),Be(Go,"pageCounters",A6);let P0=Go;var D6={local:function(i,e){var t=localStorage.getItem(i+"-"+e);return t?JSON.parse(t):!1},cookie:function(i,e){var t=document.cookie,r=i+"-"+e,a=t.indexOf(r+"="),s,o;return a>-1&&(t=t.slice(a),s=t.indexOf(";"),s>-1&&(t=t.slice(0,s)),o=t.replace(r+"=","")),o?JSON.parse(o):!1}},F6={local:function(i,e,t){localStorage.setItem(i+"-"+e,JSON.stringify(t))},cookie:function(i,e,t){var r=new Date;r.setDate(r.getDate()+1e4),document.cookie=i+"-"+e+"="+JSON.stringify(t)+"; expires="+r.toUTCString()}};const rr=class rr extends ct{constructor(e){super(e),this.mode="",this.id="",this.defWatcherBlock=!1,this.config={},this.readFunc=!1,this.writeFunc=!1,this.registerTableOption("persistence",!1),this.registerTableOption("persistenceID",""),this.registerTableOption("persistenceMode",!0),this.registerTableOption("persistenceReaderFunc",!1),this.registerTableOption("persistenceWriterFunc",!1)}localStorageTest(){var e="_tabulator_test";try{return window.localStorage.setItem(e,e),window.localStorage.removeItem(e),!0}catch{return!1}}initialize(){if(this.table.options.persistence){var e=this.table.options.persistenceMode,t=this.table.options.persistenceID,r;this.mode=e!==!0?e:this.localStorageTest()?"local":"cookie",this.table.options.persistenceReaderFunc?typeof this.table.options.persistenceReaderFunc=="function"?this.readFunc=this.table.options.persistenceReaderFunc:rr.readers[this.table.options.persistenceReaderFunc]?this.readFunc=rr.readers[this.table.options.persistenceReaderFunc]:console.warn("Persistence Read Error - invalid reader set",this.table.options.persistenceReaderFunc):rr.readers[this.mode]?this.readFunc=rr.readers[this.mode]:console.warn("Persistence Read Error - invalid reader set",this.mode),this.table.options.persistenceWriterFunc?typeof this.table.options.persistenceWriterFunc=="function"?this.writeFunc=this.table.options.persistenceWriterFunc:rr.writers[this.table.options.persistenceWriterFunc]?this.writeFunc=rr.writers[this.table.options.persistenceWriterFunc]:console.warn("Persistence Write Error - invalid reader set",this.table.options.persistenceWriterFunc):rr.writers[this.mode]?this.writeFunc=rr.writers[this.mode]:console.warn("Persistence Write Error - invalid writer set",this.mode),this.id="tabulator-"+(t||this.table.element.getAttribute("id")||""),this.config={sort:this.table.options.persistence===!0||this.table.options.persistence.sort,filter:this.table.options.persistence===!0||this.table.options.persistence.filter,headerFilter:this.table.options.persistence===!0||this.table.options.persistence.headerFilter,group:this.table.options.persistence===!0||this.table.options.persistence.group,page:this.table.options.persistence===!0||this.table.options.persistence.page,columns:this.table.options.persistence===!0?["title","width","visible"]:this.table.options.persistence.columns},this.config.page&&(r=this.retrieveData("page"),r&&(typeof r.paginationSize<"u"&&(this.config.page===!0||this.config.page.size)&&(this.table.options.paginationSize=r.paginationSize),typeof r.paginationInitialPage<"u"&&(this.config.page===!0||this.config.page.page)&&(this.table.options.paginationInitialPage=r.paginationInitialPage))),this.config.group&&(r=this.retrieveData("group"),r&&(typeof r.groupBy<"u"&&(this.config.group===!0||this.config.group.groupBy)&&(this.table.options.groupBy=r.groupBy),typeof r.groupStartOpen<"u"&&(this.config.group===!0||this.config.group.groupStartOpen)&&(this.table.options.groupStartOpen=r.groupStartOpen),typeof r.groupHeader<"u"&&(this.config.group===!0||this.config.group.groupHeader)&&(this.table.options.groupHeader=r.groupHeader))),this.config.columns&&(this.table.options.columns=this.load("columns",this.table.options.columns),this.subscribe("column-init",this.initializeColumn.bind(this)),this.subscribe("column-show",this.save.bind(this,"columns")),this.subscribe("column-hide",this.save.bind(this,"columns")),this.subscribe("column-moved",this.save.bind(this,"columns"))),this.subscribe("table-built",this.tableBuilt.bind(this),0),this.subscribe("table-redraw",this.tableRedraw.bind(this)),this.subscribe("filter-changed",this.eventSave.bind(this,"filter")),this.subscribe("filter-changed",this.eventSave.bind(this,"headerFilter")),this.subscribe("sort-changed",this.eventSave.bind(this,"sort")),this.subscribe("group-changed",this.eventSave.bind(this,"group")),this.subscribe("page-changed",this.eventSave.bind(this,"page")),this.subscribe("column-resized",this.eventSave.bind(this,"columns")),this.subscribe("column-width",this.eventSave.bind(this,"columns")),this.subscribe("layout-refreshed",this.eventSave.bind(this,"columns"))}this.registerTableFunction("getColumnLayout",this.getColumnLayout.bind(this)),this.registerTableFunction("setColumnLayout",this.setColumnLayout.bind(this))}eventSave(e){this.config[e]&&this.save(e)}tableBuilt(){var e,t,r;this.config.sort&&(e=this.load("sort"),e&&(this.table.options.initialSort=e)),this.config.filter&&(t=this.load("filter"),t&&(this.table.options.initialFilter=t)),this.config.headerFilter&&(r=this.load("headerFilter"),r&&(this.table.options.initialHeaderFilter=r))}tableRedraw(e){e&&this.config.columns&&this.save("columns")}getColumnLayout(){return this.parseColumns(this.table.columnManager.getColumns())}setColumnLayout(e){return this.table.columnManager.setColumns(this.mergeDefinition(this.table.options.columns,e,!0)),!0}initializeColumn(e){var t,r;this.config.columns&&(this.defWatcherBlock=!0,t=e.getDefinition(),r=this.config.columns===!0?Object.keys(t):this.config.columns,r.forEach(a=>{var s=Object.getOwnPropertyDescriptor(t,a),o=t[a];s&&Object.defineProperty(t,a,{set:u=>{o=u,this.defWatcherBlock||this.save("columns"),s.set&&s.set(u)},get:()=>(s.get&&s.get(),o)})}),this.defWatcherBlock=!1)}load(e,t){var r=this.retrieveData(e);return t&&(r=r?this.mergeDefinition(t,r):t),r}retrieveData(e){return this.readFunc?this.readFunc(this.id,e):!1}mergeDefinition(e,t,r){var a=[];return t=t||[],t.forEach((s,o)=>{var u=this._findColumn(e,s),h;u&&(r?h=Object.keys(s):this.config.columns===!0||this.config.columns==null?(h=Object.keys(u),h.push("width")):h=this.config.columns,h.forEach(d=>{d!=="columns"&&typeof s[d]<"u"&&(u[d]=s[d])}),u.columns&&(u.columns=this.mergeDefinition(u.columns,s.columns)),a.push(u))}),e.forEach((s,o)=>{var u=this._findColumn(t,s);u||(a.length>o?a.splice(o,0,s):a.push(s))}),a}_findColumn(e,t){var r=t.columns?"group":t.field?"field":"object";return e.find(function(a){switch(r){case"group":return a.title===t.title&&a.columns.length===t.columns.length;case"field":return a.field===t.field;case"object":return a===t}})}save(e){var t={};switch(e){case"columns":t=this.parseColumns(this.table.columnManager.getColumns());break;case"filter":t=this.table.modules.filter.getFilters();break;case"headerFilter":t=this.table.modules.filter.getHeaderFilters();break;case"sort":t=this.validateSorters(this.table.modules.sort.getSort());break;case"group":t=this.getGroupConfig();break;case"page":t=this.getPageConfig();break}this.writeFunc&&this.writeFunc(this.id,e,t)}validateSorters(e){return e.forEach(function(t){t.column=t.field,delete t.field}),e}getGroupConfig(){var e={};return this.config.group&&((this.config.group===!0||this.config.group.groupBy)&&(e.groupBy=this.table.options.groupBy),(this.config.group===!0||this.config.group.groupStartOpen)&&(e.groupStartOpen=this.table.options.groupStartOpen),(this.config.group===!0||this.config.group.groupHeader)&&(e.groupHeader=this.table.options.groupHeader)),e}getPageConfig(){var e={};return this.config.page&&((this.config.page===!0||this.config.page.size)&&(e.paginationSize=this.table.modules.page.getPageSize()),(this.config.page===!0||this.config.page.page)&&(e.paginationInitialPage=this.table.modules.page.getPage())),e}parseColumns(e){var t=[],r=["headerContextMenu","headerMenu","contextMenu","clickMenu"];return e.forEach(a=>{var s={},o=a.getDefinition(),u;a.isGroup?(s.title=o.title,s.columns=this.parseColumns(a.getColumns())):(s.field=a.getField(),this.config.columns===!0||this.config.columns==null?(u=Object.keys(o),u.push("width"),u.push("visible")):u=this.config.columns,u.forEach(h=>{switch(h){case"width":s.width=a.getWidth();break;case"visible":s.visible=a.visible;break;default:typeof o[h]!="function"&&r.indexOf(h)===-1&&(s[h]=o[h])}})),t.push(s)}),t}};Be(rr,"moduleName","persistence"),Be(rr,"moduleInitOrder",-10),Be(rr,"readers",D6),Be(rr,"writers",F6);let I0=rr;class Hy extends ct{constructor(e){super(e),this.columnSubscribers={},this.registerTableOption("rowContextPopup",!1),this.registerTableOption("rowClickPopup",!1),this.registerTableOption("rowDblClickPopup",!1),this.registerTableOption("groupContextPopup",!1),this.registerTableOption("groupClickPopup",!1),this.registerTableOption("groupDblClickPopup",!1),this.registerColumnOption("headerContextPopup"),this.registerColumnOption("headerClickPopup"),this.registerColumnOption("headerDblClickPopup"),this.registerColumnOption("headerPopup"),this.registerColumnOption("headerPopupIcon"),this.registerColumnOption("contextPopup"),this.registerColumnOption("clickPopup"),this.registerColumnOption("dblClickPopup"),this.registerComponentFunction("cell","popup",this._componentPopupCall.bind(this)),this.registerComponentFunction("column","popup",this._componentPopupCall.bind(this)),this.registerComponentFunction("row","popup",this._componentPopupCall.bind(this)),this.registerComponentFunction("group","popup",this._componentPopupCall.bind(this))}initialize(){this.initializeRowWatchers(),this.initializeGroupWatchers(),this.subscribe("column-init",this.initializeColumn.bind(this))}_componentPopupCall(e,t,r){this.loadPopupEvent(t,null,e,r)}initializeRowWatchers(){this.table.options.rowContextPopup&&(this.subscribe("row-contextmenu",this.loadPopupEvent.bind(this,this.table.options.rowContextPopup)),this.table.on("rowTapHold",this.loadPopupEvent.bind(this,this.table.options.rowContextPopup))),this.table.options.rowClickPopup&&this.subscribe("row-click",this.loadPopupEvent.bind(this,this.table.options.rowClickPopup)),this.table.options.rowDblClickPopup&&this.subscribe("row-dblclick",this.loadPopupEvent.bind(this,this.table.options.rowDblClickPopup))}initializeGroupWatchers(){this.table.options.groupContextPopup&&(this.subscribe("group-contextmenu",this.loadPopupEvent.bind(this,this.table.options.groupContextPopup)),this.table.on("groupTapHold",this.loadPopupEvent.bind(this,this.table.options.groupContextPopup))),this.table.options.groupClickPopup&&this.subscribe("group-click",this.loadPopupEvent.bind(this,this.table.options.groupClickPopup)),this.table.options.groupDblClickPopup&&this.subscribe("group-dblclick",this.loadPopupEvent.bind(this,this.table.options.groupDblClickPopup))}initializeColumn(e){var t=e.definition;t.headerContextPopup&&!this.columnSubscribers.headerContextPopup&&(this.columnSubscribers.headerContextPopup=this.loadPopupTableColumnEvent.bind(this,"headerContextPopup"),this.subscribe("column-contextmenu",this.columnSubscribers.headerContextPopup),this.table.on("headerTapHold",this.loadPopupTableColumnEvent.bind(this,"headerContextPopup"))),t.headerClickPopup&&!this.columnSubscribers.headerClickPopup&&(this.columnSubscribers.headerClickPopup=this.loadPopupTableColumnEvent.bind(this,"headerClickPopup"),this.subscribe("column-click",this.columnSubscribers.headerClickPopup)),t.headerDblClickPopup&&!this.columnSubscribers.headerDblClickPopup&&(this.columnSubscribers.headerDblClickPopup=this.loadPopupTableColumnEvent.bind(this,"headerDblClickPopup"),this.subscribe("column-dblclick",this.columnSubscribers.headerDblClickPopup)),t.headerPopup&&this.initializeColumnHeaderPopup(e),t.contextPopup&&!this.columnSubscribers.contextPopup&&(this.columnSubscribers.contextPopup=this.loadPopupTableCellEvent.bind(this,"contextPopup"),this.subscribe("cell-contextmenu",this.columnSubscribers.contextPopup),this.table.on("cellTapHold",this.loadPopupTableCellEvent.bind(this,"contextPopup"))),t.clickPopup&&!this.columnSubscribers.clickPopup&&(this.columnSubscribers.clickPopup=this.loadPopupTableCellEvent.bind(this,"clickPopup"),this.subscribe("cell-click",this.columnSubscribers.clickPopup)),t.dblClickPopup&&!this.columnSubscribers.dblClickPopup&&(this.columnSubscribers.dblClickPopup=this.loadPopupTableCellEvent.bind(this,"dblClickPopup"),this.subscribe("cell-click",this.columnSubscribers.dblClickPopup))}initializeColumnHeaderPopup(e){var t=e.definition.headerPopupIcon,r;r=document.createElement("span"),r.classList.add("tabulator-header-popup-button"),t?(typeof t=="function"&&(t=t(e.getComponent())),t instanceof HTMLElement?r.appendChild(t):r.innerHTML=t):r.innerHTML="&vellip;",r.addEventListener("click",a=>{a.stopPropagation(),a.preventDefault(),this.loadPopupEvent(e.definition.headerPopup,a,e)}),e.titleElement.insertBefore(r,e.titleElement.firstChild)}loadPopupTableCellEvent(e,t,r){r._cell&&(r=r._cell),r.column.definition[e]&&this.loadPopupEvent(r.column.definition[e],t,r)}loadPopupTableColumnEvent(e,t,r){r._column&&(r=r._column),r.definition[e]&&this.loadPopupEvent(r.definition[e],t,r)}loadPopupEvent(e,t,r,a){var s;function o(u){s=u}r._group?r=r._group:r._row&&(r=r._row),e=typeof e=="function"?e.call(this.table,t,r.getComponent(),o):e,this.loadPopup(t,r,e,s,a)}loadPopup(e,t,r,a,s){var o=!(e instanceof MouseEvent),u,h;r instanceof HTMLElement?u=r:(u=document.createElement("div"),u.innerHTML=r),u.classList.add("tabulator-popup"),u.addEventListener("click",d=>{d.stopPropagation()}),o||e.preventDefault(),h=this.popup(u),typeof a=="function"&&h.renderCallback(a),e?h.show(e):h.show(t.getElement(),s||"center"),h.hideOnBlur(()=>{this.dispatchExternal("popupClosed",t.getComponent())}),this.dispatchExternal("popupOpened",t.getComponent())}}Be(Hy,"moduleName","popup");class Py extends ct{constructor(e){super(e),this.element=!1,this.manualBlock=!1,this.beforeprintEventHandler=null,this.afterprintEventHandler=null,this.registerTableOption("printAsHtml",!1),this.registerTableOption("printFormatter",!1),this.registerTableOption("printHeader",!1),this.registerTableOption("printFooter",!1),this.registerTableOption("printStyled",!0),this.registerTableOption("printRowRange","visible"),this.registerTableOption("printConfig",{}),this.registerColumnOption("print"),this.registerColumnOption("titlePrint")}initialize(){this.table.options.printAsHtml&&(this.beforeprintEventHandler=this.replaceTable.bind(this),this.afterprintEventHandler=this.cleanup.bind(this),window.addEventListener("beforeprint",this.beforeprintEventHandler),window.addEventListener("afterprint",this.afterprintEventHandler),this.subscribe("table-destroy",this.destroy.bind(this))),this.registerTableFunction("print",this.printFullscreen.bind(this))}destroy(){this.table.options.printAsHtml&&(window.removeEventListener("beforeprint",this.beforeprintEventHandler),window.removeEventListener("afterprint",this.afterprintEventHandler))}replaceTable(){this.manualBlock||(this.element=document.createElement("div"),this.element.classList.add("tabulator-print-table"),this.element.appendChild(this.table.modules.export.generateTable(this.table.options.printConfig,this.table.options.printStyled,this.table.options.printRowRange,"print")),this.table.element.style.display="none",this.table.element.parentNode.insertBefore(this.element,this.table.element))}cleanup(){document.body.classList.remove("tabulator-print-fullscreen-hide"),this.element&&this.element.parentNode&&(this.element.parentNode.removeChild(this.element),this.table.element.style.display="")}printFullscreen(e,t,r){var a=window.scrollX,s=window.scrollY,o=document.createElement("div"),u=document.createElement("div"),h=this.table.modules.export.generateTable(typeof r<"u"?r:this.table.options.printConfig,typeof t<"u"?t:this.table.options.printStyled,e||this.table.options.printRowRange,"print"),d,p;this.manualBlock=!0,this.element=document.createElement("div"),this.element.classList.add("tabulator-print-fullscreen"),this.table.options.printHeader&&(o.classList.add("tabulator-print-header"),d=typeof this.table.options.printHeader=="function"?this.table.options.printHeader.call(this.table):this.table.options.printHeader,typeof d=="string"?o.innerHTML=d:o.appendChild(d),this.element.appendChild(o)),this.element.appendChild(h),this.table.options.printFooter&&(u.classList.add("tabulator-print-footer"),p=typeof this.table.options.printFooter=="function"?this.table.options.printFooter.call(this.table):this.table.options.printFooter,typeof p=="string"?u.innerHTML=p:u.appendChild(p),this.element.appendChild(u)),document.body.classList.add("tabulator-print-fullscreen-hide"),document.body.appendChild(this.element),this.table.options.printFormatter&&this.table.options.printFormatter(this.element,h),window.print(),this.cleanup(),window.scrollTo(a,s),this.manualBlock=!1}}Be(Py,"moduleName","print");class Iy extends ct{constructor(e){super(e),this.data=!1,this.blocked=!1,this.origFuncs={},this.currentVersion=0,this.registerTableOption("reactiveData",!1)}initialize(){this.table.options.reactiveData&&(this.subscribe("cell-value-save-before",this.block.bind(this,"cellsave")),this.subscribe("cell-value-save-after",this.unblock.bind(this,"cellsave")),this.subscribe("row-data-save-before",this.block.bind(this,"rowsave")),this.subscribe("row-data-save-after",this.unblock.bind(this,"rowsave")),this.subscribe("row-data-init-after",this.watchRow.bind(this)),this.subscribe("data-processing",this.watchData.bind(this)),this.subscribe("table-destroy",this.unwatchData.bind(this)))}watchData(e){var t=this,r;this.currentVersion++,r=this.currentVersion,this.unwatchData(),this.data=e,this.origFuncs.push=e.push,Object.defineProperty(this.data,"push",{enumerable:!1,configurable:!0,value:function(){var a=Array.from(arguments),s;return!t.blocked&&r===t.currentVersion&&(t.block("data-push"),a.forEach(o=>{t.table.rowManager.addRowActual(o,!1)}),s=t.origFuncs.push.apply(e,arguments),t.unblock("data-push")),s}}),this.origFuncs.unshift=e.unshift,Object.defineProperty(this.data,"unshift",{enumerable:!1,configurable:!0,value:function(){var a=Array.from(arguments),s;return!t.blocked&&r===t.currentVersion&&(t.block("data-unshift"),a.forEach(o=>{t.table.rowManager.addRowActual(o,!0)}),s=t.origFuncs.unshift.apply(e,arguments),t.unblock("data-unshift")),s}}),this.origFuncs.shift=e.shift,Object.defineProperty(this.data,"shift",{enumerable:!1,configurable:!0,value:function(){var a,s;return!t.blocked&&r===t.currentVersion&&(t.block("data-shift"),t.data.length&&(a=t.table.rowManager.getRowFromDataObject(t.data[0]),a&&a.deleteActual()),s=t.origFuncs.shift.call(e),t.unblock("data-shift")),s}}),this.origFuncs.pop=e.pop,Object.defineProperty(this.data,"pop",{enumerable:!1,configurable:!0,value:function(){var a,s;return!t.blocked&&r===t.currentVersion&&(t.block("data-pop"),t.data.length&&(a=t.table.rowManager.getRowFromDataObject(t.data[t.data.length-1]),a&&a.deleteActual()),s=t.origFuncs.pop.call(e),t.unblock("data-pop")),s}}),this.origFuncs.splice=e.splice,Object.defineProperty(this.data,"splice",{enumerable:!1,configurable:!0,value:function(){var a=Array.from(arguments),s=a[0]<0?e.length+a[0]:a[0],o=a[1],u=a[2]?a.slice(2):!1,h,d;if(!t.blocked&&r===t.currentVersion){if(t.block("data-splice"),u&&(h=e[s]?t.table.rowManager.getRowFromDataObject(e[s]):!1,h?u.forEach(b=>{t.table.rowManager.addRowActual(b,!0,h,!0)}):(u=u.slice().reverse(),u.forEach(b=>{t.table.rowManager.addRowActual(b,!0,!1,!0)}))),o!==0){var p=e.slice(s,typeof a[1]>"u"?a[1]:s+o);p.forEach((b,g)=>{var v=t.table.rowManager.getRowFromDataObject(b);v&&v.deleteActual(g!==p.length-1)})}(u||o!==0)&&t.table.rowManager.reRenderInPosition(),d=t.origFuncs.splice.apply(e,arguments),t.unblock("data-splice")}return d}})}unwatchData(){if(this.data!==!1)for(var e in this.origFuncs)Object.defineProperty(this.data,e,{enumerable:!0,configurable:!0,writable:!0,value:this.origFuncs.key})}watchRow(e){var t=e.getData();for(var r in t)this.watchKey(e,t,r);this.table.options.dataTree&&this.watchTreeChildren(e)}watchTreeChildren(e){var t=this,r=e.getData()[this.table.options.dataTreeChildField],a={};r&&(a.push=r.push,Object.defineProperty(r,"push",{enumerable:!1,configurable:!0,value:()=>{if(!t.blocked){t.block("tree-push");var s=a.push.apply(r,arguments);this.rebuildTree(e),t.unblock("tree-push")}return s}}),a.unshift=r.unshift,Object.defineProperty(r,"unshift",{enumerable:!1,configurable:!0,value:()=>{if(!t.blocked){t.block("tree-unshift");var s=a.unshift.apply(r,arguments);this.rebuildTree(e),t.unblock("tree-unshift")}return s}}),a.shift=r.shift,Object.defineProperty(r,"shift",{enumerable:!1,configurable:!0,value:()=>{if(!t.blocked){t.block("tree-shift");var s=a.shift.call(r);this.rebuildTree(e),t.unblock("tree-shift")}return s}}),a.pop=r.pop,Object.defineProperty(r,"pop",{enumerable:!1,configurable:!0,value:()=>{if(!t.blocked){t.block("tree-pop");var s=a.pop.call(r);this.rebuildTree(e),t.unblock("tree-pop")}return s}}),a.splice=r.splice,Object.defineProperty(r,"splice",{enumerable:!1,configurable:!0,value:()=>{if(!t.blocked){t.block("tree-splice");var s=a.splice.apply(r,arguments);this.rebuildTree(e),t.unblock("tree-splice")}return s}}))}rebuildTree(e){this.table.modules.dataTree.initializeRow(e),this.table.modules.dataTree.layoutRow(e),this.table.rowManager.refreshActiveData("tree",!1,!0)}watchKey(e,t,r){var a=this,s=Object.getOwnPropertyDescriptor(t,r),o=t[r],u=this.currentVersion;Object.defineProperty(t,r,{set:h=>{if(o=h,!a.blocked&&u===a.currentVersion){a.block("key");var d={};d[r]=h,e.updateData(d),a.unblock("key")}s.set&&s.set(h)},get:()=>(s.get&&s.get(),o)})}unwatchRow(e){var t=e.getData();for(var r in t)Object.defineProperty(t,r,{value:t[r]})}block(e){this.blocked||(this.blocked=e)}unblock(e){this.blocked===e&&(this.blocked=!1)}}Be(Iy,"moduleName","reactiveData");class Uy extends ct{constructor(e){super(e),this.startColumn=!1,this.startX=!1,this.startWidth=!1,this.latestX=!1,this.handle=null,this.initialNextColumn=null,this.nextColumn=null,this.initialized=!1,this.registerColumnOption("resizable",!0),this.registerTableOption("resizableColumnFit",!1),this.registerTableOption("resizableColumnGuide",!1)}initialize(){this.subscribe("column-rendered",this.layoutColumnHeader.bind(this))}initializeEventWatchers(){this.initialized||(this.subscribe("cell-rendered",this.layoutCellHandles.bind(this)),this.subscribe("cell-delete",this.deInitializeComponent.bind(this)),this.subscribe("cell-height",this.resizeHandle.bind(this)),this.subscribe("column-moved",this.columnLayoutUpdated.bind(this)),this.subscribe("column-hide",this.deInitializeColumn.bind(this)),this.subscribe("column-show",this.columnLayoutUpdated.bind(this)),this.subscribe("column-width",this.columnWidthUpdated.bind(this)),this.subscribe("column-delete",this.deInitializeComponent.bind(this)),this.subscribe("column-height",this.resizeHandle.bind(this)),this.initialized=!0)}layoutCellHandles(e){e.row.type==="row"&&(this.deInitializeComponent(e),this.initializeColumn("cell",e,e.column,e.element))}layoutColumnHeader(e){e.definition.resizable&&(this.initializeEventWatchers(),this.deInitializeComponent(e),this.initializeColumn("header",e,e,e.element))}columnLayoutUpdated(e){var t=e.prevColumn();this.reinitializeColumn(e),t&&this.reinitializeColumn(t)}columnWidthUpdated(e){e.modules.frozen&&(this.table.modules.frozenColumns.leftColumns.includes(e)?this.table.modules.frozenColumns.leftColumns.forEach(t=>{this.reinitializeColumn(t)}):this.table.modules.frozenColumns.rightColumns.includes(e)&&this.table.modules.frozenColumns.rightColumns.forEach(t=>{this.reinitializeColumn(t)}))}frozenColumnOffset(e){var t=!1;return e.modules.frozen&&(t=e.modules.frozen.marginValue,e.modules.frozen.position==="left"?t+=e.getWidth()-3:t&&(t-=3)),t!==!1?t+"px":!1}reinitializeColumn(e){var t=this.frozenColumnOffset(e);e.cells.forEach(r=>{r.modules.resize&&r.modules.resize.handleEl&&(t&&(r.modules.resize.handleEl.style[e.modules.frozen.position]=t,r.modules.resize.handleEl.style["z-index"]=11),r.element.after(r.modules.resize.handleEl))}),e.modules.resize&&e.modules.resize.handleEl&&(t&&(e.modules.resize.handleEl.style[e.modules.frozen.position]=t),e.element.after(e.modules.resize.handleEl))}initializeColumn(e,t,r,a){var s=this,o=!1,u=r.definition.resizable,h={},d=r.getLastColumn();if(e==="header"&&(o=r.definition.formatter=="textarea"||r.definition.variableHeight,h={variableHeight:o}),(u===!0||u==e)&&this._checkResizability(d)){var p=document.createElement("span");p.className="tabulator-col-resize-handle",p.addEventListener("click",function(g){g.stopPropagation()});var b=function(g){s.startColumn=r,s.initialNextColumn=s.nextColumn=d.nextColumn(),s._mouseDown(g,d,p)};p.addEventListener("mousedown",b),p.addEventListener("touchstart",b,{passive:!0}),p.addEventListener("dblclick",g=>{var v=d.getWidth();g.stopPropagation(),d.reinitializeWidth(!0),v!==d.getWidth()&&(s.dispatch("column-resized",d),s.dispatchExternal("columnResized",d.getComponent()))}),r.modules.frozen&&(p.style.position="sticky",p.style[r.modules.frozen.position]=this.frozenColumnOffset(r)),h.handleEl=p,a.parentNode&&r.visible&&a.after(p)}t.modules.resize=h}deInitializeColumn(e){this.deInitializeComponent(e),e.cells.forEach(t=>{this.deInitializeComponent(t)})}deInitializeComponent(e){var t;e.modules.resize&&(t=e.modules.resize.handleEl,t&&t.parentElement&&t.parentElement.removeChild(t))}resizeHandle(e,t){e.modules.resize&&e.modules.resize.handleEl&&(e.modules.resize.handleEl.style.height=t)}resize(e,t){var r=typeof e.clientX>"u"?e.touches[0].clientX:e.clientX,a=r-this.startX,s=r-this.latestX,o,u;if(this.latestX=r,this.table.rtl&&(a=-a,s=-s),o=t.width==t.minWidth||t.width==t.maxWidth,t.setWidth(this.startWidth+a),u=t.width==t.minWidth||t.width==t.maxWidth,s<0&&(this.nextColumn=this.initialNextColumn),this.table.options.resizableColumnFit&&this.nextColumn&&!(o&&u)){let h=this.nextColumn.getWidth();s>0&&h<=this.nextColumn.minWidth&&(this.nextColumn=this.nextColumn.nextColumn()),this.nextColumn&&this.nextColumn.setWidth(this.nextColumn.getWidth()-s)}this.table.columnManager.rerenderColumns(!0),!this.table.browserSlow&&t.modules.resize&&t.modules.resize.variableHeight&&t.checkCellHeights()}calcGuidePosition(e,t,r){var a=typeof e.clientX>"u"?e.touches[0].clientX:e.clientX,s=r.getBoundingClientRect().x-this.table.element.getBoundingClientRect().x,o=this.table.element.getBoundingClientRect().x,u=t.element.getBoundingClientRect().left-o,h=a-this.startX,d=Math.max(s+h,u+t.minWidth);return t.maxWidth&&(d=Math.min(d,u+t.maxWidth)),d}_checkResizability(e){return e.definition.resizable}_mouseDown(e,t,r){var a=this,s;this.dispatchExternal("columnResizing",t.getComponent()),a.table.options.resizableColumnGuide&&(s=document.createElement("span"),s.classList.add("tabulator-col-resize-guide"),a.table.element.appendChild(s),setTimeout(()=>{s.style.left=a.calcGuidePosition(e,t,r)+"px"})),a.table.element.classList.add("tabulator-block-select");function o(h){a.table.options.resizableColumnGuide?s.style.left=a.calcGuidePosition(h,t,r)+"px":a.resize(h,t)}function u(h){a.table.options.resizableColumnGuide&&(a.resize(h,t),s.remove()),a.startColumn.modules.edit&&(a.startColumn.modules.edit.blocked=!1),a.table.browserSlow&&t.modules.resize&&t.modules.resize.variableHeight&&t.checkCellHeights(),document.body.removeEventListener("mouseup",u),document.body.removeEventListener("mousemove",o),r.removeEventListener("touchmove",o),r.removeEventListener("touchend",u),a.table.element.classList.remove("tabulator-block-select"),a.startWidth!==t.getWidth()&&(a.table.columnManager.verticalAlignHeaders(),a.dispatch("column-resized",t),a.dispatchExternal("columnResized",t.getComponent()))}e.stopPropagation(),a.startColumn.modules.edit&&(a.startColumn.modules.edit.blocked=!0),a.startX=typeof e.clientX>"u"?e.touches[0].clientX:e.clientX,a.latestX=a.startX,a.startWidth=t.getWidth(),document.body.addEventListener("mousemove",o),document.body.addEventListener("mouseup",u),r.addEventListener("touchmove",o,{passive:!0}),r.addEventListener("touchend",u)}}Be(Uy,"moduleName","resizeColumns");class Vy extends ct{constructor(e){super(e),this.startColumn=!1,this.startY=!1,this.startHeight=!1,this.handle=null,this.prevHandle=null,this.registerTableOption("resizableRows",!1),this.registerTableOption("resizableRowGuide",!1)}initialize(){this.table.options.resizableRows&&this.subscribe("row-layout-after",this.initializeRow.bind(this))}initializeRow(e){var t=this,r=e.getElement(),a=document.createElement("div");a.className="tabulator-row-resize-handle";var s=document.createElement("div");s.className="tabulator-row-resize-handle prev",a.addEventListener("click",function(h){h.stopPropagation()});var o=function(h){t.startRow=e,t._mouseDown(h,e,a)};a.addEventListener("mousedown",o),a.addEventListener("touchstart",o,{passive:!0}),s.addEventListener("click",function(h){h.stopPropagation()});var u=function(h){var d=t.table.rowManager.prevDisplayRow(e);d&&(t.startRow=d,t._mouseDown(h,d,s))};s.addEventListener("mousedown",u),s.addEventListener("touchstart",u,{passive:!0}),r.appendChild(a),r.appendChild(s)}resize(e,t){t.setHeight(this.startHeight+((typeof e.screenY>"u"?e.touches[0].screenY:e.screenY)-this.startY))}calcGuidePosition(e,t,r){var a=typeof e.screenY>"u"?e.touches[0].screenY:e.screenY,s=r.getBoundingClientRect().y-this.table.element.getBoundingClientRect().y,o=this.table.element.getBoundingClientRect().y,u=t.element.getBoundingClientRect().top-o,h=a-this.startY;return Math.max(s+h,u)}_mouseDown(e,t,r){var a=this,s;a.dispatchExternal("rowResizing",t.getComponent()),a.table.options.resizableRowGuide&&(s=document.createElement("span"),s.classList.add("tabulator-row-resize-guide"),a.table.element.appendChild(s),setTimeout(()=>{s.style.top=a.calcGuidePosition(e,t,r)+"px"})),a.table.element.classList.add("tabulator-block-select");function o(h){a.table.options.resizableRowGuide?s.style.top=a.calcGuidePosition(h,t,r)+"px":a.resize(h,t)}function u(h){a.table.options.resizableRowGuide&&(a.resize(h,t),s.remove()),document.body.removeEventListener("mouseup",o),document.body.removeEventListener("mousemove",o),r.removeEventListener("touchmove",o),r.removeEventListener("touchend",u),a.table.element.classList.remove("tabulator-block-select"),a.dispatchExternal("rowResized",t.getComponent())}e.stopPropagation(),a.startY=typeof e.screenY>"u"?e.touches[0].screenY:e.screenY,a.startHeight=t.getHeight(),document.body.addEventListener("mousemove",o),document.body.addEventListener("mouseup",u),r.addEventListener("touchmove",o,{passive:!0}),r.addEventListener("touchend",u)}}Be(Vy,"moduleName","resizeRows");class Gy extends ct{constructor(e){super(e),this.binding=!1,this.visibilityObserver=!1,this.resizeObserver=!1,this.containerObserver=!1,this.tableHeight=0,this.tableWidth=0,this.containerHeight=0,this.containerWidth=0,this.autoResize=!1,this.visible=!1,this.initialized=!1,this.initialRedraw=!1,this.registerTableOption("autoResize",!0)}initialize(){if(this.table.options.autoResize){var e=this.table,t;this.tableHeight=e.element.clientHeight,this.tableWidth=e.element.clientWidth,e.element.parentNode&&(this.containerHeight=e.element.parentNode.clientHeight,this.containerWidth=e.element.parentNode.clientWidth),typeof IntersectionObserver<"u"&&typeof ResizeObserver<"u"&&e.rowManager.getRenderMode()==="virtual"?(this.initializeVisibilityObserver(),this.autoResize=!0,this.resizeObserver=new ResizeObserver(r=>{if(!e.browserMobile||e.browserMobile&&(!e.modules.edit||e.modules.edit&&!e.modules.edit.currentCell)){var a=Math.floor(r[0].contentRect.height),s=Math.floor(r[0].contentRect.width);(this.tableHeight!=a||this.tableWidth!=s)&&(this.tableHeight=a,this.tableWidth=s,e.element.parentNode&&(this.containerHeight=e.element.parentNode.clientHeight,this.containerWidth=e.element.parentNode.clientWidth),this.redrawTable())}}),this.resizeObserver.observe(e.element),t=window.getComputedStyle(e.element),this.table.element.parentNode&&!this.table.rowManager.fixedHeight&&(t.getPropertyValue("max-height")||t.getPropertyValue("min-height"))&&(this.containerObserver=new ResizeObserver(r=>{if(!e.browserMobile||e.browserMobile&&(!e.modules.edit||e.modules.edit&&!e.modules.edit.currentCell)){var a=Math.floor(r[0].contentRect.height),s=Math.floor(r[0].contentRect.width);(this.containerHeight!=a||this.containerWidth!=s)&&(this.containerHeight=a,this.containerWidth=s,this.tableHeight=e.element.clientHeight,this.tableWidth=e.element.clientWidth),this.redrawTable()}}),this.containerObserver.observe(this.table.element.parentNode)),this.subscribe("table-resize",this.tableResized.bind(this))):(this.binding=function(){(!e.browserMobile||e.browserMobile&&(!e.modules.edit||e.modules.edit&&!e.modules.edit.currentCell))&&(e.columnManager.rerenderColumns(!0),e.redraw())},window.addEventListener("resize",this.binding)),this.subscribe("table-destroy",this.clearBindings.bind(this))}}initializeVisibilityObserver(){this.visibilityObserver=new IntersectionObserver(e=>{this.visible=e[0].isIntersecting,this.initialized?this.visible&&(this.redrawTable(this.initialRedraw),this.initialRedraw=!1):(this.initialized=!0,this.initialRedraw=!this.visible)}),this.visibilityObserver.observe(this.table.element)}redrawTable(e){this.initialized&&this.visible&&(this.table.columnManager.rerenderColumns(!0),this.table.redraw(e))}tableResized(){this.table.rowManager.redraw()}clearBindings(){this.binding&&window.removeEventListener("resize",this.binding),this.resizeObserver&&this.resizeObserver.unobserve(this.table.element),this.visibilityObserver&&this.visibilityObserver.unobserve(this.table.element),this.containerObserver&&this.containerObserver.unobserve(this.table.element.parentNode)}}Be(Gy,"moduleName","resizeTable");function M6(i,e,t){var r=document.createElement("div"),a=i.getRow()._row.modules.responsiveLayout;r.classList.add("tabulator-responsive-collapse-toggle"),r.innerHTML=`<svg class='tabulator-responsive-collapse-toggle-open' viewbox="0 0 24 24">
  <line x1="7" y1="12" x2="17" y2="12" fill="none" stroke-width="3" stroke-linecap="round" />
  <line y1="7" x1="12" y2="17" x2="12" fill="none" stroke-width="3" stroke-linecap="round" />
</svg>

<svg class='tabulator-responsive-collapse-toggle-close' viewbox="0 0 24 24">
  <line x1="7" y1="12" x2="17" y2="12"  fill="none" stroke-width="3" stroke-linecap="round" />
</svg>`,i.getElement().classList.add("tabulator-row-handle");function s(o){var u=a.element;a.open=o,u&&(a.open?(r.classList.add("open"),u.style.display=""):(r.classList.remove("open"),u.style.display="none"))}return r.addEventListener("click",function(o){o.stopImmediatePropagation(),s(!a.open),i.getTable().rowManager.adjustTableSize()}),s(a.open),r}var O6={format:{formatters:{responsiveCollapse:M6}}};class U0 extends ct{constructor(e){super(e),this.columns=[],this.hiddenColumns=[],this.mode="",this.index=0,this.collapseFormatter=[],this.collapseStartOpen=!0,this.collapseHandleColumn=!1,this.registerTableOption("responsiveLayout",!1),this.registerTableOption("responsiveLayoutCollapseStartOpen",!0),this.registerTableOption("responsiveLayoutCollapseUseFormatters",!0),this.registerTableOption("responsiveLayoutCollapseFormatter",!1),this.registerColumnOption("responsive")}initialize(){this.table.options.responsiveLayout&&(this.subscribe("column-layout",this.initializeColumn.bind(this)),this.subscribe("column-show",this.updateColumnVisibility.bind(this)),this.subscribe("column-hide",this.updateColumnVisibility.bind(this)),this.subscribe("columns-loaded",this.initializeResponsivity.bind(this)),this.subscribe("column-moved",this.initializeResponsivity.bind(this)),this.subscribe("column-add",this.initializeResponsivity.bind(this)),this.subscribe("column-delete",this.initializeResponsivity.bind(this)),this.subscribe("table-redrawing",this.tableRedraw.bind(this)),this.table.options.responsiveLayout==="collapse"&&(this.subscribe("row-data-changed",this.generateCollapsedRowContent.bind(this)),this.subscribe("row-init",this.initializeRow.bind(this)),this.subscribe("row-layout",this.layoutRow.bind(this))))}tableRedraw(e){["fitColumns","fitDataStretch"].indexOf(this.layoutMode())===-1&&(e||this.update())}initializeResponsivity(){var e=[];this.mode=this.table.options.responsiveLayout,this.collapseFormatter=this.table.options.responsiveLayoutCollapseFormatter||this.formatCollapsedData,this.collapseStartOpen=this.table.options.responsiveLayoutCollapseStartOpen,this.hiddenColumns=[],this.collapseFormatter&&(this.collapseFormatter=this.collapseFormatter.bind(this.table)),this.table.columnManager.columnsByIndex.forEach((t,r)=>{t.modules.responsive&&t.modules.responsive.order&&t.modules.responsive.visible&&(t.modules.responsive.index=r,e.push(t),!t.visible&&this.mode==="collapse"&&this.hiddenColumns.push(t))}),e=e.reverse(),e=e.sort((t,r)=>{var a=r.modules.responsive.order-t.modules.responsive.order;return a||r.modules.responsive.index-t.modules.responsive.index}),this.columns=e,this.mode==="collapse"&&this.generateCollapsedContent();for(let t of this.table.columnManager.columnsByIndex)if(t.definition.formatter=="responsiveCollapse"){this.collapseHandleColumn=t;break}this.collapseHandleColumn&&(this.hiddenColumns.length?this.collapseHandleColumn.show():this.collapseHandleColumn.hide())}initializeColumn(e){var t=e.getDefinition();e.modules.responsive={order:typeof t.responsive>"u"?1:t.responsive,visible:t.visible!==!1}}initializeRow(e){var t;e.type!=="calc"&&(t=document.createElement("div"),t.classList.add("tabulator-responsive-collapse"),e.modules.responsiveLayout={element:t,open:this.collapseStartOpen},this.collapseStartOpen||(t.style.display="none"))}layoutRow(e){var t=e.getElement();e.modules.responsiveLayout&&(t.appendChild(e.modules.responsiveLayout.element),this.generateCollapsedRowContent(e))}updateColumnVisibility(e,t){!t&&e.modules.responsive&&(e.modules.responsive.visible=e.visible,this.initializeResponsivity())}hideColumn(e){var t=this.hiddenColumns.length;e.hide(!1,!0),this.mode==="collapse"&&(this.hiddenColumns.unshift(e),this.generateCollapsedContent(),this.collapseHandleColumn&&!t&&this.collapseHandleColumn.show())}showColumn(e){var t;e.show(!1,!0),e.setWidth(e.getWidth()),this.mode==="collapse"&&(t=this.hiddenColumns.indexOf(e),t>-1&&this.hiddenColumns.splice(t,1),this.generateCollapsedContent(),this.collapseHandleColumn&&!this.hiddenColumns.length&&this.collapseHandleColumn.hide())}update(){for(var e=!0;e;){let t=this.table.modules.layout.getMode()=="fitColumns"?this.table.columnManager.getFlexBaseWidth():this.table.columnManager.getWidth(),r=(this.table.options.headerVisible?this.table.columnManager.element.clientWidth:this.table.element.clientWidth)-t;if(r<0){let a=this.columns[this.index];a?(this.hideColumn(a),this.index++):e=!1}else{let a=this.columns[this.index-1];a&&r>0&&r>=a.getWidth()?(this.showColumn(a),this.index--):e=!1}this.table.rowManager.activeRowsCount||this.table.rowManager.renderEmptyScroll()}}generateCollapsedContent(){var e=this.table.rowManager.getDisplayRows();e.forEach(t=>{this.generateCollapsedRowContent(t)})}generateCollapsedRowContent(e){var t,r;if(e.modules.responsiveLayout){for(t=e.modules.responsiveLayout.element;t.firstChild;)t.removeChild(t.firstChild);r=this.collapseFormatter(this.generateCollapsedRowData(e)),r&&t.appendChild(r),e.calcHeight(!0)}}generateCollapsedRowData(e){var t=e.getData(),r=[],a;return this.hiddenColumns.forEach(s=>{var o=s.getFieldValue(t);if(s.definition.title&&s.field)if(s.modules.format&&this.table.options.responsiveLayoutCollapseUseFormatters){let h=function(d){d()};var u=h;a={value:!1,data:{},getValue:function(){return o},getData:function(){return t},getType:function(){return"cell"},getElement:function(){return document.createElement("div")},getRow:function(){return e.getComponent()},getColumn:function(){return s.getComponent()},getTable:()=>this.table},r.push({field:s.field,title:s.definition.title,value:s.modules.format.formatter.call(this.table.modules.format,a,s.modules.format.params,h)})}else r.push({field:s.field,title:s.definition.title,value:o})}),r}formatCollapsedData(e){var t=document.createElement("table");return e.forEach(r=>{var a=document.createElement("tr"),s=document.createElement("td"),o=document.createElement("td"),u,h=document.createElement("strong");s.appendChild(h),this.modules.localize.bind("columns|"+r.field,function(d){h.innerHTML=d||r.title}),r.value instanceof Node?(u=document.createElement("div"),u.appendChild(r.value),o.appendChild(u)):o.innerHTML=r.value,a.appendChild(s),a.appendChild(o),t.appendChild(a)}),Object.keys(e).length?t:""}}Be(U0,"moduleName","responsiveLayout"),Be(U0,"moduleExtensions",O6);function L6(i,e,t){var r=document.createElement("input"),a=!1;if(r.type="checkbox",r.setAttribute("aria-label","Select Row"),this.table.modExists("selectRow",!0))if(r.addEventListener("click",o=>{o.stopPropagation()}),typeof i.getRow=="function"){var s=i.getRow();s instanceof Eh?(r.addEventListener("change",o=>{this.table.options.selectableRowsRangeMode==="click"&&a?a=!1:s.toggleSelect()}),this.table.options.selectableRowsRangeMode==="click"&&r.addEventListener("click",o=>{a=!0,this.table.modules.selectRow.handleComplexRowClick(s._row,o)}),r.checked=s.isSelected&&s.isSelected(),this.table.modules.selectRow.registerRowSelectCheckbox(s,r)):r=""}else r.addEventListener("change",o=>{this.table.modules.selectRow.selectedRows.length?this.table.deselectRow():this.table.selectRow(e.rowRange)}),this.table.modules.selectRow.registerHeaderSelectCheckbox(r);return r}var N6={format:{formatters:{rowSelection:L6}}};class V0 extends ct{constructor(e){super(e),this.selecting=!1,this.lastClickedRow=!1,this.selectPrev=[],this.selectedRows=[],this.headerCheckboxElement=null,this.registerTableOption("selectableRows","highlight"),this.registerTableOption("selectableRowsRangeMode","drag"),this.registerTableOption("selectableRowsRollingSelection",!0),this.registerTableOption("selectableRowsPersistence",!0),this.registerTableOption("selectableRowsCheck",function(t,r){return!0}),this.registerTableFunction("selectRow",this.selectRows.bind(this)),this.registerTableFunction("deselectRow",this.deselectRows.bind(this)),this.registerTableFunction("toggleSelectRow",this.toggleRow.bind(this)),this.registerTableFunction("getSelectedRows",this.getSelectedRows.bind(this)),this.registerTableFunction("getSelectedData",this.getSelectedData.bind(this)),this.registerComponentFunction("row","select",this.selectRows.bind(this)),this.registerComponentFunction("row","deselect",this.deselectRows.bind(this)),this.registerComponentFunction("row","toggleSelect",this.toggleRow.bind(this)),this.registerComponentFunction("row","isSelected",this.isRowSelected.bind(this))}initialize(){this.deprecatedOptionsCheck(),this.table.options.selectableRows==="highlight"&&this.table.options.selectableRange&&(this.table.options.selectableRows=!1),this.table.options.selectableRows!==!1&&(this.subscribe("row-init",this.initializeRow.bind(this)),this.subscribe("row-deleting",this.rowDeleted.bind(this)),this.subscribe("rows-wipe",this.clearSelectionData.bind(this)),this.subscribe("rows-retrieve",this.rowRetrieve.bind(this)),this.table.options.selectableRows&&!this.table.options.selectableRowsPersistence&&this.subscribe("data-refreshing",this.deselectRows.bind(this)))}deprecatedOptionsCheck(){}rowRetrieve(e,t){return e==="selected"?this.selectedRows:t}rowDeleted(e){this._deselectRow(e,!0)}clearSelectionData(e){var t=this.selectedRows.length;this.selecting=!1,this.lastClickedRow=!1,this.selectPrev=[],this.selectedRows=[],t&&e!==!0&&this._rowSelectionChanged()}initializeRow(e){var t=this,r=t.checkRowSelectability(e),a=e.getElement(),s=function(){setTimeout(function(){t.selecting=!1},50),document.body.removeEventListener("mouseup",s)};e.modules.select={selected:!1},a.classList.toggle("tabulator-selectable",r),a.classList.toggle("tabulator-unselectable",!r),t.checkRowSelectability(e)&&t.table.options.selectableRows&&t.table.options.selectableRows!="highlight"&&(t.table.options.selectableRowsRangeMode==="click"?a.addEventListener("click",this.handleComplexRowClick.bind(this,e)):(a.addEventListener("click",function(o){(!t.table.modExists("edit")||!t.table.modules.edit.getCurrentCell())&&t.table._clearSelection(),t.selecting||t.toggleRow(e)}),a.addEventListener("mousedown",function(o){if(o.shiftKey)return t.table._clearSelection(),t.selecting=!0,t.selectPrev=[],document.body.addEventListener("mouseup",s),document.body.addEventListener("keyup",s),t.toggleRow(e),!1}),a.addEventListener("mouseenter",function(o){t.selecting&&(t.table._clearSelection(),t.toggleRow(e),t.selectPrev[1]==e&&t.toggleRow(t.selectPrev[0]))}),a.addEventListener("mouseout",function(o){t.selecting&&(t.table._clearSelection(),t.selectPrev.unshift(e))})))}handleComplexRowClick(e,t){if(t.shiftKey){this.table._clearSelection(),this.lastClickedRow=this.lastClickedRow||e;var r=this.table.rowManager.getDisplayRowIndex(this.lastClickedRow),a=this.table.rowManager.getDisplayRowIndex(e),s=r<=a?r:a,o=r>=a?r:a,u=this.table.rowManager.getDisplayRows().slice(0),h=u.splice(s,o-s+1);t.ctrlKey||t.metaKey?(h.forEach(d=>{d!==this.lastClickedRow&&(this.table.options.selectableRows!==!0&&!this.isRowSelected(e)?this.selectedRows.length<this.table.options.selectableRows&&this.toggleRow(d):this.toggleRow(d))}),this.lastClickedRow=e):(this.deselectRows(void 0,!0),this.table.options.selectableRows!==!0&&h.length>this.table.options.selectableRows&&(h=h.slice(0,this.table.options.selectableRows)),this.selectRows(h)),this.table._clearSelection()}else t.ctrlKey||t.metaKey?(this.toggleRow(e),this.lastClickedRow=e):(this.deselectRows(void 0,!0),this.selectRows(e),this.lastClickedRow=e)}checkRowSelectability(e){return e&&e.type==="row"?this.table.options.selectableRowsCheck.call(this.table,e.getComponent()):!1}toggleRow(e){this.checkRowSelectability(e)&&(e.modules.select&&e.modules.select.selected?this._deselectRow(e):this._selectRow(e))}selectRows(e){var t=[],r,a;switch(typeof e){case"undefined":r=this.table.rowManager.rows;break;case"number":r=this.table.rowManager.findRow(e);break;case"string":r=this.table.rowManager.findRow(e),r||(r=this.table.rowManager.getRows(e));break;default:r=e;break}Array.isArray(r)?r.length&&(r.forEach(s=>{a=this._selectRow(s,!0,!0),a&&t.push(a)}),this._rowSelectionChanged(!1,t)):r&&this._selectRow(r,!1,!0)}_selectRow(e,t,r){if(!isNaN(this.table.options.selectableRows)&&this.table.options.selectableRows!==!0&&!r&&this.selectedRows.length>=this.table.options.selectableRows)if(this.table.options.selectableRowsRollingSelection)this._deselectRow(this.selectedRows[0]);else return!1;var a=this.table.rowManager.findRow(e);if(a){if(this.selectedRows.indexOf(a)==-1)return a.getElement().classList.add("tabulator-selected"),a.modules.select||(a.modules.select={}),a.modules.select.selected=!0,a.modules.select.checkboxEl&&(a.modules.select.checkboxEl.checked=!0),this.selectedRows.push(a),this.table.options.dataTreeSelectPropagate&&this.childRowSelection(a,!0),this.dispatchExternal("rowSelected",a.getComponent()),this._rowSelectionChanged(t,a),a}else t||console.warn("Selection Error - No such row found, ignoring selection:"+e)}isRowSelected(e){return this.selectedRows.indexOf(e)!==-1}deselectRows(e,t){var r=[],a,s;switch(typeof e){case"undefined":a=Object.assign([],this.selectedRows);break;case"number":a=this.table.rowManager.findRow(e);break;case"string":a=this.table.rowManager.findRow(e),a||(a=this.table.rowManager.getRows(e));break;default:a=e;break}Array.isArray(a)?a.length&&(a.forEach(o=>{s=this._deselectRow(o,!0,!0),s&&r.push(s)}),this._rowSelectionChanged(t,[],r)):a&&this._deselectRow(a,t,!0)}_deselectRow(e,t){var r=this,a=r.table.rowManager.findRow(e),s,o;if(a){if(s=r.selectedRows.findIndex(function(u){return u==a}),s>-1)return o=a.getElement(),o&&o.classList.remove("tabulator-selected"),a.modules.select||(a.modules.select={}),a.modules.select.selected=!1,a.modules.select.checkboxEl&&(a.modules.select.checkboxEl.checked=!1),r.selectedRows.splice(s,1),this.table.options.dataTreeSelectPropagate&&this.childRowSelection(a,!1),this.dispatchExternal("rowDeselected",a.getComponent()),r._rowSelectionChanged(t,void 0,a),a}else t||console.warn("Deselection Error - No such row found, ignoring selection:"+e)}getSelectedData(){var e=[];return this.selectedRows.forEach(function(t){e.push(t.getData())}),e}getSelectedRows(){var e=[];return this.selectedRows.forEach(function(t){e.push(t.getComponent())}),e}_rowSelectionChanged(e,t=[],r=[]){this.headerCheckboxElement&&(this.selectedRows.length===0?(this.headerCheckboxElement.checked=!1,this.headerCheckboxElement.indeterminate=!1):this.table.rowManager.rows.length===this.selectedRows.length?(this.headerCheckboxElement.checked=!0,this.headerCheckboxElement.indeterminate=!1):(this.headerCheckboxElement.indeterminate=!0,this.headerCheckboxElement.checked=!1)),e||(Array.isArray(t)||(t=[t]),t=t.map(a=>a.getComponent()),Array.isArray(r)||(r=[r]),r=r.map(a=>a.getComponent()),this.dispatchExternal("rowSelectionChanged",this.getSelectedData(),this.getSelectedRows(),t,r))}registerRowSelectCheckbox(e,t){e._row.modules.select||(e._row.modules.select={}),e._row.modules.select.checkboxEl=t}registerHeaderSelectCheckbox(e){this.headerCheckboxElement=e}childRowSelection(e,t){var r=this.table.modules.dataTree.getChildren(e,!0,!0);if(t)for(let a of r)this._selectRow(a,!0);else for(let a of r)this._deselectRow(a,!0)}}Be(V0,"moduleName","selectRow"),Be(V0,"moduleExtensions",N6);class B6{constructor(e){return this._range=e,new Proxy(this,{get:function(t,r,a){return typeof t[r]<"u"?t[r]:t._range.table.componentFunctionBinder.handle("range",t._range,r)}})}getElement(){return this._range.element}getData(){return this._range.getData()}getCells(){return this._range.getCells(!0,!0)}getStructuredCells(){return this._range.getStructuredCells()}getRows(){return this._range.getRows().map(e=>e.getComponent())}getColumns(){return this._range.getColumns().map(e=>e.getComponent())}getBounds(){return this._range.getBounds()}getTopEdge(){return this._range.top}getBottomEdge(){return this._range.bottom}getLeftEdge(){return this._range.left}getRightEdge(){return this._range.right}setBounds(e,t){this._range.destroyedGuard("setBounds")&&this._range.setBounds(e&&e._cell,t&&t._cell)}setStartBound(e){this._range.destroyedGuard("setStartBound")&&(this._range.setEndBound(e&&e._cell),this._range.rangeManager.layoutElement())}setEndBound(e){this._range.destroyedGuard("setEndBound")&&(this._range.setEndBound(e&&e._cell),this._range.rangeManager.layoutElement())}clearValues(){this._range.destroyedGuard("clearValues")&&this._range.clearValues()}remove(){this._range.destroyedGuard("remove")&&this._range.destroy(!0)}}class z6 extends zi{constructor(e,t,r,a){super(e),this.rangeManager=t,this.element=null,this.initialized=!1,this.initializing={start:!1,end:!1},this.destroyed=!1,this.top=0,this.bottom=0,this.left=0,this.right=0,this.table=e,this.start={row:0,col:0},this.end={row:0,col:0},this.rangeManager.rowHeader&&(this.left=1,this.right=1,this.start.col=1,this.end.col=1),this.initElement(),setTimeout(()=>{this.initBounds(r,a)})}initElement(){this.element=document.createElement("div"),this.element.classList.add("tabulator-range")}initBounds(e,t){this._updateMinMax(),e&&this.setBounds(e,t||e)}setStart(e,t){(this.start.row!==e||this.start.col!==t)&&(this.start.row=e,this.start.col=t,this.initializing.start=!0,this._updateMinMax())}setEnd(e,t){(this.end.row!==e||this.end.col!==t)&&(this.end.row=e,this.end.col=t,this.initializing.end=!0,this._updateMinMax())}setBounds(e,t,r){e&&this.setStartBound(e),this.setEndBound(t||e),this.rangeManager.layoutElement(r)}setStartBound(e){var t,r;e.type==="column"?this.rangeManager.columnSelection&&this.setStart(0,e.getPosition()-1):(t=e.row.position-1,r=e.column.getPosition()-1,e.column===this.rangeManager.rowHeader?this.setStart(t,1):this.setStart(t,r))}setEndBound(e){var t=this._getTableRows().length,r,a,s;e.type==="column"?this.rangeManager.columnSelection&&(this.rangeManager.selecting==="column"?this.setEnd(t-1,e.getPosition()-1):this.rangeManager.selecting==="cell"&&this.setEnd(0,e.getPosition()-1)):(r=e.row.position-1,a=e.column.getPosition()-1,s=e.column===this.rangeManager.rowHeader,this.rangeManager.selecting==="row"?this.setEnd(r,this._getTableColumns().length-1):this.rangeManager.selecting!=="row"&&s?this.setEnd(r,0):this.rangeManager.selecting==="column"?this.setEnd(t-1,a):this.setEnd(r,a))}_updateMinMax(){this.top=Math.min(this.start.row,this.end.row),this.bottom=Math.max(this.start.row,this.end.row),this.left=Math.min(this.start.col,this.end.col),this.right=Math.max(this.start.col,this.end.col),this.initialized?this.dispatchExternal("rangeChanged",this.getComponent()):this.initializing.start&&this.initializing.end&&(this.initialized=!0,this.dispatchExternal("rangeAdded",this.getComponent()))}_getTableColumns(){return this.table.columnManager.getVisibleColumnsByIndex()}_getTableRows(){return this.table.rowManager.getDisplayRows().filter(e=>e.type==="row")}layout(){var e=this.table.rowManager.renderer.vDomTop,t=this.table.rowManager.renderer.vDomBottom,r=this.table.columnManager.renderer.leftCol,a=this.table.columnManager.renderer.rightCol,s,o,u,h,d,p,b,g,v,y;this.table.options.renderHorizontal==="virtual"&&this.rangeManager.rowHeader&&(a+=1),e==null&&(e=0),t==null&&(t=1/0),r==null&&(r=0),a==null&&(a=1/0),this.overlaps(r,e,a,t)&&(s=Math.max(this.top,e),o=Math.min(this.bottom,t),u=Math.max(this.left,r),h=Math.min(this.right,a),d=this.rangeManager.getCell(s,u),p=this.rangeManager.getCell(o,h),b=d.getElement(),g=p.getElement(),v=d.row.getElement(),y=p.row.getElement(),this.element.classList.add("tabulator-range-active"),this.table.rtl?(this.element.style.right=v.offsetWidth-b.offsetLeft-b.offsetWidth+"px",this.element.style.width=b.offsetLeft+b.offsetWidth-g.offsetLeft+"px"):(this.element.style.left=v.offsetLeft+b.offsetLeft+"px",this.element.style.width=g.offsetLeft+g.offsetWidth-b.offsetLeft+"px"),this.element.style.top=v.offsetTop+"px",this.element.style.height=y.offsetTop+y.offsetHeight-v.offsetTop+"px")}atTopLeft(e){return e.row.position-1===this.top&&e.column.getPosition()-1===this.left}atBottomRight(e){return e.row.position-1===this.bottom&&e.column.getPosition()-1===this.right}occupies(e){return this.occupiesRow(e.row)&&this.occupiesColumn(e.column)}occupiesRow(e){return this.top<=e.position-1&&e.position-1<=this.bottom}occupiesColumn(e){return this.left<=e.getPosition()-1&&e.getPosition()-1<=this.right}overlaps(e,t,r,a){return!(this.left>r||e>this.right||this.top>a||t>this.bottom)}getData(){var e=[],t=this.getRows(),r=this.getColumns();return t.forEach(a=>{var s=a.getData(),o={};r.forEach(u=>{o[u.field]=s[u.field]}),e.push(o)}),e}getCells(e,t){var r=[],a=this.getRows(),s=this.getColumns();return e?r=a.map(o=>{var u=[];return o.getCells().forEach(h=>{s.includes(h.column)&&u.push(t?h.getComponent():h)}),u}):a.forEach(o=>{o.getCells().forEach(u=>{s.includes(u.column)&&r.push(t?u.getComponent():u)})}),r}getStructuredCells(){return this.getCells(!0,!0)}getRows(){return this._getTableRows().slice(this.top,this.bottom+1)}getColumns(){return this._getTableColumns().slice(this.left,this.right+1)}clearValues(){var e=this.getCells(),t=this.table.options.selectableRangeClearCellsValue;this.table.blockRedraw(),e.forEach(r=>{r.setValue(t)}),this.table.restoreRedraw()}getBounds(e){var t=this.getCells(!1,e),r={start:null,end:null};return t.length?(r.start=t[0],r.end=t[t.length-1]):console.warn("No bounds defined on range"),r}getComponent(){return this.component||(this.component=new B6(this)),this.component}destroy(e){this.destroyed=!0,this.element.remove(),e&&this.rangeManager.rangeRemoved(this),this.initialized&&this.dispatchExternal("rangeRemoved",this.getComponent())}destroyedGuard(e){return this.destroyed&&console.warn("You cannot call the "+e+" function on a destroyed range"),!this.destroyed}}var H6={rangeJumpUp:["ctrl + 38","meta + 38"],rangeJumpDown:["ctrl + 40","meta + 40"],rangeJumpLeft:["ctrl + 37","meta + 37"],rangeJumpRight:["ctrl + 39","meta + 39"],rangeExpandUp:"shift + 38",rangeExpandDown:"shift + 40",rangeExpandLeft:"shift + 37",rangeExpandRight:"shift + 39",rangeExpandJumpUp:["ctrl + shift + 38","meta + shift + 38"],rangeExpandJumpDown:["ctrl + shift + 40","meta + shift + 40"],rangeExpandJumpLeft:["ctrl + shift + 37","meta + shift + 37"],rangeExpandJumpRight:["ctrl + shift + 39","meta + shift + 39"]},P6={rangeJumpLeft:function(i){this.dispatch("keybinding-nav-range",i,"left",!0,!1)},rangeJumpRight:function(i){this.dispatch("keybinding-nav-range",i,"right",!0,!1)},rangeJumpUp:function(i){this.dispatch("keybinding-nav-range",i,"up",!0,!1)},rangeJumpDown:function(i){this.dispatch("keybinding-nav-range",i,"down",!0,!1)},rangeExpandLeft:function(i){this.dispatch("keybinding-nav-range",i,"left",!1,!0)},rangeExpandRight:function(i){this.dispatch("keybinding-nav-range",i,"right",!1,!0)},rangeExpandUp:function(i){this.dispatch("keybinding-nav-range",i,"up",!1,!0)},rangeExpandDown:function(i){this.dispatch("keybinding-nav-range",i,"down",!1,!0)},rangeExpandJumpLeft:function(i){this.dispatch("keybinding-nav-range",i,"left",!0,!0)},rangeExpandJumpRight:function(i){this.dispatch("keybinding-nav-range",i,"right",!0,!0)},rangeExpandJumpUp:function(i){this.dispatch("keybinding-nav-range",i,"up",!0,!0)},rangeExpandJumpDown:function(i){this.dispatch("keybinding-nav-range",i,"down",!0,!0)}},I6={range:function(i){var e=[],t=this.table.modules.selectRange.activeRange,r=!1,a,s,o,u,h;return h=i.length,t&&(a=t.getBounds(),s=a.start,a.start===a.end&&(r=!0),s&&(e=this.table.rowManager.activeRows.slice(),o=e.indexOf(s.row),r?u=i.length:u=e.indexOf(a.end.row)-o+1,o>-1&&(this.table.blockRedraw(),e=e.slice(o,o+u),e.forEach((d,p)=>{d.updateData(i[p%h])}),this.table.restoreRedraw()))),e}},U6={range:function(i){var e=[],t=[],r=this.table.modules.selectRange.activeRange,a=!1,s,o,u,h,d;return r&&(s=r.getBounds(),o=s.start,s.start===s.end&&(a=!0),o&&(i=i.split(`
`),i.forEach(function(p){e.push(p.split("	"))}),e.length&&(h=this.table.columnManager.getVisibleColumnsByIndex(),d=h.indexOf(o.column),d>-1)))?(a?u=e[0].length:u=h.indexOf(s.end.column)-d+1,h=h.slice(d,d+u),e.forEach(p=>{var b={},g=p.length;h.forEach(function(v,y){b[v.field]=p[y%g]}),t.push(b)}),t):!1}},V6={range:function(){var i=this.modules.selectRange.selectedColumns();return this.columnManager.rowHeader&&i.unshift(this.columnManager.rowHeader),i}},G6={range:function(){return this.modules.selectRange.selectedRows()}},W6={keybindings:{bindings:H6,actions:P6},clipboard:{pasteActions:I6,pasteParsers:U6},export:{columnLookups:V6,rowLookups:G6}};class Hc extends ct{constructor(e){super(e),this.selecting="cell",this.mousedown=!1,this.ranges=[],this.overlay=null,this.rowHeader=null,this.layoutChangeTimeout=null,this.columnSelection=!1,this.rowSelection=!1,this.maxRanges=0,this.activeRange=!1,this.blockKeydown=!1,this.keyDownEvent=this._handleKeyDown.bind(this),this.mouseUpEvent=this._handleMouseUp.bind(this),this.registerTableOption("selectableRange",!1),this.registerTableOption("selectableRangeColumns",!1),this.registerTableOption("selectableRangeRows",!1),this.registerTableOption("selectableRangeClearCells",!1),this.registerTableOption("selectableRangeClearCellsValue",void 0),this.registerTableOption("selectableRangeAutoFocus",!0),this.registerTableFunction("getRangesData",this.getRangesData.bind(this)),this.registerTableFunction("getRanges",this.getRanges.bind(this)),this.registerTableFunction("addRange",this.addRangeFromComponent.bind(this)),this.registerComponentFunction("cell","getRanges",this.cellGetRanges.bind(this)),this.registerComponentFunction("row","getRanges",this.rowGetRanges.bind(this)),this.registerComponentFunction("column","getRanges",this.colGetRanges.bind(this))}initialize(){this.options("selectableRange")&&(this.options("selectableRows")?console.warn("SelectRange functionality cannot be used in conjunction with row selection"):(this.maxRanges=this.options("selectableRange"),this.initializeTable(),this.initializeWatchers()),this.options("columns").findIndex(e=>e.frozen)>0&&console.warn("Having frozen column in arbitrary position with selectRange option may result in unpredictable behavior."),this.options("columns").filter(e=>e.frozen)>1&&console.warn("Having multiple frozen columns with selectRange option may result in unpredictable behavior."))}initializeTable(){this.overlay=document.createElement("div"),this.overlay.classList.add("tabulator-range-overlay"),this.rangeContainer=document.createElement("div"),this.rangeContainer.classList.add("tabulator-range-container"),this.activeRangeCellElement=document.createElement("div"),this.activeRangeCellElement.classList.add("tabulator-range-cell-active"),this.overlay.appendChild(this.rangeContainer),this.overlay.appendChild(this.activeRangeCellElement),this.table.rowManager.element.addEventListener("keydown",this.keyDownEvent),this.resetRanges(),this.table.rowManager.element.appendChild(this.overlay),this.table.columnManager.element.setAttribute("tabindex",0),this.table.element.classList.add("tabulator-ranges")}initializeWatchers(){this.columnSelection=this.options("selectableRangeColumns"),this.rowSelection=this.options("selectableRangeRows"),this.subscribe("column-init",this.initializeColumn.bind(this)),this.subscribe("column-mousedown",this.handleColumnMouseDown.bind(this)),this.subscribe("column-mousemove",this.handleColumnMouseMove.bind(this)),this.subscribe("column-resized",this.handleColumnResized.bind(this)),this.subscribe("column-moving",this.handleColumnMoving.bind(this)),this.subscribe("column-moved",this.handleColumnMoved.bind(this)),this.subscribe("column-width",this.layoutChange.bind(this)),this.subscribe("column-height",this.layoutChange.bind(this)),this.subscribe("column-resized",this.layoutChange.bind(this)),this.subscribe("columns-loaded",this.updateHeaderColumn.bind(this)),this.subscribe("cell-height",this.layoutChange.bind(this)),this.subscribe("cell-rendered",this.renderCell.bind(this)),this.subscribe("cell-mousedown",this.handleCellMouseDown.bind(this)),this.subscribe("cell-mousemove",this.handleCellMouseMove.bind(this)),this.subscribe("cell-click",this.handleCellClick.bind(this)),this.subscribe("cell-editing",this.handleEditingCell.bind(this)),this.subscribe("page-changed",this.redraw.bind(this)),this.subscribe("scroll-vertical",this.layoutChange.bind(this)),this.subscribe("scroll-horizontal",this.layoutChange.bind(this)),this.subscribe("data-destroy",this.tableDestroyed.bind(this)),this.subscribe("data-processed",this.resetRanges.bind(this)),this.subscribe("table-layout",this.layoutElement.bind(this)),this.subscribe("table-redraw",this.redraw.bind(this)),this.subscribe("table-destroy",this.tableDestroyed.bind(this)),this.subscribe("edit-editor-clear",this.finishEditingCell.bind(this)),this.subscribe("edit-blur",this.restoreFocus.bind(this)),this.subscribe("keybinding-nav-prev",this.keyNavigate.bind(this,"left")),this.subscribe("keybinding-nav-next",this.keyNavigate.bind(this,"right")),this.subscribe("keybinding-nav-left",this.keyNavigate.bind(this,"left")),this.subscribe("keybinding-nav-right",this.keyNavigate.bind(this,"right")),this.subscribe("keybinding-nav-up",this.keyNavigate.bind(this,"up")),this.subscribe("keybinding-nav-down",this.keyNavigate.bind(this,"down")),this.subscribe("keybinding-nav-range",this.keyNavigateRange.bind(this))}initializeColumn(e){this.columnSelection&&e.definition.headerSort&&this.options("headerSortClickElement")!=="icon"&&console.warn("Using column headerSort with selectableRangeColumns option may result in unpredictable behavior. Consider using headerSortClickElement: 'icon'."),e.modules.edit}updateHeaderColumn(){var e;this.rowSelection&&(this.rowHeader=this.table.columnManager.getVisibleColumnsByIndex()[0],this.rowHeader&&(this.rowHeader.definition.cssClass=this.rowHeader.definition.cssClass+" tabulator-range-row-header",this.rowHeader.definition.headerSort&&console.warn("Using column headerSort with selectableRangeRows option may result in unpredictable behavior"),this.rowHeader.definition.editor&&console.warn("Using column editor with selectableRangeRows option may result in unpredictable behavior"))),this.table.modules.frozenColumns&&this.table.modules.frozenColumns.active&&(e=this.table.modules.frozenColumns.getFrozenColumns(),(e.length>1||e.length===1&&e[0]!==this.rowHeader)&&console.warn("Using frozen columns that are not the range header in combination with the selectRange option may result in unpredictable behavior"))}getRanges(){return this.ranges.map(e=>e.getComponent())}getRangesData(){return this.ranges.map(e=>e.getData())}addRangeFromComponent(e,t){return e=e?e._cell:null,t=t?t._cell:null,this.addRange(e,t)}cellGetRanges(e){var t=[];return e.column===this.rowHeader?t=this.ranges.filter(r=>r.occupiesRow(e.row)):t=this.ranges.filter(r=>r.occupies(e)),t.map(r=>r.getComponent())}rowGetRanges(e){var t=this.ranges.filter(r=>r.occupiesRow(e));return t.map(r=>r.getComponent())}colGetRanges(e){var t=this.ranges.filter(r=>r.occupiesColumn(e));return t.map(r=>r.getComponent())}_handleMouseUp(e){this.mousedown=!1,document.removeEventListener("mouseup",this.mouseUpEvent)}_handleKeyDown(e){if(!this.blockKeydown&&(!this.table.modules.edit||this.table.modules.edit&&!this.table.modules.edit.currentCell)){if(e.key==="Enter"){if(this.table.modules.edit&&this.table.modules.edit.currentCell)return;this.table.modules.edit.editCell(this.getActiveCell()),e.preventDefault()}(e.key==="Backspace"||e.key==="Delete")&&this.options("selectableRangeClearCells")&&this.activeRange&&this.activeRange.clearValues()}}initializeFocus(e){var t;this.restoreFocus();try{document.selection?(t=document.body.createTextRange(),t.moveToElementText(e.getElement()),t.select()):window.getSelection&&(t=document.createRange(),t.selectNode(e.getElement()),window.getSelection().removeAllRanges(),window.getSelection().addRange(t))}catch{}}restoreFocus(e){return this.table.rowManager.element.focus(),!0}handleColumnResized(e){var t;this.selecting!=="column"&&this.selecting!=="all"||(t=this.ranges.some(r=>r.occupiesColumn(e)),t&&this.ranges.forEach(r=>{var a=r.getColumns(!0);a.forEach(s=>{s!==e&&s.setWidth(e.width)})}))}handleColumnMoving(e,t){this.resetRanges().setBounds(t),this.overlay.style.visibility="hidden"}handleColumnMoved(e,t,r){this.activeRange.setBounds(e),this.layoutElement()}handleColumnMouseDown(e,t){e.button===2&&(this.selecting==="column"||this.selecting==="all")&&this.activeRange.occupiesColumn(t)||this.table.options.movableColumns&&this.selecting==="column"&&this.activeRange.occupiesColumn(t)||(this.mousedown=!0,document.addEventListener("mouseup",this.mouseUpEvent),this.newSelection(e,t))}handleColumnMouseMove(e,t){t===this.rowHeader||!this.mousedown||this.selecting==="all"||this.activeRange.setBounds(!1,t,!0)}renderCell(e){var t=e.getElement(),r=this.ranges.findIndex(a=>a.occupies(e));t.classList.toggle("tabulator-range-selected",r!==-1),t.classList.toggle("tabulator-range-only-cell-selected",this.ranges.length===1&&this.ranges[0].atTopLeft(e)&&this.ranges[0].atBottomRight(e)),t.dataset.range=r}handleCellMouseDown(e,t){e.button===2&&(this.activeRange.occupies(t)||(this.selecting==="row"||this.selecting==="all")&&this.activeRange.occupiesRow(t.row))||(this.mousedown=!0,document.addEventListener("mouseup",this.mouseUpEvent),this.newSelection(e,t))}handleCellMouseMove(e,t){!this.mousedown||this.selecting==="all"||this.activeRange.setBounds(!1,t,!0)}handleCellClick(e,t){this.initializeFocus(t)}handleEditingCell(e){this.activeRange&&this.activeRange.setBounds(e)}finishEditingCell(){this.blockKeydown=!0,this.table.rowManager.element.focus(),setTimeout(()=>{this.blockKeydown=!1},10)}keyNavigate(e,t){this.navigate(!1,!1,e),t.preventDefault()}keyNavigateRange(e,t,r,a){this.navigate(r,a,t),e.preventDefault()}navigate(e,t,r){var a=!1,s,o,u,h,d,p,b,g,v,y,C;if(this.table.modules.edit&&this.table.modules.edit.currentCell)return!1;if(this.ranges.length>1&&(this.ranges=this.ranges.filter(E=>E===this.activeRange?(E.setEnd(E.start.row,E.start.col),!0):(E.destroy(),!1))),s=this.activeRange,u={top:s.top,bottom:s.bottom,left:s.left,right:s.right},o=t?s.end:s.start,h=o.row,d=o.col,e)switch(r){case"left":d=this.findJumpCellLeft(s.start.row,o.col);break;case"right":d=this.findJumpCellRight(s.start.row,o.col);break;case"up":h=this.findJumpCellUp(o.row,s.start.col);break;case"down":h=this.findJumpCellDown(o.row,s.start.col);break}else{if(t&&(this.selecting==="row"&&(r==="left"||r==="right")||this.selecting==="column"&&(r==="up"||r==="down")))return;switch(r){case"left":d=Math.max(d-1,0);break;case"right":d=Math.min(d+1,this.getTableColumns().length-1);break;case"up":h=Math.max(h-1,0);break;case"down":h=Math.min(h+1,this.getTableRows().length-1);break}}if(this.rowHeader&&d===0&&(d=1),t||s.setStart(h,d),s.setEnd(h,d),t||(this.selecting="cell"),a=u.top!==s.top||u.bottom!==s.bottom||u.left!==s.left||u.right!==s.right,a)return p=this.getRowByRangePos(s.end.row),b=this.getColumnByRangePos(s.end.col),g=p.getElement().getBoundingClientRect(),y=b.getElement().getBoundingClientRect(),v=this.table.rowManager.getElement().getBoundingClientRect(),C=this.table.columnManager.getElement().getBoundingClientRect(),g.top>=v.top&&g.bottom<=v.bottom||(p.getElement().parentNode&&b.getElement().parentNode?this.autoScroll(s,p.getElement(),b.getElement()):p.getComponent().scrollTo(void 0,!1)),y.left>=C.left+this.getRowHeaderWidth()&&y.right<=C.right||(p.getElement().parentNode&&b.getElement().parentNode?this.autoScroll(s,p.getElement(),b.getElement()):b.getComponent().scrollTo(void 0,!1)),this.layoutElement(),!0}rangeRemoved(e){this.ranges=this.ranges.filter(t=>t!==e),this.activeRange===e&&(this.ranges.length?this.activeRange=this.ranges[this.ranges.length-1]:this.addRange()),this.layoutElement()}findJumpRow(e,t,r,a,s){return r&&(t=t.reverse()),this.findJumpItem(a,s,t,function(o){return o.getData()[e.getField()]})}findJumpCol(e,t,r,a,s){return r&&(t=t.reverse()),this.findJumpItem(a,s,t,function(o){return e.getData()[o.getField()]})}findJumpItem(e,t,r,a){var s;for(let o of r){let u=a(o);if(e){if(s=o,u)break}else if(t){if(s=o,u)break}else if(u)s=o;else break}return s}findJumpCellLeft(e,t){var r=this.getRowByRangePos(e),a=this.getTableColumns(),s=this.isEmpty(r.getData()[a[t].getField()]),o=a[t-1]?this.isEmpty(r.getData()[a[t-1].getField()]):!1,u=this.rowHeader?a.slice(1,t):a.slice(0,t),h=this.findJumpCol(r,u,!0,s,o);return h?h.getPosition()-1:t}findJumpCellRight(e,t){var r=this.getRowByRangePos(e),a=this.getTableColumns(),s=this.isEmpty(r.getData()[a[t].getField()]),o=a[t+1]?this.isEmpty(r.getData()[a[t+1].getField()]):!1,u=this.findJumpCol(r,a.slice(t+1,a.length),!1,s,o);return u?u.getPosition()-1:t}findJumpCellUp(e,t){var r=this.getColumnByRangePos(t),a=this.getTableRows(),s=this.isEmpty(a[e].getData()[r.getField()]),o=a[e-1]?this.isEmpty(a[e-1].getData()[r.getField()]):!1,u=this.findJumpRow(r,a.slice(0,e),!0,s,o);return u?u.position-1:e}findJumpCellDown(e,t){var r=this.getColumnByRangePos(t),a=this.getTableRows(),s=this.isEmpty(a[e].getData()[r.getField()]),o=a[e+1]?this.isEmpty(a[e+1].getData()[r.getField()]):!1,u=this.findJumpRow(r,a.slice(e+1,a.length),!1,s,o);return u?u.position-1:e}newSelection(e,t){var r;if(t.type==="column"){if(!this.columnSelection)return;if(t===this.rowHeader){r=this.resetRanges(),this.selecting="all";var a,s=this.getCell(-1,-1);this.rowHeader?a=this.getCell(0,1):a=this.getCell(0,0),r.setBounds(a,s);return}else this.selecting="column"}else t.column===this.rowHeader?this.selecting="row":this.selecting="cell";e.shiftKey?this.activeRange.setBounds(!1,t):e.ctrlKey?this.addRange().setBounds(t):this.resetRanges().setBounds(t)}autoScroll(e,t,r){var a=this.table.rowManager.element,s,o,u,h;typeof t>"u"&&(t=this.getRowByRangePos(e.end.row).getElement()),typeof r>"u"&&(r=this.getColumnByRangePos(e.end.col).getElement()),s={left:r.offsetLeft,right:r.offsetLeft+r.offsetWidth,top:t.offsetTop,bottom:t.offsetTop+t.offsetHeight},o={left:a.scrollLeft+this.getRowHeaderWidth(),right:Math.ceil(a.scrollLeft+a.clientWidth),top:a.scrollTop,bottom:a.scrollTop+a.offsetHeight-this.table.rowManager.scrollbarWidth},u=o.left<s.left&&s.left<o.right&&o.left<s.right&&s.right<o.right,h=o.top<s.top&&s.top<o.bottom&&o.top<s.bottom&&s.bottom<o.bottom,u||(s.left<o.left?a.scrollLeft=s.left-this.getRowHeaderWidth():s.right>o.right&&(a.scrollLeft=Math.min(s.right-a.clientWidth,s.left-this.getRowHeaderWidth()))),h||(s.top<o.top?a.scrollTop=s.top:s.bottom>o.bottom&&(a.scrollTop=s.bottom-a.clientHeight))}layoutChange(){this.overlay.style.visibility="hidden",clearTimeout(this.layoutChangeTimeout),this.layoutChangeTimeout=setTimeout(this.layoutRanges.bind(this),200)}redraw(e){e&&(this.selecting="cell",this.resetRanges(),this.layoutElement())}layoutElement(e){var t;e?t=this.table.rowManager.getVisibleRows(!0):t=this.table.rowManager.getRows(),t.forEach(r=>{r.type==="row"&&(this.layoutRow(r),r.cells.forEach(a=>this.renderCell(a)))}),this.getTableColumns().forEach(r=>{this.layoutColumn(r)}),this.layoutRanges()}layoutRow(e){var t=e.getElement(),r=!1,a=this.ranges.some(s=>s.occupiesRow(e));this.selecting==="row"?r=a:this.selecting==="all"&&(r=!0),t.classList.toggle("tabulator-range-selected",r),t.classList.toggle("tabulator-range-highlight",a)}layoutColumn(e){var t=e.getElement(),r=!1,a=this.ranges.some(s=>s.occupiesColumn(e));this.selecting==="column"?r=a:this.selecting==="all"&&(r=!0),t.classList.toggle("tabulator-range-selected",r),t.classList.toggle("tabulator-range-highlight",a)}layoutRanges(){var e,t,r;this.table.initialized&&(e=this.getActiveCell(),e&&(t=e.getElement(),r=e.row.getElement(),this.table.rtl?this.activeRangeCellElement.style.right=r.offsetWidth-t.offsetLeft-t.offsetWidth+"px":this.activeRangeCellElement.style.left=r.offsetLeft+t.offsetLeft+"px",this.activeRangeCellElement.style.top=r.offsetTop+"px",this.activeRangeCellElement.style.width=t.offsetWidth+"px",this.activeRangeCellElement.style.height=r.offsetHeight+"px",this.ranges.forEach(a=>a.layout()),this.overlay.style.visibility="visible"))}getCell(e,t){var r;return t<0&&(t=this.getTableColumns().length+t,t<0)?null:(e<0&&(e=this.getTableRows().length+e),r=this.table.rowManager.getRowFromPosition(e+1),r?r.getCells(!1,!0).filter(a=>a.column.visible)[t]:null)}getActiveCell(){return this.getCell(this.activeRange.start.row,this.activeRange.start.col)}getRowByRangePos(e){return this.getTableRows()[e]}getColumnByRangePos(e){return this.getTableColumns()[e]}getTableRows(){return this.table.rowManager.getDisplayRows().filter(e=>e.type==="row")}getTableColumns(){return this.table.columnManager.getVisibleColumnsByIndex()}addRange(e,t){var r;return this.maxRanges!==!0&&this.ranges.length>=this.maxRanges&&this.ranges.shift().destroy(),r=new z6(this.table,this,e,t),this.activeRange=r,this.ranges.push(r),this.rangeContainer.appendChild(r.element),r}resetRanges(){var e,t,r;return this.ranges.forEach(a=>a.destroy()),this.ranges=[],e=this.addRange(),this.table.rowManager.activeRows.length&&(r=this.table.rowManager.activeRows[0].cells.filter(a=>a.column.visible),t=r[this.rowHeader?1:0],t&&(e.setBounds(t),this.options("selectableRangeAutoFocus")&&this.initializeFocus(t))),e}tableDestroyed(){document.removeEventListener("mouseup",this.mouseUpEvent),this.table.rowManager.element.removeEventListener("keydown",this.keyDownEvent)}selectedRows(e){return e?this.activeRange.getRows().map(t=>t.getComponent()):this.activeRange.getRows()}selectedColumns(e){return e?this.activeRange.getColumns().map(t=>t.getComponent()):this.activeRange.getColumns()}getRowHeaderWidth(){return this.rowHeader?this.rowHeader.getElement().offsetWidth:0}isEmpty(e){return e==null||e===""}}Be(Hc,"moduleName","selectRange"),Be(Hc,"moduleInitOrder",1),Be(Hc,"moduleExtensions",W6);function j6(i,e,t,r,a,s,o){var u=o.alignEmptyValues,h=o.decimalSeparator,d=o.thousandSeparator,p=0;if(i=String(i),e=String(e),d&&(i=i.split(d).join(""),e=e.split(d).join("")),h&&(i=i.split(h).join("."),e=e.split(h).join(".")),i=parseFloat(i),e=parseFloat(e),isNaN(i))p=isNaN(e)?0:-1;else if(isNaN(e))p=1;else return i-e;return(u==="top"&&s==="desc"||u==="bottom"&&s==="asc")&&(p*=-1),p}function X6(i,e,t,r,a,s,o){var u=o.alignEmptyValues,h=0,d;if(!i)h=e?-1:0;else if(!e)h=1;else{switch(typeof o.locale){case"boolean":o.locale&&(d=this.langLocale());break;case"string":d=o.locale;break}return String(i).toLowerCase().localeCompare(String(e).toLowerCase(),d)}return(u==="top"&&s==="desc"||u==="bottom"&&s==="asc")&&(h*=-1),h}function Mp(i,e,t,r,a,s,o){var u=this.table.dependencyRegistry.lookup(["luxon","DateTime"],"DateTime"),h=o.format||"dd/MM/yyyy HH:mm:ss",d=o.alignEmptyValues,p=0;if(typeof u<"u"){if(u.isDateTime(i)||(h==="iso"?i=u.fromISO(String(i)):i=u.fromFormat(String(i),h)),u.isDateTime(e)||(h==="iso"?e=u.fromISO(String(e)):e=u.fromFormat(String(e),h)),!i.isValid)p=e.isValid?-1:0;else if(!e.isValid)p=1;else return i-e;return(d==="top"&&s==="desc"||d==="bottom"&&s==="asc")&&(p*=-1),p}else console.error("Sort Error - 'datetime' sorter is dependant on luxon.js")}function Y6(i,e,t,r,a,s,o){return o.format||(o.format="dd/MM/yyyy"),Mp.call(this,i,e,t,r,a,s,o)}function q6(i,e,t,r,a,s,o){return o.format||(o.format="HH:mm"),Mp.call(this,i,e,t,r,a,s,o)}function K6(i,e,t,r,a,s,o){var u=i===!0||i==="true"||i==="True"||i===1?1:0,h=e===!0||e==="true"||e==="True"||e===1?1:0;return u-h}function $6(i,e,t,r,a,s,o){var u=o.type||"length",h=o.alignEmptyValues,d=0,p=this.table,b;o.valueMap&&(typeof o.valueMap=="string"?b=function(v){return v.map(y=>Wt.retrieveNestedData(p.options.nestedFieldSeparator,o.valueMap,y))}:b=o.valueMap);function g(v){var y;switch(b&&(v=b(v)),u){case"length":y=v.length;break;case"sum":y=v.reduce(function(C,E){return C+E});break;case"max":y=Math.max.apply(null,v);break;case"min":y=Math.min.apply(null,v);break;case"avg":y=v.reduce(function(C,E){return C+E})/v.length;break;case"string":y=v.join("");break}return y}if(!Array.isArray(i))d=Array.isArray(e)?-1:0;else if(!Array.isArray(e))d=1;else return u==="string"?String(g(i)).toLowerCase().localeCompare(String(g(e)).toLowerCase()):g(e)-g(i);return(h==="top"&&s==="desc"||h==="bottom"&&s==="asc")&&(d*=-1),d}function Z6(i,e,t,r,a,s,o){var u=typeof i>"u"?0:1,h=typeof e>"u"?0:1;return u-h}function Q6(i,e,t,r,a,s,o){var u,h,d,p,b=0,g,v=/(\d+)|(\D+)/g,y=/\d/,C=o.alignEmptyValues,E=0;if(!i&&i!==0)E=!e&&e!==0?0:-1;else if(!e&&e!==0)E=1;else{if(isFinite(i)&&isFinite(e))return i-e;if(u=String(i).toLowerCase(),h=String(e).toLowerCase(),u===h)return 0;if(!(y.test(u)&&y.test(h)))return u>h?1:-1;for(u=u.match(v),h=h.match(v),g=u.length>h.length?h.length:u.length;b<g;)if(d=u[b],p=h[b++],d!==p)return isFinite(d)&&isFinite(p)?(d.charAt(0)==="0"&&(d="."+d),p.charAt(0)==="0"&&(p="."+p),d-p):d>p?1:-1;return u.length>h.length}return(C==="top"&&s==="desc"||C==="bottom"&&s==="asc")&&(E*=-1),E}var J6={number:j6,string:X6,date:Y6,time:q6,datetime:Mp,boolean:K6,array:$6,exists:Z6,alphanum:Q6};const ss=class ss extends ct{constructor(e){super(e),this.sortList=[],this.changed=!1,this.registerTableOption("sortMode","local"),this.registerTableOption("initialSort",!1),this.registerTableOption("columnHeaderSortMulti",!0),this.registerTableOption("sortOrderReverse",!1),this.registerTableOption("headerSortElement","<div class='tabulator-arrow'></div>"),this.registerTableOption("headerSortClickElement","header"),this.registerColumnOption("sorter"),this.registerColumnOption("sorterParams"),this.registerColumnOption("headerSort",!0),this.registerColumnOption("headerSortStartingDir"),this.registerColumnOption("headerSortTristate")}initialize(){this.subscribe("column-layout",this.initializeColumn.bind(this)),this.subscribe("table-built",this.tableBuilt.bind(this)),this.registerDataHandler(this.sort.bind(this),20),this.registerTableFunction("setSort",this.userSetSort.bind(this)),this.registerTableFunction("getSorters",this.getSort.bind(this)),this.registerTableFunction("clearSort",this.clearSort.bind(this)),this.table.options.sortMode==="remote"&&this.subscribe("data-params",this.remoteSortParams.bind(this))}tableBuilt(){this.table.options.initialSort&&this.setSort(this.table.options.initialSort)}remoteSortParams(e,t,r,a){var s=this.getSort();return s.forEach(o=>{delete o.column}),a.sort=s,a}userSetSort(e,t){this.setSort(e,t),this.refreshSort()}clearSort(){this.clear(),this.refreshSort()}initializeColumn(e){var t=!1,r,a;switch(typeof e.definition.sorter){case"string":ss.sorters[e.definition.sorter]?t=ss.sorters[e.definition.sorter]:console.warn("Sort Error - No such sorter found: ",e.definition.sorter);break;case"function":t=e.definition.sorter;break}if(e.modules.sort={sorter:t,dir:"none",params:e.definition.sorterParams||{},startingDir:e.definition.headerSortStartingDir||"asc",tristate:e.definition.headerSortTristate},e.definition.headerSort!==!1){switch(r=e.getElement(),r.classList.add("tabulator-sortable"),a=document.createElement("div"),a.classList.add("tabulator-col-sorter"),this.table.options.headerSortClickElement){case"icon":a.classList.add("tabulator-col-sorter-element");break;case"header":r.classList.add("tabulator-col-sorter-element");break;default:r.classList.add("tabulator-col-sorter-element");break}switch(this.table.options.headerSortElement){case"function":break;case"object":a.appendChild(this.table.options.headerSortElement);break;default:a.innerHTML=this.table.options.headerSortElement}e.titleHolderElement.appendChild(a),e.modules.sort.element=a,this.setColumnHeaderSortIcon(e,"none"),this.table.options.headerSortClickElement==="icon"&&a.addEventListener("mousedown",s=>{s.stopPropagation()}),(this.table.options.headerSortClickElement==="icon"?a:r).addEventListener("click",s=>{var o="",u=[],h=!1;if(e.modules.sort){if(e.modules.sort.tristate)e.modules.sort.dir=="none"?o=e.modules.sort.startingDir:e.modules.sort.dir==e.modules.sort.startingDir?o=e.modules.sort.dir=="asc"?"desc":"asc":o="none";else switch(e.modules.sort.dir){case"asc":o="desc";break;case"desc":o="asc";break;default:o=e.modules.sort.startingDir}this.table.options.columnHeaderSortMulti&&(s.shiftKey||s.ctrlKey)?(u=this.getSort(),h=u.findIndex(d=>d.field===e.getField()),h>-1?(u[h].dir=o,h=u.splice(h,1)[0],o!="none"&&u.push(h)):o!="none"&&u.push({column:e,dir:o}),this.setSort(u)):o=="none"?this.clear():this.setSort(e,o),this.refreshSort()}})}}refreshSort(){this.table.options.sortMode==="remote"?this.reloadData(null,!1,!1):this.refreshData(!0)}hasChanged(){var e=this.changed;return this.changed=!1,e}getSort(){var e=this,t=[];return e.sortList.forEach(function(r){r.column&&t.push({column:r.column.getComponent(),field:r.column.getField(),dir:r.dir})}),t}setSort(e,t){var r=this,a=[];Array.isArray(e)||(e=[{column:e,dir:t}]),e.forEach(function(s){var o;o=r.table.columnManager.findColumn(s.column),o?(s.column=o,a.push(s),r.changed=!0):console.warn("Sort Warning - Sort field does not exist and is being ignored: ",s.column)}),r.sortList=a,this.dispatch("sort-changed")}clear(){this.setSort([])}findSorter(e){var t=this.table.rowManager.activeRows[0],r="string",a,s;if(t&&(t=t.getData(),a=e.getField(),a))switch(s=e.getFieldValue(t),typeof s){case"undefined":r="string";break;case"boolean":r="boolean";break;default:!isNaN(s)&&s!==""?r="number":s.match(/((^[0-9]+[a-z]+)|(^[a-z]+[0-9]+))+$/i)&&(r="alphanum");break}return ss.sorters[r]}sort(e,t){var r=this,a=this.table.options.sortOrderReverse?r.sortList.slice().reverse():r.sortList,s=[],o=[];return this.subscribedExternal("dataSorting")&&this.dispatchExternal("dataSorting",r.getSort()),t||r.clearColumnHeaders(),this.table.options.sortMode!=="remote"?(a.forEach(function(u,h){var d;u.column&&(d=u.column.modules.sort,d&&(d.sorter||(d.sorter=r.findSorter(u.column)),u.params=typeof d.params=="function"?d.params(u.column.getComponent(),u.dir):d.params,s.push(u)),t||r.setColumnHeader(u.column,u.dir))}),s.length&&r._sortItems(e,s)):t||a.forEach(function(u,h){r.setColumnHeader(u.column,u.dir)}),this.subscribedExternal("dataSorted")&&(e.forEach(u=>{o.push(u.getComponent())}),this.dispatchExternal("dataSorted",r.getSort(),o)),e}clearColumnHeaders(){this.table.columnManager.getRealColumns().forEach(e=>{e.modules.sort&&(e.modules.sort.dir="none",e.getElement().setAttribute("aria-sort","none"),this.setColumnHeaderSortIcon(e,"none"))})}setColumnHeader(e,t){e.modules.sort.dir=t,e.getElement().setAttribute("aria-sort",t==="asc"?"ascending":"descending"),this.setColumnHeaderSortIcon(e,t)}setColumnHeaderSortIcon(e,t){var r=e.modules.sort.element,a;if(e.definition.headerSort&&typeof this.table.options.headerSortElement=="function"){for(;r.firstChild;)r.removeChild(r.firstChild);a=this.table.options.headerSortElement.call(this.table,e.getComponent(),t),typeof a=="object"?r.appendChild(a):r.innerHTML=a}}_sortItems(e,t){var r=t.length-1;e.sort((a,s)=>{for(var o,u=r;u>=0;u--){let h=t[u];if(o=this._sortRow(a,s,h.column,h.dir,h.params),o!==0)break}return o})}_sortRow(e,t,r,a,s){var o,u,h=a=="asc"?e:t,d=a=="asc"?t:e;return e=r.getFieldValue(h.getData()),t=r.getFieldValue(d.getData()),e=typeof e<"u"?e:"",t=typeof t<"u"?t:"",o=h.getComponent(),u=d.getComponent(),r.modules.sort.sorter.call(this,e,t,o,u,r.getComponent(),a,s)}};Be(ss,"moduleName","sort"),Be(ss,"sorters",J6);let G0=ss;class e8{constructor(e,t){this.columnCount=e,this.rowCount=t,this.columnString=[],this.columns=[],this.rows=[]}genColumns(e){var t=Math.max(this.columnCount,Math.max(...e.map(r=>r.length)));this.columnString=[],this.columns=[];for(let r=1;r<=t;r++)this.incrementChar(this.columnString.length-1),this.columns.push(this.columnString.join(""));return this.columns}genRows(e){var t=Math.max(this.rowCount,e.length);this.rows=[];for(let r=1;r<=t;r++)this.rows.push(r);return this.rows}incrementChar(e){let t=this.columnString[e];t?t!=="Z"?this.columnString[e]=String.fromCharCode(this.columnString[e].charCodeAt(0)+1):(this.columnString[e]="A",e?this.incrementChar(e-1):this.columnString.push("A")):this.columnString.push("A")}setRowCount(e){this.rowCount=e}setColumnCount(e){this.columnCount=e}}class Wy{constructor(e){return this._sheet=e,new Proxy(this,{get:function(t,r,a){return typeof t[r]<"u"?t[r]:t._sheet.table.componentFunctionBinder.handle("sheet",t._sheet,r)}})}getTitle(){return this._sheet.title}getKey(){return this._sheet.key}getDefinition(){return this._sheet.getDefinition()}getData(){return this._sheet.getData()}setData(e){return this._sheet.setData(e)}clear(){return this._sheet.clear()}remove(){return this._sheet.remove()}active(){return this._sheet.active()}setTitle(e){return this._sheet.setTitle(e)}setRows(e){return this._sheet.setRows(e)}setColumns(e){return this._sheet.setColumns(e)}}class Zb extends zi{constructor(e,t){super(e.table),this.spreadsheetManager=e,this.definition=t,this.title=this.definition.title||"",this.key=this.definition.key||this.definition.title,this.rowCount=this.definition.rows,this.columnCount=this.definition.columns,this.data=this.definition.data||[],this.element=null,this.isActive=!1,this.grid=new e8(this.columnCount,this.rowCount),this.defaultColumnDefinition={width:100,headerHozAlign:"center",headerSort:!1},this.columnDefinition=Object.assign(this.defaultColumnDefinition,this.options("spreadsheetColumnDefinition")),this.columnDefs=[],this.rowDefs=[],this.columnFields=[],this.columns=[],this.rows=[],this.scrollTop=null,this.scrollLeft=null,this.initialize(),this.dispatchExternal("sheetAdded",this.getComponent())}initialize(){this.initializeElement(),this.initializeColumns(),this.initializeRows()}reinitialize(){this.initializeColumns(),this.initializeRows()}initializeElement(){this.element=document.createElement("div"),this.element.classList.add("tabulator-spreadsheet-tab"),this.element.innerText=this.title,this.element.addEventListener("click",()=>{this.spreadsheetManager.loadSheet(this)})}initializeColumns(){this.grid.setColumnCount(this.columnCount),this.columnFields=this.grid.genColumns(this.data),this.columnDefs=[],this.columnFields.forEach(e=>{var t=Object.assign({},this.columnDefinition);t.field=e,t.title=e,this.columnDefs.push(t)})}initializeRows(){var e;this.grid.setRowCount(this.rowCount),e=this.grid.genRows(this.data),this.rowDefs=[],e.forEach((t,r)=>{var a={_id:t},s=this.data[r];s&&s.forEach((o,u)=>{var h=this.columnFields[u];h&&(a[h]=o)}),this.rowDefs.push(a)})}unload(){this.isActive=!1,this.scrollTop=this.table.rowManager.scrollTop,this.scrollLeft=this.table.rowManager.scrollLeft,this.data=this.getData(!0),this.element.classList.remove("tabulator-spreadsheet-tab-active")}load(){var e=!this.isActive;this.isActive=!0,this.table.blockRedraw(),this.table.setData([]),this.table.setColumns(this.columnDefs),this.table.setData(this.rowDefs),this.table.restoreRedraw(),e&&this.scrollTop!==null&&(this.table.rowManager.element.scrollLeft=this.scrollLeft,this.table.rowManager.element.scrollTop=this.scrollTop),this.element.classList.add("tabulator-spreadsheet-tab-active"),this.dispatchExternal("sheetLoaded",this.getComponent())}getComponent(){return new Wy(this)}getDefinition(){return{title:this.title,key:this.key,rows:this.rowCount,columns:this.columnCount,data:this.getData()}}getData(e){var t=[],r,a,s;return this.rowDefs.forEach(o=>{var u=[];this.columnFields.forEach(h=>{u.push(o[h])}),t.push(u)}),!e&&!this.options("spreadsheetOutputFull")&&(r=t.map(o=>o.findLastIndex(u=>typeof u<"u")+1),a=Math.max(...r),s=r.findLastIndex(o=>o>0)+1,t=t.slice(0,s),t=t.map(o=>o.slice(0,a))),t}setData(e){this.data=e,this.reinitialize(),this.dispatchExternal("sheetUpdated",this.getComponent()),this.isActive&&this.load()}clear(){this.setData([])}setTitle(e){this.title=e,this.element.innerText=e,this.dispatchExternal("sheetUpdated",this.getComponent())}setRows(e){this.rowCount=e,this.initializeRows(),this.dispatchExternal("sheetUpdated",this.getComponent()),this.isActive&&this.load()}setColumns(e){this.columnCount=e,this.reinitialize(),this.dispatchExternal("sheetUpdated",this.getComponent()),this.isActive&&this.load()}remove(){this.spreadsheetManager.removeSheet(this)}destroy(){this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.dispatchExternal("sheetRemoved",this.getComponent())}active(){this.spreadsheetManager.loadSheet(this)}}class jy extends ct{constructor(e){super(e),this.sheets=[],this.element=null,this.registerTableOption("spreadsheet",!1),this.registerTableOption("spreadsheetRows",50),this.registerTableOption("spreadsheetColumns",50),this.registerTableOption("spreadsheetColumnDefinition",{}),this.registerTableOption("spreadsheetOutputFull",!1),this.registerTableOption("spreadsheetData",!1),this.registerTableOption("spreadsheetSheets",!1),this.registerTableOption("spreadsheetSheetTabs",!1),this.registerTableOption("spreadsheetSheetTabsElement",!1),this.registerTableFunction("setSheets",this.setSheets.bind(this)),this.registerTableFunction("addSheet",this.addSheet.bind(this)),this.registerTableFunction("getSheets",this.getSheets.bind(this)),this.registerTableFunction("getSheetDefinitions",this.getSheetDefinitions.bind(this)),this.registerTableFunction("setSheetData",this.setSheetData.bind(this)),this.registerTableFunction("getSheet",this.getSheet.bind(this)),this.registerTableFunction("getSheetData",this.getSheetData.bind(this)),this.registerTableFunction("clearSheet",this.clearSheet.bind(this)),this.registerTableFunction("removeSheet",this.removeSheetFunc.bind(this)),this.registerTableFunction("activeSheet",this.activeSheetFunc.bind(this))}initialize(){this.options("spreadsheet")&&(this.subscribe("table-initialized",this.tableInitialized.bind(this)),this.subscribe("data-loaded",this.loadRemoteData.bind(this)),this.table.options.index="_id",this.options("spreadsheetData")&&this.options("spreadsheetSheets")&&(console.warn("You cannot use spreadsheetData and spreadsheetSheets at the same time, ignoring spreadsheetData"),this.table.options.spreadsheetData=!1),this.compatibilityCheck(),this.options("spreadsheetSheetTabs")&&this.initializeTabset())}compatibilityCheck(){this.options("data")&&console.warn("Do not use the data option when working with spreadsheets, use either spreadsheetData or spreadsheetSheets to pass data into the table"),this.options("pagination")&&console.warn("The spreadsheet module is not compatible with the pagination module"),this.options("groupBy")&&console.warn("The spreadsheet module is not compatible with the row grouping module"),this.options("responsiveCollapse")&&console.warn("The spreadsheet module is not compatible with the responsive collapse module")}initializeTabset(){this.element=document.createElement("div"),this.element.classList.add("tabulator-spreadsheet-tabs");var e=this.options("spreadsheetSheetTabsElement");e&&!(e instanceof HTMLElement)&&(e=document.querySelector(e),e||console.warn("Unable to find element matching spreadsheetSheetTabsElement selector:",this.options("spreadsheetSheetTabsElement"))),e?e.appendChild(this.element):this.footerAppend(this.element)}tableInitialized(){this.sheets.length?this.loadSheet(this.sheets[0]):this.options("spreadsheetSheets")?this.loadSheets(this.options("spreadsheetSheets")):this.options("spreadsheetData")&&this.loadData(this.options("spreadsheetData"))}loadRemoteData(e,t,r){return console.log("data",e,t,r),Array.isArray(e)?(this.table.dataLoader.clearAlert(),this.dispatchExternal("dataLoaded",e),!e.length||Array.isArray(e[0])?this.loadData(e):this.loadSheets(e)):console.error(`Spreadsheet Loading Error - Unable to process remote data due to invalid data type 
Expecting: array 
Received: `,typeof e,`
Data:     `,e),!1}loadData(e){var t={data:e};this.loadSheet(this.newSheet(t))}destroySheets(){this.sheets.forEach(e=>{e.destroy()}),this.sheets=[],this.activeSheet=null}loadSheets(e){Array.isArray(e)||(e=[]),this.destroySheets(),e.forEach(t=>{this.newSheet(t)}),this.loadSheet(this.sheets[0])}loadSheet(e){this.activeSheet!==e&&(this.activeSheet&&this.activeSheet.unload(),this.activeSheet=e,e.load())}newSheet(e={}){var t;return e.rows||(e.rows=this.options("spreadsheetRows")),e.columns||(e.columns=this.options("spreadsheetColumns")),t=new Zb(this,e),this.sheets.push(t),this.element&&this.element.appendChild(t.element),t}removeSheet(e){var t=this.sheets.indexOf(e),r;this.sheets.length>1?t>-1&&(this.sheets.splice(t,1),e.destroy(),this.activeSheet===e&&(r=this.sheets[t-1]||this.sheets[0],r?this.loadSheet(r):this.activeSheet=null)):console.warn("Unable to remove sheet, at least one sheet must be active")}lookupSheet(e){return e?e instanceof Zb?e:e instanceof Wy?e._sheet:this.sheets.find(t=>t.key===e)||!1:this.activeSheet}setSheets(e){return this.loadSheets(e),this.getSheets()}addSheet(e){return this.newSheet(e).getComponent()}getSheetDefinitions(){return this.sheets.map(e=>e.getDefinition())}getSheets(){return this.sheets.map(e=>e.getComponent())}getSheet(e){var t=this.lookupSheet(e);return t?t.getComponent():!1}setSheetData(e,t){e&&!t&&(t=e,e=!1);var r=this.lookupSheet(e);return r?r.setData(t):!1}getSheetData(e){var t=this.lookupSheet(e);return t?t.getData():!1}clearSheet(e){var t=this.lookupSheet(e);return t?t.clear():!1}removeSheetFunc(e){var t=this.lookupSheet(e);t&&this.removeSheet(t)}activeSheetFunc(e){var t=this.lookupSheet(e);return t?this.loadSheet(t):!1}}Be(jy,"moduleName","spreadsheet");class Xy extends ct{constructor(e){super(e),this.tooltipSubscriber=null,this.headerSubscriber=null,this.timeout=null,this.popupInstance=null,this.registerTableOption("tooltipDelay",300),this.registerColumnOption("tooltip"),this.registerColumnOption("headerTooltip")}initialize(){this.deprecatedOptionsCheck(),this.subscribe("column-init",this.initializeColumn.bind(this))}deprecatedOptionsCheck(){}initializeColumn(e){e.definition.headerTooltip&&!this.headerSubscriber&&(this.headerSubscriber=!0,this.subscribe("column-mousemove",this.mousemoveCheck.bind(this,"headerTooltip")),this.subscribe("column-mouseout",this.mouseoutCheck.bind(this,"headerTooltip"))),e.definition.tooltip&&!this.tooltipSubscriber&&(this.tooltipSubscriber=!0,this.subscribe("cell-mousemove",this.mousemoveCheck.bind(this,"tooltip")),this.subscribe("cell-mouseout",this.mouseoutCheck.bind(this,"tooltip")))}mousemoveCheck(e,t,r){var a=e==="tooltip"?r.column.definition.tooltip:r.definition.headerTooltip;a&&(this.clearPopup(),this.timeout=setTimeout(this.loadTooltip.bind(this,t,r,a),this.table.options.tooltipDelay))}mouseoutCheck(e,t,r){this.popupInstance||this.clearPopup()}clearPopup(e,t,r){clearTimeout(this.timeout),this.timeout=null,this.popupInstance&&this.popupInstance.hide()}loadTooltip(e,t,r){var a,s,o;function u(h){s=h}typeof r=="function"&&(r=r(e,t.getComponent(),u)),r instanceof HTMLElement?a=r:(a=document.createElement("div"),r===!0&&(t instanceof mu?r=t.value:t.definition.field?this.langBind("columns|"+t.definition.field,h=>{a.innerHTML=r=h||t.definition.title}):r=t.definition.title),a.innerHTML=r),(r||r===0||r===!1)&&(a.classList.add("tabulator-tooltip"),a.addEventListener("mousemove",h=>h.preventDefault()),this.popupInstance=this.popup(a),typeof s=="function"&&this.popupInstance.renderCallback(s),o=this.popupInstance.containerEventCoords(e),this.popupInstance.show(o.x+15,o.y+15).hideOnBlur(()=>{this.dispatchExternal("TooltipClosed",t.getComponent()),this.popupInstance=null}),this.dispatchExternal("TooltipOpened",t.getComponent()))}}Be(Xy,"moduleName","tooltip");var t8={integer:function(i,e,t){return e===""||e===null||typeof e>"u"?!0:(e=Number(e),!isNaN(e)&&isFinite(e)&&Math.floor(e)===e)},float:function(i,e,t){return e===""||e===null||typeof e>"u"?!0:(e=Number(e),!isNaN(e)&&isFinite(e)&&e%1!==0)},numeric:function(i,e,t){return e===""||e===null||typeof e>"u"?!0:!isNaN(e)},string:function(i,e,t){return e===""||e===null||typeof e>"u"?!0:isNaN(e)},alphanumeric:function(i,e,t){if(e===""||e===null||typeof e>"u")return!0;var r=new RegExp(/^[a-z0-9]+$/i);return r.test(e)},max:function(i,e,t){return e===""||e===null||typeof e>"u"?!0:parseFloat(e)<=t},min:function(i,e,t){return e===""||e===null||typeof e>"u"?!0:parseFloat(e)>=t},starts:function(i,e,t){return e===""||e===null||typeof e>"u"?!0:String(e).toLowerCase().startsWith(String(t).toLowerCase())},ends:function(i,e,t){return e===""||e===null||typeof e>"u"?!0:String(e).toLowerCase().endsWith(String(t).toLowerCase())},minLength:function(i,e,t){return e===""||e===null||typeof e>"u"?!0:String(e).length>=t},maxLength:function(i,e,t){return e===""||e===null||typeof e>"u"?!0:String(e).length<=t},in:function(i,e,t){return e===""||e===null||typeof e>"u"?!0:(typeof t=="string"&&(t=t.split("|")),t.indexOf(e)>-1)},regex:function(i,e,t){if(e===""||e===null||typeof e>"u")return!0;var r=new RegExp(t);return r.test(e)},unique:function(i,e,t){if(e===""||e===null||typeof e>"u")return!0;var r=!0,a=i.getData(),s=i.getColumn()._getSelf();return this.table.rowManager.rows.forEach(function(o){var u=o.getData();u!==a&&e==s.getFieldValue(u)&&(r=!1)}),r},required:function(i,e,t){return e!==""&&e!==null&&typeof e<"u"}};const Wo=class Wo extends ct{constructor(e){super(e),this.invalidCells=[],this.registerTableOption("validationMode","blocking"),this.registerColumnOption("validator"),this.registerTableFunction("getInvalidCells",this.getInvalidCells.bind(this)),this.registerTableFunction("clearCellValidation",this.userClearCellValidation.bind(this)),this.registerTableFunction("validate",this.userValidate.bind(this)),this.registerComponentFunction("cell","isValid",this.cellIsValid.bind(this)),this.registerComponentFunction("cell","clearValidation",this.clearValidation.bind(this)),this.registerComponentFunction("cell","validate",this.cellValidate.bind(this)),this.registerComponentFunction("column","validate",this.columnValidate.bind(this)),this.registerComponentFunction("row","validate",this.rowValidate.bind(this))}initialize(){this.subscribe("cell-delete",this.clearValidation.bind(this)),this.subscribe("column-layout",this.initializeColumnCheck.bind(this)),this.subscribe("edit-success",this.editValidate.bind(this)),this.subscribe("edit-editor-clear",this.editorClear.bind(this)),this.subscribe("edit-edited-clear",this.editedClear.bind(this))}editValidate(e,t,r){var a=this.table.options.validationMode!=="manual"?this.validate(e.column.modules.validate,e,t):!0;return a!==!0&&setTimeout(()=>{e.getElement().classList.add("tabulator-validation-fail"),this.dispatchExternal("validationFailed",e.getComponent(),t,a)}),a}editorClear(e,t){t&&e.column.modules.validate&&this.cellValidate(e),e.getElement().classList.remove("tabulator-validation-fail")}editedClear(e){e.modules.validate&&(e.modules.validate.invalid=!1)}cellIsValid(e){return e.modules.validate&&e.modules.validate.invalid||!0}cellValidate(e){return this.validate(e.column.modules.validate,e,e.getValue())}columnValidate(e){var t=[];return e.cells.forEach(r=>{this.cellValidate(r)!==!0&&t.push(r.getComponent())}),t.length?t:!0}rowValidate(e){var t=[];return e.cells.forEach(r=>{this.cellValidate(r)!==!0&&t.push(r.getComponent())}),t.length?t:!0}userClearCellValidation(e){e||(e=this.getInvalidCells()),Array.isArray(e)||(e=[e]),e.forEach(t=>{this.clearValidation(t._getSelf())})}userValidate(e){var t=[];return this.table.rowManager.rows.forEach(r=>{r=r.getComponent();var a=r.validate();a!==!0&&(t=t.concat(a))}),t.length?t:!0}initializeColumnCheck(e){typeof e.definition.validator<"u"&&this.initializeColumn(e)}initializeColumn(e){var t=this,r=[],a;e.definition.validator&&(Array.isArray(e.definition.validator)?e.definition.validator.forEach(s=>{a=t._extractValidator(s),a&&r.push(a)}):(a=this._extractValidator(e.definition.validator),a&&r.push(a)),e.modules.validate=r.length?r:!1)}_extractValidator(e){var t,r,a;switch(typeof e){case"string":return a=e.indexOf(":"),a>-1?(t=e.substring(0,a),r=e.substring(a+1)):t=e,this._buildValidator(t,r);case"function":return this._buildValidator(e);case"object":return this._buildValidator(e.type,e.parameters)}}_buildValidator(e,t){var r=typeof e=="function"?e:Wo.validators[e];return r?{type:typeof e=="function"?"function":e,func:r,params:t}:(console.warn("Validator Setup Error - No matching validator found:",e),!1)}validate(e,t,r){var a=this,s=[],o=this.invalidCells.indexOf(t);return e&&e.forEach(u=>{u.func.call(a,t.getComponent(),r,u.params)||s.push({type:u.type,parameters:u.params})}),t.modules.validate||(t.modules.validate={}),s.length?(t.modules.validate.invalid=s,this.table.options.validationMode!=="manual"&&t.getElement().classList.add("tabulator-validation-fail"),o==-1&&this.invalidCells.push(t)):(t.modules.validate.invalid=!1,t.getElement().classList.remove("tabulator-validation-fail"),o>-1&&this.invalidCells.splice(o,1)),s.length?s:!0}getInvalidCells(){var e=[];return this.invalidCells.forEach(t=>{e.push(t.getComponent())}),e}clearValidation(e){var t;e.modules.validate&&e.modules.validate.invalid&&(e.getElement().classList.remove("tabulator-validation-fail"),e.modules.validate.invalid=!1,t=this.invalidCells.indexOf(e),t>-1&&this.invalidCells.splice(t,1))}};Be(Wo,"moduleName","validate"),Be(Wo,"validators",t8);let W0=Wo;var a0=Object.freeze({__proto__:null,AccessorModule:C0,AjaxModule:S0,ClipboardModule:R0,ColumnCalcsModule:k0,DataTreeModule:Dy,DownloadModule:A0,EditModule:D0,ExportModule:F0,FilterModule:M0,FormatModule:O0,FrozenColumnsModule:Fy,FrozenRowsModule:My,GroupRowsModule:Oy,HistoryModule:L0,HtmlTableImportModule:Ly,ImportModule:N0,InteractionModule:Ny,KeybindingsModule:B0,MenuModule:By,MoveColumnsModule:zy,MoveRowsModule:z0,MutatorModule:H0,PageModule:P0,PersistenceModule:I0,PopupModule:Hy,PrintModule:Py,ReactiveDataModule:Iy,ResizeColumnsModule:Uy,ResizeRowsModule:Vy,ResizeTableModule:Gy,ResponsiveLayoutModule:U0,SelectRangeModule:Hc,SelectRowModule:V0,SortModule:G0,SpreadsheetModule:jy,TooltipModule:Xy,ValidateModule:W0}),i8={debugEventsExternal:!1,debugEventsInternal:!1,debugInvalidOptions:!0,debugInvalidComponentFuncs:!0,debugInitialization:!0,debugDeprecation:!0,height:!1,minHeight:!1,maxHeight:!1,columnHeaderVertAlign:"top",popupContainer:!1,columns:[],columnDefaults:{},rowHeader:!1,data:!1,autoColumns:!1,autoColumnsDefinitions:!1,nestedFieldSeparator:".",footerElement:!1,index:"id",textDirection:"auto",addRowPos:"bottom",headerVisible:!0,renderVertical:"virtual",renderHorizontal:"basic",renderVerticalBuffer:0,scrollToRowPosition:"top",scrollToRowIfVisible:!0,scrollToColumnPosition:"left",scrollToColumnIfVisible:!0,rowFormatter:!1,rowFormatterPrint:null,rowFormatterClipboard:null,rowFormatterHtmlOutput:null,rowHeight:null,placeholder:!1,dataLoader:!0,dataLoaderLoading:!1,dataLoaderError:!1,dataLoaderErrorTimeout:3e3,dataSendParams:{},dataReceiveParams:{},dependencies:{}};class Yy{constructor(e,t,r={}){this.table=e,this.msgType=t,this.registeredDefaults=Object.assign({},r)}register(e,t){this.registeredDefaults[e]=t}generate(e,t={}){var r=Object.assign({},this.registeredDefaults),a=this.table.options.debugInvalidOptions||t.debugInvalidOptions===!0;Object.assign(r,e);for(let s in t)r.hasOwnProperty(s)||(a&&console.warn("Invalid "+this.msgType+" option:",s),r[s]=t.key);for(let s in r)s in t?r[s]=t[s]:Array.isArray(r[s])?r[s]=Object.assign([],r[s]):typeof r[s]=="object"&&r[s]!==null?r[s]=Object.assign({},r[s]):typeof r[s]>"u"&&delete r[s];return r}}class Th extends zi{constructor(e){super(e),this.elementVertical=e.rowManager.element,this.elementHorizontal=e.columnManager.element,this.tableElement=e.rowManager.tableElement,this.verticalFillMode="fit"}initialize(){}clearRows(){}clearColumns(){}reinitializeColumnWidths(e){}renderRows(){}renderColumns(){}rerenderRows(e){e&&e()}rerenderColumns(e,t){}renderRowCells(e){}rerenderRowCells(e,t){}scrollColumns(e,t){}scrollRows(e,t){}resize(){}scrollToRow(e){}scrollToRowNearestTop(e){}visibleRows(e){return[]}rows(){return this.table.rowManager.getDisplayRows()}styleRow(e,t){var r=e.getElement();t%2?(r.classList.add("tabulator-row-even"),r.classList.remove("tabulator-row-odd")):(r.classList.add("tabulator-row-odd"),r.classList.remove("tabulator-row-even"))}clear(){this.clearRows(),this.clearColumns()}render(){this.renderRows(),this.renderColumns()}rerender(e){this.rerenderRows(),this.rerenderColumns()}scrollToRowPosition(e,t,r){var a=this.rows().indexOf(e),s=e.getElement(),o=0;return new Promise((u,h)=>{if(a>-1){if(typeof r>"u"&&(r=this.table.options.scrollToRowIfVisible),!r&&Wt.elVisible(s)&&(o=Wt.elOffset(s).top-Wt.elOffset(this.elementVertical).top,o>0&&o<this.elementVertical.clientHeight-s.offsetHeight))return u(),!1;switch(typeof t>"u"&&(t=this.table.options.scrollToRowPosition),t==="nearest"&&(t=this.scrollToRowNearestTop(e)?"top":"bottom"),this.scrollToRow(e),t){case"middle":case"center":this.elementVertical.scrollHeight-this.elementVertical.scrollTop==this.elementVertical.clientHeight?this.elementVertical.scrollTop=this.elementVertical.scrollTop+(s.offsetTop-this.elementVertical.scrollTop)-(this.elementVertical.scrollHeight-s.offsetTop)/2:this.elementVertical.scrollTop=this.elementVertical.scrollTop-this.elementVertical.clientHeight/2;break;case"bottom":this.elementVertical.scrollHeight-this.elementVertical.scrollTop==this.elementVertical.clientHeight?this.elementVertical.scrollTop=this.elementVertical.scrollTop-(this.elementVertical.scrollHeight-s.offsetTop)+s.offsetHeight:this.elementVertical.scrollTop=this.elementVertical.scrollTop-this.elementVertical.clientHeight+s.offsetHeight;break;case"top":this.elementVertical.scrollTop=s.offsetTop;break}u()}else console.warn("Scroll Error - Row not visible"),h("Scroll Error - Row not visible")})}}class r8 extends Th{constructor(e){super(e)}renderRowCells(e,t){const r=document.createDocumentFragment();e.cells.forEach(a=>{r.appendChild(a.getElement())}),e.element.appendChild(r),t||e.cells.forEach(a=>{a.cellRendered()})}reinitializeColumnWidths(e){e.forEach(function(t){t.reinitializeWidth()})}}class a8 extends Th{constructor(e){super(e),this.leftCol=0,this.rightCol=0,this.scrollLeft=0,this.vDomScrollPosLeft=0,this.vDomScrollPosRight=0,this.vDomPadLeft=0,this.vDomPadRight=0,this.fitDataColAvg=0,this.windowBuffer=200,this.visibleRows=null,this.initialized=!1,this.isFitData=!1,this.columns=[]}initialize(){this.compatibilityCheck(),this.layoutCheck(),this.vertScrollListen()}compatibilityCheck(){this.options("layout")=="fitDataTable"&&console.warn("Horizontal Virtual DOM is not compatible with fitDataTable layout mode"),this.options("responsiveLayout")&&console.warn("Horizontal Virtual DOM is not compatible with responsive columns"),this.options("rtl")&&console.warn("Horizontal Virtual DOM is not currently compatible with RTL text direction")}layoutCheck(){this.isFitData=this.options("layout").startsWith("fitData")}vertScrollListen(){this.subscribe("scroll-vertical",this.clearVisRowCache.bind(this)),this.subscribe("data-refreshed",this.clearVisRowCache.bind(this))}clearVisRowCache(){this.visibleRows=null}renderColumns(e,t){this.dataChange()}scrollColumns(e,t){this.scrollLeft!=e&&(this.scrollLeft=e,this.scroll(e-(this.vDomScrollPosLeft+this.windowBuffer)))}calcWindowBuffer(){var e=this.elementVertical.clientWidth;this.table.columnManager.columnsByIndex.forEach(t=>{if(t.visible){var r=t.getWidth();r>e&&(e=r)}}),this.windowBuffer=e*2}rerenderColumns(e,t){var r={cols:this.columns,leftCol:this.leftCol,rightCol:this.rightCol},a=0;e&&!this.initialized||(this.clear(),this.calcWindowBuffer(),this.scrollLeft=this.elementVertical.scrollLeft,this.vDomScrollPosLeft=this.scrollLeft-this.windowBuffer,this.vDomScrollPosRight=this.scrollLeft+this.elementVertical.clientWidth+this.windowBuffer,this.table.columnManager.columnsByIndex.forEach(s=>{var o={},u;s.visible&&(s.modules.frozen||(u=s.getWidth(),o.leftPos=a,o.rightPos=a+u,o.width=u,this.isFitData&&(o.fitDataCheck=s.modules.vdomHoz?s.modules.vdomHoz.fitDataCheck:!0),a+u>this.vDomScrollPosLeft&&a<this.vDomScrollPosRight?(this.leftCol==-1&&(this.leftCol=this.columns.length,this.vDomPadLeft=a),this.rightCol=this.columns.length):this.leftCol!==-1&&(this.vDomPadRight+=u),this.columns.push(s),s.modules.vdomHoz=o,a+=u))}),this.tableElement.style.paddingLeft=this.vDomPadLeft+"px",this.tableElement.style.paddingRight=this.vDomPadRight+"px",this.initialized=!0,t||(!e||this.reinitChanged(r))&&this.reinitializeRows(),this.elementVertical.scrollLeft=this.scrollLeft)}renderRowCells(e){if(this.initialized)this.initializeRow(e);else{const t=document.createDocumentFragment();e.cells.forEach(r=>{t.appendChild(r.getElement())}),e.element.appendChild(t),e.cells.forEach(r=>{r.cellRendered()})}}rerenderRowCells(e,t){this.reinitializeRow(e,t)}reinitializeColumnWidths(e){for(let t=this.leftCol;t<=this.rightCol;t++){let r=this.columns[t];r&&r.reinitializeWidth()}}deinitialize(){this.initialized=!1}clear(){this.columns=[],this.leftCol=-1,this.rightCol=0,this.vDomScrollPosLeft=0,this.vDomScrollPosRight=0,this.vDomPadLeft=0,this.vDomPadRight=0}dataChange(){var e=!1,t,r;if(this.isFitData){if(this.table.columnManager.columnsByIndex.forEach(a=>{!a.definition.width&&a.visible&&(e=!0)}),e&&this.table.rowManager.getDisplayRows().length&&(this.vDomScrollPosRight=this.scrollLeft+this.elementVertical.clientWidth+this.windowBuffer,t=this.chain("rows-sample",[1],[],()=>this.table.rowManager.getDisplayRows())[0],t)){r=t.getElement(),t.generateCells(),this.tableElement.appendChild(r);for(let a=0;a<t.cells.length;a++){let s=t.cells[a];r.appendChild(s.getElement()),s.column.reinitializeWidth()}r.parentNode.removeChild(r),this.rerenderColumns(!1,!0)}}else this.options("layout")==="fitColumns"&&(this.layoutRefresh(),this.rerenderColumns(!1,!0))}reinitChanged(e){var t=!0;return e.cols.length!==this.columns.length||e.leftCol!==this.leftCol||e.rightCol!==this.rightCol?!0:(e.cols.forEach((r,a)=>{r!==this.columns[a]&&(t=!1)}),!t)}reinitializeRows(){var e=this.getVisibleRows(),t=this.table.rowManager.getRows().filter(r=>!e.includes(r));e.forEach(r=>{this.reinitializeRow(r,!0)}),t.forEach(r=>{r.deinitialize()})}getVisibleRows(){return this.visibleRows||(this.visibleRows=this.table.rowManager.getVisibleRows()),this.visibleRows}scroll(e){this.vDomScrollPosLeft+=e,this.vDomScrollPosRight+=e,Math.abs(e)>this.windowBuffer/2?this.rerenderColumns():e>0?(this.addColRight(),this.removeColLeft()):(this.addColLeft(),this.removeColRight())}colPositionAdjust(e,t,r){for(let a=e;a<t;a++){let s=this.columns[a];s.modules.vdomHoz.leftPos+=r,s.modules.vdomHoz.rightPos+=r}}addColRight(){for(var e=!1,t=!0;t;){let r=this.columns[this.rightCol+1];r&&r.modules.vdomHoz.leftPos<=this.vDomScrollPosRight?(e=!0,this.getVisibleRows().forEach(a=>{if(a.type!=="group"){var s=a.getCell(r);a.getElement().insertBefore(s.getElement(),a.getCell(this.columns[this.rightCol]).getElement().nextSibling),s.cellRendered()}}),this.fitDataColActualWidthCheck(r),this.rightCol++,this.getVisibleRows().forEach(a=>{a.type!=="group"&&(a.modules.vdomHoz.rightCol=this.rightCol)}),this.rightCol>=this.columns.length-1?this.vDomPadRight=0:this.vDomPadRight-=r.getWidth()):t=!1}e&&(this.tableElement.style.paddingRight=this.vDomPadRight+"px")}addColLeft(){for(var e=!1,t=!0;t;){let r=this.columns[this.leftCol-1];if(r)if(r.modules.vdomHoz.rightPos>=this.vDomScrollPosLeft){e=!0,this.getVisibleRows().forEach(s=>{if(s.type!=="group"){var o=s.getCell(r);s.getElement().insertBefore(o.getElement(),s.getCell(this.columns[this.leftCol]).getElement()),o.cellRendered()}}),this.leftCol--,this.getVisibleRows().forEach(s=>{s.type!=="group"&&(s.modules.vdomHoz.leftCol=this.leftCol)}),this.leftCol<=0?this.vDomPadLeft=0:this.vDomPadLeft-=r.getWidth();let a=this.fitDataColActualWidthCheck(r);a&&(this.scrollLeft=this.elementVertical.scrollLeft=this.elementVertical.scrollLeft+a,this.vDomPadRight-=a)}else t=!1;else t=!1}e&&(this.tableElement.style.paddingLeft=this.vDomPadLeft+"px")}removeColRight(){for(var e=!1,t=!0;t;){let r=this.columns[this.rightCol];r&&r.modules.vdomHoz.leftPos>this.vDomScrollPosRight?(e=!0,this.getVisibleRows().forEach(a=>{if(a.type!=="group"){var s=a.getCell(r);try{a.getElement().removeChild(s.getElement())}catch(o){console.warn("Could not removeColRight",o.message)}}}),this.vDomPadRight+=r.getWidth(),this.rightCol--,this.getVisibleRows().forEach(a=>{a.type!=="group"&&(a.modules.vdomHoz.rightCol=this.rightCol)})):t=!1}e&&(this.tableElement.style.paddingRight=this.vDomPadRight+"px")}removeColLeft(){for(var e=!1,t=!0;t;){let r=this.columns[this.leftCol];r&&r.modules.vdomHoz.rightPos<this.vDomScrollPosLeft?(e=!0,this.getVisibleRows().forEach(a=>{if(a.type!=="group"){var s=a.getCell(r);try{a.getElement().removeChild(s.getElement())}catch(o){console.warn("Could not removeColLeft",o.message)}}}),this.vDomPadLeft+=r.getWidth(),this.leftCol++,this.getVisibleRows().forEach(a=>{a.type!=="group"&&(a.modules.vdomHoz.leftCol=this.leftCol)})):t=!1}e&&(this.tableElement.style.paddingLeft=this.vDomPadLeft+"px")}fitDataColActualWidthCheck(e){var t,r;return e.modules.vdomHoz.fitDataCheck&&(e.reinitializeWidth(),t=e.getWidth(),r=t-e.modules.vdomHoz.width,r&&(e.modules.vdomHoz.rightPos+=r,e.modules.vdomHoz.width=t,this.colPositionAdjust(this.columns.indexOf(e)+1,this.columns.length,r)),e.modules.vdomHoz.fitDataCheck=!1),r}initializeRow(e){if(e.type!=="group"){e.modules.vdomHoz={leftCol:this.leftCol,rightCol:this.rightCol},this.table.modules.frozenColumns&&this.table.modules.frozenColumns.leftColumns.forEach(t=>{this.appendCell(e,t)});for(let t=this.leftCol;t<=this.rightCol;t++)this.appendCell(e,this.columns[t]);this.table.modules.frozenColumns&&this.table.modules.frozenColumns.rightColumns.forEach(t=>{this.appendCell(e,t)})}}appendCell(e,t){if(t&&t.visible){let r=e.getCell(t);e.getElement().appendChild(r.getElement()),r.cellRendered()}}reinitializeRow(e,t){if(e.type!=="group"&&(t||!e.modules.vdomHoz||e.modules.vdomHoz.leftCol!==this.leftCol||e.modules.vdomHoz.rightCol!==this.rightCol)){for(var r=e.getElement();r.firstChild;)r.removeChild(r.firstChild);this.initializeRow(e)}}}class n8 extends zi{constructor(e){super(e),this.blockHozScrollEvent=!1,this.headersElement=null,this.contentsElement=null,this.rowHeader=null,this.element=null,this.columns=[],this.columnsByIndex=[],this.columnsByField={},this.scrollLeft=0,this.optionsList=new Yy(this.table,"column definition",Ay),this.redrawBlock=!1,this.redrawBlockUpdate=null,this.renderer=null}initialize(){this.initializeRenderer(),this.headersElement=this.createHeadersElement(),this.contentsElement=this.createHeaderContentsElement(),this.element=this.createHeaderElement(),this.contentsElement.insertBefore(this.headersElement,this.contentsElement.firstChild),this.element.insertBefore(this.contentsElement,this.element.firstChild),this.initializeScrollWheelWatcher(),this.subscribe("scroll-horizontal",this.scrollHorizontal.bind(this)),this.subscribe("scrollbar-vertical",this.padVerticalScrollbar.bind(this))}padVerticalScrollbar(e){this.table.rtl?this.headersElement.style.marginLeft=e+"px":this.headersElement.style.marginRight=e+"px"}initializeRenderer(){var e,t={virtual:a8,basic:r8};typeof this.table.options.renderHorizontal=="string"?e=t[this.table.options.renderHorizontal]:e=this.table.options.renderHorizontal,e?(this.renderer=new e(this.table,this.element,this.tableElement),this.renderer.initialize()):console.error("Unable to find matching renderer:",this.table.options.renderHorizontal)}createHeadersElement(){var e=document.createElement("div");return e.classList.add("tabulator-headers"),e.setAttribute("role","row"),e}createHeaderContentsElement(){var e=document.createElement("div");return e.classList.add("tabulator-header-contents"),e.setAttribute("role","rowgroup"),e}createHeaderElement(){var e=document.createElement("div");return e.classList.add("tabulator-header"),e.setAttribute("role","rowgroup"),this.table.options.headerVisible||e.classList.add("tabulator-header-hidden"),e}getElement(){return this.element}getContentsElement(){return this.contentsElement}getHeadersElement(){return this.headersElement}scrollHorizontal(e){this.contentsElement.scrollLeft=e,this.scrollLeft=e,this.renderer.scrollColumns(e)}initializeScrollWheelWatcher(){this.contentsElement.addEventListener("wheel",e=>{var t;e.deltaX&&(t=this.contentsElement.scrollLeft+e.deltaX,this.table.rowManager.scrollHorizontal(t),this.table.columnManager.scrollHorizontal(t))})}generateColumnsFromRowData(e){var t=[],r={},a=this.table.options.autoColumns==="full"?e:[e[0]],s=this.table.options.autoColumnsDefinitions;if(e&&e.length){if(a.forEach(o=>{Object.keys(o).forEach((u,h)=>{let d=o[u],p;r[u]?r[u]!==!0&&typeof d<"u"&&(r[u].sorter=this.calculateSorterFromValue(d),r[u]=!0):(p={field:u,title:u,sorter:this.calculateSorterFromValue(d)},t.splice(h,0,p),r[u]=typeof d>"u"?p:!0)})}),s)switch(typeof s){case"function":this.table.options.columns=s.call(this.table,t);break;case"object":Array.isArray(s)?t.forEach(o=>{var u=s.find(h=>h.field===o.field);u&&Object.assign(o,u)}):t.forEach(o=>{s[o.field]&&Object.assign(o,s[o.field])}),this.table.options.columns=t;break}else this.table.options.columns=t;this.setColumns(this.table.options.columns)}}calculateSorterFromValue(e){var t;switch(typeof e){case"undefined":t="string";break;case"boolean":t="boolean";break;case"number":t="number";break;case"object":Array.isArray(e)?t="array":t="string";break;default:!isNaN(e)&&e!==""?t="number":e.match(/((^[0-9]+[a-z]+)|(^[a-z]+[0-9]+))+$/i)?t="alphanum":t="string";break}return t}setColumns(e,t){for(;this.headersElement.firstChild;)this.headersElement.removeChild(this.headersElement.firstChild);this.columns=[],this.columnsByIndex=[],this.columnsByField={},this.dispatch("columns-loading"),this.dispatchExternal("columnsLoading"),this.table.options.rowHeader&&(this.rowHeader=new fs(this.table.options.rowHeader===!0?{}:this.table.options.rowHeader,this,!0),this.columns.push(this.rowHeader),this.headersElement.appendChild(this.rowHeader.getElement()),this.rowHeader.columnRendered()),e.forEach((r,a)=>{this._addColumn(r)}),this._reIndexColumns(),this.dispatch("columns-loaded"),this.subscribedExternal("columnsLoaded")&&this.dispatchExternal("columnsLoaded",this.getComponents()),this.rerenderColumns(!1,!0),this.redraw(!0)}_addColumn(e,t,r){var a=new fs(e,this),s=a.getElement(),o=r&&this.findColumnIndex(r);if(t&&this.rowHeader&&(!r||r===this.rowHeader)&&(t=!1,r=this.rowHeader,o=0),r&&o>-1){var u=r.getTopColumn(),h=this.columns.indexOf(u),d=u.getElement();t?(this.columns.splice(h,0,a),d.parentNode.insertBefore(s,d)):(this.columns.splice(h+1,0,a),d.parentNode.insertBefore(s,d.nextSibling))}else t?(this.columns.unshift(a),this.headersElement.insertBefore(a.getElement(),this.headersElement.firstChild)):(this.columns.push(a),this.headersElement.appendChild(a.getElement()));return a.columnRendered(),a}registerColumnField(e){e.definition.field&&(this.columnsByField[e.definition.field]=e)}registerColumnPosition(e){this.columnsByIndex.push(e)}_reIndexColumns(){this.columnsByIndex=[],this.columns.forEach(function(e){e.reRegisterPosition()})}verticalAlignHeaders(){var e=0;this.redrawBlock||(this.headersElement.style.height="",this.columns.forEach(t=>{t.clearVerticalAlign()}),this.columns.forEach(t=>{var r=t.getHeight();r>e&&(e=r)}),this.headersElement.style.height=e+"px",this.columns.forEach(t=>{t.verticalAlign(this.table.options.columnHeaderVertAlign,e)}),this.table.rowManager.adjustTableSize())}findColumn(e){var t;if(typeof e=="object"){if(e instanceof fs)return e;if(e instanceof ky)return e._getSelf()||!1;if(typeof HTMLElement<"u"&&e instanceof HTMLElement)return t=[],this.columns.forEach(a=>{t.push(a),t=t.concat(a.getColumns(!0))}),t.find(a=>a.element===e)||!1}else return this.columnsByField[e]||!1;return!1}getColumnByField(e){return this.columnsByField[e]}getColumnsByFieldRoot(e){var t=[];return Object.keys(this.columnsByField).forEach(r=>{var a=this.table.options.nestedFieldSeparator?r.split(this.table.options.nestedFieldSeparator)[0]:r;a===e&&t.push(this.columnsByField[r])}),t}getColumnByIndex(e){return this.columnsByIndex[e]}getFirstVisibleColumn(){var e=this.columnsByIndex.findIndex(t=>t.visible);return e>-1?this.columnsByIndex[e]:!1}getVisibleColumnsByIndex(){return this.columnsByIndex.filter(e=>e.visible)}getColumns(){return this.columns}findColumnIndex(e){return this.columnsByIndex.findIndex(t=>e===t)}getRealColumns(){return this.columnsByIndex}traverse(e){this.columnsByIndex.forEach((t,r)=>{e(t,r)})}getDefinitions(e){var t=[];return this.columnsByIndex.forEach(r=>{(!e||e&&r.visible)&&t.push(r.getDefinition())}),t}getDefinitionTree(){var e=[];return this.columns.forEach(t=>{e.push(t.getDefinition(!0))}),e}getComponents(e){var t=[],r=e?this.columns:this.columnsByIndex;return r.forEach(a=>{t.push(a.getComponent())}),t}getWidth(){var e=0;return this.columnsByIndex.forEach(t=>{t.visible&&(e+=t.getWidth())}),e}moveColumn(e,t,r){t.element.parentNode.insertBefore(e.element,t.element),r&&t.element.parentNode.insertBefore(t.element,e.element),this.moveColumnActual(e,t,r),this.verticalAlignHeaders(),this.table.rowManager.reinitialize()}moveColumnActual(e,t,r){e.parent.isGroup?this._moveColumnInArray(e.parent.columns,e,t,r):this._moveColumnInArray(this.columns,e,t,r),this._moveColumnInArray(this.columnsByIndex,e,t,r,!0),this.rerenderColumns(!0),this.dispatch("column-moved",e,t,r),this.subscribedExternal("columnMoved")&&this.dispatchExternal("columnMoved",e.getComponent(),this.table.columnManager.getComponents())}_moveColumnInArray(e,t,r,a,s){var o=e.indexOf(t),u,h=[];o>-1&&(e.splice(o,1),u=e.indexOf(r),u>-1?a&&(u=u+1):u=o,e.splice(u,0,t),s&&(h=this.chain("column-moving-rows",[t,r,a],null,[])||[],h=h.concat(this.table.rowManager.rows),h.forEach(function(d){if(d.cells.length){var p=d.cells.splice(o,1)[0];d.cells.splice(u,0,p)}})))}scrollToColumn(e,t,r){var a=0,s=e.getLeftOffset(),o=0,u=e.getElement();return new Promise((h,d)=>{if(typeof t>"u"&&(t=this.table.options.scrollToColumnPosition),typeof r>"u"&&(r=this.table.options.scrollToColumnIfVisible),e.visible){switch(t){case"middle":case"center":o=-this.element.clientWidth/2;break;case"right":o=u.clientWidth-this.headersElement.clientWidth;break}if(!r&&s>0&&s+u.offsetWidth<this.element.clientWidth)return!1;a=s+o,a=Math.max(Math.min(a,this.table.rowManager.element.scrollWidth-this.table.rowManager.element.clientWidth),0),this.table.rowManager.scrollHorizontal(a),this.scrollHorizontal(a),h()}else console.warn("Scroll Error - Column not visible"),d("Scroll Error - Column not visible")})}generateCells(e){var t=[];return this.columnsByIndex.forEach(r=>{t.push(r.generateCell(e))}),t}getFlexBaseWidth(){var e=this.table.element.clientWidth,t=0;return this.table.rowManager.element.scrollHeight>this.table.rowManager.element.clientHeight&&(e-=this.table.rowManager.element.offsetWidth-this.table.rowManager.element.clientWidth),this.columnsByIndex.forEach(function(r){var a,s,o;r.visible&&(a=r.definition.width||0,s=parseInt(r.minWidth),typeof a=="string"?a.indexOf("%")>-1?o=e/100*parseInt(a):o=parseInt(a):o=a,t+=o>s?o:s)}),t}addColumn(e,t,r){return new Promise((a,s)=>{var o=this._addColumn(e,t,r);this._reIndexColumns(),this.dispatch("column-add",e,t,r),this.layoutMode()!="fitColumns"&&o.reinitializeWidth(),this.redraw(!0),this.table.rowManager.reinitialize(),this.rerenderColumns(),a(o)})}deregisterColumn(e){var t=e.getField(),r;t&&delete this.columnsByField[t],r=this.columnsByIndex.indexOf(e),r>-1&&this.columnsByIndex.splice(r,1),r=this.columns.indexOf(e),r>-1&&this.columns.splice(r,1),this.verticalAlignHeaders(),this.redraw()}rerenderColumns(e,t){this.redrawBlock?(e===!1||e===!0&&this.redrawBlockUpdate===null)&&(this.redrawBlockUpdate=e):this.renderer.rerenderColumns(e,t)}blockRedraw(){this.redrawBlock=!0,this.redrawBlockUpdate=null}restoreRedraw(){this.redrawBlock=!1,this.verticalAlignHeaders(),this.renderer.rerenderColumns(this.redrawBlockUpdate)}redraw(e){Wt.elVisible(this.element)&&this.verticalAlignHeaders(),e&&(this.table.rowManager.resetScroll(),this.table.rowManager.reinitialize()),this.confirm("table-redrawing",e)||this.layoutRefresh(e),this.dispatch("table-redraw",e),this.table.footerManager.redraw()}}class s8 extends Th{constructor(e){super(e),this.verticalFillMode="fill",this.scrollTop=0,this.scrollLeft=0,this.scrollTop=0,this.scrollLeft=0}clearRows(){for(var e=this.tableElement;e.firstChild;)e.removeChild(e.firstChild);e.scrollTop=0,e.scrollLeft=0,e.style.minWidth="",e.style.minHeight="",e.style.display="",e.style.visibility=""}renderRows(){var e=this.tableElement,t=!0,r=document.createDocumentFragment(),a=this.rows();a.forEach((s,o)=>{this.styleRow(s,o),s.initialize(!1,!0),s.type!=="group"&&(t=!1),r.appendChild(s.getElement())}),e.appendChild(r),a.forEach(s=>{s.rendered(),s.heightInitialized||s.calcHeight(!0)}),a.forEach(s=>{s.heightInitialized||s.setCellHeight()}),t?e.style.minWidth=this.table.columnManager.getWidth()+"px":e.style.minWidth=""}rerenderRows(e){this.clearRows(),e&&e(),this.renderRows(),this.rows().length||this.table.rowManager.tableEmpty()}scrollToRowNearestTop(e){var t=Wt.elOffset(e.getElement()).top;return!(Math.abs(this.elementVertical.scrollTop-t)>Math.abs(this.elementVertical.scrollTop+this.elementVertical.clientHeight-t))}scrollToRow(e){var t=e.getElement();this.elementVertical.scrollTop=Wt.elOffset(t).top-Wt.elOffset(this.elementVertical).top+this.elementVertical.scrollTop}visibleRows(e){return this.rows()}}class l8 extends Th{constructor(e){super(e),this.verticalFillMode="fill",this.scrollTop=0,this.scrollLeft=0,this.vDomRowHeight=20,this.vDomTop=0,this.vDomBottom=0,this.vDomScrollPosTop=0,this.vDomScrollPosBottom=0,this.vDomTopPad=0,this.vDomBottomPad=0,this.vDomMaxRenderChain=90,this.vDomWindowBuffer=0,this.vDomWindowMinTotalRows=20,this.vDomWindowMinMarginRows=5,this.vDomTopNewRows=[],this.vDomBottomNewRows=[]}clearRows(){for(var e=this.tableElement;e.firstChild;)e.removeChild(e.firstChild);e.style.paddingTop="",e.style.paddingBottom="",e.style.minHeight="",e.style.display="",e.style.visibility="",this.elementVertical.scrollTop=0,this.elementVertical.scrollLeft=0,this.scrollTop=0,this.scrollLeft=0,this.vDomTop=0,this.vDomBottom=0,this.vDomTopPad=0,this.vDomBottomPad=0,this.vDomScrollPosTop=0,this.vDomScrollPosBottom=0}renderRows(){this._virtualRenderFill()}rerenderRows(e){for(var t=this.elementVertical.scrollTop,r=!1,a=!1,s=this.table.rowManager.scrollLeft,o=this.rows(),u=this.vDomTop;u<=this.vDomBottom;u++)if(o[u]){var h=t-o[u].getElement().offsetTop;if(a===!1||Math.abs(h)<a)a=h,r=u;else break}o.forEach(d=>{d.deinitializeHeight()}),e&&e(),this.rows().length?this._virtualRenderFill(r===!1?this.rows.length-1:r,!0,a||0):(this.clear(),this.table.rowManager.tableEmpty()),this.scrollColumns(s)}scrollColumns(e){this.table.rowManager.scrollHorizontal(e)}scrollRows(e,t){var r=e-this.vDomScrollPosTop,a=e-this.vDomScrollPosBottom,s=this.vDomWindowBuffer*2,o=this.rows();if(this.scrollTop=e,-r>s||a>s){var u=this.table.rowManager.scrollLeft;this._virtualRenderFill(Math.floor(this.elementVertical.scrollTop/this.elementVertical.scrollHeight*o.length)),this.scrollColumns(u)}else t?(r<0&&this._addTopRow(o,-r),a<0&&(this.vDomScrollHeight-this.scrollTop>this.vDomWindowBuffer?this._removeBottomRow(o,-a):this.vDomScrollPosBottom=this.scrollTop)):(a>=0&&this._addBottomRow(o,a),r>=0&&(this.scrollTop>this.vDomWindowBuffer?this._removeTopRow(o,r):this.vDomScrollPosTop=this.scrollTop))}resize(){this.vDomWindowBuffer=this.table.options.renderVerticalBuffer||this.elementVertical.clientHeight}scrollToRowNearestTop(e){var t=this.rows().indexOf(e);return!(Math.abs(this.vDomTop-t)>Math.abs(this.vDomBottom-t))}scrollToRow(e){var t=this.rows().indexOf(e);t>-1&&this._virtualRenderFill(t,!0)}visibleRows(e){var t=this.elementVertical.scrollTop,r=this.elementVertical.clientHeight+t,a=!1,s=0,o=0,u=this.rows();if(e)s=this.vDomTop,o=this.vDomBottom;else for(var h=this.vDomTop;h<=this.vDomBottom;h++)if(u[h])if(a)if(r-u[h].getElement().offsetTop>=0)o=h;else break;else if(t-u[h].getElement().offsetTop>=0)s=h;else if(a=!0,r-u[h].getElement().offsetTop>=0)o=h;else break;return u.slice(s,o+1)}_virtualRenderFill(e,t,r){var a=this.tableElement,s=this.elementVertical,o=0,u=0,h=0,d=0,p=0,b=0,g=this.rows(),v=g.length,y=0,C,E,w=[],R=0,T=0,D=this.table.rowManager.fixedHeight,k=this.elementVertical.clientHeight,V=this.table.options.rowHeight,P=!0;if(e=e||0,r=r||0,!e)this.clear();else{for(;a.firstChild;)a.removeChild(a.firstChild);d=(v-e+1)*this.vDomRowHeight,d<k&&(e-=Math.ceil((k-d)/this.vDomRowHeight),e<0&&(e=0)),o=Math.min(Math.max(Math.floor(this.vDomWindowBuffer/this.vDomRowHeight),this.vDomWindowMinMarginRows),e),e-=o}if(v&&Wt.elVisible(this.elementVertical)){for(this.vDomTop=e,this.vDomBottom=e-1,D||this.table.options.maxHeight?(V&&(T=k/V+this.vDomWindowBuffer/V),T=Math.max(this.vDomWindowMinTotalRows,Math.ceil(T))):T=v;(T==v||u<=k+this.vDomWindowBuffer||R<this.vDomWindowMinTotalRows)&&this.vDomBottom<v-1;){for(w=[],E=document.createDocumentFragment(),b=0;b<T&&this.vDomBottom<v-1;)y=this.vDomBottom+1,C=g[y],this.styleRow(C,y),C.initialize(!1,!0),!C.heightInitialized&&!this.table.options.rowHeight&&C.clearCellHeight(),E.appendChild(C.getElement()),w.push(C),this.vDomBottom++,b++;if(!w.length)break;a.appendChild(E),w.forEach(U=>{U.rendered(),U.heightInitialized||U.calcHeight(!0)}),w.forEach(U=>{U.heightInitialized||U.setCellHeight()}),w.forEach(U=>{h=U.getHeight(),R<o?p+=h:u+=h,h>this.vDomWindowBuffer&&(this.vDomWindowBuffer=h*2),R++}),P=this.table.rowManager.adjustTableSize(),k=this.elementVertical.clientHeight,P&&(D||this.table.options.maxHeight)&&(V=u/R,T=Math.max(this.vDomWindowMinTotalRows,Math.ceil(k/V+this.vDomWindowBuffer/V)))}e?(this.vDomTopPad=t?this.vDomRowHeight*this.vDomTop+r:this.scrollTop-p,this.vDomBottomPad=this.vDomBottom==v-1?0:Math.max(this.vDomScrollHeight-this.vDomTopPad-u-p,0)):(this.vDomTopPad=0,this.vDomRowHeight=Math.floor((u+p)/R),this.vDomBottomPad=this.vDomRowHeight*(v-this.vDomBottom-1),this.vDomScrollHeight=p+u+this.vDomBottomPad-k),a.style.paddingTop=this.vDomTopPad+"px",a.style.paddingBottom=this.vDomBottomPad+"px",t&&(this.scrollTop=this.vDomTopPad+p+r-(this.elementVertical.scrollWidth>this.elementVertical.clientWidth?this.elementVertical.offsetHeight-k:0)),this.scrollTop=Math.min(this.scrollTop,this.elementVertical.scrollHeight-k),this.elementVertical.scrollWidth>this.elementVertical.clientWidth&&t&&(this.scrollTop+=this.elementVertical.offsetHeight-k),this.vDomScrollPosTop=this.scrollTop,this.vDomScrollPosBottom=this.scrollTop,s.scrollTop=this.scrollTop,this.dispatch("render-virtual-fill")}}_addTopRow(e,t){for(var r=this.tableElement,a=[],s=0,o=this.vDomTop-1,u=0,h=!0;h;)if(this.vDomTop){let d=e[o],p,b;d&&u<this.vDomMaxRenderChain?(p=d.getHeight()||this.vDomRowHeight,b=d.initialized,t>=p?(this.styleRow(d,o),r.insertBefore(d.getElement(),r.firstChild),(!d.initialized||!d.heightInitialized)&&a.push(d),d.initialize(),b||(p=d.getElement().offsetHeight,p>this.vDomWindowBuffer&&(this.vDomWindowBuffer=p*2)),t-=p,s+=p,this.vDomTop--,o--,u++):h=!1):h=!1}else h=!1;for(let d of a)d.clearCellHeight();this._quickNormalizeRowHeight(a),s&&(this.vDomTopPad-=s,this.vDomTopPad<0&&(this.vDomTopPad=o*this.vDomRowHeight),o<1&&(this.vDomTopPad=0),r.style.paddingTop=this.vDomTopPad+"px",this.vDomScrollPosTop-=s)}_removeTopRow(e,t){for(var r=[],a=0,s=0,o=!0;o;){let u=e[this.vDomTop],h;u&&s<this.vDomMaxRenderChain?(h=u.getHeight()||this.vDomRowHeight,t>=h?(this.vDomTop++,t-=h,a+=h,r.push(u),s++):o=!1):o=!1}for(let u of r){let h=u.getElement();h.parentNode&&h.parentNode.removeChild(h)}a&&(this.vDomTopPad+=a,this.tableElement.style.paddingTop=this.vDomTopPad+"px",this.vDomScrollPosTop+=this.vDomTop?a:a+this.vDomWindowBuffer)}_addBottomRow(e,t){for(var r=this.tableElement,a=[],s=0,o=this.vDomBottom+1,u=0,h=!0;h;){let d=e[o],p,b;d&&u<this.vDomMaxRenderChain?(p=d.getHeight()||this.vDomRowHeight,b=d.initialized,t>=p?(this.styleRow(d,o),r.appendChild(d.getElement()),(!d.initialized||!d.heightInitialized)&&a.push(d),d.initialize(),b||(p=d.getElement().offsetHeight,p>this.vDomWindowBuffer&&(this.vDomWindowBuffer=p*2)),t-=p,s+=p,this.vDomBottom++,o++,u++):h=!1):h=!1}for(let d of a)d.clearCellHeight();this._quickNormalizeRowHeight(a),s&&(this.vDomBottomPad-=s,(this.vDomBottomPad<0||o==e.length-1)&&(this.vDomBottomPad=0),r.style.paddingBottom=this.vDomBottomPad+"px",this.vDomScrollPosBottom+=s)}_removeBottomRow(e,t){for(var r=[],a=0,s=0,o=!0;o;){let u=e[this.vDomBottom],h;u&&s<this.vDomMaxRenderChain?(h=u.getHeight()||this.vDomRowHeight,t>=h?(this.vDomBottom--,t-=h,a+=h,r.push(u),s++):o=!1):o=!1}for(let u of r){let h=u.getElement();h.parentNode&&h.parentNode.removeChild(h)}a&&(this.vDomBottomPad+=a,this.vDomBottomPad<0&&(this.vDomBottomPad=0),this.tableElement.style.paddingBottom=this.vDomBottomPad+"px",this.vDomScrollPosBottom-=a)}_quickNormalizeRowHeight(e){for(let t of e)t.calcHeight();for(let t of e)t.setCellHeight()}}class o8 extends zi{constructor(e){super(e),this.element=this.createHolderElement(),this.tableElement=this.createTableElement(),this.heightFixer=this.createTableElement(),this.placeholder=null,this.placeholderContents=null,this.firstRender=!1,this.renderMode="virtual",this.fixedHeight=!1,this.rows=[],this.activeRowsPipeline=[],this.activeRows=[],this.activeRowsCount=0,this.displayRows=[],this.displayRowsCount=0,this.scrollTop=0,this.scrollLeft=0,this.redrawBlock=!1,this.redrawBlockRestoreConfig=!1,this.redrawBlockRenderInPosition=!1,this.dataPipeline=[],this.displayPipeline=[],this.scrollbarWidth=0,this.renderer=null}createHolderElement(){var e=document.createElement("div");return e.classList.add("tabulator-tableholder"),e.setAttribute("tabindex",0),e}createTableElement(){var e=document.createElement("div");return e.classList.add("tabulator-table"),e.setAttribute("role","rowgroup"),e}initializePlaceholder(){var e=this.table.options.placeholder;if(typeof e=="function"&&(e=e.call(this.table)),e=this.chain("placeholder",[e],e,e)||e,e){let t=document.createElement("div");if(t.classList.add("tabulator-placeholder"),typeof e=="string"){let r=document.createElement("div");r.classList.add("tabulator-placeholder-contents"),r.innerHTML=e,t.appendChild(r),this.placeholderContents=r}else typeof HTMLElement<"u"&&e instanceof HTMLElement?(t.appendChild(e),this.placeholderContents=e):(console.warn("Invalid placeholder provided, must be string or HTML Element",e),this.el=null);this.placeholder=t}}getElement(){return this.element}getTableElement(){return this.tableElement}initialize(){this.initializePlaceholder(),this.initializeRenderer(),this.element.appendChild(this.tableElement),this.firstRender=!0,this.element.addEventListener("scroll",()=>{var e=this.element.scrollLeft,t=this.scrollLeft>e,r=this.element.scrollTop,a=this.scrollTop>r;this.scrollLeft!=e&&(this.scrollLeft=e,this.dispatch("scroll-horizontal",e,t),this.dispatchExternal("scrollHorizontal",e,t),this._positionPlaceholder()),this.scrollTop!=r&&(this.scrollTop=r,this.renderer.scrollRows(r,a),this.dispatch("scroll-vertical",r,a),this.dispatchExternal("scrollVertical",r,a))})}findRow(e){if(typeof e=="object"){if(e instanceof Gi)return e;if(e instanceof Eh)return e._getSelf()||!1;if(typeof HTMLElement<"u"&&e instanceof HTMLElement)return this.rows.find(r=>r.getElement()===e)||!1;if(e===null)return!1}else return typeof e>"u"?!1:this.rows.find(r=>r.data[this.table.options.index]==e)||!1;return!1}getRowFromDataObject(e){var t=this.rows.find(r=>r.data===e);return t||!1}getRowFromPosition(e){return this.getDisplayRows().find(t=>t.type==="row"&&t.getPosition()===e&&t.isDisplayed())}scrollToRow(e,t,r){return this.renderer.scrollToRowPosition(e,t,r)}setData(e,t,r){return new Promise((a,s)=>{t&&this.getDisplayRows().length?this.table.options.pagination?this._setDataActual(e,!0):this.reRenderInPosition(()=>{this._setDataActual(e)}):(this.table.options.autoColumns&&r&&this.table.initialized&&this.table.columnManager.generateColumnsFromRowData(e),this.resetScroll(),this._setDataActual(e)),a()})}_setDataActual(e,t){this.dispatchExternal("dataProcessing",e),this._wipeElements(),Array.isArray(e)?(this.dispatch("data-processing",e),e.forEach((r,a)=>{if(r&&typeof r=="object"){var s=new Gi(r,this);this.rows.push(s)}else console.warn("Data Loading Warning - Invalid row data detected and ignored, expecting object but received:",r)}),this.refreshActiveData(!1,!1,t),this.dispatch("data-processed",e),this.dispatchExternal("dataProcessed",e)):console.error(`Data Loading Error - Unable to process data due to invalid data type 
Expecting: array 
Received: `,typeof e,`
Data:     `,e)}_wipeElements(){this.dispatch("rows-wipe"),this.destroy(),this.adjustTableSize(),this.dispatch("rows-wiped")}destroy(){this.rows.forEach(e=>{e.wipe()}),this.rows=[],this.activeRows=[],this.activeRowsPipeline=[],this.activeRowsCount=0,this.displayRows=[],this.displayRowsCount=0}deleteRow(e,t){var r=this.rows.indexOf(e),a=this.activeRows.indexOf(e);a>-1&&this.activeRows.splice(a,1),r>-1&&this.rows.splice(r,1),this.setActiveRows(this.activeRows),this.displayRowIterator(s=>{var o=s.indexOf(e);o>-1&&s.splice(o,1)}),t||this.reRenderInPosition(),this.regenerateRowPositions(),this.dispatchExternal("rowDeleted",e.getComponent()),this.displayRowsCount||this.tableEmpty(),this.subscribedExternal("dataChanged")&&this.dispatchExternal("dataChanged",this.getData())}addRow(e,t,r,a){var s=this.addRowActual(e,t,r,a);return s}addRows(e,t,r,a){var s=[];return new Promise((o,u)=>{t=this.findAddRowPos(t),Array.isArray(e)||(e=[e]),(typeof r>"u"&&t||typeof r<"u"&&!t)&&e.reverse(),e.forEach((h,d)=>{var p=this.addRow(h,t,r,!0);s.push(p),this.dispatch("row-added",p,h,t,r)}),this.refreshActiveData(a?"displayPipeline":!1,!1,!0),this.regenerateRowPositions(),this.displayRowsCount&&this._clearPlaceholder(),o(s)})}findAddRowPos(e){return typeof e>"u"&&(e=this.table.options.addRowPos),e==="pos"&&(e=!0),e==="bottom"&&(e=!1),e}addRowActual(e,t,r,a){var s=e instanceof Gi?e:new Gi(e||{},this),o=this.findAddRowPos(t),u=-1,h,d;return r||(d=this.chain("row-adding-position",[s,o],null,{index:r,top:o}),r=d.index,o=d.top),typeof r<"u"&&(r=this.findRow(r)),r=this.chain("row-adding-index",[s,r,o],null,r),r&&(u=this.rows.indexOf(r)),r&&u>-1?(h=this.activeRows.indexOf(r),this.displayRowIterator(function(p){var b=p.indexOf(r);b>-1&&p.splice(o?b:b+1,0,s)}),h>-1&&this.activeRows.splice(o?h:h+1,0,s),this.rows.splice(o?u:u+1,0,s)):o?(this.displayRowIterator(function(p){p.unshift(s)}),this.activeRows.unshift(s),this.rows.unshift(s)):(this.displayRowIterator(function(p){p.push(s)}),this.activeRows.push(s),this.rows.push(s)),this.setActiveRows(this.activeRows),this.dispatchExternal("rowAdded",s.getComponent()),this.subscribedExternal("dataChanged")&&this.dispatchExternal("dataChanged",this.table.rowManager.getData()),a||this.reRenderInPosition(),s}moveRow(e,t,r){this.dispatch("row-move",e,t,r),this.moveRowActual(e,t,r),this.regenerateRowPositions(),this.dispatch("row-moved",e,t,r),this.dispatchExternal("rowMoved",e.getComponent())}moveRowActual(e,t,r){this.moveRowInArray(this.rows,e,t,r),this.moveRowInArray(this.activeRows,e,t,r),this.displayRowIterator(a=>{this.moveRowInArray(a,e,t,r)}),this.dispatch("row-moving",e,t,r)}moveRowInArray(e,t,r,a){var s,o,u,h;if(t!==r&&(s=e.indexOf(t),s>-1&&(e.splice(s,1),o=e.indexOf(r),o>-1?a?e.splice(o+1,0,t):e.splice(o,0,t):e.splice(s,0,t)),e===this.getDisplayRows())){u=s<o?s:o,h=o>s?o:s+1;for(let d=u;d<=h;d++)e[d]&&this.styleRow(e[d],d)}}clearData(){this.setData([])}getRowIndex(e){return this.findRowIndex(e,this.rows)}getDisplayRowIndex(e){var t=this.getDisplayRows().indexOf(e);return t>-1?t:!1}nextDisplayRow(e,t){var r=this.getDisplayRowIndex(e),a=!1;return r!==!1&&r<this.displayRowsCount-1&&(a=this.getDisplayRows()[r+1]),a&&(!(a instanceof Gi)||a.type!="row")?this.nextDisplayRow(a,t):a}prevDisplayRow(e,t){var r=this.getDisplayRowIndex(e),a=!1;return r&&(a=this.getDisplayRows()[r-1]),t&&a&&(!(a instanceof Gi)||a.type!="row")?this.prevDisplayRow(a,t):a}findRowIndex(e,t){var r;return e=this.findRow(e),e&&(r=t.indexOf(e),r>-1)?r:!1}getData(e,t){var r=[],a=this.getRows(e);return a.forEach(function(s){s.type=="row"&&r.push(s.getData(t||"data"))}),r}getComponents(e){var t=[],r=this.getRows(e);return r.forEach(function(a){t.push(a.getComponent())}),t}getDataCount(e){var t=this.getRows(e);return t.length}scrollHorizontal(e){this.scrollLeft=e,this.element.scrollLeft=e,this.dispatch("scroll-horizontal",e)}registerDataPipelineHandler(e,t){typeof t<"u"?(this.dataPipeline.push({handler:e,priority:t}),this.dataPipeline.sort((r,a)=>r.priority-a.priority)):console.error("Data pipeline handlers must have a priority in order to be registered")}registerDisplayPipelineHandler(e,t){typeof t<"u"?(this.displayPipeline.push({handler:e,priority:t}),this.displayPipeline.sort((r,a)=>r.priority-a.priority)):console.error("Display pipeline handlers must have a priority in order to be registered")}refreshActiveData(e,t,r){var a=this.table,s="",o=0,u=["all","dataPipeline","display","displayPipeline","end"];if(!this.table.destroyed){if(typeof e=="function")if(o=this.dataPipeline.findIndex(h=>h.handler===e),o>-1)s="dataPipeline",t&&(o==this.dataPipeline.length-1?s="display":o++);else if(o=this.displayPipeline.findIndex(h=>h.handler===e),o>-1)s="displayPipeline",t&&(o==this.displayPipeline.length-1?s="end":o++);else{console.error("Unable to refresh data, invalid handler provided",e);return}else s=e||"all",o=0;if(this.redrawBlock){(!this.redrawBlockRestoreConfig||this.redrawBlockRestoreConfig&&(this.redrawBlockRestoreConfig.stage===s&&o<this.redrawBlockRestoreConfig.index||u.indexOf(s)<u.indexOf(this.redrawBlockRestoreConfig.stage)))&&(this.redrawBlockRestoreConfig={handler:e,skipStage:t,renderInPosition:r,stage:s,index:o});return}else Wt.elVisible(this.element)?r?this.reRenderInPosition(this.refreshPipelines.bind(this,e,s,o,r)):(this.refreshPipelines(e,s,o,r),e||this.table.columnManager.renderer.renderColumns(),this.renderTable(),a.options.layoutColumnsOnNewData&&this.table.columnManager.redraw(!0)):this.refreshPipelines(e,s,o,r),this.dispatch("data-refreshed")}}refreshPipelines(e,t,r,a){switch(this.dispatch("data-refreshing"),(!e||!this.activeRowsPipeline[0])&&(this.activeRowsPipeline[0]=this.rows.slice(0)),t){case"all":case"dataPipeline":for(let s=r;s<this.dataPipeline.length;s++){let o=this.dataPipeline[s].handler(this.activeRowsPipeline[s].slice(0));this.activeRowsPipeline[s+1]=o||this.activeRowsPipeline[s].slice(0)}this.setActiveRows(this.activeRowsPipeline[this.dataPipeline.length]);case"display":r=0,this.resetDisplayRows();case"displayPipeline":for(let s=r;s<this.displayPipeline.length;s++){let o=this.displayPipeline[s].handler((s?this.getDisplayRows(s-1):this.activeRows).slice(0),a);this.setDisplayRows(o||this.getDisplayRows(s-1).slice(0),s)}case"end":this.regenerateRowPositions()}this.getDisplayRows().length&&this._clearPlaceholder()}regenerateRowPositions(){var e=this.getDisplayRows(),t=1;e.forEach(r=>{r.type==="row"&&(r.setPosition(t),t++)})}setActiveRows(e){this.activeRows=this.activeRows=Object.assign([],e),this.activeRowsCount=this.activeRows.length}resetDisplayRows(){this.displayRows=[],this.displayRows.push(this.activeRows.slice(0)),this.displayRowsCount=this.displayRows[0].length}setDisplayRows(e,t){this.displayRows[t]=e,t==this.displayRows.length-1&&(this.displayRowsCount=this.displayRows[this.displayRows.length-1].length)}getDisplayRows(e){return typeof e>"u"?this.displayRows.length?this.displayRows[this.displayRows.length-1]:[]:this.displayRows[e]||[]}getVisibleRows(e,t){var r=Object.assign([],this.renderer.visibleRows(!t));return e&&(r=this.chain("rows-visible",[t],r,r)),r}displayRowIterator(e){this.activeRowsPipeline.forEach(e),this.displayRows.forEach(e),this.displayRowsCount=this.displayRows[this.displayRows.length-1].length}getRows(e){var t=[];switch(e){case"active":t=this.activeRows;break;case"display":t=this.table.rowManager.getDisplayRows();break;case"visible":t=this.getVisibleRows(!1,!0);break;default:t=this.chain("rows-retrieve",e,null,this.rows)||this.rows}return t}reRenderInPosition(e){this.redrawBlock?e?e():this.redrawBlockRenderInPosition=!0:(this.dispatchExternal("renderStarted"),this.renderer.rerenderRows(e),this.fixedHeight||this.adjustTableSize(),this.scrollBarCheck(),this.dispatchExternal("renderComplete"))}scrollBarCheck(){var e=0;this.element.scrollHeight>this.element.clientHeight&&(e=this.element.offsetWidth-this.element.clientWidth),e!==this.scrollbarWidth&&(this.scrollbarWidth=e,this.dispatch("scrollbar-vertical",e))}initializeRenderer(){var e,t={virtual:l8,basic:s8};typeof this.table.options.renderVertical=="string"?e=t[this.table.options.renderVertical]:e=this.table.options.renderVertical,e?(this.renderMode=this.table.options.renderVertical,this.renderer=new e(this.table,this.element,this.tableElement),this.renderer.initialize(),(this.table.element.clientHeight||this.table.options.height)&&!(this.table.options.minHeight&&this.table.options.maxHeight)?this.fixedHeight=!0:this.fixedHeight=!1):console.error("Unable to find matching renderer:",this.table.options.renderVertical)}getRenderMode(){return this.renderMode}renderTable(){this.dispatchExternal("renderStarted"),this.element.scrollTop=0,this._clearTable(),this.displayRowsCount?(this.renderer.renderRows(),this.firstRender&&(this.firstRender=!1,this.fixedHeight||this.adjustTableSize(),this.layoutRefresh(!0))):this.renderEmptyScroll(),this.fixedHeight||this.adjustTableSize(),this.dispatch("table-layout"),this.displayRowsCount||this._showPlaceholder(),this.scrollBarCheck(),this.dispatchExternal("renderComplete")}renderEmptyScroll(){this.placeholder?this.tableElement.style.display="none":this.tableElement.style.minWidth=this.table.columnManager.getWidth()+"px"}_clearTable(){this._clearPlaceholder(),this.scrollTop=0,this.scrollLeft=0,this.renderer.clearRows()}tableEmpty(){this.renderEmptyScroll(),this._showPlaceholder()}checkPlaceholder(){this.displayRowsCount?this._clearPlaceholder():this.tableEmpty()}_showPlaceholder(){this.placeholder&&(this.placeholder&&this.placeholder.parentNode&&this.placeholder.parentNode.removeChild(this.placeholder),this.initializePlaceholder(),this.placeholder.setAttribute("tabulator-render-mode",this.renderMode),this.getElement().appendChild(this.placeholder),this._positionPlaceholder(),this.adjustTableSize())}_clearPlaceholder(){this.placeholder&&this.placeholder.parentNode&&this.placeholder.parentNode.removeChild(this.placeholder),this.tableElement.style.minWidth="",this.tableElement.style.display=""}_positionPlaceholder(){this.placeholder&&this.placeholder.parentNode&&(this.placeholder.style.width=this.table.columnManager.getWidth()+"px",this.placeholderContents.style.width=this.table.rowManager.element.clientWidth+"px",this.placeholderContents.style.marginLeft=this.scrollLeft+"px")}styleRow(e,t){var r=e.getElement();t%2?(r.classList.add("tabulator-row-even"),r.classList.remove("tabulator-row-odd")):(r.classList.add("tabulator-row-odd"),r.classList.remove("tabulator-row-even"))}normalizeHeight(e){this.activeRows.forEach(function(t){t.normalizeHeight(e)})}adjustTableSize(){let e=this.element.clientHeight,t,r=!1;if(this.renderer.verticalFillMode==="fill"){let a=Math.floor(this.table.columnManager.getElement().getBoundingClientRect().height+(this.table.footerManager&&this.table.footerManager.active&&!this.table.footerManager.external?this.table.footerManager.getElement().getBoundingClientRect().height:0));if(this.fixedHeight){t=isNaN(this.table.options.minHeight)?this.table.options.minHeight:this.table.options.minHeight+"px";const s="calc(100% - "+a+"px)";this.element.style.minHeight=t||"calc(100% - "+a+"px)",this.element.style.height=s,this.element.style.maxHeight=s}else this.element.style.height="",this.element.style.height=this.table.element.clientHeight-a+"px",this.element.scrollTop=this.scrollTop;this.renderer.resize(),!this.fixedHeight&&e!=this.element.clientHeight&&(r=!0,this.subscribed("table-resize")?this.dispatch("table-resize"):this.redraw()),this.scrollBarCheck()}return this._positionPlaceholder(),r}reinitialize(){this.rows.forEach(function(e){e.reinitialize(!0)})}blockRedraw(){this.redrawBlock=!0,this.redrawBlockRestoreConfig=!1}restoreRedraw(){this.redrawBlock=!1,this.redrawBlockRestoreConfig?(this.refreshActiveData(this.redrawBlockRestoreConfig.handler,this.redrawBlockRestoreConfig.skipStage,this.redrawBlockRestoreConfig.renderInPosition),this.redrawBlockRestoreConfig=!1):this.redrawBlockRenderInPosition&&this.reRenderInPosition(),this.redrawBlockRenderInPosition=!1}redraw(e){this.adjustTableSize(),this.table.tableWidth=this.table.element.clientWidth,e?this.renderTable():(this.reRenderInPosition(),this.scrollHorizontal(this.scrollLeft))}resetScroll(){if(this.element.scrollLeft=0,this.element.scrollTop=0,this.table.browser==="ie"){var e=document.createEvent("Event");e.initEvent("scroll",!1,!0),this.element.dispatchEvent(e)}else this.element.dispatchEvent(new Event("scroll"))}}class u8 extends zi{constructor(e){super(e),this.active=!1,this.element=this.createElement(),this.containerElement=this.createContainerElement(),this.external=!1}initialize(){this.initializeElement()}createElement(){var e=document.createElement("div");return e.classList.add("tabulator-footer"),e}createContainerElement(){var e=document.createElement("div");return e.classList.add("tabulator-footer-contents"),this.element.appendChild(e),e}initializeElement(){if(this.table.options.footerElement)switch(typeof this.table.options.footerElement){case"string":this.table.options.footerElement[0]==="<"?this.containerElement.innerHTML=this.table.options.footerElement:(this.external=!0,this.containerElement=document.querySelector(this.table.options.footerElement));break;default:this.element=this.table.options.footerElement;break}}getElement(){return this.element}append(e){this.activate(),this.containerElement.appendChild(e),this.table.rowManager.adjustTableSize()}prepend(e){this.activate(),this.element.insertBefore(e,this.element.firstChild),this.table.rowManager.adjustTableSize()}remove(e){e.parentNode.removeChild(e),this.deactivate()}deactivate(e){(!this.element.firstChild||e)&&(this.external||this.element.parentNode.removeChild(this.element),this.active=!1)}activate(){this.active||(this.active=!0,this.external||(this.table.element.appendChild(this.getElement()),this.table.element.style.display=""))}redraw(){this.dispatch("footer-redraw")}}class c8 extends zi{constructor(e){super(e),this.el=null,this.abortClasses=["tabulator-headers","tabulator-table"],this.previousTargets={},this.listeners=["click","dblclick","contextmenu","mouseenter","mouseleave","mouseover","mouseout","mousemove","mouseup","mousedown","touchstart","touchend"],this.componentMap={"tabulator-cell":"cell","tabulator-row":"row","tabulator-group":"group","tabulator-col":"column"},this.pseudoTrackers={row:{subscriber:null,target:null},cell:{subscriber:null,target:null},group:{subscriber:null,target:null},column:{subscriber:null,target:null}},this.pseudoTracking=!1}initialize(){this.el=this.table.element,this.buildListenerMap(),this.bindSubscriptionWatchers()}buildListenerMap(){var e={};this.listeners.forEach(t=>{e[t]={handler:null,components:[]}}),this.listeners=e}bindPseudoEvents(){Object.keys(this.pseudoTrackers).forEach(e=>{this.pseudoTrackers[e].subscriber=this.pseudoMouseEnter.bind(this,e),this.subscribe(e+"-mouseover",this.pseudoTrackers[e].subscriber)}),this.pseudoTracking=!0}pseudoMouseEnter(e,t,r){this.pseudoTrackers[e].target!==r&&(this.pseudoTrackers[e].target&&this.dispatch(e+"-mouseleave",t,this.pseudoTrackers[e].target),this.pseudoMouseLeave(e,t),this.pseudoTrackers[e].target=r,this.dispatch(e+"-mouseenter",t,r))}pseudoMouseLeave(e,t){var r=Object.keys(this.pseudoTrackers),a={row:["cell"],cell:["row"]};r=r.filter(s=>{var o=a[e];return s!==e&&(!o||o&&!o.includes(s))}),r.forEach(s=>{var o=this.pseudoTrackers[s].target;this.pseudoTrackers[s].target&&(this.dispatch(s+"-mouseleave",t,o),this.pseudoTrackers[s].target=null)})}bindSubscriptionWatchers(){var e=Object.keys(this.listeners),t=Object.values(this.componentMap);for(let r of t)for(let a of e){let s=r+"-"+a;this.subscriptionChange(s,this.subscriptionChanged.bind(this,r,a))}this.subscribe("table-destroy",this.clearWatchers.bind(this))}subscriptionChanged(e,t,r){var a=this.listeners[t].components,s=a.indexOf(e),o=!1;r?s===-1&&(a.push(e),o=!0):this.subscribed(e+"-"+t)||s>-1&&(a.splice(s,1),o=!0),(t==="mouseenter"||t==="mouseleave")&&!this.pseudoTracking&&this.bindPseudoEvents(),o&&this.updateEventListeners()}updateEventListeners(){for(let e in this.listeners){let t=this.listeners[e];t.components.length?t.handler||(t.handler=this.track.bind(this,e),this.el.addEventListener(e,t.handler)):t.handler&&(this.el.removeEventListener(e,t.handler),t.handler=null)}}track(e,t){var r=t.composedPath&&t.composedPath()||t.path,a=this.findTargets(r);a=this.bindComponents(e,a),this.triggerEvents(e,t,a),this.pseudoTracking&&(e=="mouseover"||e=="mouseleave")&&!Object.keys(a).length&&this.pseudoMouseLeave("none",t)}findTargets(e){var t={};let r=Object.keys(this.componentMap);for(let a of e){let s=a.classList?[...a.classList]:[];if(s.filter(h=>this.abortClasses.includes(h)).length)break;let u=s.filter(h=>r.includes(h));for(let h of u)t[this.componentMap[h]]||(t[this.componentMap[h]]=a)}return t.group&&t.group===t.row&&delete t.row,t}bindComponents(e,t){var r=Object.keys(t).reverse(),a=this.listeners[e],s={},o={},u={};for(let h of r){let d,p=t[h],b=this.previousTargets[h];if(b&&b.target===p)d=b.component;else switch(h){case"row":case"group":(a.components.includes("row")||a.components.includes("cell")||a.components.includes("group"))&&(d=this.table.rowManager.getVisibleRows(!0).find(v=>v.getElement()===p),t.row&&t.row.parentNode&&t.row.parentNode.closest(".tabulator-row")&&(t[h]=!1));break;case"column":a.components.includes("column")&&(d=this.table.columnManager.findColumn(p));break;case"cell":a.components.includes("cell")&&(s.row instanceof Gi?d=s.row.findCell(p):t.row&&console.warn("Event Target Lookup Error - The row this cell is attached to cannot be found, has the table been reinitialized without being destroyed first?"));break}d&&(s[h]=d,u[h]={target:p,component:d})}return this.previousTargets=u,Object.keys(t).forEach(h=>{let d=s[h];o[h]=d}),o}triggerEvents(e,t,r){var a=this.listeners[e];for(let s in r)r[s]&&a.components.includes(s)&&this.dispatch(s+"-"+e,t,r[s])}clearWatchers(){for(let e in this.listeners){let t=this.listeners[e];t.handler&&(this.el.removeEventListener(e,t.handler),t.handler=null)}}}class h8{constructor(e){this.table=e,this.bindings={}}bind(e,t,r){this.bindings[e]||(this.bindings[e]={}),this.bindings[e][t]?console.warn("Unable to bind component handler, a matching function name is already bound",e,t,r):this.bindings[e][t]=r}handle(e,t,r){if(this.bindings[e]&&this.bindings[e][r]&&typeof this.bindings[e][r].bind=="function")return this.bindings[e][r].bind(null,t);r!=="then"&&typeof r=="string"&&!r.startsWith("_")&&this.table.options.debugInvalidComponentFuncs&&console.error("The "+e+" component does not have a "+r+" function, have you checked that you have the correct Tabulator module installed?")}}class f8 extends zi{constructor(e){super(e),this.requestOrder=0,this.loading=!1}initialize(){}load(e,t,r,a,s,o){var u=++this.requestOrder;if(this.table.destroyed)return Promise.resolve();if(this.dispatchExternal("dataLoading",e),e&&(e.indexOf("{")==0||e.indexOf("[")==0)&&(e=JSON.parse(e)),this.confirm("data-loading",[e,t,r,s])){this.loading=!0,s||this.alertLoader(),t=this.chain("data-params",[e,r,s],t||{},t||{}),t=this.mapParams(t,this.table.options.dataSendParams);var h=this.chain("data-load",[e,t,r,s],!1,Promise.resolve([]));return h.then(d=>{if(this.table.destroyed)console.warn("Data Load Response Blocked - Table has been destroyed");else{!Array.isArray(d)&&typeof d=="object"&&(d=this.mapParams(d,this.objectInvert(this.table.options.dataReceiveParams)));var p=this.chain("data-loaded",[d],null,d);u==this.requestOrder?(this.clearAlert(),p!==!1&&(this.dispatchExternal("dataLoaded",p),this.table.rowManager.setData(p,a,typeof o>"u"?!a:o))):console.warn("Data Load Response Blocked - An active data load request was blocked by an attempt to change table data while the request was being made")}}).catch(d=>{console.error("Data Load Error: ",d),this.dispatchExternal("dataLoadError",d),s||this.alertError(),setTimeout(()=>{this.clearAlert()},this.table.options.dataLoaderErrorTimeout)}).finally(()=>{this.loading=!1})}else return this.dispatchExternal("dataLoaded",e),e||(e=[]),this.table.rowManager.setData(e,a,typeof o>"u"?!a:o),Promise.resolve()}mapParams(e,t){var r={};for(let a in e)r[t.hasOwnProperty(a)?t[a]:a]=e[a];return r}objectInvert(e){var t={};for(let r in e)t[e[r]]=r;return t}blockActiveLoad(){this.requestOrder++}alertLoader(){var e=typeof this.table.options.dataLoader=="function"?this.table.options.dataLoader():this.table.options.dataLoader;e&&this.table.alertManager.alert(this.table.options.dataLoaderLoading||this.langText("data|loading"))}alertError(){this.table.alertManager.alert(this.table.options.dataLoaderError||this.langText("data|error"),"error")}clearAlert(){this.table.alertManager.clear()}}class d8{constructor(e,t,r){this.table=e,this.events={},this.optionsList=t||{},this.subscriptionNotifiers={},this.dispatch=r?this._debugDispatch.bind(this):this._dispatch.bind(this),this.debug=r}subscriptionChange(e,t){this.subscriptionNotifiers[e]||(this.subscriptionNotifiers[e]=[]),this.subscriptionNotifiers[e].push(t),this.subscribed(e)&&this._notifySubscriptionChange(e,!0)}subscribe(e,t){this.events[e]||(this.events[e]=[]),this.events[e].push(t),this._notifySubscriptionChange(e,!0)}unsubscribe(e,t){var r;if(this.events[e])if(t)if(r=this.events[e].findIndex(a=>a===t),r>-1)this.events[e].splice(r,1);else{console.warn("Cannot remove event, no matching event found:",e,t);return}else delete this.events[e];else{console.warn("Cannot remove event, no events set on:",e);return}this._notifySubscriptionChange(e,!1)}subscribed(e){return this.events[e]&&this.events[e].length}_notifySubscriptionChange(e,t){var r=this.subscriptionNotifiers[e];r&&r.forEach(a=>{a(t)})}_dispatch(){var e=Array.from(arguments),t=e.shift(),r;return this.events[t]&&this.events[t].forEach((a,s)=>{let o=a.apply(this.table,e);s||(r=o)}),r}_debugDispatch(){var e=Array.from(arguments),t=e[0];return e[0]="ExternalEvent:"+e[0],(this.debug===!0||this.debug.includes(t))&&console.log(...e),this._dispatch(...arguments)}}class p8{constructor(e){this.events={},this.subscriptionNotifiers={},this.dispatch=e?this._debugDispatch.bind(this):this._dispatch.bind(this),this.chain=e?this._debugChain.bind(this):this._chain.bind(this),this.confirm=e?this._debugConfirm.bind(this):this._confirm.bind(this),this.debug=e}subscriptionChange(e,t){this.subscriptionNotifiers[e]||(this.subscriptionNotifiers[e]=[]),this.subscriptionNotifiers[e].push(t),this.subscribed(e)&&this._notifySubscriptionChange(e,!0)}subscribe(e,t,r=1e4){this.events[e]||(this.events[e]=[]),this.events[e].push({callback:t,priority:r}),this.events[e].sort((a,s)=>a.priority-s.priority),this._notifySubscriptionChange(e,!0)}unsubscribe(e,t){var r;if(this.events[e]){if(t)if(r=this.events[e].findIndex(a=>a.callback===t),r>-1)this.events[e].splice(r,1);else{console.warn("Cannot remove event, no matching event found:",e,t);return}}else{console.warn("Cannot remove event, no events set on:",e);return}this._notifySubscriptionChange(e,!1)}subscribed(e){return this.events[e]&&this.events[e].length}_chain(e,t,r,a){var s=r;return Array.isArray(t)||(t=[t]),this.subscribed(e)?(this.events[e].forEach((o,u)=>{s=o.callback.apply(this,t.concat([s]))}),s):typeof a=="function"?a():a}_confirm(e,t){var r=!1;return Array.isArray(t)||(t=[t]),this.subscribed(e)&&this.events[e].forEach((a,s)=>{a.callback.apply(this,t)&&(r=!0)}),r}_notifySubscriptionChange(e,t){var r=this.subscriptionNotifiers[e];r&&r.forEach(a=>{a(t)})}_dispatch(){var e=Array.from(arguments),t=e.shift();this.events[t]&&this.events[t].forEach(r=>{r.callback.apply(this,e)})}_debugDispatch(){var e=Array.from(arguments),t=e[0];return e[0]="InternalEvent:"+t,(this.debug===!0||this.debug.includes(t))&&console.log(...e),this._dispatch(...arguments)}_debugChain(){var e=Array.from(arguments),t=e[0];return e[0]="InternalEvent:"+t,(this.debug===!0||this.debug.includes(t))&&console.log(...e),this._chain(...arguments)}_debugConfirm(){var e=Array.from(arguments),t=e[0];return e[0]="InternalEvent:"+t,(this.debug===!0||this.debug.includes(t))&&console.log(...e),this._confirm(...arguments)}}class m8 extends zi{constructor(e){super(e)}_warnUser(){this.options("debugDeprecation")&&console.warn(...arguments)}check(e,t,r){var a="";return typeof this.options(e)<"u"?(a="Deprecated Setup Option - Use of the %c"+e+"%c option is now deprecated",t?(a=a+", Please use the %c"+t+"%c option instead",this._warnUser(a,"font-weight: bold;","font-weight: normal;","font-weight: bold;","font-weight: normal;"),r&&(this.table.options[t]=this.table.options[e])):this._warnUser(a,"font-weight: bold;","font-weight: normal;"),!1):!0}checkMsg(e,t){return typeof this.options(e)<"u"?(this._warnUser("%cDeprecated Setup Option - Use of the %c"+e+" %c option is now deprecated, "+t,"font-weight: normal;","font-weight: bold;","font-weight: normal;"),!1):!0}msg(e){this._warnUser(e)}}class g8 extends zi{constructor(e){super(e),this.deps={},this.props={}}initialize(){this.deps=Object.assign({},this.options("dependencies"))}lookup(e,t,r){if(Array.isArray(e)){for(const s of e){var a=this.lookup(s,t,!0);if(a)break}if(a)return a;this.error(e)}else return t?this.lookupProp(e,t,r):this.lookupKey(e,r)}lookupProp(e,t,r){var a;if(this.props[e]&&this.props[e][t])return this.props[e][t];if(a=this.lookupKey(e,r),a)return this.props[e]||(this.props[e]={}),this.props[e][t]=a[t]||a,this.props[e][t]}lookupKey(e,t){var r;return this.deps[e]?r=this.deps[e]:window[e]?(this.deps[e]=window[e],r=this.deps[e]):t||this.error(e),r}error(e){console.error("Unable to find dependency",e,"Please check documentation and ensure you have imported the required library into your project")}}function v8(i,e){e&&this.table.columnManager.renderer.reinitializeColumnWidths(i),this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.update()}function Qb(i,e){i.forEach(function(t){t.reinitializeWidth()}),this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.update()}function b8(i,e){var t=0,r=this.table.rowManager.element.clientWidth,a=0,s=!1;i.forEach((o,u)=>{o.widthFixed||o.reinitializeWidth(),(this.table.options.responsiveLayout?o.modules.responsive.visible:o.visible)&&(s=o),o.visible&&(t+=o.getWidth())}),s?(a=r-t+s.getWidth(),this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&(s.setWidth(0),this.table.modules.responsiveLayout.update()),a>0?s.setWidth(a):s.reinitializeWidth()):this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.update()}function x8(i,e){var t=this.table.rowManager.element.getBoundingClientRect().width,r=0,a=0,s=0,o=0,u=[],h=[],d=0,p=0,b=0;function g(y){var C;return typeof y=="string"?y.indexOf("%")>-1?C=t/100*parseInt(y):C=parseInt(y):C=y,C}function v(y,C,E,w){var R=[],T=0,D=0,k=0,V=s,P=0,U=0,N=[];function j(Z){return E*(Z.column.definition.widthGrow||1)}function Y(Z){return g(Z.width)-E*(Z.column.definition.widthShrink||0)}return y.forEach(function(Z,ce){var Le=w?Y(Z):j(Z);Z.column.minWidth>=Le?R.push(Z):Z.column.maxWidth&&Z.column.maxWidth<Le?(Z.width=Z.column.maxWidth,C-=Z.column.maxWidth,V-=w?Z.column.definition.widthShrink||1:Z.column.definition.widthGrow||1,V&&(E=Math.floor(C/V))):(N.push(Z),U+=w?Z.column.definition.widthShrink||1:Z.column.definition.widthGrow||1)}),R.length?(R.forEach(function(Z){T+=w?Z.width-Z.column.minWidth:Z.column.minWidth,Z.width=Z.column.minWidth}),D=C-T,k=U?Math.floor(D/U):D,P=v(N,D,k,w)):(P=U?C-Math.floor(C/U)*U:C,N.forEach(function(Z){Z.width=w?Y(Z):j(Z)})),P}this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.update(),this.table.rowManager.element.scrollHeight>this.table.rowManager.element.clientHeight&&(t-=this.table.rowManager.element.offsetWidth-this.table.rowManager.element.clientWidth),i.forEach(function(y){var C,E,w;y.visible&&(C=y.definition.width,E=parseInt(y.minWidth),C?(w=g(C),r+=w>E?w:E,y.definition.widthShrink&&(h.push({column:y,width:w>E?w:E}),d+=y.definition.widthShrink)):(u.push({column:y,width:0}),s+=y.definition.widthGrow||1))}),a=t-r,o=Math.floor(a/s),b=v(u,a,o,!1),u.length&&b>0&&(u[u.length-1].width+=b),u.forEach(function(y){a-=y.width}),p=Math.abs(b)+a,p>0&&d&&(b=v(h,p,Math.floor(p/d),!0)),b&&h.length&&(h[h.length-1].width-=b),u.forEach(function(y){y.column.setWidth(y.width)}),h.forEach(function(y){y.column.setWidth(y.width)})}var w8={fitData:v8,fitDataFill:Qb,fitDataTable:Qb,fitDataStretch:b8,fitColumns:x8};const hl=class hl extends ct{constructor(e){super(e,"layout"),this.mode=null,this.registerTableOption("layout","fitData"),this.registerTableOption("layoutColumnsOnNewData",!1),this.registerColumnOption("widthGrow"),this.registerColumnOption("widthShrink")}initialize(){var e=this.table.options.layout;hl.modes[e]?this.mode=e:(console.warn("Layout Error - invalid mode set, defaulting to 'fitData' : "+e),this.mode="fitData"),this.table.element.setAttribute("tabulator-layout",this.mode),this.subscribe("column-init",this.initializeColumn.bind(this))}initializeColumn(e){e.definition.widthGrow&&(e.definition.widthGrow=Number(e.definition.widthGrow)),e.definition.widthShrink&&(e.definition.widthShrink=Number(e.definition.widthShrink))}getMode(){return this.mode}layout(e){var t=this.table.columnManager.columnsByIndex.find(r=>r.definition.variableHeight||r.definition.formatter==="textarea");this.dispatch("layout-refreshing"),hl.modes[this.mode].call(this,this.table.columnManager.columnsByIndex,e),t&&this.table.rowManager.normalizeHeight(!0),this.dispatch("layout-refreshed")}};Be(hl,"moduleName","layout"),Be(hl,"modes",w8);let j0=hl;var y8={default:{groups:{item:"item",items:"items"},columns:{},data:{loading:"Loading",error:"Error"},pagination:{page_size:"Page Size",page_title:"Show Page",first:"First",first_title:"First Page",last:"Last",last_title:"Last Page",prev:"Prev",prev_title:"Prev Page",next:"Next",next_title:"Next Page",all:"All",counter:{showing:"Showing",of:"of",rows:"rows",pages:"pages"}},headerFilters:{default:"filter column...",columns:{}}}};const jo=class jo extends ct{constructor(e){super(e),this.locale="default",this.lang=!1,this.bindings={},this.langList={},this.registerTableOption("locale",!1),this.registerTableOption("langs",{})}initialize(){this.langList=Wt.deepClone(jo.langs),this.table.options.columnDefaults.headerFilterPlaceholder!==!1&&this.setHeaderFilterPlaceholder(this.table.options.columnDefaults.headerFilterPlaceholder);for(let e in this.table.options.langs)this.installLang(e,this.table.options.langs[e]);this.setLocale(this.table.options.locale),this.registerTableFunction("setLocale",this.setLocale.bind(this)),this.registerTableFunction("getLocale",this.getLocale.bind(this)),this.registerTableFunction("getLang",this.getLang.bind(this))}setHeaderFilterPlaceholder(e){this.langList.default.headerFilters.default=e}installLang(e,t){this.langList[e]?this._setLangProp(this.langList[e],t):this.langList[e]=t}_setLangProp(e,t){for(let r in t)e[r]&&typeof e[r]=="object"?this._setLangProp(e[r],t[r]):e[r]=t[r]}setLocale(e){e=e||"default";function t(r,a){for(var s in r)typeof r[s]=="object"?(a[s]||(a[s]={}),t(r[s],a[s])):a[s]=r[s]}if(e===!0&&navigator.language&&(e=navigator.language.toLowerCase()),e&&!this.langList[e]){let r=e.split("-")[0];this.langList[r]?(console.warn("Localization Error - Exact matching locale not found, using closest match: ",e,r),e=r):(console.warn("Localization Error - Matching locale not found, using default: ",e),e="default")}this.locale=e,this.lang=Wt.deepClone(this.langList.default||{}),e!="default"&&t(this.langList[e],this.lang),this.dispatchExternal("localized",this.locale,this.lang),this._executeBindings()}getLocale(e){return this.locale}getLang(e){return e?this.langList[e]:this.lang}getText(e,t){var r=t?e+"|"+t:e,a=r.split("|"),s=this._getLangElement(a,this.locale);return s||""}_getLangElement(e,t){var r=this.lang;return e.forEach(function(a){var s;r&&(s=r[a],typeof s<"u"?r=s:r=!1)}),r}bind(e,t){this.bindings[e]||(this.bindings[e]=[]),this.bindings[e].push(t),t(this.getText(e),this.lang)}_executeBindings(){for(let e in this.bindings)this.bindings[e].forEach(t=>{t(this.getText(e),this.lang)})}};Be(jo,"moduleName","localize"),Be(jo,"langs",y8);let X0=jo;class qy extends ct{constructor(e){super(e)}initialize(){this.registerTableFunction("tableComms",this.receive.bind(this))}getConnections(e){var t=[],r;return r=this.table.constructor.registry.lookupTable(e),r.forEach(a=>{this.table!==a&&t.push(a)}),t}send(e,t,r,a){var s=this.getConnections(e);s.forEach(o=>{o.tableComms(this.table.element,t,r,a)}),!s.length&&e&&console.warn("Table Connection Error - No tables matching selector found",e)}receive(e,t,r,a){if(this.table.modExists(t))return this.table.modules[t].commsReceived(e,r,a);console.warn("Inter-table Comms Error - no such module:",t)}}Be(qy,"moduleName","comms");var E8=Object.freeze({__proto__:null,CommsModule:qy,LayoutModule:j0,LocalizeModule:X0});const pr=class pr{static findTable(e){var t=pr.registry.lookupTable(e,!0);return Array.isArray(t)&&!t.length?!1:t}};Be(pr,"registry",{tables:[],register(e){pr.registry.tables.push(e)},deregister(e){var t=pr.registry.tables.indexOf(e);t>-1&&pr.registry.tables.splice(t,1)},lookupTable(e,t){var r=[],a,s;if(typeof e=="string"){if(a=document.querySelectorAll(e),a.length)for(var o=0;o<a.length;o++)s=pr.registry.matchElement(a[o]),s&&r.push(s)}else typeof HTMLElement<"u"&&e instanceof HTMLElement||e instanceof pr?(s=pr.registry.matchElement(e),s&&r.push(s)):Array.isArray(e)?e.forEach(function(u){r=r.concat(pr.registry.lookupTable(u))}):t||console.warn("Table Connection Error - Invalid Selector",e);return r},matchElement(e){return pr.registry.tables.find(function(t){return e instanceof pr?t===e:t.element===e})}});let Y0=pr;const Ut=class Ut extends Y0{constructor(){super()}static initializeModuleBinder(e){Ut.modulesRegistered||(Ut.modulesRegistered=!0,Ut._registerModules(E8,!0),e&&Ut._registerModules(e))}static _extendModule(e,t,r){if(Ut.moduleBindings[e]){var a=Ut.moduleBindings[e][t];if(a)if(typeof r=="object")for(let s in r)a[s]=r[s];else console.warn("Module Error - Invalid value type, it must be an object");else console.warn("Module Error - property does not exist:",t)}else console.warn("Module Error - module does not exist:",e)}static _registerModules(e,t){var r=Object.values(e);t&&r.forEach(a=>{a.prototype.moduleCore=!0}),Ut._registerModule(r)}static _registerModule(e){Array.isArray(e)||(e=[e]),e.forEach(t=>{Ut._registerModuleBinding(t),Ut._registerModuleExtensions(t)})}static _registerModuleBinding(e){e.moduleName?Ut.moduleBindings[e.moduleName]=e:console.error("Unable to bind module, no moduleName defined",e.moduleName)}static _registerModuleExtensions(e){var t=e.moduleExtensions;if(e.moduleExtensions)for(let r in t){let a=t[r];if(Ut.moduleBindings[r])for(let s in a)Ut._extendModule(r,s,a[s]);else{Ut.moduleExtensions[r]||(Ut.moduleExtensions[r]={});for(let s in a)Ut.moduleExtensions[r][s]||(Ut.moduleExtensions[r][s]={}),Object.assign(Ut.moduleExtensions[r][s],a[s])}}Ut._extendModuleFromQueue(e)}static _extendModuleFromQueue(e){var t=Ut.moduleExtensions[e.moduleName];if(t)for(let r in t)Ut._extendModule(e.moduleName,r,t[r])}_bindModules(){var e=[],t=[],r=[];this.modules={};for(var a in Ut.moduleBindings){let s=Ut.moduleBindings[a],o=new s(this);this.modules[a]=o,s.prototype.moduleCore?this.modulesCore.push(o):s.moduleInitOrder?s.moduleInitOrder<0?e.push(o):t.push(o):r.push(o)}e.sort((s,o)=>s.moduleInitOrder>o.moduleInitOrder?1:-1),t.sort((s,o)=>s.moduleInitOrder>o.moduleInitOrder?1:-1),this.modulesRegular=e.concat(r.concat(t))}};Be(Ut,"moduleBindings",{}),Be(Ut,"moduleExtensions",{}),Be(Ut,"modulesRegistered",!1),Be(Ut,"defaultModules",!1);let q0=Ut;class C8 extends zi{constructor(e){super(e),this.element=this._createAlertElement(),this.msgElement=this._createMsgElement(),this.type=null,this.element.appendChild(this.msgElement)}_createAlertElement(){var e=document.createElement("div");return e.classList.add("tabulator-alert"),e}_createMsgElement(){var e=document.createElement("div");return e.classList.add("tabulator-alert-msg"),e.setAttribute("role","alert"),e}_typeClass(){return"tabulator-alert-state-"+this.type}alert(e,t="msg"){if(e){for(this.clear(),this.dispatch("alert-show",t),this.type=t;this.msgElement.firstChild;)this.msgElement.removeChild(this.msgElement.firstChild);this.msgElement.classList.add(this._typeClass()),typeof e=="function"&&(e=e()),e instanceof HTMLElement?this.msgElement.appendChild(e):this.msgElement.innerHTML=e,this.table.element.appendChild(this.element)}}clear(){this.dispatch("alert-hide",this.type),this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.msgElement.classList.remove(this._typeClass())}}const Ma=class Ma extends q0{static extendModule(){Ma.initializeModuleBinder(),Ma._extendModule(...arguments)}static registerModule(){Ma.initializeModuleBinder(),Ma._registerModule(...arguments)}constructor(e,t,r){super(),Ma.initializeModuleBinder(r),this.options={},this.columnManager=null,this.rowManager=null,this.footerManager=null,this.alertManager=null,this.vdomHoz=null,this.externalEvents=null,this.eventBus=null,this.interactionMonitor=!1,this.browser="",this.browserSlow=!1,this.browserMobile=!1,this.rtl=!1,this.originalElement=null,this.componentFunctionBinder=new h8(this),this.dataLoader=!1,this.modules={},this.modulesCore=[],this.modulesRegular=[],this.deprecationAdvisor=new m8(this),this.optionsList=new Yy(this,"table constructor"),this.dependencyRegistry=new g8(this),this.initialized=!1,this.destroyed=!1,this.initializeElement(e)&&(this.initializeCoreSystems(t),setTimeout(()=>{this._create()})),this.constructor.registry.register(this)}initializeElement(e){return typeof HTMLElement<"u"&&e instanceof HTMLElement?(this.element=e,!0):typeof e=="string"?(this.element=document.querySelector(e),this.element?!0:(console.error("Tabulator Creation Error - no element found matching selector: ",e),!1)):(console.error("Tabulator Creation Error - Invalid element provided:",e),!1)}initializeCoreSystems(e){this.columnManager=new n8(this),this.rowManager=new o8(this),this.footerManager=new u8(this),this.dataLoader=new f8(this),this.alertManager=new C8(this),this._bindModules(),this.options=this.optionsList.generate(Ma.defaultOptions,e),this._clearObjectPointers(),this._mapDeprecatedFunctionality(),this.externalEvents=new d8(this,this.options,this.options.debugEventsExternal),this.eventBus=new p8(this.options.debugEventsInternal),this.interactionMonitor=new c8(this),this.dataLoader.initialize(),this.footerManager.initialize(),this.dependencyRegistry.initialize()}_mapDeprecatedFunctionality(){}_clearSelection(){this.element.classList.add("tabulator-block-select"),window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty(),this.element.classList.remove("tabulator-block-select")}_create(){this.externalEvents.dispatch("tableBuilding"),this.eventBus.dispatch("table-building"),this._rtlCheck(),this._buildElement(),this._initializeTable(),this.initialized=!0,this._loadInitialData().finally(()=>{this.eventBus.dispatch("table-initialized"),this.externalEvents.dispatch("tableBuilt")})}_rtlCheck(){var e=window.getComputedStyle(this.element);switch(this.options.textDirection){case"auto":if(e.direction!=="rtl")break;case"rtl":this.element.classList.add("tabulator-rtl"),this.rtl=!0;break;case"ltr":this.element.classList.add("tabulator-ltr");default:this.rtl=!1}}_clearObjectPointers(){this.options.columns=this.options.columns.slice(0),Array.isArray(this.options.data)&&!this.options.reactiveData&&(this.options.data=this.options.data.slice(0))}_buildElement(){var e=this.element,t=this.options,r;if(e.tagName==="TABLE"){this.originalElement=this.element,r=document.createElement("div");var a=e.attributes;for(var s in a)typeof a[s]=="object"&&r.setAttribute(a[s].name,a[s].value);e.parentNode.replaceChild(r,e),this.element=e=r}for(e.classList.add("tabulator"),e.setAttribute("role","grid");e.firstChild;)e.removeChild(e.firstChild);t.height&&(t.height=isNaN(t.height)?t.height:t.height+"px",e.style.height=t.height),t.minHeight!==!1&&(t.minHeight=isNaN(t.minHeight)?t.minHeight:t.minHeight+"px",e.style.minHeight=t.minHeight),t.maxHeight!==!1&&(t.maxHeight=isNaN(t.maxHeight)?t.maxHeight:t.maxHeight+"px",e.style.maxHeight=t.maxHeight)}_initializeTable(){var e=this.element,t=this.options;this.interactionMonitor.initialize(),this.columnManager.initialize(),this.rowManager.initialize(),this._detectBrowser(),this.modulesCore.forEach(r=>{r.initialize()}),e.appendChild(this.columnManager.getElement()),e.appendChild(this.rowManager.getElement()),t.footerElement&&this.footerManager.activate(),t.autoColumns&&t.data&&this.columnManager.generateColumnsFromRowData(this.options.data),this.modulesRegular.forEach(r=>{r.initialize()}),this.columnManager.setColumns(t.columns),this.eventBus.dispatch("table-built")}_loadInitialData(){return this.dataLoader.load(this.options.data).finally(()=>{this.columnManager.verticalAlignHeaders()})}destroy(){var e=this.element;for(this.destroyed=!0,this.constructor.registry.deregister(this),this.eventBus.dispatch("table-destroy"),this.rowManager.destroy();e.firstChild;)e.removeChild(e.firstChild);e.classList.remove("tabulator"),this.externalEvents.dispatch("tableDestroyed")}_detectBrowser(){var e=navigator.userAgent||navigator.vendor||window.opera;e.indexOf("Trident")>-1?(this.browser="ie",this.browserSlow=!0):e.indexOf("Edge")>-1?(this.browser="edge",this.browserSlow=!0):e.indexOf("Firefox")>-1?(this.browser="firefox",this.browserSlow=!1):e.indexOf("Mac OS")>-1?(this.browser="safari",this.browserSlow=!1):(this.browser="other",this.browserSlow=!1),this.browserMobile=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(e.slice(0,4))}initGuard(e,t){var r,a;return this.options.debugInitialization&&!this.initialized&&(e||(r=new Error().stack.split(`
`),a=r[0]=="Error"?r[2]:r[1],a[0]==" "?e=a.trim().split(" ")[1].split(".")[1]:e=a.trim().split("@")[0]),console.warn("Table Not Initialized - Calling the "+e+" function before the table is initialized may result in inconsistent behavior, Please wait for the `tableBuilt` event before calling this function."+(t?" "+t:""))),this.initialized}blockRedraw(){this.initGuard(),this.eventBus.dispatch("redraw-blocking"),this.rowManager.blockRedraw(),this.columnManager.blockRedraw(),this.eventBus.dispatch("redraw-blocked")}restoreRedraw(){this.initGuard(),this.eventBus.dispatch("redraw-restoring"),this.rowManager.restoreRedraw(),this.columnManager.restoreRedraw(),this.eventBus.dispatch("redraw-restored")}setData(e,t,r){return this.initGuard(!1,"To set initial data please use the 'data' property in the table constructor."),this.dataLoader.load(e,t,r,!1)}clearData(){this.initGuard(),this.dataLoader.blockActiveLoad(),this.rowManager.clearData()}getData(e){return this.rowManager.getData(e)}getDataCount(e){return this.rowManager.getDataCount(e)}replaceData(e,t,r){return this.initGuard(),this.dataLoader.load(e,t,r,!0,!0)}updateData(e){var t=0;return this.initGuard(),new Promise((r,a)=>{this.dataLoader.blockActiveLoad(),typeof e=="string"&&(e=JSON.parse(e)),e&&e.length>0?e.forEach(s=>{var o=this.rowManager.findRow(s[this.options.index]);o?(t++,o.updateData(s).then(()=>{t--,t||r()}).catch(u=>{a("Update Error - Unable to update row",s,u)})):a("Update Error - Unable to find row",s)}):(console.warn("Update Error - No data provided"),a("Update Error - No data provided"))})}addData(e,t,r){return this.initGuard(),new Promise((a,s)=>{this.dataLoader.blockActiveLoad(),typeof e=="string"&&(e=JSON.parse(e)),e?this.rowManager.addRows(e,t,r).then(o=>{var u=[];o.forEach(function(h){u.push(h.getComponent())}),a(u)}):(console.warn("Update Error - No data provided"),s("Update Error - No data provided"))})}updateOrAddData(e){var t=[],r=0;return this.initGuard(),new Promise((a,s)=>{this.dataLoader.blockActiveLoad(),typeof e=="string"&&(e=JSON.parse(e)),e&&e.length>0?e.forEach(o=>{var u=this.rowManager.findRow(o[this.options.index]);r++,u?u.updateData(o).then(()=>{r--,t.push(u.getComponent()),r||a(t)}):this.rowManager.addRows(o).then(h=>{r--,t.push(h[0].getComponent()),r||a(t)})}):(console.warn("Update Error - No data provided"),s("Update Error - No data provided"))})}getRow(e){var t=this.rowManager.findRow(e);return t?t.getComponent():(console.warn("Find Error - No matching row found:",e),!1)}getRowFromPosition(e){var t=this.rowManager.getRowFromPosition(e);return t?t.getComponent():(console.warn("Find Error - No matching row found:",e),!1)}deleteRow(e){var t=[];this.initGuard(),Array.isArray(e)||(e=[e]);for(let r of e){let a=this.rowManager.findRow(r,!0);if(a)t.push(a);else return console.error("Delete Error - No matching row found:",r),Promise.reject("Delete Error - No matching row found")}return t.sort((r,a)=>this.rowManager.rows.indexOf(r)>this.rowManager.rows.indexOf(a)?1:-1),t.forEach(r=>{r.delete()}),this.rowManager.reRenderInPosition(),Promise.resolve()}addRow(e,t,r){return this.initGuard(),typeof e=="string"&&(e=JSON.parse(e)),this.rowManager.addRows(e,t,r,!0).then(a=>a[0].getComponent())}updateOrAddRow(e,t){var r=this.rowManager.findRow(e);return this.initGuard(),typeof t=="string"&&(t=JSON.parse(t)),r?r.updateData(t).then(()=>r.getComponent()):this.rowManager.addRows(t).then(a=>a[0].getComponent())}updateRow(e,t){var r=this.rowManager.findRow(e);return this.initGuard(),typeof t=="string"&&(t=JSON.parse(t)),r?r.updateData(t).then(()=>Promise.resolve(r.getComponent())):(console.warn("Update Error - No matching row found:",e),Promise.reject("Update Error - No matching row found"))}scrollToRow(e,t,r){var a=this.rowManager.findRow(e);return a?this.rowManager.scrollToRow(a,t,r):(console.warn("Scroll Error - No matching row found:",e),Promise.reject("Scroll Error - No matching row found"))}moveRow(e,t,r){var a=this.rowManager.findRow(e);this.initGuard(),a?a.moveToRow(t,r):console.warn("Move Error - No matching row found:",e)}getRows(e){return this.rowManager.getComponents(e)}getRowPosition(e){var t=this.rowManager.findRow(e);return t?t.getPosition():(console.warn("Position Error - No matching row found:",e),!1)}setColumns(e){this.initGuard(!1,"To set initial columns please use the 'columns' property in the table constructor"),this.columnManager.setColumns(e)}getColumns(e){return this.columnManager.getComponents(e)}getColumn(e){var t=this.columnManager.findColumn(e);return t?t.getComponent():(console.warn("Find Error - No matching column found:",e),!1)}getColumnDefinitions(){return this.columnManager.getDefinitionTree()}showColumn(e){var t=this.columnManager.findColumn(e);if(this.initGuard(),t)t.show();else return console.warn("Column Show Error - No matching column found:",e),!1}hideColumn(e){var t=this.columnManager.findColumn(e);if(this.initGuard(),t)t.hide();else return console.warn("Column Hide Error - No matching column found:",e),!1}toggleColumn(e){var t=this.columnManager.findColumn(e);if(this.initGuard(),t)t.visible?t.hide():t.show();else return console.warn("Column Visibility Toggle Error - No matching column found:",e),!1}addColumn(e,t,r){var a=this.columnManager.findColumn(r);return this.initGuard(),this.columnManager.addColumn(e,t,a).then(s=>s.getComponent())}deleteColumn(e){var t=this.columnManager.findColumn(e);return this.initGuard(),t?t.delete():(console.warn("Column Delete Error - No matching column found:",e),Promise.reject())}updateColumnDefinition(e,t){var r=this.columnManager.findColumn(e);return this.initGuard(),r?r.updateDefinition(t):(console.warn("Column Update Error - No matching column found:",e),Promise.reject())}moveColumn(e,t,r){var a=this.columnManager.findColumn(e),s=this.columnManager.findColumn(t);this.initGuard(),a?s?this.columnManager.moveColumn(a,s,r):console.warn("Move Error - No matching column found:",s):console.warn("Move Error - No matching column found:",e)}scrollToColumn(e,t,r){return new Promise((a,s)=>{var o=this.columnManager.findColumn(e);return o?this.columnManager.scrollToColumn(o,t,r):(console.warn("Scroll Error - No matching column found:",e),Promise.reject("Scroll Error - No matching column found"))})}redraw(e){this.initGuard(),this.columnManager.redraw(e),this.rowManager.redraw(e)}setHeight(e){this.options.height=isNaN(e)?e:e+"px",this.element.style.height=this.options.height,this.rowManager.initializeRenderer(),this.rowManager.redraw(!0)}on(e,t){this.externalEvents.subscribe(e,t)}off(e,t){this.externalEvents.unsubscribe(e,t)}dispatchEvent(){var e=Array.from(arguments);e.shift(),this.externalEvents.dispatch(...arguments)}alert(e,t){this.initGuard(),this.alertManager.alert(e,t)}clearAlert(){this.initGuard(),this.alertManager.clear()}modExists(e,t){return this.modules[e]?!0:(t&&console.error("Tabulator Module Not Installed: "+e),!1)}module(e){var t=this.modules[e];return t||console.error("Tabulator module not installed: "+e),t}};Be(Ma,"defaultOptions",i8);let K0=Ma;var wo=K0;class T8 extends wo{static extendModule(){wo.initializeModuleBinder(a0),wo._extendModule(...arguments)}static registerModule(){wo.initializeModuleBinder(a0),wo._registerModule(...arguments)}constructor(e,t,r){super(e,t,a0)}}var _8=T8;const Jb=i=>{i.map(e=>{const t=e;return e.title.toLowerCase()==="links"&&(t.formatter=S8),t})},S8=i=>{const e=i.getValue();let t="";if(e){const u=e.split("|");for(const h of u){u.length>=2&&console.log(h);const d=h.split(":");d[0].startsWith("http")?t+=`<a target="_blank" href='${h}'><img class="link-icon" src="images/link.svg" /></a> `:d[0]==="youtube"?t+=`<a target="_blank" href='https://www.youtube.com/watch?v=${d[1]}'><img class="link-icon" src="images/youtube.svg" /></a> `:console.log(`Unrecognized link type (${d[0]})`)}}const a=i.getRow().getData(),s=a.artist?a.artist.replace(/"/g,"").replace(/ /g,"+"):"",o=a.song?a.song.replace(/"/g,"").replace(/ /g,"+"):"";return t+=`<a target="_blank" href="https://www.youtube.com/results?search_query=${s}+${o}"><img class="link-icon" src="images/search.svg" /></a>`,t},R8=({data:i,columns:e})=>{const t=ne.useRef(null),r=ne.useRef(null),a=ne.useRef(i),s=ne.useRef(e);return ne.useEffect(()=>{if(console.log("init!"),t.current){const o=s.current.map(u=>({...u}));Jb(o),console.log(o),r.current=new _8(t.current,{data:a.current,columns:o,layout:"fitColumns"}),r.current.on("tableBuilt",()=>{})}return()=>{var o;(o=r.current)==null||o.destroy()}},[]),ne.useEffect(()=>{var o;console.log("[data, isTableBuilt]"),(o=r.current)!=null&&o.initialized&&i.length>0&&r.current.replaceData(i)},[i]),ne.useEffect(()=>{var o;if(console.log("[columns, isTableBuilt]"),(o=r.current)!=null&&o.initialized&&e.length>0){const u=e.map(h=>({...h}));Jb(u),console.log(e),r.current.setColumns(u)}},[e]),nt.jsx("div",{ref:t})};function k8(){const i=du(),{content:e,headers:t,metadata:r,loading:a,error:s}=pu(d=>d.file),[o]=WO(),u=o.get("url"),h=d=>{var b;const p=(b=d.target.files)==null?void 0:b[0];p&&i(Io(p))};return ne.useEffect(()=>{console.log(u),u&&i(Po(u))},[i,u]),nt.jsxs("div",{className:"song-list",children:[r.title&&nt.jsx("h1",{id:"page-title",children:r.title}),u?nt.jsx(nt.Fragment,{}):nt.jsx("input",{type:"file",accept:".csv,.xlsx,.xls,.txt",onChange:h,style:{marginBottom:"20px"}}),a&&nt.jsx("p",{children:"Loading file..."}),s&&nt.jsxs("p",{style:{color:"red"},children:["Error: ",s]}),nt.jsx(R8,{data:e.map(d=>({...d})),columns:t})]})}const A8=zO([{path:"/",element:nt.jsx(QO,{}),errorElement:nt.jsx(Kb,{}),loader:eL,children:[{index:!0,element:nt.jsx(k8,{})},{path:"/about",element:nt.jsx(iL,{})},{path:"/view",element:nt.jsx(rL,{})},{path:"/upload",element:nt.jsx(aL,{})},{path:"/home",element:nt.jsx(tL,{})},{path:"*",element:nt.jsx(Kb,{})}]}]);c2.createRoot(document.getElementById("root")).render(nt.jsx(ne.StrictMode,{children:nt.jsx(_2,{store:VF,children:nt.jsx(ZO,{router:A8})})}));
